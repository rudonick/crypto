/*
 2014-2015, Rudolf Nickolaev. All rights reserved.
*/
(function(c,g){"function"===typeof define&&define.amd?define(["gostRandom","gostCipher","gostDigest","gostSign"],g):"object"===typeof exports?module.exports=g(require("gostRandom"),require("gostCipher"),require("gostDigest"),require("gostSign")):("undefined"!==typeof importScripts&&(c.GostRandom&&c.GostCipher&&c.GostDigest&&c.GostSign||importScripts("gostRandom.js","gostCipher.js","gostDigest.js","gostSign.js")),c.gostEngine=g(c.GostRandom,c.GostCipher,c.GostDigest,c.GostSign))})(this,function(c,
g,k,l){var f=this,m={execute:function(b,a,c){var e;if(!b)throw new (f.SyntaxError||Error)("Algorithm not defined");if(!b.name)throw new (f.SyntaxError||Error)("Algorithm name not defined");e=b.name;var d=b.mode;if("GOST 28147"!==e&&"GOST R 34.12"!==e&&"RC2"!==e||"generateKey"!==a&&("MAC"!==d||"sign"!==a&&"verify"!==a)&&("KW"!==d&&"MASK"!==d||"wrapKey"!==a&&"unwrapKey"!==a)&&(d&&"ES"!==d||"encrypt"!==a&&"decrypt"!==a))if("GOST R 34.11"!==e&&"SHA"!==e||"digest"!==a&&("HMAC"!==d||"sign"!==a&&"verify"!==
a&&"generateKey"!==a)&&("KDF"!==d&&"PBKDF2"!==d&&"PFXKDF"!==d&&"CPKDF"!==d||"deriveKey"!==a&&"deriveBits"!==a&&"generateKey"!==a)){if("GOST R 34.10"!==e||"generateKey"!==a&&(d&&"SIGN"!==d||"sign"!==a&&"verify"!==a)&&("MASK"!==d||"wrapKey"!==a&&"unwrapKey"!==a)&&("DH"!==d||"deriveKey"!==a&&"deriveBits"!==a))throw new (f.NotSupportedError||Error)("Algorithm "+e+"-"+d+" is not valid for "+a);e="GostSign"}else e="GostDigest";else e="GostCipher";b=this["get"+e](b);return b[a].apply(b,c)},getGostCipher:function(b){return new (g||
(g=f.GostCipher))(b)},getGostDigest:function(b){return new (k||(k=f.GostDigest))(b)},getGostSign:function(b){return new (l||(l=f.GostSign))(b)}};if(f.importScripts)f.onmessage=function(b){try{postMessage({id:b.data.id,result:m.execute(b.data.algorithm,b.data.method,b.data.args)})}catch(a){postMessage({id:b.data.id,error:a.message})}};else{var n="",p="";"undefined"!==typeof document&&function(){for(var b=/^(.*)gostCrypto(.*)\.js$/i,a=document.querySelectorAll("script"),c=0,e=a.length;c<e;c++){var d=
a[c].getAttribute("src");if(d=b.exec(d))n=d[1],p=d[2]}}();var h=function(){for(var b=0,a=arguments.length;b<a;b++){var c=arguments[b].split("."),c=n+c[0]+p+"."+c[1],e=document.querySelector('script[src="'+c+'"]');e||(e=document.createElement("script"),e.setAttribute("src",c),document.head.appendChild(e))}};c||h("gostRandom.js");g||h("gostCipher.js");k||h("gostDigest.js");l||h("gostSign.js")}return m});
