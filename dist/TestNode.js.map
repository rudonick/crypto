{"version":3,"sources":["webpack://crypto-gost-js/webpack/universalModuleDefinition","webpack://crypto-gost-js/webpack/bootstrap","webpack://crypto-gost-js/./src/utils/errors.js","webpack://crypto-gost-js/./src/utils/seeds.js","webpack://crypto-gost-js/./src/crypto/gostCoding.js","webpack://crypto-gost-js/./src/engine/gostDigest.js","webpack://crypto-gost-js/./src/engine/gostCipher.js","webpack://crypto-gost-js/./src/utils/environment.js","webpack://crypto-gost-js/./src/gostRandom.js","webpack://crypto-gost-js/./src/engine/gostSign.js","webpack://crypto-gost-js/external \"crypto\"","webpack://crypto-gost-js/./test/gostSign.test.js","webpack://crypto-gost-js/./test/gostDigest.test.js","webpack://crypto-gost-js/./test/gostCipher.test.js","webpack://crypto-gost-js/./test/index.js"],"names":["NotSupportedError","Error","DataError","OperationError","getSeed","randomSeed","length","gostRandom","GostRandom","d","Uint8Array","Math","ceil","getRandomValues","e","GostCoding","CryptoOperationData","ArrayBuffer","buffer","byteOffset","byteLength","Base64","decode","s","replace","n","k","r","m3","m4","u24","j","i","c","charCodeAt","encode","data","slen","String","fromCharCode","substr","prototype","Chars","_win1251_","_win1251back_","from","to","charset","toLowerCase","push","first","second","join","Hex","endean","indexOf","parseInt","toString","slice","Int16","neg","charAt","substring","test","t","v","BER","encodeBER","source","format","onlyContent","object","undefined","tagClass","tagNumber","Array","Date","tagConstructed","content","a","set","bytelen","ba","offset","sort","b","min","unusedBits","match","r1","result","original","date","setMinutes","getMinutes","getTimezoneOffset","ms","getMilliseconds","getYear","getFullYear","getMonth","getDate","getHours","getSeconds","size","Unit8Array","ha","ha1","len","l2","ha2","header","block","decodeBER","pos","start","sub","buf","end","subarray","unusedBit","skip","reverse","bits","m","shortYear","exec","dt","tz","toUpperCase","PEM","name","deep","index","re1","valid","re2","RegExp","re3","out","gostCodingInstance","GostDigest","arraycopy","sOfs","dOfs","swap","src","dst","b64decode","digest2012","buffer0","Int32Array","buffer512","C","h","Ax","sigma","N","get8","x","add512","y","CF","w0","w1","get512","copy512","new512","xor512","XLPS","z0","z1","Ki","g","stage2","stage3","b0","m0","bitLength","q","call","digest","procreator","digest94","H","M","Sum","P","K","A","fw","wS","Uint16Array","wS15","encrypt","key","sOff","dOff","cipher","process","S","U","V","W","tmpA","summing","carry","sum","C2","L","n8","floor","digestSHA1","state","Uint32Array","common","w","f","f1","f2","f3","f4","cycle","fn","swap32","dlen","ofs","o","signHMAC","l","k0","s0","s1","verifyHMAC","signature","hmac","sign","generateKey","deriveBitsPFXKDF","baseKey","u","iterations","ID","diversifier","D","S0","salt","P0","p","plen","I","B","cf","R","deriveBitsKDF","rlen","label","context","blen","deriveBitsPBKDF1","hLen","dkLen","T","DK","deriveBitsPBKDF2","Z","rLen","deriveBitsCP","deriveKey","deriveBits","keySize","algorithm","version","mode","sBox","GostCipher","verify","littleEndian","DataView","setInt16","Int16Array","defaultIV","sBoxes","signed","unsigned","byteArray","cloneArray","intArray","defaultIV128","multTable","gmul","counter","kB","funcR","funcReverseR","tmp","kPi","kReversePi","funcS","funcReverseS","funcX","funcL","funcReverseL","funcLSX","funcReverseLSX","funcF","inputKey","inputKeySecond","iterationConst","funcC","number","keySchedule128","keys","j0","j1","process128","round","cm","om","process89","process15","keySchedule89","sch","keySchedule15","keyScheduleRC2","PITABLE","T1","effectiveLength","T8","TM","pow","processRC2","rol","ror","mix","mash","perform","method","count","encryptECB","pad","blockSize","keySchedule","decryptECB","unpad","encryptCFB","iv","shiftBits","cb","keyMeshing","decryptCFB","processOFB","processCTR89","Int8Array","syn","processCTR15","encryptCBC","decryptCBC","next","processMAC89","zeroPad","processKeyMAC15","t1","processMAC15","bitPad","signMAC","macLength","processMAC","mac","verifyMAC","wrapKeyGOST","kek","cek","ukm","enc","unwrapKeyGOST","check","diversifyKEK","wrapKeyCP","dek","unwrapKeyCP","packKeySC","unpacked","mcount","zero32","mask","unpackKeySC","packed","magic","names","wrapKeySC","unwrapKeySC","generateWrappingKeySC","maskKey","inverse","m32","k32","r32","wrapKeyMask","unwrapKeyMask","keyMeshingCP","noKeyMeshing","noPad","pkcs5Pad","nb","pkcs5Unpad","bitUnpad","randomPad","blockLength","keyWrapping","padding","decrypt","wrapKey","unwrapKey","sBoxName","SyntaxError","getRoot","getCryptoModule","isInNode","isBrowser","isInWebWorker","global","self","root","hasOwnProperty","crypto","msCrypto","require","exports","module","window","importScripts","randomRing","seed","getIndex","setIndex","get","document","addEventListener","getTime","clientX","pageX","clientY","pageY","keyCode","TypeMismatchError","QuotaExceededError","rootCryptoModule","array","u8","random","GostSign","ECGostParams","GostParams","modulusLength","DB","DM","DV","FV","F1","F2","am","xl","xh","nbi","words","copyTo","copy","setInt","nbv","ZERO","ONE","THREE","clamp","subTo","addTo","add","negTo","absTo","abs","compare","equals","max","nbits","dshlTo","dshrTo","shlTo","bs","cbs","bm","ds","shrTo","shl","shr","mulTo","mul","sqrTo","sqr","divRemTo","pm","pt","ts","nsh","ys","y0","yt","d1","d2","qd","modTo","mod","div","isEven","isZero","sig","invMod","ac","subtract","testBit","nothing","extend","Classic","convert","revert","reduce","invDig","Montgomery","mp","mpl","mph","um","mt2","u0","dAddOffset","mulLowerTo","mulUpperTo","Barrett","r2","q3","mu","expMod","z","k1","km","g2","is1","newFE","copyFE","negFE","addFE","subFE","mulFE","sqrFE","shlFE","invFE","newEC","curve","getX","point","zinv","getY","isInfinity","getInfinity","infinity","equalsEC","negEC","addEC","twiceEC","x1","y1","v2","v3","x1v2","zu2","x3","y3","z3","y1z1","y1sqz1","mulEC","hBit","eBit","mul2AndAddEC","Q","mulTwoEC","both","newCurve","atobi","sh","bitoa","r8","htobi","Number","mi","bitoh","bitoi","itobi","hash","to2","from2","privateKey","alpha","zetta","publicKey","z2","k2","generateMaskKey","derive","peer_Q","peer_y","namedParam","namedCurve","param","hashLen","keyLen","keyLength","tests","println","tests2","gostCoding","performDerive","tag","postMessage","log","console","el","createElement","innerHTML","getElementById","body","appendChild","id","message","output","keyPair","verified","keyPair1","keyPair2","privateKey1","publicKey1","privateKey2","publicKey2","public","kek1","finish","kek2","pk","maskdb","mkdb","sign0","pubkey","performance","million_a","tests3","input1","output1","input2","output2","input3","output3","input4","output4","TestSBox","gkeyBytes5","gkeyBytes6","input5","input6","output5","output6","performMac","input","performWrap","key64","inp64","key128","inp128","res"],"mappings":"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","file":"TestNode.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"crypto-gost-js\"] = factory();\n\telse\n\t\troot[\"crypto-gost-js\"] = factory();\n})(global, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 23);\n","export class NotSupportedError extends Error {\r\n}\r\n\r\nexport class DataError extends Error {\r\n}\r\n\r\nexport class OperationError extends Error {\r\n}\r\n","import { GostRandom } from '../gostRandom';\r\n\r\n// Get random values\r\nexport function getSeed(length) {\r\n    const gostRandom = new GostRandom();\r\n    try {\r\n        const d = new Uint8Array(Math.ceil(length / 8));\r\n        gostRandom.getRandomValues(d);\r\n        return d;\r\n    } catch (e) {\r\n        throw new Error('Error occurred during random values generation');\r\n    }\r\n}\r\n\r\n// Set random values into Uint8Arry\r\n// Random generator\r\nexport function randomSeed(e) {\r\n    try {\r\n        const gostRandom = new GostRandom();\r\n        return gostRandom.getRandomValues(e);\r\n    } catch (e) {\r\n        throw new Error('Error occurred during random values generation');\r\n    }\r\n}\r\n","/**\r\n * @file Coding algorithms: Base64, Hex, Int16, Chars, BER and PEM\r\n * @version 1.76\r\n * @copyright 2014-2016, Rudolf Nickolaev. All rights reserved.\r\n */\r\n\r\nimport { DataError } from '../utils/errors';\r\n\r\n/**\r\n * The Coding interface provides string converting methods: Base64, Hex,\r\n * Int16, Chars, BER and PEM\r\n * @class GostCoding\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\nvar CryptoOperationData = ArrayBuffer;\r\n\r\nfunction buffer(d) {\r\n    if (d instanceof CryptoOperationData)\r\n        return d;\r\n    else if (d && d.buffer && d.buffer instanceof CryptoOperationData)\r\n        return d.byteOffset === 0 && d.byteLength === d.buffer.byteLength ?\r\n          d.buffer : new Uint8Array(new Uint8Array(d, d.byteOffset, d.byteLength)).buffer;\r\n    else\r\n        throw new DataError('CryptoOperationData required');\r\n} // </editor-fold>\r\n\r\nexport function GostCoding() {\r\n}\r\n\r\n/**\r\n * BASE64 conversion\r\n *\r\n * @class GostCoding.Base64\r\n */\r\nvar Base64 = {// <editor-fold defaultstate=\"collapsed\">\r\n    /**\r\n     * Base64.decode convert BASE64 string s to CryptoOperationData\r\n     *\r\n     * @memberOf GostCoding.Base64\r\n     * @param {String} s BASE64 encoded string value\r\n     * @returns {CryptoOperationData} Binary decoded data\r\n     */\r\n    decode: function (s) {\r\n        s = s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\r\n        var n = s.length,\r\n          k = n * 3 + 1 >> 2, r = new Uint8Array(k);\r\n\r\n        for (var m3, m4, u24 = 0, j = 0, i = 0; i < n; i++) {\r\n            m4 = i & 3;\r\n            var c = s.charCodeAt(i);\r\n\r\n            c = c > 64 && c < 91 ?\r\n              c - 65 : c > 96 && c < 123 ?\r\n                c - 71 : c > 47 && c < 58 ?\r\n                  c + 4 : c === 43 ?\r\n                    62 : c === 47 ?\r\n                      63 : 0;\r\n\r\n            u24 |= c << 18 - 6 * m4;\r\n            if (m4 === 3 || n - i === 1) {\r\n                for (m3 = 0; m3 < 3 && j < k; m3++, j++) {\r\n                    r[j] = u24 >>> (16 >>> m3 & 24) & 255;\r\n                }\r\n                u24 = 0;\r\n\r\n            }\r\n        }\r\n        return r.buffer;\r\n    },\r\n    /**\r\n     * Base64.encode(data) convert CryptoOperationData data to BASE64 string\r\n     *\r\n     * @memberOf GostCoding.Base64\r\n     * @param {CryptoOperationData} data Bynary data for encoding\r\n     * @returns {String} BASE64 encoded data\r\n     */\r\n    encode: function (data) {\r\n        var slen = 8, d = new Uint8Array(buffer(data));\r\n        var m3 = 2, s = '';\r\n        for (var n = d.length, u24 = 0, i = 0; i < n; i++) {\r\n            m3 = i % 3;\r\n            if (i > 0 && (i * 4 / 3) % (12 * slen) === 0)\r\n                s += '\\r\\n';\r\n            u24 |= d[i] << (16 >>> m3 & 24);\r\n            if (m3 === 2 || n - i === 1) {\r\n                for (var j = 18; j >= 0; j -= 6) {\r\n                    var c = u24 >>> j & 63;\r\n                    c = c < 26 ? c + 65 : c < 52 ? c + 71 : c < 62 ? c - 4 :\r\n                      c === 62 ? 43 : c === 63 ? 47 : 65;\r\n                    s += String.fromCharCode(c);\r\n                }\r\n                u24 = 0;\r\n            }\r\n        }\r\n        return s.substr(0, s.length - 2 + m3) + (m3 === 2 ? '' : m3 === 1 ? '=' : '==');\r\n    } // </editor-fold>\r\n};\r\n\r\n/**\r\n * BASE64 conversion\r\n *\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.Base64\r\n */\r\nGostCoding.prototype.Base64 = Base64;\r\n\r\n/**\r\n * Text string conversion <br>\r\n * Methods support charsets: ascii, win1251, utf8, utf16 (ucs2, unicode), utf32 (ucs4)\r\n *\r\n * @class GostCoding.Chars\r\n */\r\nvar Chars = (function () { // <editor-fold defaultstate=\"collapsed\">\r\n\r\n    var _win1251_ = {\r\n        0x402: 0x80,\r\n        0x403: 0x81,\r\n        0x201A: 0x82,\r\n        0x453: 0x83,\r\n        0x201E: 0x84,\r\n        0x2026: 0x85,\r\n        0x2020: 0x86,\r\n        0x2021: 0x87,\r\n        0x20AC: 0x88,\r\n        0x2030: 0x89,\r\n        0x409: 0x8A,\r\n        0x2039: 0x8B,\r\n        0x40A: 0x8C,\r\n        0x40C: 0x8D,\r\n        0x40B: 0x8E,\r\n        0x40f: 0x8f,\r\n        0x452: 0x90,\r\n        0x2018: 0x91,\r\n        0x2019: 0x92,\r\n        0x201C: 0x93,\r\n        0x201D: 0x94,\r\n        0x2022: 0x95,\r\n        0x2013: 0x96,\r\n        0x2014: 0x97,\r\n        0x2122: 0x99,\r\n        0x459: 0x9A,\r\n        0x203A: 0x9B,\r\n        0x45A: 0x9C,\r\n        0x45C: 0x9D,\r\n        0x45B: 0x9E,\r\n        0x45f: 0x9f,\r\n        0xA0: 0xA0,\r\n        0x40E: 0xA1,\r\n        0x45E: 0xA2,\r\n        0x408: 0xA3,\r\n        0xA4: 0xA4,\r\n        0x490: 0xA5,\r\n        0xA6: 0xA6,\r\n        0xA7: 0xA7,\r\n        0x401: 0xA8,\r\n        0xA9: 0xA9,\r\n        0x404: 0xAA,\r\n        0xAB: 0xAB,\r\n        0xAC: 0xAC,\r\n        0xAD: 0xAD,\r\n        0xAE: 0xAE,\r\n        0x407: 0xAf,\r\n        0xB0: 0xB0,\r\n        0xB1: 0xB1,\r\n        0x406: 0xB2,\r\n        0x456: 0xB3,\r\n        0x491: 0xB4,\r\n        0xB5: 0xB5,\r\n        0xB6: 0xB6,\r\n        0xB7: 0xB7,\r\n        0x451: 0xB8,\r\n        0x2116: 0xB9,\r\n        0x454: 0xBA,\r\n        0xBB: 0xBB,\r\n        0x458: 0xBC,\r\n        0x405: 0xBD,\r\n        0x455: 0xBE,\r\n        0x457: 0xBf\r\n    };\r\n    var _win1251back_ = {};\r\n    for (var from in _win1251_) {\r\n        var to = _win1251_[from];\r\n        _win1251back_[to] = from;\r\n    }\r\n\r\n    return {\r\n        /**\r\n         * Chars.decode(s, charset) convert string s with defined charset to CryptoOperationData\r\n         *\r\n         * @memberOf GostCoding.Chars\r\n         * @param {string} s Javascript string\r\n         * @param {string} charset Charset, default 'win1251'\r\n         * @returns {CryptoOperationData} Decoded binary data\r\n         */\r\n        decode: function (s, charset) {\r\n            charset = (charset || 'win1251').toLowerCase().replace('-', '');\r\n            var r = [];\r\n            for (var i = 0, j = s.length; i < j; i++) {\r\n                var c = s.charCodeAt(i);\r\n                if (charset === 'utf8') {\r\n                    if (c < 0x80) {\r\n                        r.push(c);\r\n                    } else if (c < 0x800) {\r\n                        r.push(0xc0 + (c >>> 6));\r\n                        r.push(0x80 + (c & 63));\r\n                    } else if (c < 0x10000) {\r\n                        r.push(0xe0 + (c >>> 12));\r\n                        r.push(0x80 + (c >>> 6 & 63));\r\n                        r.push(0x80 + (c & 63));\r\n                    } else if (c < 0x200000) {\r\n                        r.push(0xf0 + (c >>> 18));\r\n                        r.push(0x80 + (c >>> 12 & 63));\r\n                        r.push(0x80 + (c >>> 6 & 63));\r\n                        r.push(0x80 + (c & 63));\r\n                    } else if (c < 0x4000000) {\r\n                        r.push(0xf8 + (c >>> 24));\r\n                        r.push(0x80 + (c >>> 18 & 63));\r\n                        r.push(0x80 + (c >>> 12 & 63));\r\n                        r.push(0x80 + (c >>> 6 & 63));\r\n                        r.push(0x80 + (c & 63));\r\n                    } else {\r\n                        r.push(0xfc + (c >>> 30));\r\n                        r.push(0x80 + (c >>> 24 & 63));\r\n                        r.push(0x80 + (c >>> 18 & 63));\r\n                        r.push(0x80 + (c >>> 12 & 63));\r\n                        r.push(0x80 + (c >>> 6 & 63));\r\n                        r.push(0x80 + (c & 63));\r\n                    }\r\n                } else if (charset === 'unicode' || charset === 'ucs2' || charset === 'utf16') {\r\n                    if (c < 0xD800 || (c >= 0xE000 && c <= 0x10000)) {\r\n                        r.push(c >>> 8);\r\n                        r.push(c & 0xff);\r\n                    } else if (c >= 0x10000 && c < 0x110000) {\r\n                        c -= 0x10000;\r\n                        var first = ((0xffc00 & c) >> 10) + 0xD800;\r\n                        var second = (0x3ff & c) + 0xDC00;\r\n                        r.push(first >>> 8);\r\n                        r.push(first & 0xff);\r\n                        r.push(second >>> 8);\r\n                        r.push(second & 0xff);\r\n                    }\r\n                } else if (charset === 'utf32' || charset === 'ucs4') {\r\n                    r.push(c >>> 24 & 0xff);\r\n                    r.push(c >>> 16 & 0xff);\r\n                    r.push(c >>> 8 & 0xff);\r\n                    r.push(c & 0xff);\r\n                } else if (charset === 'win1251') {\r\n                    if (c >= 0x80) {\r\n                        if (c >= 0x410 && c < 0x450) // ....\r\n                            c -= 0x350;\r\n                        else\r\n                            c = _win1251_[c] || 0;\r\n                    }\r\n                    r.push(c);\r\n                } else\r\n                    r.push(c & 0xff);\r\n            }\r\n            return new Uint8Array(r).buffer;\r\n        },\r\n        /**\r\n         * Chars.encode(data, charset) convert CryptoOperationData data to string with defined charset\r\n         *\r\n         * @memberOf GostCoding.Chars\r\n         * @param {CryptoOperationData} data Binary data\r\n         * @param {string} charset Charset, default win1251\r\n         * @returns {string} Encoded javascript string\r\n         */\r\n        encode: function (data, charset) {\r\n            charset = (charset || 'win1251').toLowerCase().replace('-', '');\r\n            var r = [], d = new Uint8Array(buffer(data));\r\n            for (var i = 0, n = d.length; i < n; i++) {\r\n                var c = d[i];\r\n                if (charset === 'utf8') {\r\n                    c = c >= 0xfc && c < 0xfe && i + 5 < n ? // six bytes\r\n                      (c - 0xfc) * 1073741824 + (d[++i] - 0x80 << 24) + (d[++i] - 0x80 << 18) + (d[++i] - 0x80 << 12) + (d[++i] - 0x80 << 6) + d[++i] - 0x80\r\n                      : c >> 0xf8 && c < 0xfc && i + 4 < n ? // five bytes\r\n                        (c - 0xf8 << 24) + (d[++i] - 0x80 << 18) + (d[++i] - 0x80 << 12) + (d[++i] - 0x80 << 6) + d[++i] - 0x80\r\n                        : c >> 0xf0 && c < 0xf8 && i + 3 < n ? // four bytes\r\n                          (c - 0xf0 << 18) + (d[++i] - 0x80 << 12) + (d[++i] - 0x80 << 6) + d[++i] - 0x80\r\n                          : c >= 0xe0 && c < 0xf0 && i + 2 < n ? // three bytes\r\n                            (c - 0xe0 << 12) + (d[++i] - 0x80 << 6) + d[++i] - 0x80\r\n                            : c >= 0xc0 && c < 0xe0 && i + 1 < n ? // two bytes\r\n                              (c - 0xc0 << 6) + d[++i] - 0x80\r\n                              : c; // one byte\r\n                } else if (charset === 'unicode' || charset === 'ucs2' || charset === 'utf16') {\r\n                    c = (c << 8) + d[++i];\r\n                    if (c >= 0xD800 && c < 0xE000) {\r\n                        var first = (c - 0xD800) << 10;\r\n                        c = d[++i];\r\n                        c = (c << 8) + d[++i];\r\n                        var second = c - 0xDC00;\r\n                        c = first + second + 0x10000;\r\n                    }\r\n                } else if (charset === 'utf32' || charset === 'ucs4') {\r\n                    c = (c << 8) + d[++i];\r\n                    c = (c << 8) + d[++i];\r\n                    c = (c << 8) + d[++i];\r\n                } else if (charset === 'win1251') {\r\n                    if (c >= 0x80) {\r\n                        if (c >= 0xC0 && c < 0x100)\r\n                            c += 0x350; // ....\r\n                        else\r\n                            c = _win1251back_[c] || 0;\r\n                    }\r\n                }\r\n                r.push(String.fromCharCode(c));\r\n            }\r\n            return r.join('');\r\n        }\r\n    }; // </editor-fold>\r\n})();\r\n\r\n/**\r\n * Text string conversion\r\n *\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.Chars\r\n */\r\nGostCoding.prototype.Chars = Chars;\r\n\r\n/**\r\n * HEX conversion\r\n *\r\n * @class GostCoding.Hex\r\n */\r\nvar Hex = {// <editor-fold defaultstate=\"collapsed\">\r\n    /**\r\n     * Hex.decode(s, endean) convert HEX string s to CryptoOperationData in endean mode\r\n     *\r\n     * @memberOf GostCoding.Hex\r\n     * @param {string} s Hex encoded string\r\n     * @param {boolean} endean Little or Big Endean, default Little\r\n     * @returns {CryptoOperationData} Decoded binary data\r\n     */\r\n    decode: function (s, endean) {\r\n        s = s.replace(/[^A-fa-f0-9]/g, '');\r\n        var n = Math.ceil(s.length / 2), r = new Uint8Array(n);\r\n        s = (s.length % 2 > 0 ? '0' : '') + s;\r\n        if (endean && ((typeof endean !== 'string') ||\r\n          (endean.toLowerCase().indexOf('little') < 0)))\r\n            for (var i = 0; i < n; i++)\r\n                r[i] = parseInt(s.substr((n - i - 1) * 2, 2), 16);\r\n        else\r\n            for (var i = 0; i < n; i++)\r\n                r[i] = parseInt(s.substr(i * 2, 2), 16);\r\n        return r.buffer;\r\n    },\r\n    /**\r\n     * Hex.encode(data, endean) convert CryptoOperationData data to HEX string in endean mode\r\n     *\r\n     * @memberOf GostCoding.Hex\r\n     * @param {CryptoOperationData} data Binary data\r\n     * @param {boolean} endean Little/Big Endean, default Little\r\n     * @returns {string} Hex decoded string\r\n     */\r\n    encode: function (data, endean) {\r\n        var s = [], d = new Uint8Array(buffer(data)), n = d.length;\r\n        if (endean && ((typeof endean !== 'string') ||\r\n          (endean.toLowerCase().indexOf('little') < 0)))\r\n            for (var i = 0; i < n; i++) {\r\n                var j = n - i - 1;\r\n                s[j] = (j > 0 && j % 32 === 0 ? '\\r\\n' : '') +\r\n                  ('00' + d[i].toString(16)).slice(-2);\r\n            }\r\n        else\r\n            for (var i = 0; i < n; i++)\r\n                s[i] = (i > 0 && i % 32 === 0 ? '\\r\\n' : '') +\r\n                  ('00' + d[i].toString(16)).slice(-2);\r\n        return s.join('');\r\n    } // </editor-fold>\r\n};\r\n\r\n/**\r\n *  HEX conversion\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.Hex\r\n */\r\nGostCoding.prototype.Hex = Hex;\r\n\r\n/**\r\n * String hex-encoded integer conversion\r\n *\r\n * @class GostCoding.Int16\r\n */\r\nvar Int16 = {// <editor-fold defaultstate=\"collapsed\">\r\n    /**\r\n     * Int16.decode(s) convert hex big insteger s to CryptoOperationData\r\n     *\r\n     * @memberOf GostCoding.Int16\r\n     * @param {string} s Int16 string\r\n     * @returns {CryptoOperationData} Decoded binary data\r\n     */\r\n    decode: function (s) {\r\n        s = (s || '').replace(/[^\\-A-fa-f0-9]/g, '');\r\n        if (s.length === 0)\r\n            s = '0';\r\n        // Signature\r\n        var neg = false;\r\n        if (s.charAt(0) === '-') {\r\n            neg = true;\r\n            s = s.substring(1);\r\n        }\r\n        // Align 2 chars\r\n        while (s.charAt(0) === '0' && s.length > 1)\r\n            s = s.substring(1);\r\n        s = (s.length % 2 > 0 ? '0' : '') + s;\r\n        // Padding for singanuture\r\n        // '800000' - 'ffffff' - for positive\r\n        // '800001' - 'ffffff' - for negative\r\n        if ((!neg && !/^[0-7]/.test(s)) ||\r\n          (neg && !/^[0-7]|8[0]+$/.test(s)))\r\n            s = '00' + s;\r\n        // Convert hex\r\n        var n = s.length / 2, r = new Uint8Array(n), t = 0;\r\n        for (var i = n - 1; i >= 0; --i) {\r\n            var c = parseInt(s.substr(i * 2, 2), 16);\r\n            if (neg && (c + t > 0)) {\r\n                c = 256 - c - t;\r\n                t = 1;\r\n            }\r\n            r[i] = c;\r\n        }\r\n        return r.buffer;\r\n    },\r\n    /**\r\n     * Int16.encode(data) convert CryptoOperationData data to big integer hex string\r\n     *\r\n     * @memberOf GostCoding.Int16\r\n     * @param {CryptoOperationData} data Binary data\r\n     * @returns {string} Int16 encoded string\r\n     */\r\n    encode: function (data) {\r\n        var d = new Uint8Array(buffer(data)), n = d.length;\r\n        if (d.length === 0)\r\n            return '0x00';\r\n        var s = [], neg = d[0] > 0x7f, t = 0;\r\n        for (var i = n - 1; i >= 0; --i) {\r\n            var v = d[i];\r\n            if (neg && (v + t > 0)) {\r\n                v = 256 - v - t;\r\n                t = 1;\r\n            }\r\n            s[i] = ('00' + v.toString(16)).slice(-2);\r\n        }\r\n        s = s.join('');\r\n        while (s.charAt(0) === '0')\r\n            s = s.substring(1);\r\n        return (neg ? '-' : '') + '0x' + s;\r\n    } // </editor-fold>\r\n};\r\n\r\n/**\r\n * String hex-encoded integer conversion\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.Int16\r\n */\r\nGostCoding.prototype.Int16 = Int16;\r\n\r\n/**\r\n * BER, DER, CER conversion\r\n *\r\n * @class GostCoding.BER\r\n */\r\nvar BER = (function () { // <editor-fold defaultstate=\"collapsed\">\r\n\r\n    // Predefenition block\r\n    function encodeBER(source, format, onlyContent) {\r\n        // Correct primitive type\r\n        var object = source.object;\r\n        if (object === undefined)\r\n            object = source;\r\n\r\n        // Determinate tagClass\r\n        var tagClass = source.tagClass = source.tagClass || 0; // Universial default\r\n\r\n        // Determinate tagNumber. Use only for Universal class\r\n        if (tagClass === 0) {\r\n            var tagNumber = source.tagNumber;\r\n            if (typeof tagNumber === 'undefined') {\r\n                if (typeof object === 'string') {\r\n                    if (object === '')   // NULL\r\n                        tagNumber = 0x05;\r\n                    else if (/^\\-?0x[0-9a-fA-F]+$/.test(object)) // INTEGER\r\n                        tagNumber = 0x02;\r\n                    else if (/^(\\d+\\.)+\\d+$/.test(object)) // OID\r\n                        tagNumber = 0x06;\r\n                    else if (/^[01]+$/.test(object)) // BIT STRING\r\n                        tagNumber = 0x03;\r\n                    else if (/^(true|false)$/.test(object)) // BOOLEAN\r\n                        tagNumber = 0x01;\r\n                    else if (/^[0-9a-fA-F]+$/.test(object)) // OCTET STRING\r\n                        tagNumber = 0x04;\r\n                    else\r\n                        tagNumber = 0x13; // Printable string (later can be changed to UTF8String)\r\n                } else if (typeof object === 'number') { // INTEGER\r\n                    tagNumber = 0x02;\r\n                } else if (typeof object === 'boolean') { // BOOLEAN\r\n                    tagNumber = 0x01;\r\n                } else if (object instanceof Array) { // SEQUENCE\r\n                    tagNumber = 0x10;\r\n                } else if (object instanceof Date) { // GeneralizedTime\r\n                    tagNumber = 0x18;\r\n                } else if (object instanceof CryptoOperationData || (object && object.buffer instanceof CryptoOperationData)) {\r\n                    tagNumber = 0x04;\r\n                } else\r\n                    throw new DataError('Unrecognized type for ' + object);\r\n            }\r\n        }\r\n\r\n        // Determinate constructed\r\n        var tagConstructed = source.tagConstructed;\r\n        if (typeof tagConstructed === 'undefined')\r\n            tagConstructed = source.tagConstructed = object instanceof Array;\r\n\r\n        // Create content\r\n        var content;\r\n        if (object instanceof CryptoOperationData || (object && object.buffer instanceof CryptoOperationData)) { // Direct\r\n            content = new Uint8Array(buffer(object));\r\n            if (tagNumber === 0x03) { // BITSTRING\r\n                // Set unused bits\r\n                var a = new Uint8Array(buffer(content));\r\n                content = new Uint8Array(a.length + 1);\r\n                content[0] = 0; // No unused bits\r\n                content.set(a, 1);\r\n            }\r\n        } else if (tagConstructed) { // Sub items coding\r\n            if (object instanceof Array) {\r\n                var bytelen = 0, ba = [], offset = 0;\r\n                for (var i = 0, n = object.length; i < n; i++) {\r\n                    ba[i] = encodeBER(object[i], format);\r\n                    bytelen += ba[i].length;\r\n                }\r\n                if (tagNumber === 0x11)\r\n                    ba.sort(function (a, b) { // Sort order for SET components\r\n                        for (var i = 0, n = Math.min(a.length, b.length); i < n; i++) {\r\n                            var r = a[i] - b[i];\r\n                            if (r !== 0)\r\n                                return r;\r\n                        }\r\n                        return a.length - b.length;\r\n                    });\r\n                if (format === 'CER') { // final for CER 00 00\r\n                    ba[n] = new Uint8Array(2);\r\n                    bytelen += 2;\r\n                }\r\n                content = new Uint8Array(bytelen);\r\n                for (var i = 0, n = ba.length; i < n; i++) {\r\n                    content.set(ba[i], offset);\r\n                    offset = offset + ba[i].length;\r\n                }\r\n            } else\r\n                throw new DataError('Constracted block can\\'t be primitive');\r\n        } else {\r\n            switch (tagNumber) {\r\n              // 0x00: // EOC\r\n                case 0x01: // BOOLEAN\r\n                    content = new Uint8Array(1);\r\n                    content[0] = object ? 0xff : 0;\r\n                    break;\r\n                case 0x02: // INTEGER\r\n                case 0x0a: // ENUMIRATED\r\n                    content = Int16.decode(\r\n                      typeof object === 'number' ? object.toString(16) : object);\r\n                    break;\r\n                case 0x03: // BIT STRING\r\n                    if (typeof object === 'string') {\r\n                        var unusedBits = 7 - (object.length + 7) % 8;\r\n                        var n = Math.ceil(object.length / 8);\r\n                        content = new Uint8Array(n + 1);\r\n                        content[0] = unusedBits;\r\n                        for (var i = 0; i < n; i++) {\r\n                            var c = 0;\r\n                            for (var j = 0; j < 8; j++) {\r\n                                var k = i * 8 + j;\r\n                                c = (c << 1) + (k < object.length ? (object.charAt(k) === '1' ? 1 : 0) : 0);\r\n                            }\r\n                            content[i + 1] = c;\r\n                        }\r\n                    }\r\n                    break;\r\n                case 0x04:\r\n                    content = Hex.decode(\r\n                      typeof object === 'number' ? object.toString(16) : object);\r\n                    break;\r\n              // case 0x05: // NULL\r\n                case 0x06: // OBJECT IDENTIFIER\r\n                    var a = object.match(/\\d+/g), r = [];\r\n                    for (var i = 1; i < a.length; i++) {\r\n                        var n = +a[i], r1 = [];\r\n                        if (i === 1)\r\n                            n = n + a[0] * 40;\r\n                        do {\r\n                            r1.push(n & 0x7F);\r\n                            n = n >>> 7;\r\n                        } while (n);\r\n                        // reverse order\r\n                        for (j = r1.length - 1; j >= 0; --j)\r\n                            r.push(r1[j] + (j === 0 ? 0x00 : 0x80));\r\n                    }\r\n                    content = new Uint8Array(r);\r\n                    break;\r\n              // case 0x07: // ObjectDescriptor\r\n              // case 0x08: // EXTERNAL\r\n              // case 0x09: // REAL\r\n              // case 0x0A: // ENUMERATED\r\n              // case 0x0B: // EMBEDDED PDV\r\n                case 0x0C: // UTF8String\r\n                    content = Chars.decode(object, 'utf8');\r\n                    break;\r\n              // case 0x10: // SEQUENCE\r\n              // case 0x11: // SET\r\n                case 0x12: // NumericString\r\n                case 0x16: // IA5String // ASCII\r\n                case 0x13: // PrintableString // ASCII subset\r\n                case 0x14: // TeletexString // aka T61String\r\n                case 0x15: // VideotexString\r\n                case 0x19: // GraphicString\r\n                case 0x1A: // VisibleString // ASCII subset\r\n                case 0x1B: // GeneralString\r\n                    // Reflect on character encoding\r\n                    for (var i = 0, n = object.length; i < n; i++)\r\n                        if (object.charCodeAt(i) > 255)\r\n                            tagNumber = 0x0C;\r\n                    if (tagNumber === 0x0C)\r\n                        content = Chars.decode(object, 'utf8');\r\n                    else\r\n                        content = Chars.decode(object, 'ascii');\r\n                    break;\r\n                case 0x17: // UTCTime\r\n                case 0x18: // GeneralizedTime\r\n                    var result = object.original;\r\n                    if (!result) {\r\n                        var date = new Date(object);\r\n                        date.setMinutes(date.getMinutes() + date.getTimezoneOffset()); // to UTC\r\n                        var ms = tagNumber === 0x18 ? date.getMilliseconds().toString() : ''; // Milliseconds, remove trailing zeros\r\n                        while (ms.length > 0 && ms.charAt(ms.length - 1) === '0')\r\n                            ms = ms.substring(0, ms.length - 1);\r\n                        if (ms.length > 0)\r\n                            ms = '.' + ms;\r\n                        result = (tagNumber === 0x17 ? date.getYear().toString().slice(-2) : date.getFullYear().toString()) +\r\n                          ('00' + (date.getMonth() + 1)).slice(-2) +\r\n                          ('00' + date.getDate()).slice(-2) +\r\n                          ('00' + date.getHours()).slice(-2) +\r\n                          ('00' + date.getMinutes()).slice(-2) +\r\n                          ('00' + date.getSeconds()).slice(-2) + ms + 'Z';\r\n                    }\r\n                    content = Chars.decode(result, 'ascii');\r\n                    break;\r\n                case 0x1C: // UniversalString\r\n                    content = Chars.decode(object, 'utf32');\r\n                    break;\r\n                case 0x1E: // BMPString\r\n                    content = Chars.decode(object, 'utf16');\r\n                    break;\r\n            }\r\n        }\r\n\r\n        if (!content)\r\n            content = new Uint8Array(0);\r\n        if (content instanceof CryptoOperationData)\r\n            content = new Uint8Array(content);\r\n\r\n        if (!tagConstructed && format === 'CER') {\r\n            // Encoding CER-form for string types\r\n            var k;\r\n            switch (tagNumber) {\r\n                case 0x03: // BIT_STRING\r\n                    k = 1; // ingnore unused bit for bit string\r\n                case 0x04: // OCTET_STRING\r\n                case 0x0C: // UTF8String\r\n                case 0x12: // NumericString\r\n                case 0x13: // PrintableString\r\n                case 0x14: // TeletexString\r\n                case 0x15: // VideotexString\r\n                case 0x16: // IA5String\r\n                case 0x19: // GraphicString\r\n                case 0x1A: // VisibleString\r\n                case 0x1B: // GeneralString\r\n                case 0x1C: // UniversalString\r\n                case 0x1E: // BMPString\r\n                    k = k || 0;\r\n                    // Split content on 1000 octet len parts\r\n                    var size = 1000;\r\n                    var bytelen = 0, ba = [], offset = 0;\r\n                    for (var i = k, n = content.length; i < n; i += size - k) {\r\n                        ba[i] = encodeBER({\r\n                            object: new Unit8Array(content.buffer, i, Math.min(size - k, n - i)),\r\n                            tagNumber: tagNumber,\r\n                            tagClass: 0,\r\n                            tagConstructed: false\r\n                        }, format);\r\n                        bytelen += ba[i].length;\r\n                    }\r\n                    ba[n] = new Uint8Array(2); // final for CER 00 00\r\n                    bytelen += 2;\r\n                    content = new Uint8Array(bytelen);\r\n                    for (var i = 0, n = ba.length; i < n; i++) {\r\n                        content.set(ba[i], offset);\r\n                        offset = offset + ba[i].length;\r\n                    }\r\n            }\r\n        }\r\n\r\n        // Restore tagNumber for all classes\r\n        if (tagClass === 0)\r\n            source.tagNumber = tagNumber;\r\n        else\r\n            source.tagNumber = tagNumber = source.tagNumber || 0;\r\n        source.content = content;\r\n\r\n        if (onlyContent)\r\n            return content;\r\n\r\n        // Create header\r\n        // tagNumber\r\n        var ha = [], first = tagClass === 3 ? 0xC0 : tagClass === 2 ? 0x80 :\r\n          tagClass === 1 ? 0x40 : 0x00;\r\n        if (tagConstructed)\r\n            first |= 0x20;\r\n        if (tagNumber < 0x1F) {\r\n            first |= tagNumber & 0x1F;\r\n            ha.push(first);\r\n        } else {\r\n            first |= 0x1F;\r\n            ha.push(first);\r\n            var n = tagNumber, ha1 = [];\r\n            do {\r\n                ha1.push(n & 0x7F);\r\n                n = n >>> 7;\r\n            } while (n)\r\n            // reverse order\r\n            for (var j = ha1.length - 1; j >= 0; --j)\r\n                ha.push(ha1[j] + (j === 0 ? 0x00 : 0x80));\r\n        }\r\n        // Length\r\n        if (tagConstructed && format === 'CER') {\r\n            ha.push(0x80);\r\n        } else {\r\n            var len = content.length;\r\n            if (len > 0x7F) {\r\n                var l2 = len, ha2 = [];\r\n                do {\r\n                    ha2.push(l2 & 0xff);\r\n                    l2 = l2 >>> 8;\r\n                } while (l2);\r\n                ha.push(ha2.length + 0x80); // reverse order\r\n                for (var j = ha2.length - 1; j >= 0; --j)\r\n                    ha.push(ha2[j]);\r\n            } else {\r\n                // simple len\r\n                ha.push(len);\r\n            }\r\n        }\r\n        var header = source.header = new Uint8Array(ha);\r\n\r\n        // Result - complete buffer\r\n        var block = new Uint8Array(header.length + content.length);\r\n        block.set(header, 0);\r\n        block.set(content, header.length);\r\n        return block;\r\n    }\r\n\r\n    function decodeBER(source, offset) {\r\n\r\n        // start pos\r\n        var pos = offset || 0, start = pos;\r\n        var tagNumber, tagClass, tagConstructed,\r\n          content, header, buffer, sub, len;\r\n\r\n        if (source.object) {\r\n            // Ready from source\r\n            tagNumber = source.tagNumber;\r\n            tagClass = source.tagClass;\r\n            tagConstructed = source.tagConstructed;\r\n            content = source.content;\r\n            header = source.header;\r\n            buffer = source.object instanceof CryptoOperationData ?\r\n              new Uint8Array(source.object) : null;\r\n            sub = source.object instanceof Array ? source.object : null;\r\n            len = buffer && buffer.length || null;\r\n        } else {\r\n            // Decode header\r\n            var d = source;\r\n\r\n            // Read tag\r\n            var buf = d[pos++];\r\n            tagNumber = buf & 0x1f;\r\n            tagClass = buf >> 6;\r\n            tagConstructed = (buf & 0x20) !== 0;\r\n            if (tagNumber === 0x1f) { // long tag\r\n                tagNumber = 0;\r\n                do {\r\n                    if (tagNumber > 0x1fffffffffff80)\r\n                        throw new DataError('Convertor not supported tag number more then (2^53 - 1) at position ' + offset);\r\n                    buf = d[pos++];\r\n                    tagNumber = (tagNumber << 7) + (buf & 0x7f);\r\n                } while (buf & 0x80);\r\n            }\r\n\r\n            // Read len\r\n            buf = d[pos++];\r\n            len = buf & 0x7f;\r\n            if (len !== buf) {\r\n                if (len > 6) // no reason to use Int10, as it would be a huge buffer anyways\r\n                    throw new DataError('Length over 48 bits not supported at position ' + offset);\r\n                if (len === 0)\r\n                    len = null; // undefined\r\n                else {\r\n                    buf = 0;\r\n                    for (var i = 0; i < len; ++i)\r\n                        buf = (buf << 8) + d[pos++];\r\n                    len = buf;\r\n                }\r\n            }\r\n\r\n            start = pos;\r\n            sub = null;\r\n\r\n            if (tagConstructed) {\r\n                // must have valid content\r\n                sub = [];\r\n                if (len !== null) {\r\n                    // definite length\r\n                    var end = start + len;\r\n                    while (pos < end) {\r\n                        var s = decodeBER(d, pos);\r\n                        sub.push(s);\r\n                        pos += s.header.length + s.content.length;\r\n                    }\r\n                    if (pos !== end)\r\n                        throw new DataError('Content size is not correct for container starting at offset ' + start);\r\n                } else {\r\n                    // undefined length\r\n                    try {\r\n                        for (; ;) {\r\n                            var s = decodeBER(d, pos);\r\n                            pos += s.header.length + s.content.length;\r\n                            if (s.tagClass === 0x00 && s.tagNumber === 0x00)\r\n                                break;\r\n                            sub.push(s);\r\n                        }\r\n                        len = pos - start;\r\n                    } catch (e) {\r\n                        throw new DataError('Exception ' + e + ' while decoding undefined length content at offset ' + start);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Header and content\r\n            header = new Uint8Array(d.buffer, offset, start - offset);\r\n            content = new Uint8Array(d.buffer, start, len);\r\n            buffer = content;\r\n        }\r\n\r\n        // Constructed types - check for string concationation\r\n        if (sub !== null && tagClass === 0) {\r\n            var k;\r\n            switch (tagNumber) {\r\n                case 0x03: // BIT_STRING\r\n                    k = 1; // ingnore unused bit for bit string\r\n                case 0x04: // OCTET_STRING\r\n                case 0x0C: // UTF8String\r\n                case 0x12: // NumericString\r\n                case 0x13: // PrintableString\r\n                case 0x14: // TeletexString\r\n                case 0x15: // VideotexString\r\n                case 0x16: // IA5String\r\n                case 0x19: // GraphicString\r\n                case 0x1A: // VisibleString\r\n                case 0x1B: // GeneralString\r\n                case 0x1C: // UniversalString\r\n                case 0x1E: // BMPString\r\n                    k = k || 0;\r\n                    // Concatination\r\n                    if (sub.length === 0)\r\n                        throw new DataError('No constructed encoding content of string type at offset ' + start);\r\n                    len = k;\r\n                    for (var i = 0, n = sub.length; i < n; i++) {\r\n                        var s = sub[i];\r\n                        if (s.tagClass !== tagClass || s.tagNumber !== tagNumber || s.tagConstructed)\r\n                            throw new DataError('Invalid constructed encoding of string type at offset ' + start);\r\n                        len += s.content.length - k;\r\n                    }\r\n                    buffer = new Uint8Array(len);\r\n                    for (var i = 0, n = sub.length, j = k; i < n; i++) {\r\n                        var s = sub[i];\r\n                        if (k > 0)\r\n                            buffer.set(s.content.subarray(1), j);\r\n                        else\r\n                            buffer.set(s.content, j);\r\n                        j += s.content.length - k;\r\n                    }\r\n                    tagConstructed = false; // follow not required\r\n                    sub = null;\r\n                    break;\r\n            }\r\n        }\r\n        // Primitive types\r\n        var object = '';\r\n        if (sub === null) {\r\n            if (len === null)\r\n                throw new DataError('Invalid tag with undefined length at offset ' + start);\r\n\r\n            if (tagClass === 0) {\r\n                switch (tagNumber) {\r\n                    case 0x01: // BOOLEAN\r\n                        object = buffer[0] !== 0;\r\n                        break;\r\n                    case 0x02: // INTEGER\r\n                    case 0x0a: // ENUMIRATED\r\n                        if (len > 6) {\r\n                            object = Int16.encode(buffer);\r\n                        } else {\r\n                            var v = buffer[0];\r\n                            if (buffer[0] > 0x7f)\r\n                                v = v - 256;\r\n                            for (var i = 1; i < len; i++)\r\n                                v = v * 256 + buffer[i];\r\n                            object = v;\r\n                        }\r\n                        break;\r\n                    case 0x03: // BIT_STRING\r\n                        if (len > 5) { // Content buffer\r\n                            object = new Uint8Array(buffer.subarray(1)).buffer;\r\n                        } else { // Max bit mask only for 32 bit\r\n                            var unusedBit = buffer[0],\r\n                              skip = unusedBit, s = [];\r\n                            for (var i = len - 1; i >= 1; --i) {\r\n                                var b = buffer[i];\r\n                                for (var j = skip; j < 8; ++j)\r\n                                    s.push((b >> j) & 1 ? '1' : '0');\r\n                                skip = 0;\r\n                            }\r\n                            object = s.reverse().join('');\r\n                        }\r\n                        break;\r\n                    case 0x04: // OCTET_STRING\r\n                        object = new Uint8Array(buffer).buffer;\r\n                        break;\r\n                  //  case 0x05: // NULL\r\n                    case 0x06: // OBJECT_IDENTIFIER\r\n                        var s = '',\r\n                          n = 0,\r\n                          bits = 0;\r\n                        for (var i = 0; i < len; ++i) {\r\n                            var v = buffer[i];\r\n                            n = (n << 7) + (v & 0x7F);\r\n                            bits += 7;\r\n                            if (!(v & 0x80)) { // finished\r\n                                if (s === '') {\r\n                                    var m = n < 80 ? n < 40 ? 0 : 1 : 2;\r\n                                    s = m + \".\" + (n - m * 40);\r\n                                } else\r\n                                    s += \".\" + n.toString();\r\n                                n = 0;\r\n                                bits = 0;\r\n                            }\r\n                        }\r\n                        if (bits > 0)\r\n                            throw new DataError('Incompleted OID at offset ' + start);\r\n                        object = s;\r\n                        break;\r\n                  //case 0x07: // ObjectDescriptor\r\n                  //case 0x08: // EXTERNAL\r\n                  //case 0x09: // REAL\r\n                  //case 0x0A: // ENUMERATED\r\n                  //case 0x0B: // EMBEDDED_PDV\r\n                    case 0x10: // SEQUENCE\r\n                    case 0x11: // SET\r\n                        object = [];\r\n                        break;\r\n                    case 0x0C: // UTF8String\r\n                        object = Chars.encode(buffer, 'utf8');\r\n                        break;\r\n                    case 0x12: // NumericString\r\n                    case 0x13: // PrintableString\r\n                    case 0x14: // TeletexString\r\n                    case 0x15: // VideotexString\r\n                    case 0x16: // IA5String\r\n                    case 0x19: // GraphicString\r\n                    case 0x1A: // VisibleString\r\n                    case 0x1B: // GeneralString\r\n                        object = Chars.encode(buffer, 'ascii');\r\n                        break;\r\n                    case 0x1C: // UniversalString\r\n                        object = Chars.encode(buffer, 'utf32');\r\n                        break;\r\n                    case 0x1E: // BMPString\r\n                        object = Chars.encode(buffer, 'utf16');\r\n                        break;\r\n                    case 0x17: // UTCTime\r\n                    case 0x18: // GeneralizedTime\r\n                        var shortYear = tagNumber === 0x17;\r\n                        var s = Chars.encode(buffer, 'ascii'),\r\n                          m = (shortYear ?\r\n                            /^(\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/ :\r\n                            /^(\\d\\d\\d\\d)(0[1-9]|1[0-2])(0[1-9]|[12]\\d|3[01])([01]\\d|2[0-3])(?:([0-5]\\d)(?:([0-5]\\d)(?:[.,](\\d{1,3}))?)?)?(Z|[-+](?:[0]\\d|1[0-2])([0-5]\\d)?)?$/).exec(s);\r\n                        if (!m)\r\n                            throw new DataError('Unrecognized time format \"' + s + '\" at offset ' + start);\r\n                        if (shortYear) {\r\n                            // Where YY is greater than or equal to 50, the year SHALL be interpreted as 19YY; and\r\n                            // Where YY is less than 50, the year SHALL be interpreted as 20YY\r\n                            m[1] = +m[1];\r\n                            m[1] += (m[1] < 50) ? 2000 : 1900;\r\n                        }\r\n                        var dt = new Date(m[1], +m[2] - 1, +m[3], +(m[4] || '0'), +(m[5] || '0'), +(m[6] || '0'), +(m[7] || '0')),\r\n                          tz = dt.getTimezoneOffset();\r\n                        if (m[8] || tagNumber === 0x17) {\r\n                            if (m[8].toUpperCase() !== 'Z' && m[9]) {\r\n                                tz = tz + parseInt(m[9]);\r\n                            }\r\n                            dt.setMinutes(dt.getMinutes() - tz);\r\n                        }\r\n                        dt.original = s;\r\n                        object = dt;\r\n                        break;\r\n                }\r\n            } else // OCTET_STRING\r\n                object = new Uint8Array(buffer).buffer;\r\n        } else\r\n            object = sub;\r\n\r\n        // result\r\n        return {\r\n            tagConstructed: tagConstructed,\r\n            tagClass: tagClass,\r\n            tagNumber: tagNumber,\r\n            header: header,\r\n            content: content,\r\n            object: object\r\n        };\r\n    }\r\n\r\n    return {\r\n        /**\r\n         * BER.decode(object, format) convert javascript object to ASN.1 format CryptoOperationData<br><br>\r\n         * If object has members tagNumber, tagClass and tagConstructed\r\n         * it is clear define encoding rules. Else method use defaul rules:\r\n         * <ul>\r\n         *   <li>Empty string or null - NULL</li>\r\n         *   <li>String starts with '0x' and has 0-9 and a-f characters - INTEGER</li>\r\n         *   <li>String like d.d.d.d (d - set of digits) - OBJECT IDENTIFIER</li>\r\n         *   <li>String with characters 0 and 1 - BIT STRING</li>\r\n         *   <li>Strings 'true' or 'false' - BOOLEAN</li>\r\n         *   <li>String has only 0-9 and a-f characters - OCTET STRING</li>\r\n         *   <li>String has only characters with code 0-255 - PrintableString</li>\r\n         *   <li>Other strings - UTF8String</li>\r\n         *   <li>Number - INTEGER</li>\r\n         *   <li>Date - GeneralizedTime</li>\r\n         *   <li>Boolean - SEQUENCE</li>\r\n         *   <li>CryptoOperationData - OCTET STRING</li>\r\n         * </ul>\r\n         * SEQUENCE or SET arrays recursively encoded for each item.<br>\r\n         * OCTET STRING and BIT STRING can presents as array with one item.\r\n         * It means encapsulates encoding for child element.<br>\r\n         *\r\n         * If CONTEXT or APPLICATION classes item presents as array with one\r\n         * item we use EXPLICIT encoding for element, else IMPLICIT encoding.<br>\r\n         *\r\n         * @memberOf GostCoding.BER\r\n         * @param {Object} object Object to encoding\r\n         * @param {string} format Encoding rule: 'DER' or 'CER', default 'DER'\r\n         * @param {boolean} onlyContent Encode content only, without header\r\n         * @returns {CryptoOperationData} BER encoded data\r\n         */\r\n        encode: function (object, format, onlyContent) {\r\n            return encodeBER(object, format, onlyContent).buffer;\r\n        },\r\n        /**\r\n         * BER.encode(data) convert ASN.1 format CryptoOperationData data to javascript object<br><br>\r\n         *\r\n         * Conversion rules to javascript object:\r\n         *  <ul>\r\n         *      <li>BOOLEAN - Boolean object</li>\r\n         *      <li>INTEGER, ENUMIRATED - Integer object if len <= 6 (48 bits) else Int16 encoded string</li>\r\n         *      <li>BIT STRING - Integer object if len <= 5 (w/o unsedBit octet - 32 bits) else String like '10111100' or  Array with one item in case of incapsulates encoding</li>\r\n         *      <li>OCTET STRING - Hex encoded string or Array with one item in case of incapsulates encoding</li>\r\n         *      <li>OBJECT IDENTIFIER - String with object identifier</li>\r\n         *      <li>SEQUENCE, SET - Array of encoded items</li>\r\n         *      <li>UTF8String, NumericString, PrintableString, TeletexString, VideotexString,\r\n         *          IA5String, GraphicString, VisibleString, GeneralString, UniversalString,\r\n         *          BMPString - encoded String</li>\r\n         *      <li>UTCTime, GeneralizedTime - Date</li>\r\n         *  </ul>\r\n         * @memberOf GostCoding.BER\r\n         * @param {(CryptoOperationData|GostCoding.BER)} data Binary data to decode\r\n         * @returns {Object} Javascript object with result of decoding\r\n         */\r\n        decode: function (data) {\r\n            return decodeBER(data.object ? data : new Uint8Array(buffer(data)), 0);\r\n        }\r\n    }; // </editor-fold>\r\n})();\r\n\r\n/**\r\n * BER, DER, CER conversion\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.BER\r\n */\r\nGostCoding.prototype.BER = BER;\r\n\r\n/**\r\n * PEM conversion\r\n * @class GostCoding.PEM\r\n */\r\nvar PEM = {// <editor-fold defaultstate=\"collapsed\">\r\n    /**\r\n     * PEM.encode(data, name) encode CryptoOperationData to PEM format with name label\r\n     *\r\n     * @memberOf GostCoding.PEM\r\n     * @param {(Object|CryptoOperationData)} data Java script object or BER-encoded binary data\r\n     * @param {string} name Name of PEM object: 'certificate', 'private key' etc.\r\n     * @returns {string} Encoded object\r\n     */\r\n    encode: function (data, name) {\r\n        return (name ? '-----BEGIN ' + name.toUpperCase() + '-----\\r\\n' : '') +\r\n          Base64.encode(data instanceof CryptoOperationData ? data : BER.encode(data)) +\r\n          (name ? '\\r\\n-----END ' + name.toUpperCase() + '-----' : '');\r\n    },\r\n    /**\r\n     * PEM.decode(s, name, deep) decode PEM format s labeled name to CryptoOperationData or javascript object in according to deep parameter\r\n     *\r\n     * @memberOf GostCoding.PEM\r\n     * @param {string} s PEM encoded string\r\n     * @param {string} name Name of PEM object: 'certificate', 'private key' etc.\r\n     * @param {boolean} deep If true method do BER-decoding, else only BASE64 decoding\r\n     * @param {integer} index Index of decoded value\r\n     * @returns {(Object|CryptoOperationData)} Decoded javascript object if deep=true, else CryptoOperationData for father BER decoding\r\n     */\r\n    decode: function (s, name, deep, index) {\r\n        // Try clear base64\r\n        var re1 = /([A-Za-z0-9\\+\\/\\s\\=]+)/g,\r\n          valid = re1.exec(s);\r\n        if (valid[1].length !== s.length)\r\n            valid = false;\r\n        if (!valid && name) {\r\n            // Try with the name\r\n            var re2 = new RegExp(\r\n              '-----\\\\s?BEGIN ' + name.toUpperCase() +\r\n              '-----([A-Za-z0-9\\\\+\\\\/\\\\s\\\\=]+)-----\\\\s?END ' +\r\n              name.toUpperCase() + '-----', 'g');\r\n            valid = re2.exec(s);\r\n        }\r\n        if (!valid) {\r\n            // Try with some name\r\n            var re3 = new RegExp(\r\n              '-----\\\\s?BEGIN [A-Z0-9\\\\s]+' +\r\n              '-----([A-Za-z0-9\\\\+\\\\/\\\\s\\\\=]+)-----\\\\s?END ' +\r\n              '[A-Z0-9\\\\s]+-----', 'g');\r\n            valid = re3.exec(s);\r\n        }\r\n        var r = valid && valid[1 + (index || 0)];\r\n        if (!r)\r\n            throw new DataError('Not valid PEM format');\r\n        var out = Base64.decode(r);\r\n        if (deep)\r\n            out = BER.decode(out);\r\n        return out;\r\n    } // </editor-fold>\r\n};\r\n\r\n/**\r\n * PEM conversion\r\n * @memberOf GostCoding\r\n * @insnance\r\n * @type GostCoding.PEM\r\n */\r\nGostCoding.prototype.PEM = PEM;\r\n\r\nexport const gostCodingInstance = new GostCoding();\r\n","/**\r\n * @file GOST R 34.11-94 / GOST R 34.11-12 implementation\r\n * @version 1.76\r\n * @copyright 2014-2016, Rudolf Nickolaev. All rights reserved.\r\n */\r\n\r\nimport { getSeed } from '../utils/seeds';\r\nimport { GostCipher } from './gostCipher';\r\nimport { NotSupportedError, DataError } from '../utils/errors';\r\n\r\n/*\r\n * GOST R 34.11\r\n * Common methods\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\n// Copy len values from s[sOfs] to d[dOfs]\r\nfunction arraycopy(s, sOfs, d, dOfs, len) {\r\n    for (var i = 0; i < len; i++)\r\n        d[dOfs + i] = s[sOfs + i];\r\n}\r\n\r\n// Swap bytes in buffer\r\nfunction swap(s) {\r\n    var src = new Uint8Array(s),\r\n      dst = new Uint8Array(src.length);\r\n    for (var i = 0, n = src.length; i < n; i++)\r\n        dst[n - i - 1] = src[i];\r\n    return dst.buffer;\r\n}\r\n\r\n// Convert BASE64 string to Uint8Array\r\n// for decompression of constants and precalc values\r\nfunction b64decode(s) {\r\n    // s = s.replace(/[^A-Za-z0-9\\+\\/]/g, '');\r\n    var n = s.length,\r\n      k = n * 3 + 1 >> 2, r = new Uint8Array(k);\r\n\r\n    for (var m3, m4, u24 = 0, j = 0, i = 0; i < n; i++) {\r\n        m4 = i & 3;\r\n        var c = s.charCodeAt(i);\r\n\r\n        c = c > 64 && c < 91 ?\r\n          c - 65 : c > 96 && c < 123 ?\r\n            c - 71 : c > 47 && c < 58 ?\r\n              c + 4 : c === 43 ?\r\n                62 : c === 47 ?\r\n                  63 : 0;\r\n\r\n        u24 |= c << 18 - 6 * m4;\r\n        if (m4 === 3 || n - i === 1) {\r\n            for (m3 = 0; m3 < 3 && j < k; m3++, j++) {\r\n                r[j] = u24 >>> (16 >>> m3 & 24) & 255;\r\n            }\r\n            u24 = 0;\r\n\r\n        }\r\n    }\r\n    return r.buffer;\r\n}\r\n\r\n// Check buffer\r\nfunction buffer(d) {\r\n    if (d instanceof ArrayBuffer)\r\n        return d;\r\n    else if (d && d.buffer && d.buffer instanceof ArrayBuffer)\r\n        return d.byteOffset === 0 && d.byteLength === d.buffer.byteLength ?\r\n          d.buffer : new Uint8Array(new Uint8Array(d, d.byteOffset, d.byteLength)).buffer;\r\n    else\r\n        throw new DataError('ArrayBuffer or ArrayBufferView required');\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11 or GOST R 34.11-12<br><br>\r\n *\r\n * http://tools.ietf.org/html/rfc6986\r\n *\r\n * The digest method returns digest data in according to GOST R 4311-2012.<br>\r\n * Size of digest also defines in algorithm name.\r\n *  <ul>\r\n *      <li>GOST R 34.11-256-12 - 256 bits digest</li>\r\n *      <li>GOST R 34.11-512-12 - 512 bits digest</li>\r\n *  </ul>\r\n *\r\n * @memberOf GostDigest\r\n * @method digest\r\n * @instance\r\n * @param {(ArrayBuffer|TypedArray)} data Data\r\n * @returns {ArrayBuffer} Digest of data\r\n */\r\nvar digest2012 = (function () // <editor-fold defaultstate=\"collapsed\">\r\n  {\r\n      // Constants\r\n      var buffer0 = new Int32Array(16); // [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n\r\n      var buffer512 = new Int32Array(16); // [512, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n      buffer512[0] = 512;\r\n\r\n      // Constant C\r\n      var C = (function (s) {\r\n          var h = new Int32Array(b64decode(s)),\r\n            r = new Array(12);\r\n          for (var i = 0; i < 12; i++)\r\n              r[i] = new Int32Array(h.buffer, i * 64, 16);\r\n          return r;\r\n      })(\r\n        'B0Wm8lllgN0jTXTMNnR2BRXTYKQIKkKiAWlnkpHgfEv8xIV1jbhOcRbQRS5DdmovH3xlwIEvy+vp2soe2lsIsbebsSFwBHnmVs3L1xui3VXKpwrbwmG1XFiZ1hJrF7WaMQG1Fg9e1WGYKyMKcur+89e1cA9GneNPGi+dqYq1o2+yCroK9ZYemTHbeoZD9LbCCdtiYDc6ycGxnjWQ5A/i03t7KbEUderyix+cUl9e8QY1hD1qKPw5Cscvzius3HT1LtHjhLy+DCLxN+iToepTNL4DUpMzE7fYddYD7YIs16k/NV5orRxynX08XDN+hY5I3eRxXaDhSPnSZhXos98f71f+bHz9WBdg9WPqqX6iVnoWGicjtwD/36P1OiVHF82/vf8PgNc1njVKEIYWHxwVf2MjqWwMQT+amUdHraxr6ktufWRGekBo+jVPkDZyxXG/tsa+wmYf8gq0t5oct6b6z8aO8Jq0mn8YbKRCUfnEZi3AOTB6O8Okb9nTOh2urk+uk9QUOk1WhojzSjyiTEUXNQQFSiiDaUcGNyyCLcWrkgnJk3oZMz5H08mHv+bHxp45VAkkv/6GrFHsxaruFg7H9B7nAr/UDX+k' +\r\n        '2ahRWTXCrDYvxKXRK43RaZAGm5LLK4n0msTbTTtEtIke3jaccfi3TkFBbgwCqucDp8mTTUJbH5vbWiODUURhcmAqH8uS3DgOVJwHppqKK3uxzrLbC0QKgIQJDeC3Vdk8JEKJJRs6fTreXxbs2JpMlJsiMRZUWo837ZxFmPvHtHTDtjsV0fqYNvRSdjswbB56SzNprwJn558DYTMbiuH/H9t4iv8c50GJ8/PkskjlKjhSbwWApt6+qxst84HNpMprXdhvwEpZot6Ybkd9Hc2678q5SOrvcR2KeWaEFCGAASBhB6vru2v62JT+WmPNxgIw+4nI79CezXsg1xvxSpK8SJkbstnVF/T6UijhiKqkHeeGzJEYne+AXZufITDUEiD4dx3fvDI8pM16sUkEsIAT0roxFvFn5443');\r\n\r\n      // Precalc Ax\r\n      var Ax = (function (s) {\r\n          return new Int32Array(b64decode(s));\r\n      })(\r\n        '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'); //==\r\n\r\n      // Variables\r\n      var sigma, N, h;\r\n\r\n      // 64bit tools\r\n      function get8(x, i) {\r\n          return (x[i >> 2] >> ((i & 3) << 3)) & 0xff;\r\n      }\r\n\r\n      // 512bit tools\r\n      function add512(x, y) {\r\n          var CF = 0, w0, w1;\r\n          for (var i = 0; i < 16; i++) {\r\n              w0 = (x[i] & 0xffff) + (y[i] & 0xffff) + (CF || 0);\r\n              w1 = (x[i] >>> 16) + (y[i] >>> 16) + (w0 >>> 16);\r\n              x[i] = (w0 & 0xffff) | (w1 << 16);\r\n              CF = (w1 >>> 16);\r\n          }\r\n      }\r\n\r\n      function get512(d) {\r\n          return new Int32Array(d.buffer, d.byteOffset, 16);\r\n      }\r\n\r\n\r\n      function copy512(r, d) {\r\n          for (var i = 0; i < 16; i++)\r\n              r[i] = d[i];\r\n      }\r\n\r\n      function new512() {\r\n          return new Int32Array(16);\r\n      }\r\n\r\n      // Core private algorithms\r\n      function xor512(x, y) {\r\n          for (var i = 0; i < 16; i++)\r\n              x[i] = x[i] ^ y[i];\r\n      }\r\n\r\n\r\n      var r = new512();\r\n\r\n      function XLPS(x, y) {\r\n          copy512(r, x);\r\n          xor512(r, y);\r\n          for (var i = 0; i < 8; i++) {\r\n              var z0, z1, k = get8(r, i) << 1;\r\n              z0 = Ax[k];\r\n              z1 = Ax[k + 1];\r\n              for (var j = 1; j < 8; j++) {\r\n                  k = (j << 9) + (get8(r, (j << 3) + i) << 1);\r\n                  z0 = z0 ^ Ax[k];\r\n                  z1 = z1 ^ Ax[k + 1];\r\n              }\r\n              x[i << 1] = z0;\r\n              x[(i << 1) + 1] = z1;\r\n          }\r\n      }\r\n\r\n      var data = new512(), Ki = new512();\r\n\r\n      function g(h, N, m) {\r\n          var i;\r\n\r\n          copy512(data, h);\r\n          XLPS(data, N);\r\n\r\n          /* Starting E() */\r\n          copy512(Ki, data);\r\n          XLPS(data, m);\r\n\r\n          for (i = 0; i < 11; i++) {\r\n              XLPS(Ki, C[i]);\r\n              XLPS(data, Ki);\r\n          }\r\n\r\n          XLPS(Ki, C[11]);\r\n          xor512(data, Ki);\r\n          /* E() done */\r\n\r\n          xor512(h, data);\r\n          xor512(h, m);\r\n      }\r\n\r\n      // Stages\r\n      function stage2(d) {\r\n          var m = get512(d);\r\n          g(h, N, m);\r\n\r\n          add512(N, buffer512);\r\n          add512(sigma, m);\r\n      }\r\n\r\n      function stage3(d) {\r\n          var n = d.length;\r\n          if (n > 63)\r\n              return;\r\n\r\n          var b0 = new Int32Array(16);\r\n          b0[0] = n << 3;\r\n\r\n          var b = new Uint8Array(64);\r\n          for (var i = 0; i < n; i++)\r\n              b[i] = d[i];\r\n          b[n] = 0x01;\r\n\r\n          var m = get512(b), m0 = get512(b0);\r\n          g(h, N, m);\r\n\r\n          add512(N, m0);\r\n          add512(sigma, m);\r\n\r\n          g(h, buffer0, N);\r\n          g(h, buffer0, sigma);\r\n      }\r\n\r\n      return function (data) {\r\n\r\n          // Cleanup\r\n          sigma = new512();\r\n          N = new512();\r\n\r\n          // Initial vector\r\n          h = new512();\r\n          for (var i = 0; i < 16; i++)\r\n              if (this.bitLength === 256)\r\n                  h[i] = 0x01010101;\r\n\r\n          // Make data\r\n          var d = new Uint8Array(buffer(data));\r\n\r\n          var n = d.length;\r\n          var r = n % 64, q = (n - r) / 64;\r\n\r\n          for (var i = 0; i < q; i++)\r\n              stage2.call(this, new Uint8Array(d.buffer, i * 64, 64));\r\n\r\n          stage3.call(this, new Uint8Array(d.buffer, q * 64, r));\r\n\r\n          var digest;\r\n          if (this.bitLength === 256) {\r\n              digest = new Int32Array(8);\r\n              for (var i = 0; i < 8; i++)\r\n                  digest[i] = h[8 + i];\r\n          } else {\r\n              digest = new Int32Array(16);\r\n              for (var i = 0; i < 16; i++)\r\n                  digest[i] = h[i];\r\n          }\r\n          // Swap hash for SignalCom\r\n          if (this.procreator === 'SC' || this.procreator === 'VN')\r\n              return swap(digest.buffer);\r\n          else\r\n              return digest.buffer;\r\n      };\r\n  } // </editor-fold>\r\n)();\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-94<br><br>\r\n *\r\n * http://tools.ietf.org/html/rfc5831\r\n *\r\n * The digest method returns digest data in according to GOST R 34.11-94.\r\n * @memberOf GostDigest\r\n * @method digest\r\n * @instance\r\n * @param {(ArrayBuffer|TypedArray)} data Data\r\n * @returns {ArrayBuffer} Digest of data\r\n */\r\nvar digest94 = (function () // <editor-fold defaultstate=\"collapsed\">\r\n  {\r\n      var C, H, M, Sum;\r\n\r\n      // (i + 1 + 4(k - 1)) = 8i + k      i = 0-3, k = 1-8\r\n      function P(d) {\r\n          var K = new Uint8Array(32);\r\n\r\n          for (var k = 0; k < 8; k++) {\r\n              K[4 * k] = d[k];\r\n              K[1 + 4 * k] = d[8 + k];\r\n              K[2 + 4 * k] = d[16 + k];\r\n              K[3 + 4 * k] = d[24 + k];\r\n          }\r\n\r\n          return K;\r\n      }\r\n\r\n      //A (x) = (x0 ^ x1) || x3 || x2 || x1\r\n      function A(d) {\r\n          var a = new Uint8Array(8);\r\n\r\n          for (var j = 0; j < 8; j++) {\r\n              a[j] = (d[j] ^ d[j + 8]);\r\n          }\r\n\r\n          arraycopy(d, 8, d, 0, 24);\r\n          arraycopy(a, 0, d, 24, 8);\r\n\r\n          return d;\r\n      }\r\n\r\n      // (in:) n16||..||n1 ==> (out:) n1^n2^n3^n4^n13^n16||n16||..||n2\r\n      function fw(d) {\r\n          var wS = new Uint16Array(d.buffer, 0, 16);\r\n          var wS15 = wS[0] ^ wS[1] ^ wS[2] ^ wS[3] ^ wS[12] ^ wS[15];\r\n          arraycopy(wS, 1, wS, 0, 15);\r\n          wS[15] = wS15;\r\n      }\r\n\r\n      //Encrypt function, ECB mode\r\n      function encrypt(key, s, sOff, d, dOff) {\r\n          var t = new Uint8Array(8);\r\n          arraycopy(d, dOff, t, 0, 8);\r\n          var r = new Uint8Array(this.cipher.encrypt(key, t));\r\n          arraycopy(r, 0, s, sOff, 8);\r\n      }\r\n\r\n      // block processing\r\n      function process(d, dOff) {\r\n          var S = new Uint8Array(32), U = new Uint8Array(32),\r\n            V = new Uint8Array(32), W = new Uint8Array(32);\r\n\r\n          arraycopy(d, dOff, M, 0, 32);\r\n\r\n          //key step 1\r\n\r\n          // H = h3 || h2 || h1 || h0\r\n          // S = s3 || s2 || s1 || s0\r\n          arraycopy(H, 0, U, 0, 32);\r\n          arraycopy(M, 0, V, 0, 32);\r\n          for (var j = 0; j < 32; j++) {\r\n              W[j] = (U[j] ^ V[j]);\r\n          }\r\n          // Encrypt GOST 28147-ECB\r\n          encrypt.call(this, P(W), S, 0, H, 0); // s0 = EK0 [h0]\r\n\r\n          //keys step 2,3,4\r\n          for (var i = 1; i < 4; i++) {\r\n              var tmpA = A(U);\r\n              for (var j = 0; j < 32; j++) {\r\n                  U[j] = (tmpA[j] ^ C[i][j]);\r\n              }\r\n              V = A(A(V));\r\n              for (var j = 0; j < 32; j++) {\r\n                  W[j] = (U[j] ^ V[j]);\r\n              }\r\n              // Encrypt GOST 28147-ECB\r\n              encrypt.call(this, P(W), S, i * 8, H, i * 8); // si = EKi [hi]\r\n          }\r\n\r\n          // x(M, H) = y61(H^y(M^y12(S)))\r\n          for (var n = 0; n < 12; n++) {\r\n              fw(S);\r\n          }\r\n          for (var n = 0; n < 32; n++) {\r\n              S[n] = (S[n] ^ M[n]);\r\n          }\r\n\r\n          fw(S);\r\n\r\n          for (var n = 0; n < 32; n++) {\r\n              S[n] = (H[n] ^ S[n]);\r\n          }\r\n          for (var n = 0; n < 61; n++) {\r\n              fw(S);\r\n          }\r\n          arraycopy(S, 0, H, 0, H.length);\r\n      }\r\n\r\n\r\n      //  256 bitsblock modul -> (Sum + a mod (2^256))\r\n      function summing(d) {\r\n          var carry = 0;\r\n          for (var i = 0; i < Sum.length; i++) {\r\n              var sum = (Sum[i] & 0xff) + (d[i] & 0xff) + carry;\r\n\r\n              Sum[i] = sum;\r\n\r\n              carry = sum >>> 8;\r\n          }\r\n      }\r\n\r\n      // reset the chaining variables to the IV values.\r\n      var C2 = new Uint8Array([\r\n          0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF,\r\n          0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00,\r\n          0x00, 0xFF, 0xFF, 0x00, 0xFF, 0x00, 0x00, 0xFF,\r\n          0xFF, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0x00, 0xFF\r\n      ]);\r\n\r\n      return function (data) {\r\n\r\n          // Reset buffers\r\n          H = new Uint8Array(32);\r\n          M = new Uint8Array(32);\r\n          Sum = new Uint8Array(32);\r\n\r\n          // Reset IV value\r\n          C = new Array(4);\r\n          for (var i = 0; i < 4; i++)\r\n              C[i] = new Uint8Array(32);\r\n          arraycopy(C2, 0, C[2], 0, C2.length);\r\n\r\n          // Make data\r\n          var d = new Uint8Array(buffer(data));\r\n\r\n          var n = d.length;\r\n          var r = n % 32, q = (n - r) / 32;\r\n\r\n          // Proccess full blocks\r\n          for (var i = 0; i < q; i++) {\r\n              var b = new Uint8Array(d.buffer, i * 32, 32);\r\n\r\n              summing.call(this, b); // calc sum M\r\n              process.call(this, b, 0);\r\n          }\r\n\r\n          // load d the remadder with padding zero;\r\n          if (r > 0) {\r\n              var b = new Uint8Array(d.buffer, q * 32),\r\n                c = new Uint8Array(32);\r\n              arraycopy(b, 0, c, 0, r);\r\n              summing.call(this, c); // calc sum M\r\n              process.call(this, c, 0);\r\n\r\n          }\r\n\r\n          // get length into L (byteCount * 8 = bitCount) in little endian.\r\n          var L = new Uint8Array(32), n8 = n * 8, k = 0;\r\n          while (n8 > 0) {\r\n              L[k++] = n8 & 0xff;\r\n              n8 = Math.floor(n8 / 256);\r\n          }\r\n          process.call(this, L, 0);\r\n          process.call(this, Sum, 0);\r\n\r\n          var h = H.buffer;\r\n\r\n          // Swap hash for SignalCom\r\n          if (this.procreator === 'SC')\r\n              h = swap(h);\r\n\r\n          return h;\r\n      };\r\n\r\n  } // </editor-fold>\r\n)();\r\n\r\n/**\r\n * Algorithm name SHA-1<br><br>\r\n *\r\n * https://tools.ietf.org/html/rfc3174\r\n *\r\n * The digest method returns digest data in according to SHA-1.<br>\r\n *\r\n * @memberOf GostDigest\r\n * @method digest\r\n * @instance\r\n * @param {(ArrayBuffer|TypedArray)} data Data\r\n * @returns {ArrayBuffer} Digest of data\r\n */\r\nvar digestSHA1 = (function () // <editor-fold defaultstate=\"collapsed\">\r\n  {\r\n\r\n      // Create a buffer for each 80 word block.\r\n      var state, block = new Uint32Array(80);\r\n\r\n      function common(a, e, w, k, f) {\r\n          return (f + e + w + k + ((a << 5) | (a >>> 27))) >>> 0;\r\n      }\r\n\r\n      function f1(a, b, c, d, e, w) {\r\n          return common(a, e, w, 0x5A827999, d ^ (b & (c ^ d)));\r\n      }\r\n\r\n      function f2(a, b, c, d, e, w) {\r\n          return common(a, e, w, 0x6ED9EBA1, b ^ c ^ d);\r\n      }\r\n\r\n      function f3(a, b, c, d, e, w) {\r\n          return common(a, e, w, 0x8F1BBCDC, (b & c) | (d & (b | c)));\r\n      }\r\n\r\n      function f4(a, b, c, d, e, w) {\r\n          return common(a, e, w, 0xCA62C1D6, b ^ c ^ d);\r\n      }\r\n\r\n      function cycle(state, block) {\r\n          var a = state[0],\r\n            b = state[1],\r\n            c = state[2],\r\n            d = state[3],\r\n            e = state[4];\r\n\r\n          // Partially unroll loops so we don't have to shift variables.\r\n          var fn = f1;\r\n          for (var i = 0; i < 80; i += 5) {\r\n              if (i === 20) {\r\n                  fn = f2;\r\n              }\r\n              else if (i === 40) {\r\n                  fn = f3;\r\n              }\r\n              else if (i === 60) {\r\n                  fn = f4;\r\n              }\r\n              e = fn(a, b, c, d, e, block[i]);\r\n              b = ((b << 30) | (b >>> 2)) >>> 0;\r\n              d = fn(e, a, b, c, d, block[i + 1]);\r\n              a = ((a << 30) | (a >>> 2)) >>> 0;\r\n              c = fn(d, e, a, b, c, block[i + 2]);\r\n              e = ((e << 30) | (e >>> 2)) >>> 0;\r\n              b = fn(c, d, e, a, b, block[i + 3]);\r\n              d = ((d << 30) | (d >>> 2)) >>> 0;\r\n              a = fn(b, c, d, e, a, block[i + 4]);\r\n              c = ((c << 30) | (c >>> 2)) >>> 0;\r\n          }\r\n          state[0] += a;\r\n          state[1] += b;\r\n          state[2] += c;\r\n          state[3] += d;\r\n          state[4] += e;\r\n      }\r\n\r\n      // Swap bytes for 32bits word\r\n      function swap32(b) {\r\n          return ((b & 0xff) << 24)\r\n            | ((b & 0xff00) << 8)\r\n            | ((b >> 8) & 0xff00)\r\n            | ((b >> 24) & 0xff);\r\n      }\r\n\r\n      // input is a Uint8Array bitstream of the data\r\n      return function (data) {\r\n          var d = new Uint8Array(buffer(data)), dlen = d.length;\r\n\r\n          // Pad the input string length.\r\n          var len = dlen + 9;\r\n          if (len % 64) {\r\n              len += 64 - (len % 64);\r\n          }\r\n\r\n          state = new Uint32Array(5);\r\n          state[0] = 0x67452301;\r\n          state[1] = 0xefcdab89;\r\n          state[2] = 0x98badcfe;\r\n          state[3] = 0x10325476;\r\n          state[4] = 0xc3d2e1f0;\r\n\r\n          for (var ofs = 0; ofs < len; ofs += 64) {\r\n\r\n              // Copy input to block and write padding as needed\r\n              for (var i = 0; i < 64; i++) {\r\n                  var b = 0,\r\n                    o = ofs + i;\r\n                  if (o < dlen) {\r\n                      b = d[o];\r\n                  }\r\n                  else if (o === dlen) {\r\n                      b = 0x80;\r\n                  }\r\n                  else {\r\n                      // Write original bit length as a 64bit big-endian integer to the end.\r\n                      var x = len - o - 1;\r\n                      if (x >= 0 && x < 4) {\r\n                          b = (dlen << 3 >>> (x * 8)) & 0xff;\r\n                      }\r\n                  }\r\n\r\n                  // Interpret the input bytes as big-endian per the spec\r\n                  if (i % 4 === 0) {\r\n                      block[i >> 2] = b << 24;\r\n                  }\r\n                  else {\r\n                      block[i >> 2] |= b << ((3 - (i % 4)) * 8);\r\n                  }\r\n              }\r\n\r\n              // Extend the block\r\n              for (var i = 16; i < 80; i++) {\r\n                  var w = block[i - 3] ^ block[i - 8] ^ block[i - 14] ^ block[i - 16];\r\n                  block[i] = (w << 1) | (w >>> 31);\r\n              }\r\n\r\n              cycle(state, block);\r\n\r\n          }\r\n\r\n          // Swap the bytes around since they are big endian internally\r\n          for (var i = 0; i < 5; i++)\r\n              state[i] = swap32(state[i]);\r\n          return state.buffer;\r\n      };\r\n\r\n  } // </editor-fold>\r\n)();\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-HMAC<br><br>\r\n *\r\n * HMAC with the specified hash function.\r\n * @memberOf GostDigest\r\n * @method sign\r\n * @instance\r\n * @param {ArrayBuffer} key The key for HMAC.\r\n * @param {Hash} data Data\r\n */\r\nfunction signHMAC(key, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    // GOST R 34.11-94 - B=32b, L=32b\r\n    // GOST R 34.11-256 - B=64b, L=32b\r\n    // GOST R 34.11-512 - B=64b, L=64b\r\n    var b = (this.digest === digest94) ? 32 : 64,\r\n      l = this.bitLength / 8,\r\n      k = buffer(key),\r\n      d = buffer(data), k0;\r\n    if (k.byteLength === b)\r\n        k0 = new Uint8Array(k);\r\n    else {\r\n        var k0 = new Uint8Array(b);\r\n        if (k.byteLength > b) {\r\n            k0.set(new Uint8Array(this.digest(k)));\r\n        } else {\r\n            k0.set(new Uint8Array(k));\r\n        }\r\n    }\r\n    var s0 = new Uint8Array(b + d.byteLength),\r\n      s1 = new Uint8Array(b + l);\r\n    for (var i = 0; i < b; i++) {\r\n        s0[i] = k0[i] ^ 0x36;\r\n        s1[i] = k0[i] ^ 0x5C;\r\n    }\r\n    s0.set(new Uint8Array(d), b);\r\n    s1.set(new Uint8Array(this.digest(s0)), b);\r\n    return this.digest(s1);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-HMAC<br><br>\r\n *\r\n * Verify HMAC based on GOST R 34.11 hash\r\n *\r\n * @memberOf GostDigest\r\n * @method verify\r\n * @instance\r\n * @param {(ArrayBuffer|TypedArray)} key Key which used for HMAC generation\r\n * @param {(ArrayBuffer|TypedArray)} signature generated HMAC\r\n * @param {(ArrayBuffer|TypedArray)} data Data\r\n * @returns {boolean} HMAC verified = true\r\n */\r\nfunction verifyHMAC(key, signature, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var hmac = new Uint8Array(this.sign(key, data)),\r\n      test = new Uint8Array(signature);\r\n    if (hmac.length !== test.length)\r\n        return false;\r\n    for (var i = 0, n = hmac.length; i < n; i++)\r\n        if (hmac[i] !== test[i])\r\n            return false;\r\n    return true;\r\n} // </editor-fold>\r\n\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-KDF<br><br>\r\n *\r\n * Simple generate key 256/512 bit random seed for derivation algorithms\r\n *\r\n * @memberOf GostDigest\r\n * @method generateKey\r\n * @instance\r\n * @returns {ArrayBuffer} Generated key\r\n */\r\nfunction generateKey() // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return getSeed(this.bitLength).buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-PFXKDF<br><br>\r\n *\r\n * Derive bits from password (PKCS12 mode)\r\n *  <ul>\r\n *      <li>algorithm.salt - random value, salt</li>\r\n *      <li>algorithm.iterations - number of iterations</li>\r\n *  </ul>\r\n * @memberOf GostDigest\r\n * @method deriveBits\r\n * @instance\r\n * @param {ArrayBuffer} baseKey - password after UTF-8 decoding\r\n * @param {number} length output bit-length\r\n * @returns {ArrayBuffer} result\r\n */\r\nfunction deriveBitsPFXKDF(baseKey, length) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if (length % 8 > 0)\r\n        throw new DataError('Length must multiple of 8');\r\n    var u = this.bitLength / 8, v = (this.digest === digest94) ? 32 : 64,\r\n      n = length / 8, r = this.iterations;\r\n    //   1.  Construct a string, D (the \"diversifier\"), by concatenating v/8\r\n    //       copies of ID.\r\n    var ID = this.diversifier, D = new Uint8Array(v);\r\n    for (var i = 0; i < v; i++)\r\n        D[i] = ID;\r\n    //   2.  Concatenate copies of the salt together to create a string S of\r\n    //       length v(ceiling(s/v)) bits (the final copy of the salt may be\r\n    //       truncated to create S).  Note that if the salt is the empty\r\n    //       string, then so is S.\r\n    var S0 = new Uint8Array(buffer(this.salt)), s = S0.length,\r\n      slen = v * Math.ceil(s / v), S = new Uint8Array(slen);\r\n    for (var i = 0; i < slen; i++)\r\n        S[i] = S0[i % s];\r\n    //   3.  Concatenate copies of the password together to create a string P\r\n    //       of length v(ceiling(p/v)) bits (the final copy of the password\r\n    //       may be truncated to create P).  Note that if the password is the\r\n    //       empty string, then so is P.\r\n    var P0 = new Uint8Array(buffer(baseKey)), p = P0.length,\r\n      plen = v * Math.ceil(p / v), P = new Uint8Array(plen);\r\n    for (var i = 0; i < plen; i++)\r\n        P[i] = P0[i % p];\r\n    //   4.  Set I=S||P to be the concatenation of S and P.\r\n    var I = new Uint8Array(slen + plen);\r\n    arraycopy(S, 0, I, 0, slen);\r\n    arraycopy(P, 0, I, slen, plen);\r\n    //   5.  Set c=ceiling(n/u).\r\n    var c = Math.ceil(n / u);\r\n    //   6.  For i=1, 2, ..., c, do the following:\r\n    var A = new Uint8Array(c * u);\r\n    for (var i = 0; i < c; i++) {\r\n        //  A.  Set A2=H^r(D||I). (i.e., the r-th hash of D||1,\r\n        //      H(H(H(... H(D||I))))\r\n        var H = new Uint8Array(v + slen + plen);\r\n        arraycopy(D, 0, H, 0, v);\r\n        arraycopy(I, 0, H, v, slen + plen);\r\n        for (var j = 0; j < r; j++)\r\n            H = new Uint8Array(this.digest(H));\r\n        arraycopy(H, 0, A, i * u, u);\r\n        //  B.  Concatenate copies of Ai to create a string B of length v\r\n        //      bits (the final copy of Ai may be truncated to create B).\r\n        var B = new Uint8Array(v);\r\n        for (var j = 0; j < v; j++)\r\n            B[j] = H[j % u];\r\n        //  C.  Treating I as a concatenation I_0, I_1, ..., I_(k-1) of v-bit\r\n        //      blocks, where k=ceiling(s/v)+ceiling(p/v), modify I by\r\n        //      setting I_j=(I_j+B+1) mod 2^v for each j.\r\n        var k = (slen + plen) / v;\r\n        for (j = 0; j < k; j++) {\r\n            var cf = 1, w;\r\n            for (var l = v - 1; l >= 0; --l) {\r\n                w = I[v * j + l] + B[l] + cf;\r\n                cf = w >>> 8;\r\n                I[v * j + l] = w & 0xff;\r\n            }\r\n        }\r\n    }\r\n    //   7.  Concatenate A_1, A_2, ..., A_c together to form a pseudorandom\r\n    //       bit string, A.\r\n    //   8.  Use the first n bits of A as the output of this entire process.\r\n    var R = new Uint8Array(n);\r\n    arraycopy(A, 0, R, 0, n);\r\n    return R.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-KDF<br><br>\r\n *\r\n * Derive bits for KEK deversification in 34.10-2012 algorithm\r\n * KDF(KEK, UKM, label) = HMAC256 (KEK,  0x01|label|0x00|UKM|0x01|0x00)\r\n * Default label = 0x26|0xBD|0xB8|0x78\r\n *\r\n * @memberOf GostDigest\r\n * @method deriveBits\r\n * @instance\r\n * @param {(ArrayBuffer|TypedArray)} baseKey base key for deriviation\r\n * @param {number} length output bit-length\r\n * @returns {ArrayBuffer} result\r\n */\r\nfunction deriveBitsKDF(baseKey, length) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if (length % 8 > 0)\r\n        throw new DataError('Length must be multiple of 8');\r\n    var rlen = length / 8, label, context = new Uint8Array(buffer(this.context)),\r\n      blen = this.bitLength / 8, n = Math.ceil(rlen / blen);\r\n    if (this.label)\r\n        label = new Uint8Array(buffer(this.label));\r\n    else\r\n        label = new Uint8Array([0x26, 0xBD, 0xB8, 0x78]);\r\n    var result = new Uint8Array(rlen);\r\n    for (var i = 0; i < n; i++) {\r\n        var data = new Uint8Array(label.length + context.length + 4);\r\n        data[0] = i + 1;\r\n        data.set(label, 1);\r\n        data[label.length + 1] = 0x00;\r\n        data.set(context, label.length + 2);\r\n        data[data.length - 2] = length >>> 8;\r\n        data[data.length - 1] = length & 0xff;\r\n        result.set(new Uint8Array(signHMAC.call(this, baseKey, data), 0,\r\n          i < n - 1 ? blen : rlen - i * blen), i * blen);\r\n    }\r\n    return result.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-PBKDF1<br><br>\r\n *\r\n * Derive bits from password\r\n *  <ul>\r\n *      <li>algorithm.salt - random value, salt</li>\r\n *      <li>algorithm.iterations - number of iterations</li>\r\n *  </ul>\r\n * @memberOf GostDigest\r\n * @method deriveBits\r\n * @instance\r\n * @param {ArrayBuffer} baseKey - password after UTF-8 decoding\r\n * @param {number} length output bit-length\r\n * @returns {ArrayBuffer} result\r\n */\r\nfunction deriveBitsPBKDF1(baseKey, length) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if (length < this.bitLength / 2 || length % 8 > 0)\r\n        throw new DataError('Length must be more than ' + this.bitLength / 2 + ' bits and multiple of 8');\r\n    var hLen = this.bitLength / 8, dkLen = length / 8,\r\n      c = this.iterations,\r\n      P = new Uint8Array(buffer(baseKey)),\r\n      S = new Uint8Array(buffer(this.salt)),\r\n      slen = S.length, plen = P.length,\r\n      T = new Uint8Array(plen + slen),\r\n      DK = new Uint8Array(dkLen);\r\n    if (dkLen > hLen)\r\n        throw new DataError('Invalid parameters: Length value');\r\n    arraycopy(P, 0, T, 0, plen);\r\n    arraycopy(S, 0, T, plen, slen);\r\n    for (var i = 0; i < c; i++)\r\n        T = new Uint8Array(this.digest(T));\r\n    arraycopy(T, 0, DK, 0, dkLen);\r\n    return DK.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-PBKDF2<br><br>\r\n *\r\n * Derive bits from password\r\n *  <ul>\r\n *      <li>algorithm.salt - random value, salt</li>\r\n *      <li>algorithm.iterations - number of iterations</li>\r\n *  </ul>\r\n * @memberOf GostDigest\r\n * @method deriveBits\r\n * @instance\r\n * @param {ArrayBuffer} baseKey - password after UTF-8 decoding\r\n * @param {number} length output bit-length\r\n * @returns {ArrayBuffer} result\r\n */\r\nfunction deriveBitsPBKDF2(baseKey, length) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var diversifier = this.diversifier || 1; // For PKCS12 MAC required 3*length\r\n    length = length * diversifier;\r\n    if (length < this.bitLength / 2 || length % 8 > 0)\r\n        throw new DataError('Length must be more than ' + this.bitLength / 2 + ' bits and multiple of 8');\r\n    var hLen = this.bitLength / 8, dkLen = length / 8,\r\n      c = this.iterations,\r\n      P = new Uint8Array(buffer(baseKey)),\r\n      S = new Uint8Array(buffer(this.salt));\r\n    var slen = S.byteLength,\r\n      data = new Uint8Array(slen + 4);\r\n    arraycopy(S, 0, data, 0, slen);\r\n\r\n    if (dkLen > (0xffffffff - 1) * 32)\r\n        throw new DataError('Invalid parameters: Length value');\r\n    var n = Math.ceil(dkLen / hLen),\r\n      DK = new Uint8Array(dkLen);\r\n    for (var i = 1; i <= n; i++) {\r\n        data[slen] = i >>> 24 & 0xff;\r\n        data[slen + 1] = i >>> 16 & 0xff;\r\n        data[slen + 2] = i >>> 8 & 0xff;\r\n        data[slen + 3] = i & 0xff;\r\n\r\n        var U = new Uint8Array(signHMAC.call(this, P, data)), Z = U;\r\n        for (var j = 1; j < c; j++) {\r\n            U = new Uint8Array(signHMAC.call(this, P, U));\r\n            for (var k = 0; k < hLen; k++)\r\n                Z[k] = U[k] ^ Z[k];\r\n        }\r\n        var ofs = (i - 1) * hLen;\r\n        arraycopy(Z, 0, DK, ofs, Math.min(hLen, dkLen - ofs));\r\n    }\r\n    if (diversifier > 1) {\r\n        var rLen = dkLen / diversifier, R = new Uint8Array(rLen);\r\n        arraycopy(DK, dkLen - rLen, R, 0, rLen);\r\n        return R.buffer;\r\n    } else\r\n        return DK.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-CPKDF<br><br>\r\n *\r\n * Derive bits from password. CryptoPro algorithm\r\n *  <ul>\r\n *      <li>algorithm.salt - random value, salt</li>\r\n *      <li>algorithm.iterations - number of iterations</li>\r\n *  </ul>\r\n * @memberOf GostDigest\r\n * @method deriveBits\r\n * @instance\r\n * @param {ArrayBuffer} baseKey - password after UTF-8 decoding\r\n * @param {number} length output bit-length\r\n * @returns {ArrayBuffer} result\r\n */\r\nfunction deriveBitsCP(baseKey, length) {\r\n    if (length > this.bitLength || length % 8 > 0)\r\n        throw new DataError('Length can\\'t be more than ' + this.bitLength + ' bits and multiple of 8');\r\n    // GOST R 34.11-94 - B=32b, L=32b\r\n    // GOST R 34.11-256 - B=64b, L=32b\r\n    // GOST R 34.11-512 - B=64b, L=64b\r\n    var b = (this.digest === digest94) ? 32 : 64,\r\n      l = this.bitLength / 8,\r\n      p = baseKey && baseKey.byteLength > 0 ? new Uint8Array(buffer(baseKey)) : false,\r\n      plen = p ? p.length : 0,\r\n      iterations = this.iterations,\r\n      salt = new Uint8Array(buffer(this.salt)),\r\n      slen = salt.length,\r\n      d = new Uint8Array(slen + plen);\r\n    arraycopy(salt, 0, d, 0, slen);\r\n    if (p)\r\n        arraycopy(p, 0, d, slen, plen);\r\n\r\n    var h = new Uint8Array(this.digest(d)),\r\n      k = new Uint8Array(b),\r\n      s0 = new Uint8Array(b),\r\n      s1 = new Uint8Array(b);\r\n    var c = 'DENEFH028.760246785.IUEFHWUIO.EF';\r\n    for (var i = 0; i < c.length; i++)\r\n        k[i] = c.charCodeAt(i);\r\n\r\n    d = new Uint8Array(2 * (b + l));\r\n    for (var j = 0; j < iterations; j++) {\r\n        for (var i = 0; i < b; i++) {\r\n            s0[i] = k[i] ^ 0x36;\r\n            s1[i] = k[i] ^ 0x5C;\r\n            k[i] = 0;\r\n        }\r\n        arraycopy(s0, 0, d, 0, b);\r\n        arraycopy(h, 0, d, b, l);\r\n        arraycopy(s1, 0, d, b + l, b);\r\n        arraycopy(h, 0, d, b + l + b, l);\r\n        arraycopy(new Uint8Array(this.digest(d)), 0, k, 0, l);\r\n    }\r\n    for (var i = 0; i < l; i++) {\r\n        s0[i] = k[i] ^ 0x36;\r\n        s1[i] = k[i] ^ 0x5C;\r\n        k[i] = 0;\r\n    }\r\n    d = new Uint8Array(2 * l + slen + plen);\r\n    arraycopy(s0, 0, d, 0, l);\r\n    arraycopy(salt, 0, d, l, slen);\r\n    arraycopy(s1, 0, d, l + slen, l);\r\n    if (p)\r\n        arraycopy(p, 0, d, l + slen + l, plen);\r\n    h = this.digest(this.digest(d));\r\n    if (length === this.bitLength)\r\n        return h;\r\n    else {\r\n        var rlen = length / 8, r = new Uint8Array(rlen);\r\n        arraycopy(h, 0, r, 0, rlen);\r\n        return r.buffer;\r\n    }\r\n}\r\n\r\n/**\r\n * Algorithm name GOST R 34.11-KDF or GOST R 34.11-PBKDF2 or other<br><br>\r\n *\r\n * Derive key from derive bits subset\r\n *\r\n * @memberOf GostDigest\r\n * @method deriveKey\r\n * @instance\r\n * @param {ArrayBuffer} baseKey\r\n * @returns {ArrayBuffer}\r\n */\r\nfunction deriveKey(baseKey) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return this.deriveBits(baseKey, this.keySize * 8);\r\n} // </editor-fold>\r\n\r\n/**\r\n * GOST R 34.11 Algorithm<br><br>\r\n *\r\n * References: {@link http://tools.ietf.org/html/rfc6986} and {@link http://tools.ietf.org/html/rfc5831}<br><br>\r\n *\r\n * Normalized algorithm identifier common parameters:\r\n *\r\n *  <ul>\r\n *      <li><b>name</b> Algorithm name 'GOST R 34.11'</li>\r\n *      <li><b>version</b> Algorithm version\r\n *          <ul>\r\n *              <li><b>1994</b> old-style 256 bits digest based on GOST 28147-89</li>\r\n *              <li><b>2012</b> 256 ro 512 bits digest algorithm \"Streebog\" GOST R 34.11-2012 (default)</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>length</b> Digest length\r\n *          <ul>\r\n *              <li><b>256</b> 256 bits digest</li>\r\n *              <li><b>512</b> 512 bits digest, valid only for algorithm \"Streebog\"</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>mode</b> Algorithm mode\r\n *          <ul>\r\n *              <li><b>HASH</b> simple digest mode (default)</li>\r\n *              <li><b>HMAC</b> HMAC algorithm based on GOST R 34.11</li>\r\n *              <li><b>KDF</b> Derive bits for KEK deversification</li>\r\n *              <li><b>PBKDF2</b> Password based key dirivation algorithms PBKDF2 (based on HMAC)</li>\r\n *              <li><b>PFXKDF</b> Password based PFX key dirivation algorithms</li>\r\n *              <li><b>CPKDF</b> CpyptoPro Password based key dirivation algorithms</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>sBox</b> Paramset sBox for GOST 28147-89. Used only if version = 1994</li>\r\n *  </ul>\r\n *\r\n * Supported algorithms, modes and parameters:\r\n *\r\n *  <ul>\r\n *      <li>Digest HASH mode (default)</li>\r\n *      <li>Sign/Verify HMAC modes parameters depends on version and length\r\n *          <ul>\r\n *              <li><b>version: 1994</b> HMAC parameters (B = 32, L = 32)</li>\r\n *              <li><b>version: 2012, length: 256</b> HMAC parameters (B = 64, L = 32)</li>\r\n *              <li><b>version: 2012, length: 512</b> HMAC parameters  (B = 64, L = 64)</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>DeriveBits/DeriveKey KDF mode\r\n *          <ul>\r\n *              <li><b>context</b> {@link CryptoOperationData} Context of the key derivation</li>\r\n *              <li><b>label</b> {@link CryptoOperationData} Label that identifies the purpose for the derived keying material</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>DeriveBits/DeriveKey PBKDF2 mode\r\n *          <ul>\r\n *              <li><b>salt</b> {@link CryptoOperationData} Random salt as input for HMAC algorithm</li>\r\n *              <li><b>iterations</b> Iteration count. GOST recomended value 1000 (default) or 2000</li>\r\n *              <li><b>diversifier</b> Deversifier, ID=1 - key material for performing encryption or decryption, ID=3 - integrity key for MACing</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>DeriveBits/DeriveKey PFXKDF mode\r\n *          <ul>\r\n *              <li><b>salt</b> {@link CryptoOperationData} Random salt as input for HMAC algorithm</li>\r\n *              <li><b>iterations</b> Iteration count. GOST recomended value 1000 (default) or 2000</li>\r\n *              <li><b>diversifier</b> Deversifier, ID=1 - key material for performing encryption or decryption,\r\n *              ID=2 - IV (Initial Value) for encryption or decryption, ID=3 - integrity key for MACing</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>DeriveBits/DeriveKey CPKDF mode\r\n *          <ul>\r\n *              <li><b>salt</b> {@link CryptoOperationData} Random salt as input for HMAC algorithm</li>\r\n *              <li><b>iterations</b> Iteration count. GOST recomended value 1000 (default) or 2000</li>\r\n *          </ul>\r\n *      </li>\r\n *  </ul>\r\n *\r\n * @class GostDigest\r\n * @param {AlgorithmIdentifier} algorithm WebCryptoAPI algorithm identifier\r\n */\r\nexport function GostDigest(algorithm) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    algorithm = algorithm || {};\r\n\r\n    this.name = (algorithm.name || 'GOST R 34.10') + '-' + ((algorithm.version || 2012) % 100) +\r\n      ((algorithm.version || 2012) > 1 ? '-' + (algorithm.length || 256) : '') +\r\n      (((algorithm.mode || 'HASH') !== 'HASH') ? '-' + algorithm.mode : '') +\r\n      (algorithm.procreator ? '/' + algorithm.procreator : '') +\r\n      (typeof algorithm.sBox === 'string' ? '/' + algorithm.sBox : '');\r\n\r\n    // Algorithm procreator\r\n    this.procreator = algorithm.procreator;\r\n\r\n    // Bit length\r\n    this.bitLength = algorithm.length || 256;\r\n\r\n    switch (algorithm.version || 2012) {\r\n        case 1: // SHA-1\r\n            this.digest = digestSHA1;\r\n            this.bitLength = 160;\r\n            break;\r\n        case 1994:\r\n            this.digest = digest94;\r\n            // Define chiper algorithm\r\n            this.sBox = (algorithm.sBox || (algorithm.procreator === 'SC' ? 'D-SC' : 'D-A')).toUpperCase();\r\n\r\n            this.cipher = new GostCipher({\r\n                name: 'GOST 28147',\r\n                block: 'ECB',\r\n                sBox: this.sBox,\r\n                procreator: this.procreator\r\n            });\r\n\r\n            break;\r\n        case 2012:\r\n            this.digest = digest2012;\r\n            break;\r\n        default:\r\n            throw new NotSupportedError('Algorithm version ' + algorithm.version + ' not supported');\r\n    }\r\n\r\n    // Key size\r\n    this.keySize = algorithm.keySize || (algorithm.version <= 2 ? this.bitLength / 8 : 32);\r\n\r\n    switch (algorithm.mode || 'HASH') {\r\n        case 'HASH':\r\n            break;\r\n        case 'HMAC':\r\n            this.sign = signHMAC;\r\n            this.verify = verifyHMAC;\r\n            this.generateKey = generateKey;\r\n            break;\r\n        case 'KDF':\r\n            this.deriveKey = deriveKey;\r\n            this.deriveBits = deriveBitsKDF;\r\n            this.label = algorithm.label;\r\n            this.context = algorithm.context;\r\n            break;\r\n        case 'PBKDF2':\r\n            this.deriveKey = deriveKey;\r\n            this.deriveBits = deriveBitsPBKDF2;\r\n            this.generateKey = generateKey;\r\n            this.salt = algorithm.salt;\r\n            this.iterations = algorithm.iterations || 2000;\r\n            this.diversifier = algorithm.diversifier || 1;\r\n            break;\r\n        case 'PFXKDF':\r\n            this.deriveKey = deriveKey;\r\n            this.deriveBits = deriveBitsPFXKDF;\r\n            this.generateKey = generateKey;\r\n            this.salt = algorithm.salt;\r\n            this.iterations = algorithm.iterations || 2000;\r\n            this.diversifier = algorithm.diversifier || 1;\r\n            break;\r\n        case 'CPKDF':\r\n            this.deriveKey = deriveKey;\r\n            this.deriveBits = deriveBitsCP;\r\n            this.generateKey = generateKey;\r\n            this.salt = algorithm.salt;\r\n            this.iterations = algorithm.iterations || 2000;\r\n            break;\r\n        default:\r\n            throw new NotSupportedError('Algorithm mode ' + algorithm.mode + ' not supported');\r\n    }\r\n} // </editor-fold>\r\n","/**\r\n * @file GOST 28147-89/GOST R 34.12-2015/GOST R 32.13-2015 Encryption Algorithm\r\n * @version 1.76\r\n * @copyright 2014-2016, Rudolf Nickolaev. All rights reserved.\r\n */\r\n\r\nimport { NotSupportedError, DataError } from '../utils/errors';\r\nimport { randomSeed } from '../utils/seeds';\r\n\r\n/*\r\n * Initial parameters and common algortithms of GOST 28147-89\r\n *\r\n * http://tools.ietf.org/html/rfc5830\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\nvar CryptoOperationData = ArrayBuffer;\r\n\r\n/*\r\n * Check supported\r\n * This implementation support only Little Endian arhitecture\r\n */\r\n\r\nvar littleEndian = (function () {\r\n    var buffer = new CryptoOperationData(2);\r\n    new DataView(buffer).setInt16(0, 256, true);\r\n    return new Int16Array(buffer)[0] === 256;\r\n})();\r\n\r\n// Default initial vector\r\nvar defaultIV = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);\r\n\r\n// Predefined sBox collection\r\nvar sBoxes = {\r\n    'E-TEST': [\r\n        0x4, 0x2, 0xF, 0x5, 0x9, 0x1, 0x0, 0x8, 0xE, 0x3, 0xB, 0xC, 0xD, 0x7, 0xA, 0x6,\r\n        0xC, 0x9, 0xF, 0xE, 0x8, 0x1, 0x3, 0xA, 0x2, 0x7, 0x4, 0xD, 0x6, 0x0, 0xB, 0x5,\r\n        0xD, 0x8, 0xE, 0xC, 0x7, 0x3, 0x9, 0xA, 0x1, 0x5, 0x2, 0x4, 0x6, 0xF, 0x0, 0xB,\r\n        0xE, 0x9, 0xB, 0x2, 0x5, 0xF, 0x7, 0x1, 0x0, 0xD, 0xC, 0x6, 0xA, 0x4, 0x3, 0x8,\r\n        0x3, 0xE, 0x5, 0x9, 0x6, 0x8, 0x0, 0xD, 0xA, 0xB, 0x7, 0xC, 0x2, 0x1, 0xF, 0x4,\r\n        0x8, 0xF, 0x6, 0xB, 0x1, 0x9, 0xC, 0x5, 0xD, 0x3, 0x7, 0xA, 0x0, 0xE, 0x2, 0x4,\r\n        0x9, 0xB, 0xC, 0x0, 0x3, 0x6, 0x7, 0x5, 0x4, 0x8, 0xE, 0xF, 0x1, 0xA, 0x2, 0xD,\r\n        0xC, 0x6, 0x5, 0x2, 0xB, 0x0, 0x9, 0xD, 0x3, 0xE, 0x7, 0xA, 0xF, 0x4, 0x1, 0x8\r\n    ],\r\n    'E-A': [\r\n        0x9, 0x6, 0x3, 0x2, 0x8, 0xB, 0x1, 0x7, 0xA, 0x4, 0xE, 0xF, 0xC, 0x0, 0xD, 0x5,\r\n        0x3, 0x7, 0xE, 0x9, 0x8, 0xA, 0xF, 0x0, 0x5, 0x2, 0x6, 0xC, 0xB, 0x4, 0xD, 0x1,\r\n        0xE, 0x4, 0x6, 0x2, 0xB, 0x3, 0xD, 0x8, 0xC, 0xF, 0x5, 0xA, 0x0, 0x7, 0x1, 0x9,\r\n        0xE, 0x7, 0xA, 0xC, 0xD, 0x1, 0x3, 0x9, 0x0, 0x2, 0xB, 0x4, 0xF, 0x8, 0x5, 0x6,\r\n        0xB, 0x5, 0x1, 0x9, 0x8, 0xD, 0xF, 0x0, 0xE, 0x4, 0x2, 0x3, 0xC, 0x7, 0xA, 0x6,\r\n        0x3, 0xA, 0xD, 0xC, 0x1, 0x2, 0x0, 0xB, 0x7, 0x5, 0x9, 0x4, 0x8, 0xF, 0xE, 0x6,\r\n        0x1, 0xD, 0x2, 0x9, 0x7, 0xA, 0x6, 0x0, 0x8, 0xC, 0x4, 0x5, 0xF, 0x3, 0xB, 0xE,\r\n        0xB, 0xA, 0xF, 0x5, 0x0, 0xC, 0xE, 0x8, 0x6, 0x2, 0x3, 0x9, 0x1, 0x7, 0xD, 0x4\r\n    ],\r\n    'E-B': [\r\n        0x8, 0x4, 0xB, 0x1, 0x3, 0x5, 0x0, 0x9, 0x2, 0xE, 0xA, 0xC, 0xD, 0x6, 0x7, 0xF,\r\n        0x0, 0x1, 0x2, 0xA, 0x4, 0xD, 0x5, 0xC, 0x9, 0x7, 0x3, 0xF, 0xB, 0x8, 0x6, 0xE,\r\n        0xE, 0xC, 0x0, 0xA, 0x9, 0x2, 0xD, 0xB, 0x7, 0x5, 0x8, 0xF, 0x3, 0x6, 0x1, 0x4,\r\n        0x7, 0x5, 0x0, 0xD, 0xB, 0x6, 0x1, 0x2, 0x3, 0xA, 0xC, 0xF, 0x4, 0xE, 0x9, 0x8,\r\n        0x2, 0x7, 0xC, 0xF, 0x9, 0x5, 0xA, 0xB, 0x1, 0x4, 0x0, 0xD, 0x6, 0x8, 0xE, 0x3,\r\n        0x8, 0x3, 0x2, 0x6, 0x4, 0xD, 0xE, 0xB, 0xC, 0x1, 0x7, 0xF, 0xA, 0x0, 0x9, 0x5,\r\n        0x5, 0x2, 0xA, 0xB, 0x9, 0x1, 0xC, 0x3, 0x7, 0x4, 0xD, 0x0, 0x6, 0xF, 0x8, 0xE,\r\n        0x0, 0x4, 0xB, 0xE, 0x8, 0x3, 0x7, 0x1, 0xA, 0x2, 0x9, 0x6, 0xF, 0xD, 0x5, 0xC\r\n    ],\r\n    'E-C': [\r\n        0x1, 0xB, 0xC, 0x2, 0x9, 0xD, 0x0, 0xF, 0x4, 0x5, 0x8, 0xE, 0xA, 0x7, 0x6, 0x3,\r\n        0x0, 0x1, 0x7, 0xD, 0xB, 0x4, 0x5, 0x2, 0x8, 0xE, 0xF, 0xC, 0x9, 0xA, 0x6, 0x3,\r\n        0x8, 0x2, 0x5, 0x0, 0x4, 0x9, 0xF, 0xA, 0x3, 0x7, 0xC, 0xD, 0x6, 0xE, 0x1, 0xB,\r\n        0x3, 0x6, 0x0, 0x1, 0x5, 0xD, 0xA, 0x8, 0xB, 0x2, 0x9, 0x7, 0xE, 0xF, 0xC, 0x4,\r\n        0x8, 0xD, 0xB, 0x0, 0x4, 0x5, 0x1, 0x2, 0x9, 0x3, 0xC, 0xE, 0x6, 0xF, 0xA, 0x7,\r\n        0xC, 0x9, 0xB, 0x1, 0x8, 0xE, 0x2, 0x4, 0x7, 0x3, 0x6, 0x5, 0xA, 0x0, 0xF, 0xD,\r\n        0xA, 0x9, 0x6, 0x8, 0xD, 0xE, 0x2, 0x0, 0xF, 0x3, 0x5, 0xB, 0x4, 0x1, 0xC, 0x7,\r\n        0x7, 0x4, 0x0, 0x5, 0xA, 0x2, 0xF, 0xE, 0xC, 0x6, 0x1, 0xB, 0xD, 0x9, 0x3, 0x8\r\n    ],\r\n    'E-D': [\r\n        0xF, 0xC, 0x2, 0xA, 0x6, 0x4, 0x5, 0x0, 0x7, 0x9, 0xE, 0xD, 0x1, 0xB, 0x8, 0x3,\r\n        0xB, 0x6, 0x3, 0x4, 0xC, 0xF, 0xE, 0x2, 0x7, 0xD, 0x8, 0x0, 0x5, 0xA, 0x9, 0x1,\r\n        0x1, 0xC, 0xB, 0x0, 0xF, 0xE, 0x6, 0x5, 0xA, 0xD, 0x4, 0x8, 0x9, 0x3, 0x7, 0x2,\r\n        0x1, 0x5, 0xE, 0xC, 0xA, 0x7, 0x0, 0xD, 0x6, 0x2, 0xB, 0x4, 0x9, 0x3, 0xF, 0x8,\r\n        0x0, 0xC, 0x8, 0x9, 0xD, 0x2, 0xA, 0xB, 0x7, 0x3, 0x6, 0x5, 0x4, 0xE, 0xF, 0x1,\r\n        0x8, 0x0, 0xF, 0x3, 0x2, 0x5, 0xE, 0xB, 0x1, 0xA, 0x4, 0x7, 0xC, 0x9, 0xD, 0x6,\r\n        0x3, 0x0, 0x6, 0xF, 0x1, 0xE, 0x9, 0x2, 0xD, 0x8, 0xC, 0x4, 0xB, 0xA, 0x5, 0x7,\r\n        0x1, 0xA, 0x6, 0x8, 0xF, 0xB, 0x0, 0x4, 0xC, 0x3, 0x5, 0x9, 0x7, 0xD, 0x2, 0xE\r\n    ],\r\n    'E-SC': [\r\n        0x3, 0x6, 0x1, 0x0, 0x5, 0x7, 0xd, 0x9, 0x4, 0xb, 0x8, 0xc, 0xe, 0xf, 0x2, 0xa,\r\n        0x7, 0x1, 0x5, 0x2, 0x8, 0xb, 0x9, 0xc, 0xd, 0x0, 0x3, 0xa, 0xf, 0xe, 0x4, 0x6,\r\n        0xf, 0x1, 0x4, 0x6, 0xc, 0x8, 0x9, 0x2, 0xe, 0x3, 0x7, 0xa, 0xb, 0xd, 0x5, 0x0,\r\n        0x3, 0x4, 0xf, 0xc, 0x5, 0x9, 0xe, 0x0, 0x6, 0x8, 0x7, 0xa, 0x1, 0xb, 0xd, 0x2,\r\n        0x6, 0x9, 0x0, 0x7, 0xb, 0x8, 0x4, 0xc, 0x2, 0xe, 0xa, 0xf, 0x1, 0xd, 0x5, 0x3,\r\n        0x6, 0x1, 0x2, 0xf, 0x0, 0xb, 0x9, 0xc, 0x7, 0xd, 0xa, 0x5, 0x8, 0x4, 0xe, 0x3,\r\n        0x0, 0x2, 0xe, 0xc, 0x9, 0x1, 0x4, 0x7, 0x3, 0xf, 0x6, 0x8, 0xa, 0xd, 0xb, 0x5,\r\n        0x5, 0x2, 0xb, 0x8, 0x4, 0xc, 0x7, 0x1, 0xa, 0x6, 0xe, 0x0, 0x9, 0x3, 0xd, 0xf\r\n    ],\r\n    'E-Z': [// This is default S-box in according to draft of new standard\r\n        0xc, 0x4, 0x6, 0x2, 0xa, 0x5, 0xb, 0x9, 0xe, 0x8, 0xd, 0x7, 0x0, 0x3, 0xf, 0x1,\r\n        0x6, 0x8, 0x2, 0x3, 0x9, 0xa, 0x5, 0xc, 0x1, 0xe, 0x4, 0x7, 0xb, 0xd, 0x0, 0xf,\r\n        0xb, 0x3, 0x5, 0x8, 0x2, 0xf, 0xa, 0xd, 0xe, 0x1, 0x7, 0x4, 0xc, 0x9, 0x6, 0x0,\r\n        0xc, 0x8, 0x2, 0x1, 0xd, 0x4, 0xf, 0x6, 0x7, 0x0, 0xa, 0x5, 0x3, 0xe, 0x9, 0xb,\r\n        0x7, 0xf, 0x5, 0xa, 0x8, 0x1, 0x6, 0xd, 0x0, 0x9, 0x3, 0xe, 0xb, 0x4, 0x2, 0xc,\r\n        0x5, 0xd, 0xf, 0x6, 0x9, 0x2, 0xc, 0xa, 0xb, 0x7, 0x8, 0x1, 0x4, 0x3, 0xe, 0x0,\r\n        0x8, 0xe, 0x2, 0x5, 0x6, 0x9, 0x1, 0xc, 0xf, 0x4, 0xb, 0x0, 0xd, 0xa, 0x3, 0x7,\r\n        0x1, 0x7, 0xe, 0xd, 0x0, 0x5, 0x8, 0x3, 0x4, 0xf, 0xa, 0x6, 0x9, 0xc, 0xb, 0x2\r\n    ],\r\n    //S-box for digest\r\n    'D-TEST': [\r\n        0x4, 0xA, 0x9, 0x2, 0xD, 0x8, 0x0, 0xE, 0x6, 0xB, 0x1, 0xC, 0x7, 0xF, 0x5, 0x3,\r\n        0xE, 0xB, 0x4, 0xC, 0x6, 0xD, 0xF, 0xA, 0x2, 0x3, 0x8, 0x1, 0x0, 0x7, 0x5, 0x9,\r\n        0x5, 0x8, 0x1, 0xD, 0xA, 0x3, 0x4, 0x2, 0xE, 0xF, 0xC, 0x7, 0x6, 0x0, 0x9, 0xB,\r\n        0x7, 0xD, 0xA, 0x1, 0x0, 0x8, 0x9, 0xF, 0xE, 0x4, 0x6, 0xC, 0xB, 0x2, 0x5, 0x3,\r\n        0x6, 0xC, 0x7, 0x1, 0x5, 0xF, 0xD, 0x8, 0x4, 0xA, 0x9, 0xE, 0x0, 0x3, 0xB, 0x2,\r\n        0x4, 0xB, 0xA, 0x0, 0x7, 0x2, 0x1, 0xD, 0x3, 0x6, 0x8, 0x5, 0x9, 0xC, 0xF, 0xE,\r\n        0xD, 0xB, 0x4, 0x1, 0x3, 0xF, 0x5, 0x9, 0x0, 0xA, 0xE, 0x7, 0x6, 0x8, 0x2, 0xC,\r\n        0x1, 0xF, 0xD, 0x0, 0x5, 0x7, 0xA, 0x4, 0x9, 0x2, 0x3, 0xE, 0x6, 0xB, 0x8, 0xC\r\n    ],\r\n    'D-A': [\r\n        0xA, 0x4, 0x5, 0x6, 0x8, 0x1, 0x3, 0x7, 0xD, 0xC, 0xE, 0x0, 0x9, 0x2, 0xB, 0xF,\r\n        0x5, 0xF, 0x4, 0x0, 0x2, 0xD, 0xB, 0x9, 0x1, 0x7, 0x6, 0x3, 0xC, 0xE, 0xA, 0x8,\r\n        0x7, 0xF, 0xC, 0xE, 0x9, 0x4, 0x1, 0x0, 0x3, 0xB, 0x5, 0x2, 0x6, 0xA, 0x8, 0xD,\r\n        0x4, 0xA, 0x7, 0xC, 0x0, 0xF, 0x2, 0x8, 0xE, 0x1, 0x6, 0x5, 0xD, 0xB, 0x9, 0x3,\r\n        0x7, 0x6, 0x4, 0xB, 0x9, 0xC, 0x2, 0xA, 0x1, 0x8, 0x0, 0xE, 0xF, 0xD, 0x3, 0x5,\r\n        0x7, 0x6, 0x2, 0x4, 0xD, 0x9, 0xF, 0x0, 0xA, 0x1, 0x5, 0xB, 0x8, 0xE, 0xC, 0x3,\r\n        0xD, 0xE, 0x4, 0x1, 0x7, 0x0, 0x5, 0xA, 0x3, 0xC, 0x8, 0xF, 0x6, 0x2, 0x9, 0xB,\r\n        0x1, 0x3, 0xA, 0x9, 0x5, 0xB, 0x4, 0xF, 0x8, 0x6, 0x7, 0xE, 0xD, 0x0, 0x2, 0xC\r\n    ],\r\n    'D-SC': [\r\n        0xb, 0xd, 0x7, 0x0, 0x5, 0x4, 0x1, 0xf, 0x9, 0xe, 0x6, 0xa, 0x3, 0xc, 0x8, 0x2,\r\n        0x1, 0x2, 0x7, 0x9, 0xd, 0xb, 0xf, 0x8, 0xe, 0xc, 0x4, 0x0, 0x5, 0x6, 0xa, 0x3,\r\n        0x5, 0x1, 0xd, 0x3, 0xf, 0x6, 0xc, 0x7, 0x9, 0x8, 0xb, 0x2, 0x4, 0xe, 0x0, 0xa,\r\n        0xd, 0x1, 0xb, 0x4, 0x9, 0xc, 0xe, 0x0, 0x7, 0x5, 0x8, 0xf, 0x6, 0x2, 0xa, 0x3,\r\n        0x2, 0xd, 0xa, 0xf, 0x9, 0xb, 0x3, 0x7, 0x8, 0xc, 0x5, 0xe, 0x6, 0x0, 0x1, 0x4,\r\n        0x0, 0x4, 0x6, 0xc, 0x5, 0x3, 0x8, 0xd, 0xa, 0xb, 0xf, 0x2, 0x1, 0x9, 0x7, 0xe,\r\n        0x1, 0x3, 0xc, 0x8, 0xa, 0x6, 0xb, 0x0, 0x2, 0xe, 0x7, 0x9, 0xf, 0x4, 0x5, 0xd,\r\n        0xa, 0xb, 0x6, 0x0, 0x1, 0x3, 0x4, 0x7, 0xe, 0xd, 0x5, 0xf, 0x8, 0x2, 0x9, 0xc\r\n    ]\r\n};\r\n\r\nvar C = new Uint8Array([\r\n    0x69, 0x00, 0x72, 0x22, 0x64, 0xC9, 0x04, 0x23,\r\n    0x8D, 0x3A, 0xDB, 0x96, 0x46, 0xE9, 0x2A, 0xC4,\r\n    0x18, 0xFE, 0xAC, 0x94, 0x00, 0xED, 0x07, 0x12,\r\n    0xC0, 0x86, 0xDC, 0xC2, 0xEF, 0x4C, 0xA9, 0x2B\r\n]);\r\n\r\nfunction signed(x) {\r\n    return x >= 0x80000000 ? x - 0x100000000 : x;\r\n}\r\n\r\nfunction unsigned(x) {\r\n    return x < 0 ? x + 0x100000000 : x;\r\n}\r\n\r\n// Get buffer\r\nfunction buffer(d) {\r\n    if (d instanceof CryptoOperationData)\r\n        return d;\r\n    else if (d && d.buffer && d.buffer instanceof CryptoOperationData)\r\n        return d.byteOffset === 0 && d.byteLength === d.buffer.byteLength ?\r\n          d.buffer : new Uint8Array(new Uint8Array(d, d.byteOffset, d.byteLength)).buffer;\r\n    else\r\n        throw new DataError('CryptoOperationData required');\r\n}\r\n\r\n// Get byte array\r\nfunction byteArray(d) {\r\n    return new Uint8Array(buffer(d));\r\n}\r\n\r\n// Clone byte array\r\nfunction cloneArray(d) {\r\n    return new Uint8Array(byteArray(d));\r\n}\r\n\r\n// Get int32 array\r\nfunction intArray(d) {\r\n    return new Int32Array(buffer(d));\r\n}\r\n\r\n// Swap bytes for version 2015\r\nfunction swap32(b) {\r\n    return ((b & 0xff) << 24)\r\n      | ((b & 0xff00) << 8)\r\n      | ((b >> 8) & 0xff00)\r\n      | ((b >> 24) & 0xff);\r\n}\r\n\r\n// </editor-fold>\r\n\r\n/*\r\n * Initial parameters and common algortithms of GOST R 34.12-15\r\n * Algorithm \"Kuznechik\" 128bit\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\n// Default initial vector\r\nvar defaultIV128 = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]);\r\n\r\n// Mult table for R function\r\nvar multTable = (function () {\r\n\r\n    // Multiply two numbers in the GF(2^8) finite field defined\r\n    // by the polynomial x^8 + x^7 + x^6 + x + 1 = 0 */\r\n    function gmul(a, b) {\r\n        var p = 0, counter, carry;\r\n        for (counter = 0; counter < 8; counter++) {\r\n            if (b & 1)\r\n                p ^= a;\r\n            carry = a & 0x80; // detect if x^8 term is about to be generated\r\n            a = (a << 1) & 0xff;\r\n            if (carry)\r\n                a ^= 0xc3; // replace x^8 with x^7 + x^6 + x + 1\r\n            b >>= 1;\r\n        }\r\n        return p & 0xff;\r\n    }\r\n\r\n    // It is required only this values for R function\r\n    //       0   1   2    3    4    5    6    7\r\n    var x = [1, 16, 32, 133, 148, 192, 194, 251];\r\n    var m = [];\r\n    for (var i = 0; i < 8; i++) {\r\n        m[i] = [];\r\n        for (var j = 0; j < 256; j++)\r\n            m[i][j] = gmul(x[i], j);\r\n    }\r\n    return m;\r\n})();\r\n\r\n// 148, 32, 133, 16, 194, 192, 1, 251, 1, 192, 194, 16, 133, 32, 148, 1\r\nvar kB = [4, 2, 3, 1, 6, 5, 0, 7, 0, 5, 6, 1, 3, 2, 4, 0];\r\n\r\n// R - function\r\nfunction funcR(d) {\r\n    var sum = 0;\r\n    for (var i = 0; i < 16; i++)\r\n        sum ^= multTable[kB[i]][d[i]];\r\n\r\n    for (var i = 16; i > 0; --i)\r\n        d[i] = d[i - 1];\r\n    d[0] = sum;\r\n}\r\n\r\nfunction funcReverseR(d) {\r\n    var tmp = d[0];\r\n    for (var i = 0; i < 15; i++)\r\n        d[i] = d[i + 1];\r\n    d[15] = tmp;\r\n\r\n    var sum = 0;\r\n    for (i = 0; i < 16; i++)\r\n        sum ^= multTable[kB[i]][d[i]];\r\n    d[15] = sum;\r\n}\r\n\r\n// Nonlinear transformation\r\nvar kPi = [\r\n    252, 238, 221, 17, 207, 110, 49, 22, 251, 196, 250, 218, 35, 197, 4, 77,\r\n    233, 119, 240, 219, 147, 46, 153, 186, 23, 54, 241, 187, 20, 205, 95, 193,\r\n    249, 24, 101, 90, 226, 92, 239, 33, 129, 28, 60, 66, 139, 1, 142, 79,\r\n    5, 132, 2, 174, 227, 106, 143, 160, 6, 11, 237, 152, 127, 212, 211, 31,\r\n    235, 52, 44, 81, 234, 200, 72, 171, 242, 42, 104, 162, 253, 58, 206, 204,\r\n    181, 112, 14, 86, 8, 12, 118, 18, 191, 114, 19, 71, 156, 183, 93, 135,\r\n    21, 161, 150, 41, 16, 123, 154, 199, 243, 145, 120, 111, 157, 158, 178, 177,\r\n    50, 117, 25, 61, 255, 53, 138, 126, 109, 84, 198, 128, 195, 189, 13, 87,\r\n    223, 245, 36, 169, 62, 168, 67, 201, 215, 121, 214, 246, 124, 34, 185, 3,\r\n    224, 15, 236, 222, 122, 148, 176, 188, 220, 232, 40, 80, 78, 51, 10, 74,\r\n    167, 151, 96, 115, 30, 0, 98, 68, 26, 184, 56, 130, 100, 159, 38, 65,\r\n    173, 69, 70, 146, 39, 94, 85, 47, 140, 163, 165, 125, 105, 213, 149, 59,\r\n    7, 88, 179, 64, 134, 172, 29, 247, 48, 55, 107, 228, 136, 217, 231, 137,\r\n    225, 27, 131, 73, 76, 63, 248, 254, 141, 83, 170, 144, 202, 216, 133, 97,\r\n    32, 113, 103, 164, 45, 43, 9, 91, 203, 155, 37, 208, 190, 229, 108, 82,\r\n    89, 166, 116, 210, 230, 244, 180, 192, 209, 102, 175, 194, 57, 75, 99, 182\r\n];\r\n\r\nvar kReversePi = (function () {\r\n    var m = [];\r\n    for (var i = 0, n = kPi.length; i < n; i++)\r\n        m[kPi[i]] = i;\r\n    return m;\r\n})();\r\n\r\nfunction funcS(d) {\r\n    for (var i = 0; i < 16; ++i)\r\n        d[i] = kPi[d[i]];\r\n}\r\n\r\nfunction funcReverseS(d) {\r\n    for (var i = 0; i < 16; ++i)\r\n        d[i] = kReversePi[d[i]];\r\n}\r\n\r\nfunction funcX(a, b) {\r\n    for (var i = 0; i < 16; ++i)\r\n        a[i] ^= b[i];\r\n}\r\n\r\nfunction funcL(d) {\r\n    for (var i = 0; i < 16; ++i)\r\n        funcR(d);\r\n}\r\n\r\nfunction funcReverseL(d) {\r\n    for (var i = 0; i < 16; ++i)\r\n        funcReverseR(d);\r\n}\r\n\r\nfunction funcLSX(a, b) {\r\n    funcX(a, b);\r\n    funcS(a);\r\n    funcL(a);\r\n}\r\n\r\nfunction funcReverseLSX(a, b) {\r\n    funcX(a, b);\r\n    funcReverseL(a);\r\n    funcReverseS(a);\r\n}\r\n\r\nfunction funcF(inputKey, inputKeySecond, iterationConst) {\r\n    var tmp = new Uint8Array(inputKey);\r\n    funcLSX(inputKey, iterationConst);\r\n    funcX(inputKey, inputKeySecond);\r\n    inputKeySecond.set(tmp);\r\n}\r\n\r\nfunction funcC(number, d) {\r\n    for (var i = 0; i < 15; i++)\r\n        d[i] = 0;\r\n    d[15] = number;\r\n    funcL(d);\r\n}\r\n\r\n// </editor-fold>\r\n\r\n/**\r\n * Key schedule for GOST R 34.12-15 128bits\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method keySchedule\r\n * @param {type} k\r\n * @returns {Uint8Array}\r\n */\r\nfunction keySchedule128(k) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var keys = new Uint8Array(160), c = new Uint8Array(16);\r\n    keys.set(byteArray(k));\r\n    for (var j = 0; j < 4; j++) {\r\n        var j0 = 32 * j, j1 = 32 * (j + 1);\r\n        keys.set(new Uint8Array(keys.buffer, j0, 32), j1);\r\n        for (var i = 1; i < 9; i++) {\r\n            funcC(j * 8 + i, c);\r\n            funcF(new Uint8Array(keys.buffer, j1, 16),\r\n              new Uint8Array(keys.buffer, j1 + 16, 16), c);\r\n        }\r\n    }\r\n    return keys;\r\n} // </editor-fold>\r\n\r\n/**\r\n * GOST R 34.12-15 128 bits encrypt/decrypt process\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method round\r\n * @param {Uint8Array} k Scheduled key\r\n * @param {Uint8Array} d Data\r\n * @param {number} ofs Offsec\r\n * @param {number} e true - decrypt\r\n */\r\nfunction process128(k, d, ofs, e) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    ofs = ofs || d.byteOffset;\r\n    var r = new Uint8Array(d.buffer, ofs, 16);\r\n    if (e) {\r\n        for (var i = 0; i < 9; i++)\r\n            funcReverseLSX(r, new Uint8Array(k.buffer, (9 - i) * 16, 16));\r\n\r\n        funcX(r, new Uint8Array(k.buffer, 0, 16));\r\n    } else {\r\n        for (var i = 0; i < 9; i++)\r\n            funcLSX(r, new Uint8Array(k.buffer, 16 * i, 16));\r\n\r\n        funcX(r, new Uint8Array(k.buffer, 16 * 9, 16));\r\n    }\r\n} // </editor-fold>\r\n\r\n/**\r\n * One GOST encryption round\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method round\r\n * @param {Int8Array} S sBox\r\n * @param {Int32Array} m 2x32 bits cipher block\r\n * @param {Int32Array} k 32 bits key[i]\r\n */\r\nfunction round(S, m, k) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var cm = (m[0] + k) & 0xffffffff;\r\n\r\n    var om = S[0 + ((cm >> (0 * 4)) & 0xF)] << (0 * 4);\r\n    om |= S[16 + ((cm >> (1 * 4)) & 0xF)] << (1 * 4);\r\n    om |= S[32 + ((cm >> (2 * 4)) & 0xF)] << (2 * 4);\r\n    om |= S[48 + ((cm >> (3 * 4)) & 0xF)] << (3 * 4);\r\n    om |= S[64 + ((cm >> (4 * 4)) & 0xF)] << (4 * 4);\r\n    om |= S[80 + ((cm >> (5 * 4)) & 0xF)] << (5 * 4);\r\n    om |= S[96 + ((cm >> (6 * 4)) & 0xF)] << (6 * 4);\r\n    om |= S[112 + ((cm >> (7 * 4)) & 0xF)] << (7 * 4);\r\n    cm = om << 11 | om >>> (32 - 11);\r\n\r\n    cm ^= m[1];\r\n    m[1] = m[0];\r\n    m[0] = cm;\r\n\r\n} // </editor-fold>\r\n\r\n/**\r\n * Process encrypt/decrypt block with key K using GOST 28147-89\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method process\r\n * @param k {Int32Array} 8x32 bits key\r\n * @param d {Int32Array} 8x8 bits cipher block\r\n * @param ofs {number} offset\r\n */\r\nfunction process89(k, d, ofs) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    ofs = ofs || d.byteOffset;\r\n    var s = this.sBox,\r\n      m = new Int32Array(d.buffer, ofs, 2);\r\n\r\n    for (var i = 0; i < 32; i++)\r\n        round(s, m, k[i]);\r\n\r\n    var r = m[0];\r\n    m[0] = m[1];\r\n    m[1] = r;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Process encrypt/decrypt block with key K using GOST R 34.12-15 64bit block\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method process\r\n * @param k {Int32Array} 8x32 bits key\r\n * @param d {Int32Array} 8x8 bits cipher block\r\n * @param ofs {number} offset\r\n */\r\nfunction process15(k, d, ofs) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    ofs = ofs || d.byteOffset;\r\n    var s = this.sBox,\r\n      m = new Int32Array(d.buffer, ofs, 2),\r\n      r = swap32(m[0]);\r\n    m[0] = swap32(m[1]);\r\n    m[1] = r;\r\n\r\n    for (var i = 0; i < 32; i++)\r\n        round(s, m, k[i]);\r\n\r\n    m[0] = swap32(m[0]);\r\n    m[1] = swap32(m[1]);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Key keySchedule algorithm for GOST 28147-89 64bit cipher\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method process\r\n * @param k {Uint8Array} 8 bit key array\r\n * @param e {boolean}  true - decrypt\r\n * @returns {Int32Array} keyScheduled 32-bit key\r\n */\r\nfunction keySchedule89(k, e) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var sch = new Int32Array(32),\r\n      key = new Int32Array(buffer(k));\r\n\r\n    for (var i = 0; i < 8; i++)\r\n        sch[i] = key[i];\r\n\r\n    if (e) {\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 8] = sch[7 - i];\r\n\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 16] = sch[7 - i];\r\n    } else {\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 8] = sch[i];\r\n\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 16] = sch[i];\r\n    }\r\n\r\n    for (var i = 0; i < 8; i++)\r\n        sch[i + 24] = sch[7 - i];\r\n\r\n    return sch;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Key keySchedule algorithm for GOST R 34.12-15 64bit cipher\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method process\r\n * @param k {Uint8Array} 8 bit key array\r\n * @param e {boolean}  true - decrypt\r\n * @returns {Int32Array} keyScheduled 32-bit key\r\n */\r\nfunction keySchedule15(k, e) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var sch = new Int32Array(32),\r\n      key = new Int32Array(buffer(k));\r\n\r\n    for (var i = 0; i < 8; i++)\r\n        sch[i] = swap32(key[i]);\r\n\r\n    if (e) {\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 8] = sch[7 - i];\r\n\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 16] = sch[7 - i];\r\n    } else {\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 8] = sch[i];\r\n\r\n        for (var i = 0; i < 8; i++)\r\n            sch[i + 16] = sch[i];\r\n    }\r\n\r\n    for (var i = 0; i < 8; i++)\r\n        sch[i + 24] = sch[7 - i];\r\n\r\n    return sch;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Key schedule for RC2\r\n *\r\n * https://tools.ietf.org/html/rfc2268\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method keySchedule\r\n * @param {Uint8Array} k\r\n * @returns {Uint16Array}\r\n */\r\nvar keyScheduleRC2 = (function () // <editor-fold defaultstate=\"collapsed\">\r\n  {\r\n      // an array of \"random\" bytes based on the digits of PI = 3.14159...\r\n      var PITABLE = new Uint8Array([\r\n          0xd9, 0x78, 0xf9, 0xc4, 0x19, 0xdd, 0xb5, 0xed, 0x28, 0xe9, 0xfd, 0x79, 0x4a, 0xa0, 0xd8, 0x9d,\r\n          0xc6, 0x7e, 0x37, 0x83, 0x2b, 0x76, 0x53, 0x8e, 0x62, 0x4c, 0x64, 0x88, 0x44, 0x8b, 0xfb, 0xa2,\r\n          0x17, 0x9a, 0x59, 0xf5, 0x87, 0xb3, 0x4f, 0x13, 0x61, 0x45, 0x6d, 0x8d, 0x09, 0x81, 0x7d, 0x32,\r\n          0xbd, 0x8f, 0x40, 0xeb, 0x86, 0xb7, 0x7b, 0x0b, 0xf0, 0x95, 0x21, 0x22, 0x5c, 0x6b, 0x4e, 0x82,\r\n          0x54, 0xd6, 0x65, 0x93, 0xce, 0x60, 0xb2, 0x1c, 0x73, 0x56, 0xc0, 0x14, 0xa7, 0x8c, 0xf1, 0xdc,\r\n          0x12, 0x75, 0xca, 0x1f, 0x3b, 0xbe, 0xe4, 0xd1, 0x42, 0x3d, 0xd4, 0x30, 0xa3, 0x3c, 0xb6, 0x26,\r\n          0x6f, 0xbf, 0x0e, 0xda, 0x46, 0x69, 0x07, 0x57, 0x27, 0xf2, 0x1d, 0x9b, 0xbc, 0x94, 0x43, 0x03,\r\n          0xf8, 0x11, 0xc7, 0xf6, 0x90, 0xef, 0x3e, 0xe7, 0x06, 0xc3, 0xd5, 0x2f, 0xc8, 0x66, 0x1e, 0xd7,\r\n          0x08, 0xe8, 0xea, 0xde, 0x80, 0x52, 0xee, 0xf7, 0x84, 0xaa, 0x72, 0xac, 0x35, 0x4d, 0x6a, 0x2a,\r\n          0x96, 0x1a, 0xd2, 0x71, 0x5a, 0x15, 0x49, 0x74, 0x4b, 0x9f, 0xd0, 0x5e, 0x04, 0x18, 0xa4, 0xec,\r\n          0xc2, 0xe0, 0x41, 0x6e, 0x0f, 0x51, 0xcb, 0xcc, 0x24, 0x91, 0xaf, 0x50, 0xa1, 0xf4, 0x70, 0x39,\r\n          0x99, 0x7c, 0x3a, 0x85, 0x23, 0xb8, 0xb4, 0x7a, 0xfc, 0x02, 0x36, 0x5b, 0x25, 0x55, 0x97, 0x31,\r\n          0x2d, 0x5d, 0xfa, 0x98, 0xe3, 0x8a, 0x92, 0xae, 0x05, 0xdf, 0x29, 0x10, 0x67, 0x6c, 0xba, 0xc9,\r\n          0xd3, 0x00, 0xe6, 0xcf, 0xe1, 0x9e, 0xa8, 0x2c, 0x63, 0x16, 0x01, 0x3f, 0x58, 0xe2, 0x89, 0xa9,\r\n          0x0d, 0x38, 0x34, 0x1b, 0xab, 0x33, 0xff, 0xb0, 0xbb, 0x48, 0x0c, 0x5f, 0xb9, 0xb1, 0xcd, 0x2e,\r\n          0xc5, 0xf3, 0xdb, 0x47, 0xe5, 0xa5, 0x9c, 0x77, 0x0a, 0xa6, 0x20, 0x68, 0xfe, 0x7f, 0xc1, 0xad\r\n      ]);\r\n\r\n      return function (k) {\r\n          var key = new Uint8Array(buffer(k)),\r\n            T = Math.min(key.length, 128),\r\n            T1 = this.effectiveLength,\r\n            T8 = Math.floor((T1 + 7) / 8),\r\n            TM = 0xff % Math.pow(2, 8 + T1 - 8 * T8);\r\n\r\n          var L = new Uint8Array(128), K = new Uint16Array(L.buffer);\r\n          for (var i = 0; i < T; i++)\r\n              L[i] = key[i];\r\n          for (var i = T; i < 128; i++)\r\n              L[i] = PITABLE[(L[i - 1] + L[i - T]) % 256];\r\n          L[128 - T8] = PITABLE[L[128 - T8] & TM];\r\n          for (var i = 127 - T8; i >= 0; --i)\r\n              L[i] = PITABLE[L[i + 1] ^ L[i + T8]];\r\n          return K;\r\n      };\r\n  } // </editor-fold>\r\n)();\r\n\r\n/**\r\n * RC2 encrypt/decrypt process\r\n *\r\n * https://tools.ietf.org/html/rfc2268\r\n *\r\n * @memberOf GostCipher\r\n * @private\r\n * @instance\r\n * @method round\r\n * @param {CryptoOperationData} k Scheduled key\r\n * @param {CryptoOperationData} d Data\r\n * @param {number} ofs Offsec\r\n * @param {number} e true - decrypt\r\n */\r\nvar processRC2 = (function () // <editor-fold defaultstate=\"collapsed\">\r\n  {\r\n      var K, j, R = new Uint16Array(4),\r\n        s = new Uint16Array([1, 2, 3, 5]), reverse;\r\n\r\n      function rol(R, s) {\r\n          return (R << s | R >>> (16 - s)) & 0xffff;\r\n      }\r\n\r\n      function ror(R, s) {\r\n          return (R >>> s | R << (16 - s)) & 0xffff;\r\n      }\r\n\r\n      function mix(i) {\r\n          if (reverse) {\r\n              R[i] = ror(R[i], s[i]);\r\n              R[i] = R[i] - K[j] - (R[(i + 3) % 4] & R[(i + 2) % 4]) - ((~R[(i + 3) % 4]) & R[(i + 1) % 4]);\r\n              j = j - 1;\r\n          } else {\r\n              R[i] = R[i] + K[j] + (R[(i + 3) % 4] & R[(i + 2) % 4]) + ((~R[(i + 3) % 4]) & R[(i + 1) % 4]);\r\n              j = j + 1;\r\n              R[i] = rol(R[i], s[i]);\r\n          }\r\n      }\r\n\r\n      function mash(i) {\r\n          if (reverse) {\r\n              R[i] = R[i] - K[R[(i + 3) % 4] & 63];\r\n          } else {\r\n              R[i] = R[i] + K[R[(i + 3) % 4] & 63];\r\n          }\r\n      }\r\n\r\n      function perform(method, count) {\r\n          count = count || 1;\r\n          for (var j = 0; j < count; j++) {\r\n              if (reverse) {\r\n                  for (var i = 3; i >= 0; --i)\r\n                      method(i);\r\n              } else {\r\n                  for (var i = 0; i < 4; i++)\r\n                      method(i);\r\n              }\r\n          }\r\n      }\r\n\r\n      return function (k, d, ofs, e) {\r\n          reverse = e;\r\n          //  1. Initialize words R[0], ..., R[3] to contain the 64-bit\r\n          //     ciphertext value.\r\n          R = new Uint16Array(d.buffer, ofs || d.byteOffset, 4);\r\n          //  2. Expand the key, so that words K[0], ..., K[63] become\r\n          //     defined.\r\n          K = k;\r\n          //  3. Initialize j to zero (enc) j to 63 (dec).\r\n          j = e ? 63 : 0;\r\n          //  4. Perform five mixing rounds.\r\n          perform(mix, 5);\r\n          //  5. Perform one mashing round.\r\n          perform(mash);\r\n          //  6. Perform six mixing rounds.\r\n          perform(mix, 6);\r\n          //  7. Perform one mashing round.\r\n          perform(mash);\r\n          //  8. Perform five mixing rounds.\r\n          perform(mix, 5);\r\n      };\r\n  } // </editor-fold>\r\n)();\r\n\r\n/**\r\n * Algorithm name GOST 28147-ECB<br><br>\r\n *\r\n * encryptECB (K, D) is D, encrypted with key k using GOST 28147/GOST R 34.13 in\r\n * \"prostaya zamena\" (Electronic Codebook, ECB) mode.\r\n * @memberOf GostCipher\r\n * @method encrypt\r\n * @instance\r\n * @param k {CryptoOperationData} 8x32 bit key\r\n * @param d {CryptoOperationData} 8 bits message\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction encryptECB(k, d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var p = this.pad(byteArray(d)),\r\n      n = this.blockSize,\r\n      b = p.byteLength / n,\r\n      key = this.keySchedule(k);\r\n\r\n    for (var i = 0; i < b; i++)\r\n        this.process(key, p, n * i);\r\n\r\n    return p.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-ECB<br><br>\r\n *\r\n * decryptECB (K, D) is D, decrypted with key K using GOST 28147/GOST R 34.13 in\r\n * \"prostaya zamena\"  (Electronic Codebook, ECB) mode.\r\n *\r\n * @memberOf GostCipher\r\n * @method decrypt\r\n * @instance\r\n * @param k {CryptoOperationData} 8x32 bits key\r\n * @param d {CryptoOperationData} 8 bits message\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction decryptECB(k, d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var p = cloneArray(d),\r\n      n = this.blockSize,\r\n      b = p.byteLength / n,\r\n      key = this.keySchedule(k, 1);\r\n\r\n    for (var i = 0; i < b; i++)\r\n        this.process(key, p, n * i, 1);\r\n\r\n    return this.unpad(p).buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CFB<br><br>\r\n *\r\n * encryptCFB (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie s obratnoj svyaziyu\" (Cipher Feedback, CFB) mode, and IV is\r\n * used as the initialization vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method encrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction encryptCFB(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      c = cloneArray(d),\r\n      m = s.length,\r\n      t = new Uint8Array(m),\r\n      b = this.shiftBits >> 3,\r\n      cb = c.length, r = cb % b, q = (cb - r) / b,\r\n      key = this.keySchedule(k);\r\n\r\n    for (var i = 0; i < q; i++) {\r\n\r\n        for (var j = 0; j < m; j++)\r\n            t[j] = s[j];\r\n\r\n        this.process(key, s);\r\n\r\n        for (var j = 0; j < b; j++)\r\n            c[i * b + j] ^= s[j];\r\n\r\n        for (var j = 0; j < m - b; j++)\r\n            s[j] = t[b + j];\r\n\r\n        for (var j = 0; j < b; j++)\r\n            s[m - b + j] = c[i * b + j];\r\n\r\n        k = this.keyMeshing(k, s, i, key);\r\n    }\r\n\r\n    if (r > 0) {\r\n        this.process(key, s);\r\n\r\n        for (var i = 0; i < r; i++)\r\n            c[q * b + i] ^= s[i];\r\n    }\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CFB<br><br>\r\n *\r\n * decryptCFB (IV, K, D) is D, decrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie s obratnoj svyaziyu po shifrotekstu\" (Cipher Feedback, CFB) mode, and IV is\r\n * used as the initialization vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method decrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction decryptCFB(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      c = cloneArray(d),\r\n      m = s.length,\r\n      t = new Uint8Array(m),\r\n      b = this.shiftBits >> 3,\r\n      cb = c.length, r = cb % b, q = (cb - r) / b,\r\n      key = this.keySchedule(k);\r\n\r\n    for (var i = 0; i < q; i++) {\r\n\r\n        for (var j = 0; j < m; j++)\r\n            t[j] = s[j];\r\n\r\n        this.process(key, s);\r\n\r\n        for (var j = 0; j < b; j++) {\r\n            t[j] = c[i * b + j];\r\n            c[i * b + j] ^= s[j];\r\n        }\r\n\r\n        for (var j = 0; j < m - b; j++)\r\n            s[j] = t[b + j];\r\n\r\n        for (var j = 0; j < b; j++)\r\n            s[m - b + j] = t[j];\r\n\r\n        k = this.keyMeshing(k, s, i, key);\r\n    }\r\n\r\n    if (r > 0) {\r\n        this.process(key, s);\r\n\r\n        for (var i = 0; i < r; i++)\r\n            c[q * b + i] ^= s[i];\r\n    }\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-OFB<br><br>\r\n *\r\n * encryptOFB/decryptOFB (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie s obratnoj svyaziyu po vyhodu\" (Output Feedback, OFB) mode, and IV is\r\n * used as the initialization vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method encrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv 8x8 optional bits initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\n/**\r\n * Algorithm name GOST 28147-OFB<br><br>\r\n *\r\n * encryptOFB/decryptOFB (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie s obratnoj svyaziyu po vyhodu\" (Output Feedback, OFB) mode, and IV is\r\n * used as the initialization vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method decrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction processOFB(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      c = cloneArray(d),\r\n      m = s.length,\r\n      t = new Uint8Array(m),\r\n      b = this.shiftBits >> 3,\r\n      p = new Uint8Array(b),\r\n      cb = c.length, r = cb % b, q = (cb - r) / b,\r\n      key = this.keySchedule(k);\r\n\r\n    for (var i = 0; i < q; i++) {\r\n\r\n        for (var j = 0; j < m; j++)\r\n            t[j] = s[j];\r\n\r\n        this.process(key, s);\r\n\r\n        for (var j = 0; j < b; j++)\r\n            p[j] = s[j];\r\n\r\n        for (var j = 0; j < b; j++)\r\n            c[i * b + j] ^= s[j];\r\n\r\n        for (var j = 0; j < m - b; j++)\r\n            s[j] = t[b + j];\r\n\r\n        for (var j = 0; j < b; j++)\r\n            s[m - b + j] = p[j];\r\n\r\n        k = this.keyMeshing(k, s, i, key);\r\n    }\r\n\r\n    if (r > 0) {\r\n        this.process(key, s);\r\n\r\n        for (var i = 0; i < r; i++)\r\n            c[q * b + i] ^= s[i];\r\n    }\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CTR<br><br>\r\n *\r\n * encryptCTR/decryptCTR (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie\" (Counter Mode-CTR) mode, and IV is used as the\r\n * initialization vector.\r\n * @memberOf GostCipher\r\n * @method encrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv 8x8 optional bits initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\n/**\r\n * Algorithm name GOST 28147-CTR<br><br>\r\n *\r\n * encryptCTR/decryptCTR (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"gammirovanie\" (Counter Mode-CTR) mode, and IV is used as the\r\n * initialization vector.\r\n * @memberOf GostCipher\r\n * @method decrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction processCTR89(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      c = cloneArray(d),\r\n      b = this.blockSize,\r\n      t = new Int8Array(b),\r\n      cb = c.length, r = cb % b, q = (cb - r) / b,\r\n      key = this.keySchedule(k),\r\n      syn = new Int32Array(s.buffer);\r\n\r\n    this.process(key, s);\r\n\r\n    for (var i = 0; i < q; i++) {\r\n        syn[0] = (syn[0] + 0x1010101) & 0xffffffff;\r\n        // syn[1] = signed(unsigned((syn[1] + 0x1010104) & 0xffffffff) % 0xffffffff);\r\n        var tmp = unsigned(syn[1]) + 0x1010104; // Special thanks to Ilya Matveychikov\r\n        syn[1] = signed(tmp < 0x100000000 ? tmp : tmp - 0xffffffff);\r\n\r\n        for (var j = 0; j < b; j++)\r\n            t[j] = s[j];\r\n\r\n        this.process(key, syn);\r\n\r\n        for (var j = 0; j < b; j++)\r\n            c[i * b + j] ^= s[j];\r\n\r\n        for (var j = 0; j < b; j++)\r\n            s[j] = t[j];\r\n\r\n        k = this.keyMeshing(k, s, i, key);\r\n    }\r\n    if (r > 0) {\r\n        syn[0] = (syn[0] + 0x1010101) & 0xffffffff;\r\n        // syn[1] = signed(unsigned((syn[1] + 0x1010104) & 0xffffffff) % 0xffffffff);\r\n        var tmp = unsigned(syn[1]) + 0x1010104; // Special thanks to Ilya Matveychikov\r\n        syn[1] = signed(tmp < 0x100000000 ? tmp : tmp - 0xffffffff);\r\n\r\n        this.process(key, syn);\r\n\r\n        for (var i = 0; i < r; i++)\r\n            c[q * b + i] ^= s[i];\r\n    }\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\nfunction processCTR15(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var c = cloneArray(d),\r\n      n = this.blockSize,\r\n      b = this.shiftBits >> 3,\r\n      cb = c.length, r = cb % b, q = (cb - r) / b,\r\n      s = new Uint8Array(n),\r\n      t = new Int32Array(n),\r\n      key = this.keySchedule(k);\r\n\r\n    s.set(iv || this.iv);\r\n    for (var i = 0; i < q; i++) {\r\n\r\n        for (var j = 0; j < n; j++)\r\n            t[j] = s[j];\r\n\r\n        this.process(key, s);\r\n\r\n        for (var j = 0; j < b; j++)\r\n            c[b * i + j] ^= s[j];\r\n\r\n        for (var j = 0; j < n; j++)\r\n            s[j] = t[j];\r\n\r\n        for (var j = n - 1; i >= 0; --i) {\r\n            if (s[j] > 0xfe) {\r\n                s[j] -= 0xfe;\r\n            } else {\r\n                s[j]++;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n\r\n    if (r > 0) {\r\n        this.process(key, s);\r\n        for (var j = 0; j < r; j++)\r\n            c[b * q + j] ^= s[j];\r\n    }\r\n\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CBC<br><br>\r\n *\r\n * encryptCBC (IV, K, D) is D, encrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"Prostaya zamena s zatsepleniem\" (Cipher-Block-Chaining, CBC) mode and IV is used as the initialization\r\n * vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method encrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction encryptCBC(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      n = this.blockSize,\r\n      m = s.length,\r\n      c = this.pad(byteArray(d)),\r\n      key = this.keySchedule(k);\r\n\r\n    for (var i = 0, b = c.length / n; i < b; i++) {\r\n\r\n        for (var j = 0; j < n; j++)\r\n            s[j] ^= c[i * n + j];\r\n\r\n        this.process(key, s);\r\n\r\n        for (var j = 0; j < n; j++)\r\n            c[i * n + j] = s[j];\r\n\r\n        if (m !== n) {\r\n            for (var j = 0; j < m - n; j++)\r\n                s[j] = s[n + j];\r\n\r\n            for (var j = 0; j < n; j++)\r\n                s[j + m - n] = c[i * n + j];\r\n        }\r\n\r\n        k = this.keyMeshing(k, s, i, key);\r\n    }\r\n\r\n    return c.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CBC<br><br>\r\n *\r\n * decryptCBC (IV, K, D) is D, decrypted with key K using GOST 28147/GOST R 34.13\r\n * in \"Prostaya zamena s zatsepleniem\" (Cipher-Block-Chaining, CBC) mode and IV is used as the initialization\r\n * vector.\r\n *\r\n * @memberOf GostCipher\r\n * @method decrypt\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction decryptCBC(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var s = new Uint8Array(iv || this.iv),\r\n      n = this.blockSize,\r\n      m = s.length,\r\n      c = cloneArray(d),\r\n      next = new Uint8Array(n),\r\n      key = this.keySchedule(k, 1);\r\n\r\n    for (var i = 0, b = c.length / n; i < b; i++) {\r\n\r\n        for (var j = 0; j < n; j++)\r\n            next[j] = c[i * n + j];\r\n\r\n        this.process(key, c, i * n, 1);\r\n\r\n        for (var j = 0; j < n; j++)\r\n            c[i * n + j] ^= s[j];\r\n\r\n        if (m !== n) {\r\n            for (var j = 0; j < m - n; j++)\r\n                s[j] = s[n + j];\r\n        }\r\n\r\n        for (var j = 0; j < n; j++)\r\n            s[j + m - n] = next[j];\r\n\r\n        k = this.keyMeshing(k, s, i, key, 1);\r\n    }\r\n\r\n    return this.unpad(c).buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * The generateKey method returns a new generated key.\r\n *\r\n * @memberOf GostCipher\r\n * @method generateKey\r\n * @instance\r\n * @return {CryptoOperationData} result\r\n */\r\n\r\nfunction generateKey() // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    // Simple generate 256 bit random seed\r\n    var k = new Uint8Array(this.keySize);\r\n    randomSeed(k);\r\n    return k.buffer;\r\n} // </editor-fold>\r\n\r\n\r\n/**\r\n * makeIMIT (K, D) is the 32-bit result of the GOST 28147/GOST R 34.13 in\r\n * \"imitovstavka\" (MAC) mode, used with D as plaintext, K as key and IV\r\n * as initialization vector.  Note that the standard specifies its use\r\n * in this mode only with an initialization vector of zero.\r\n *\r\n * @memberOf GostCipher\r\n * @method processMAC\r\n * @private\r\n * @instance\r\n * @param {Int32Array} key 8x32 bits key\r\n * @param {Int32Array} s 8x8 sum array\r\n * @param {Uint8Array} d 8 bits array with data\r\n * @return {Uint8Array} result\r\n */\r\nfunction processMAC89(key, s, d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var c = zeroPad.call(this, byteArray(d)),\r\n      n = this.blockSize,\r\n      q = c.length / n,\r\n      sBox = this.sBox,\r\n      sum = new Int32Array(s.buffer);\r\n\r\n    for (var i = 0; i < q; i++) {\r\n\r\n        for (var j = 0; j < n; j++)\r\n            s[j] ^= c[i * n + j];\r\n\r\n        for (var j = 0; j < 16; j++) // 1-16 steps\r\n            round(sBox, sum, key[j]);\r\n    }\r\n} // </editor-fold>\r\n\r\nfunction processKeyMAC15(s) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var t = 0, n = s.length;\r\n    for (var i = n - 1; i >= 0; --i) {\r\n        var t1 = s[i] >>> 7;\r\n        s[i] = (s[i] << 1) & 0xff | t;\r\n        t = t1;\r\n    }\r\n    if (t !== 0) {\r\n        if (n === 16)\r\n            s[15] ^= 0x87;\r\n        else\r\n            s[7] ^= 0x1b;\r\n    }\r\n} // </editor-fold>\r\n\r\nfunction processMAC15(key, s, d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize,\r\n      sBox = this.sBox, c = byteArray(d),\r\n      r = new Uint8Array(n);\r\n    // R\r\n    this.process(key, r);\r\n    // K1\r\n    processKeyMAC15(r);\r\n    if (d.byteLength % n !== 0) {\r\n        c = bitPad.call(this, byteArray(d));\r\n        // K2\r\n        processKeyMAC15(r);\r\n    }\r\n\r\n    for (var i = 0, q = c.length / n; i < q; i++) {\r\n\r\n        for (var j = 0; j < n; j++)\r\n            s[j] ^= c[i * n + j];\r\n\r\n        if (i === q - 1) {// Last block\r\n            for (var j = 0; j < n; j++)\r\n                s[j] ^= r[j];\r\n        }\r\n\r\n        this.process(key, s);\r\n    }\r\n} // </editor-fold>\r\n\r\n/**\r\n * signMAC (K, D, IV) is the 32-bit result of the GOST 28147/GOST R 34.13 in\r\n * \"imitovstavka\" (MAC) mode, used with D as plaintext, K as key and IV\r\n * as initialization vector.  Note that the standard specifies its use\r\n * in this mode only with an initialization vector of zero.\r\n *\r\n * @memberOf GostCipher\r\n * @method sign\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv initial vector\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction signMAC(k, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var key = this.keySchedule(k),\r\n      s = new Uint8Array(iv || this.iv),\r\n      m = Math.ceil(this.macLength >> 3) || this.blockSize >> 1;\r\n\r\n    this.processMAC(key, s, d);\r\n\r\n    var mac = new Uint8Array(m); // mac size\r\n    mac.set(new Uint8Array(s.buffer, 0, m));\r\n    return mac.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * verifyMAC (K, M, D, IV) the 32-bit result verification of the GOST 28147/GOST R 34.13 in\r\n * \"imitovstavka\" (MAC) mode, used with D as plaintext, K as key and IV\r\n * as initialization vector.  Note that the standard specifies its use\r\n * in this mode only with an initialization vector of zero.\r\n *\r\n * @memberOf GostCipher\r\n * @method verify\r\n * @instance\r\n * @param {CryptoOperationData} k 8x32 bits key\r\n * @param {CryptoOperationData} m 8 bits array with signature\r\n * @param {CryptoOperationData} d 8 bits array with data\r\n * @param {CryptoOperationData} iv 8x8 optional bits initial vector\r\n * @return {boolen} MAC verified = true\r\n */\r\nfunction verifyMAC(k, m, d, iv) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var mac = new Uint8Array(signMAC.call(this, k, d, iv)),\r\n      test = byteArray(m);\r\n    if (mac.length !== test.length)\r\n        return false;\r\n    for (var i = 0, n = mac.length; i < n; i++)\r\n        if (mac[i] !== test[i])\r\n            return false;\r\n    return true;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-KW<br><br>\r\n *\r\n * This algorithm encrypts GOST 28147-89 CEK with a GOST 28147/GOST R 34.13 KEK.\r\n * Ref. rfc4357 6.1 GOST 28147-89 Key Wrap\r\n * Note: This algorithm MUST NOT be used with a KEK produced by VKO GOST\r\n * R 34.10-94, because such a KEK is constant for every sender-recipient\r\n * pair.  Encrypting many different content encryption keys on the same\r\n * constant KEK may reveal that KEK.\r\n *\r\n * @memberOf GostCipher\r\n * @method wrapKey\r\n * @instance\r\n * @param {CryptoOperationData} kek Key encryption key\r\n * @param {CryptoOperationData} cek Content encryption key\r\n * @returns {CryptoOperationData} Encrypted cek\r\n */\r\nfunction wrapKeyGOST(kek, cek) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize, k = this.keySize, len = k + (n >> 1);\r\n    // 1) For a unique symmetric KEK, generate 8 octets at random and call\r\n    // the result UKM.  For a KEK, produced by VKO GOST R 34.10-2001, use\r\n    // the UKM that was used for key derivation.\r\n    if (!this.ukm)\r\n        throw new DataError('UKM must be defined');\r\n    var ukm = new Uint8Array(this.ukm);\r\n    // 2) Compute a 4-byte checksum value, GOST 28147IMIT (UKM, KEK, CEK).\r\n    // Call the result CEK_MAC.\r\n    var mac = signMAC.call(this, kek, cek, ukm);\r\n    // 3) Encrypt the CEK in ECB mode using the KEK.  Call the ciphertext CEK_ENC.\r\n    var enc = encryptECB.call(this, kek, cek);\r\n    // 4) The wrapped content-encryption key is (UKM | CEK_ENC | CEK_MAC).\r\n    var r = new Uint8Array(len);\r\n    r.set(new Uint8Array(enc), 0);\r\n    r.set(new Uint8Array(mac), k);\r\n    return r.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-KW<br><br>\r\n *\r\n *  This algorithm decrypts GOST 28147-89 CEK with a GOST 28147 KEK.\r\n *  Ref. rfc4357 6.2 GOST 28147-89 Key Unwrap\r\n *\r\n * @memberOf GostCipher\r\n * @method unwrapKey\r\n * @instance\r\n * @param {type} kek Key encryption key\r\n * @param {type} data Content encryption key\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction unwrapKeyGOST(kek, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize, k = this.keySize, len = k + (n >> 1);\r\n    // 1) If the wrapped content-encryption key is not 44 octets, then error.\r\n    var d = buffer(data);\r\n    if (d.byteLength !== len)\r\n        throw new DataError('Wrapping key size must be ' + len + ' bytes');\r\n    // 2) Decompose the wrapped content-encryption key into UKM, CEK_ENC, and CEK_MAC.\r\n    // UKM is the most significant (first) 8 octets. CEK_ENC is next 32 octets,\r\n    // and CEK_MAC is the least significant (last) 4 octets.\r\n    if (!this.ukm)\r\n        throw new DataError('UKM must be defined');\r\n    var ukm = new Uint8Array(this.ukm),\r\n      enc = new Uint8Array(d, 0, k),\r\n      mac = new Uint8Array(d, k, n >> 1);\r\n    // 3) Decrypt CEK_ENC in ECB mode using the KEK.  Call the output CEK.\r\n    var cek = decryptECB.call(this, kek, enc);\r\n    // 4) Compute a 4-byte checksum value, GOST 28147IMIT (UKM, KEK, CEK),\r\n    // compare the result with CEK_MAC.  If they are not equal, then error.\r\n    var check = verifyMAC.call(this, kek, mac, cek, ukm);\r\n    if (!check)\r\n        throw new DataError('Error verify MAC of wrapping key');\r\n    return cek;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CPKW<br><br>\r\n *\r\n * Given a random 64-bit UKM and a GOST 28147 key K, this algorithm\r\n * creates a new GOST 28147-89 key K(UKM).\r\n * Ref. rfc4357 6.3 CryptoPro KEK Diversification Algorithm\r\n *\r\n * @memberOf GostCipher\r\n * @method diversify\r\n * @instance\r\n * @private\r\n * @param {CryptoOperationData} kek Key encryption key\r\n * @param {CryptoOperationData} ukm Random generated value\r\n * @returns {CryptoOperationData} Diversified kek\r\n */\r\nfunction diversifyKEK(kek, ukm) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize;\r\n\r\n    // 1) Let K[0] = K;\r\n    var k = intArray(kek);\r\n    // 2) UKM is split into components a[i,j]:\r\n    //    UKM = a[0]|..|a[7] (a[i] - byte, a[i,0]..a[i,7] - its bits)\r\n    var a = [];\r\n    for (var i = 0; i < n; i++) {\r\n        a[i] = [];\r\n        for (var j = 0; j < 8; j++) {\r\n            a[i][j] = (ukm[i] >>> j) & 0x1;\r\n        }\r\n    }\r\n    // 3) Let i be 0.\r\n    // 4) K[1]..K[8] are calculated by repeating the following algorithm\r\n    //    eight times:\r\n    for (var i = 0; i < n; i++) {\r\n        //     A) K[i] is split into components k[i,j]:\r\n        //        K[i] = k[i,0]|k[i,1]|..|k[i,7] (k[i,j] - 32-bit integer)\r\n        //     B) Vector S[i] is calculated:\r\n        //        S[i] = ((a[i,0]*k[i,0] + ... + a[i,7]*k[i,7]) mod 2^32) |\r\n        //         (((~a[i,0])*k[i,0] + ... + (~a[i,7])*k[i,7]) mod 2^32);\r\n        var s = new Int32Array(2);\r\n        for (var j = 0; j < 8; j++) {\r\n            if (a[i][j])\r\n                s[0] = (s[0] + k[j]) & 0xffffffff;\r\n            else\r\n                s[1] = (s[1] + k[j]) & 0xffffffff;\r\n        }\r\n        //     C) K[i+1] = encryptCFB (S[i], K[i], K[i])\r\n        var iv = new Uint8Array(s.buffer);\r\n        k = new Int32Array(encryptCFB.call(this, k, k, iv));\r\n        //     D) i = i + 1\r\n    }\r\n    // 5) Let K(UKM) be K[8].\r\n    return k;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CPKW<br><br>\r\n *\r\n * This algorithm encrypts GOST 28147-89 CEK with a GOST 28147 KEK.\r\n * It can be used with any KEK (e.g., produced by VKO GOST R 34.10-94 or\r\n * VKO GOST R 34.10-2001) because a unique UKM is used to diversify the KEK.\r\n * Ref. rfc4357 6.3  CryptoPro Key Wrap\r\n *\r\n * @memberOf GostCipher\r\n * @method wrapKey\r\n * @instance\r\n * @param {CryptoOperationData} kek Key encryption key\r\n * @param {CryptoOperationData} cek Content encryption key\r\n * @returns {CryptoOperationData} Encrypted cek\r\n */\r\nfunction wrapKeyCP(kek, cek) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize, k = this.keySize, len = k + (n >> 1);\r\n    // 1) For a unique symmetric KEK or a KEK produced by VKO GOST R\r\n    // 34.10-94, generate 8 octets at random.  Call the result UKM.  For\r\n    // a KEK, produced by VKO GOST R 34.10-2001, use the UKM that was\r\n    // used for key derivation.\r\n    if (!this.ukm)\r\n        throw new DataError('UKM must be defined');\r\n    var ukm = new Uint8Array(this.ukm);\r\n    // 2) Diversify KEK, using the CryptoPro KEK Diversification Algorithm,\r\n    // described in Section 6.5.  Call the result KEK(UKM).\r\n    var dek = diversifyKEK.call(this, kek, ukm);\r\n    // 3) Compute a 4-byte checksum value, GOST 28147IMIT (UKM, KEK(UKM),\r\n    // CEK).  Call the result CEK_MAC.\r\n    var mac = signMAC.call(this, dek, cek, ukm);\r\n    // 4) Encrypt CEK in ECB mode using KEK(UKM).  Call the ciphertext\r\n    // CEK_ENC.\r\n    var enc = encryptECB.call(this, dek, cek);\r\n    // 5) The wrapped content-encryption key is (UKM | CEK_ENC | CEK_MAC).\r\n    var r = new Uint8Array(len);\r\n    r.set(new Uint8Array(enc), 0);\r\n    r.set(new Uint8Array(mac), k);\r\n    return r.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CPKW<br><br>\r\n *\r\n * This algorithm encrypts GOST 28147-89 CEK with a GOST 28147 KEK.\r\n * Ref. rfc4357 6.4 CryptoPro Key Unwrap\r\n *\r\n * @memberOf GostCipher\r\n * @method unwrapKey\r\n * @instance\r\n * @param {CryptoOperationData} kek Key encryption key\r\n * @param {CryptoOperationData} data Encrypted content encryption keu\r\n * @return {CryptoOperationData} result Decrypted content encryption keu\r\n */\r\nfunction unwrapKeyCP(kek, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = this.blockSize, k = this.keySize, len = k + (n >> 1);\r\n    // 1) If the wrapped content-encryption key is not 44 octets, then error.\r\n    var d = buffer(data);\r\n    if (d.byteLength !== len)\r\n        throw new DataError('Wrapping key size must be ' + len + ' bytes');\r\n    // 2) Decompose the wrapped content-encryption key into UKM, CEK_ENC,\r\n    // and CEK_MAC.  UKM is the most significant (first) 8 octets.\r\n    // CEK_ENC is next 32 octets, and CEK_MAC is the least significant\r\n    // (last) 4 octets.\r\n    if (!this.ukm)\r\n        throw new DataError('UKM must be defined');\r\n    var ukm = new Uint8Array(this.ukm),\r\n      enc = new Uint8Array(d, 0, k),\r\n      mac = new Uint8Array(d, k, n >> 1);\r\n    // 3) Diversify KEK using the CryptoPro KEK Diversification Algorithm,\r\n    // described in section 6.5.  Call the result KEK(UKM).\r\n    var dek = diversifyKEK.call(this, kek, ukm);\r\n    // 4) Decrypt CEK_ENC in ECB mode using KEK(UKM).  Call the output CEK.\r\n    var cek = decryptECB.call(this, dek, enc);\r\n    // 5) Compute a 4-byte checksum value, GOST 28147IMIT (UKM, KEK(UKM),\r\n    // CEK), compare the result with CEK_MAC.  If they are not equal,\r\n    // then it is an error.\r\n    var check = verifyMAC.call(this, dek, mac, cek, ukm);\r\n    if (!check)\r\n        throw new DataError('Error verify MAC of wrapping key');\r\n    return cek;\r\n} // </editor-fold>\r\n\r\n/**\r\n * SignalCom master key packing algorithm\r\n *\r\n * kek stored in 3 files - kek.opq, mk.db3, masks.db3\r\n * kek.opq - always 36 bytes length = 32 bytes encrypted kek + 4 bytes mac of decrypted kek\r\n * mk.db3 - 6 bytes header (1 byte magic code 0x22 + 1 byte count of masks + 4 bytes mac of\r\n * xor summarizing masks value) + attached masks\r\n * masks.db3 - detached masks.\r\n * Total length  of attached + detached masks = 32 bits * count of masks\r\n * Default value of count 8 = (7 attached + 1 detached). But really no reason for such\r\n * separation - all masks xor summarizing - order is not matter.\r\n * Content of file rand.opq can used as ukm. Don't forget change file content after using.\r\n *\r\n * For usb-token files has names:\r\n * a001 - mk.db3, b001 - masks.db3, c001 - kek.opq, d001 - rand.opq\r\n * For windows registry\r\n * 00000001 - mk.db3, 00000002 - masks.db3, 00000003 - key.opq, 00000004 - rand.opq,\r\n * 00000006 - keys\\00000001.key, 0000000A - certificate\r\n *\r\n * @memberOf GostCipher\r\n * @method packKey\r\n * @instance\r\n * @private\r\n * @param {CryptoOperationData} unpacked - clear main key 32 bytes\r\n * @param {CryptoOperationData} ukm - random vector for packing - 32 bytes * (count of masks - 1)\r\n * @returns {CryptoOperationData} packed master key - concatination of mk.db3 + masks.db3\r\n */\r\nfunction packKeySC(unpacked, ukm) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = this.blockSize >> 1, k = this.keySize;\r\n    var mcount = 8;\r\n    var key = new Uint8Array(buffer(unpacked));\r\n    if (key.byteLength !== k)\r\n        throw new DataError('Wrong cleartext size ' + key.byteLength + ' bytes');\r\n    // Check or generate UKM\r\n    ukm = ukm || this.ukm;\r\n    if (ukm) {\r\n        ukm = new Uint8Array(buffer(ukm));\r\n        if (ukm.byteLength > 0 && ukm.byteLength % k === 0)\r\n            mcount = ukm.byteLength / k + 1;\r\n        else\r\n            throw new DataError('Wrong rand size ' + ukm.byteLength + ' bytes');\r\n    } else\r\n        randomSeed(ukm = new Uint8Array((mcount - 1) * k));\r\n    // Output array\r\n    var d = new Uint8Array(mcount * k + m + 2), b = d.buffer;\r\n    // Calculate MAC\r\n    var zero32 = new Uint8Array(k);\r\n    var mac = signMAC.call(this, key, zero32);\r\n    d[0] = 0x22; // Magic code\r\n    d[1] = mcount; // Count of masks\r\n    d.set(new Uint8Array(mac), 2);\r\n    d.set(ukm, k + m + 2);\r\n    for (var i = 1; i < mcount; i++) {\r\n        var mask = new Uint8Array(b, 2 + m + k * i);\r\n        for (var j = 0; j < k; j++)\r\n            key[j] ^= mask[j];\r\n    }\r\n    d.set(key, m + 2);\r\n    return d.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-SCKW<br><br>\r\n *\r\n * SignalCom master key unpacking algorithm\r\n *\r\n * @memberOf GostCipher\r\n * @method unpackKey\r\n * @instance\r\n * @private\r\n * @param {CryptoOperationData} packed - concatination of mk.db3 + masks.db3\r\n * @returns {CryptoOperationData} unpacked master key\r\n */\r\nfunction unpackKeySC(packed) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = this.blockSize >> 1, k = this.keySize;\r\n    var b = buffer(packed);\r\n    // Unpack master key\r\n    var magic = new Uint8Array(b, 0, 1)[0];\r\n    if (magic !== 0x22)\r\n        throw new DataError('Invalid magic number');\r\n    var mcount = new Uint8Array(b, 1, 1)[0];\r\n    var mac = new Uint8Array(b, 2, m); // MAC for summarized mask\r\n    // Compute packKey xor summing for all masks\r\n    var key = new Uint8Array(k);\r\n    for (var i = 0; i < mcount; i++) {\r\n        var mask = new Uint8Array(b, 2 + m + k * i, k);\r\n        for (var j = 0; j < k; j++)\r\n            key[j] ^= mask[j];\r\n    }\r\n    // Test MAC for packKey with default sBox on zero 32 bytes array\r\n    var zero32 = new Uint8Array(k);\r\n    var test = verifyMAC.call(this, key, mac, zero32);\r\n    if (!test) {\r\n        // Try to use different sBoxes\r\n        var names = ['E-A', 'E-B', 'E-C', 'E-D', 'E-SC'];\r\n        for (var i = 0, n = names.length; i < n; i++) {\r\n            this.sBox = sBoxes[names[i]];\r\n            test = verifyMAC.call(this, key, mac, zero32);\r\n            if (test)\r\n                break;\r\n        }\r\n    }\r\n    if (!test)\r\n        throw new DataError('Invalid main key MAC');\r\n    return key.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-SCKW<br><br>\r\n *\r\n * SignalCom Key Wrapping algorithm\r\n *\r\n * @memberOf GostCipher\r\n * @method wrapKey\r\n * @instance\r\n * @param {CryptoOperationData} kek - clear kek or concatination of mk.db3 + masks.db3\r\n * @param {CryptoOperationData} cek - key for wrapping\r\n * @returns {CryptoOperationData} wrapped key - file kek.opq\r\n */\r\nfunction wrapKeySC(kek, cek) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = this.blockSize >> 1, n = this.keySize;\r\n    var k = buffer(kek);\r\n    var c = buffer(cek);\r\n    if (k.byteLength !== n)\r\n        k = unpackKeySC.call(this, k);\r\n    var enc = encryptECB.call(this, k, c);\r\n    var mac = signMAC.call(this, k, c);\r\n    var d = new Uint8Array(m + n);\r\n    d.set(new Uint8Array(enc), 0);\r\n    d.set(new Uint8Array(mac), n);\r\n    return d.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-SCKW<br><br>\r\n *\r\n * SignalCom Key UnWrapping algorithm\r\n *\r\n * @memberOf GostCipher\r\n * @method unwrapKey\r\n * @instance\r\n * @param {CryptoOperationData} kek - concatination of files mk.db3 + masks.db3 or clear kek\r\n * @param {CryptoOperationData} cek - wrapping key - file kek.opq\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction unwrapKeySC(kek, cek) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = this.blockSize >> 1, n = this.keySize;\r\n    var k = buffer(kek);\r\n    var c = buffer(cek);\r\n    if (k.byteLength !== n)\r\n        k = unpackKeySC.call(this, k);\r\n    var enc = new Uint8Array(c, 0, n); // Encrypted kek\r\n    var mac = new Uint8Array(c, n, m); // MAC for clear kek\r\n    var d = decryptECB.call(this, k, enc);\r\n    if (!verifyMAC.call(this, k, mac, d))\r\n        throw new DataError('Invalid key MAC');\r\n    return d;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-SCKW<br><br>\r\n *\r\n * SignalCom master key generation for wrapping\r\n *\r\n * @memberOf GostCipher\r\n * @method generateKey\r\n * @instance\r\n * @return {CryptoOperationData} result\r\n */\r\nfunction generateWrappingKeySC() // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return packKeySC.call(this, generateKey.call(this));\r\n} // </editor-fold>\r\n\r\nfunction maskKey(mask, key, inverse, keySize) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var k = keySize / 4,\r\n      m32 = new Int32Array(buffer(mask)),\r\n      k32 = new Int32Array(buffer(key)),\r\n      r32 = new Int32Array(k);\r\n    if (inverse)\r\n        for (var i = 0; i < k; i++)\r\n            r32[i] = (k32[i] + m32[i]) & 0xffffffff;\r\n    else\r\n        for (var i = 0; i < k; i++)\r\n            r32[i] = (k32[i] - m32[i]) & 0xffffffff;\r\n    return r32.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-MASK<br><br>\r\n *\r\n * This algorithm wrap key mask\r\n *\r\n * @memberOf GostCipher\r\n * @method wrapKey\r\n * @instance\r\n * @param {CryptoOperationData} mask The mask\r\n * @param {CryptoOperationData} key The key\r\n * @returns {CryptoOperationData} The masked key\r\n */\r\nfunction wrapKeyMask(mask, key) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return maskKey(mask, key, this.procreator === 'VN', this.keySize);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CPKW<br><br>\r\n *\r\n * This algorithm unwrap key mask\r\n *\r\n * @memberOf GostCipher\r\n * @method unwrapKey\r\n * @instance\r\n * @param {CryptoOperationData} mask The mask\r\n * @param {CryptoOperationData} key The masked key\r\n * @return {CryptoOperationData} result The key\r\n */\r\nfunction unwrapKeyMask(mask, key) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return maskKey(mask, key, this.procreator !== 'VN', this.keySize);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-CPKM<br><br>\r\n *\r\n * Key meshing in according to rfc4357 2.3.2. CryptoPro Key Meshing\r\n *\r\n * @memberOf GostCipher\r\n * @method keyMeshing\r\n * @instance\r\n * @private\r\n * @param {(Uint8Array|CryptoOperationData)} k 8x8 bit key\r\n * @param {Uint8Array} s 8x8 bit sync (iv)\r\n * @param {Integer} i block index\r\n * @param {Int32Array} key 8x32 bit key schedule\r\n * @param {boolean} e true - decrypt\r\n * @returns CryptoOperationData next 8x8 bit key\r\n */\r\nfunction keyMeshingCP(k, s, i, key, e) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if ((i + 1) * this.blockSize % 1024 === 0) { // every 1024 octets\r\n        // K[i+1] = decryptECB (K[i], C);\r\n        k = decryptECB.call(this, k, C);\r\n        // IV0[i+1] = encryptECB (K[i+1],IVn[i])\r\n        s.set(new Uint8Array(encryptECB.call(this, k, s)));\r\n        // restore key schedule\r\n        key.set(this.keySchedule(k, e));\r\n    }\r\n    return k;\r\n} // </editor-fold>\r\n\r\n/**\r\n *  Null Key Meshing in according to rfc4357 2.3.1\r\n *\r\n * @memberOf GostCipher\r\n * @method keyMeshing\r\n * @instance\r\n * @private\r\n * @param {(Uint8Array|CryptoOperationData)} k 8x8 bit key\r\n */\r\nfunction noKeyMeshing(k) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return k;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-NoPadding<br><br>\r\n *\r\n * No padding.\r\n *\r\n * @memberOf GostCipher\r\n * @method padding\r\n * @instance\r\n * @private\r\n * @param {Uint8Array} d array with source data\r\n * @returns {Uint8Array} result\r\n */\r\nfunction noPad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    return new Uint8Array(d);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-PKCS5Padding<br><br>\r\n *\r\n *  PKCS#5 padding: 8-x remaining bytes are filled with the value of\r\n *  8-x.  If theres no incomplete block, one extra block filled with\r\n *  value 8 is added\r\n *\r\n * @memberOf GostCipher\r\n * @method padding\r\n * @instance\r\n * @private\r\n * @param {Uint8Array} d array with source data\r\n * @returns {Uint8Array} result\r\n */\r\nfunction pkcs5Pad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = d.byteLength,\r\n      nb = this.blockSize,\r\n      q = nb - n % nb,\r\n      m = Math.ceil((n + 1) / nb) * nb,\r\n      r = new Uint8Array(m);\r\n    r.set(d);\r\n    for (var i = n; i < m; i++)\r\n        r[i] = q;\r\n    return r;\r\n} // </editor-fold>\r\n\r\nfunction pkcs5Unpad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = d.byteLength,\r\n      nb = this.blockSize,\r\n      q = d[m - 1],\r\n      n = m - q;\r\n    if (q > nb)\r\n        throw DataError('Invalid padding');\r\n    var r = new Uint8Array(n);\r\n    if (n > 0)\r\n        r.set(new Uint8Array(d.buffer, 0, n));\r\n    return r;\r\n} // </editor-fold>\r\n\r\n\r\n/**\r\n * Algorithm name GOST 28147-ZeroPadding<br><br>\r\n *\r\n * Zero padding: 8-x remaining bytes are filled with zero\r\n *\r\n * @memberOf GostCipher\r\n * @method padding\r\n * @instance\r\n * @private\r\n * @param {Uint8Array} d array with source data\r\n * @returns {Uint8Array} result\r\n */\r\nfunction zeroPad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = d.byteLength,\r\n      nb = this.blockSize,\r\n      m = Math.ceil(n / nb) * nb,\r\n      r = new Uint8Array(m);\r\n    r.set(d);\r\n    for (var i = n; i < m; i++)\r\n        r[i] = 0;\r\n    return r;\r\n} // </editor-fold>\r\n\r\n\r\n/**\r\n * Algorithm name GOST 28147-BitPadding<br><br>\r\n *\r\n * Bit padding: P* = P || 1 || 000...0 If theres no incomplete block,\r\n * one extra block filled with 1 || 000...0\r\n *\r\n * @memberOf GostCipher\r\n * @method padding\r\n * @instance\r\n * @private\r\n * @param {Uint8Array} d array with source data\r\n * @returns {Uint8Array} result\r\n */\r\nfunction bitPad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = d.byteLength,\r\n      nb = this.blockSize,\r\n      m = Math.ceil((n + 1) / nb) * nb,\r\n      r = new Uint8Array(m);\r\n    r.set(d);\r\n    r[n] = 1;\r\n    for (var i = n + 1; i < m; i++)\r\n        r[i] = 0;\r\n    return r;\r\n} // </editor-fold>\r\n\r\nfunction bitUnpad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var m = d.byteLength,\r\n      n = m;\r\n    while (n > 1 && d[n - 1] === 0)\r\n        n--;\r\n    if (d[n - 1] !== 1)\r\n        throw DataError('Invalid padding');\r\n    n--;\r\n    var r = new Uint8Array(n);\r\n    if (n > 0)\r\n        r.set(new Uint8Array(d.buffer, 0, n));\r\n    return r;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST 28147-RandomPadding<br><br>\r\n *\r\n * Random padding: 8-x remaining bytes of the last block are set to\r\n * random.\r\n *\r\n * @memberOf GostCipher\r\n * @method padding\r\n * @instance\r\n * @private\r\n * @param {Uint8Array} d array with source data\r\n * @returns {Uint8Array} result\r\n */\r\nfunction randomPad(d) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var n = d.byteLength,\r\n      nb = this.blockSize,\r\n      q = nb - n % nb,\r\n      m = Math.ceil(n / nb) * nb,\r\n      r = new Uint8Array(m), e = new Uint8Array(r.buffer, n, q);\r\n    r.set(d);\r\n    randomSeed(e);\r\n    return r;\r\n} // </editor-fold>\r\n\r\n/**\r\n * GOST 28147-89 Encryption Algorithm<br><br>\r\n *\r\n * References {@link http://tools.ietf.org/html/rfc5830}<br><br>\r\n *\r\n * When keys and initialization vectors are converted to/from byte arrays,\r\n * little-endian byte order is assumed.<br><br>\r\n *\r\n * Normalized algorithm identifier common parameters:\r\n *\r\n *  <ul>\r\n *      <li><b>name</b> Algorithm name 'GOST 28147' or 'GOST R 34.12'</li>\r\n *      <li><b>version</b> Algorithm version, number\r\n *          <ul>\r\n *              <li><b>1989</b> Current version of standard</li>\r\n *              <li><b>2015</b> New draft version of standard</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>length</b> Block length\r\n *          <ul>\r\n *              <li><b>64</b> 64 bits length (default)</li>\r\n *              <li><b>128</b> 128 bits length (only for version 2015)</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>mode</b> Algorithm mode, string\r\n *          <ul>\r\n *              <li><b>ES</b> Encryption mode (default)</li>\r\n *              <li><b>MAC</b> \"imitovstavka\" (MAC) mode</li>\r\n *              <li><b>KW</b> Key wrapping mode</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>sBox</b> Paramset sBox for GOST 28147-89, string. Used only if version = 1989</li>\r\n *  </ul>\r\n *\r\n * Supported algorithms, modes and parameters:\r\n *\r\n *  <ul>\r\n *      <li>Encript/Decrypt mode (ES)\r\n *          <ul>\r\n *              <li><b>block</b> Block mode, string. Default ECB</li>\r\n *              <li><b>keyMeshing</b> Key meshing mode, string. Default NO</li>\r\n *              <li><b>padding</b> Padding mode, string. Default NO for CFB and CTR modes, or ZERO for others</li>\r\n *              <li><b>iv</b> {@link CryptoOperationData} Initial vector with length of block. Default - zero block</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>Sign/Verify mode (MAC)\r\n *          <ul>\r\n *              <li><b>macLength</b> Length of mac in bits (default - 32 bits)</li>\r\n *              <li><b>iv</b> {@link CryptoOperationData} Initial vector with length of block. Default - zero block</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>Wrap/Unwrap key mode (KW)\r\n *          <ul>\r\n *              <li><b>keyWrapping</b> Mode of keywrapping, string. Default NO - standard GOST key wrapping</li>\r\n *              <li><b>ukm</b> {@link CryptoOperationData} User key material. Default - random generated value</li>\r\n *          </ul>\r\n *      </li>\r\n *  </ul>\r\n *\r\n * Supported paramters values:\r\n *\r\n *  <ul>\r\n *      <li>Block modes (parameter 'block')\r\n *          <ul>\r\n *              <li><b>ECB</b> \"prostaya zamena\" (ECB) mode (default)</li>\r\n *              <li><b>CFB</b> \"gammirovanie s obratnoj svyaziyu po shifrotekstu\" (CFB) mode</li>\r\n *              <li><b>OFB</b> \"gammirovanie s obratnoj svyaziyu po vyhodu\" (OFB) mode</li>\r\n *              <li><b>CTR</b> \"gammirovanie\" (counter) mode</li>\r\n *              <li><b>CBC</b> Cipher-Block-Chaining (CBC) mode</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>Key meshing modes (parameter 'keyMeshing')\r\n *          <ul>\r\n *              <li><b>NO</b> No key wrapping (default)</li>\r\n *              <li><b>CP</b> CryptoPor Key key meshing</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>Padding modes (parameter 'padding')\r\n *          <ul>\r\n *              <li><b>NO</b> No padding only for CFB, OFB and CTR modes</li>\r\n *              <li><b>PKCS5</b> PKCS#5 padding mode</li>\r\n *              <li><b>ZERO</b> Zero bits padding mode</li>\r\n *              <li><b>RANDOM</b> Random bits padding mode</li>\r\n *              <li><b>BIT</b> One bit padding mode</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>Wrapping key modes (parameter 'keyWrapping')\r\n *          <ul>\r\n *              <li><b>NO</b> Ref. rfc4357 6.1 GOST 28147-89 Key wrapping</li>\r\n *              <li><b>CP</b> CryptoPro Key wrapping mode</li>\r\n *              <li><b>SC</b> SignalCom Key wrapping mode</li>\r\n *          </ul>\r\n *      </li>\r\n *  </ul>\r\n *\r\n * @class GostCipher\r\n * @param {AlgorithmIndentifier} algorithm WebCryptoAPI algorithm identifier\r\n */\r\nexport function GostCipher(algorithm) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    // Check little endian support\r\n    if (!littleEndian)\r\n        throw new NotSupportedError('Big endian platform not supported');\r\n    algorithm = algorithm || {};\r\n    this.keySize = 32;\r\n    this.blockLength = algorithm.length || 64;\r\n    this.blockSize = this.blockLength >> 3;\r\n\r\n    this.name = (algorithm.name || (algorithm.version === 1 ? 'RC2' :\r\n      algorithm.version === 1989 ? 'GOST 28147' : 'GOST R 34.12')) +\r\n      (algorithm.version > 4 ? '-' + ((algorithm.version || 1989) % 100) : '') + '-' +\r\n      (this.blockLength === 64 ? '' : this.blockLength + '-') +\r\n      ((algorithm.mode === 'MAC') ? 'MAC-' + (algorithm.macLength || this.blockLength >> 1) :\r\n        (algorithm.mode === 'KW' || algorithm.keyWrapping) ?\r\n          ((algorithm.keyWrapping || 'NO') !== 'NO' ? algorithm.keyWrapping : '') + 'KW' :\r\n          (algorithm.block || 'ECB') + ((algorithm.block === 'CFB' || algorithm.block === 'OFB' ||\r\n          (algorithm.block === 'CTR' && algorithm.version === 2015)) &&\r\n          algorithm.shiftBits && algorithm.shiftBits !== this.blockLength ? '-' + algorithm.shiftBits : '') +\r\n          (algorithm.padding ? '-' + (algorithm.padding || (algorithm.block === 'CTR' ||\r\n          algorithm.block === 'CFB' || algorithm.block === 'OFB' ? 'NO' : 'ZERO')) + 'PADDING' : '') +\r\n          ((algorithm.keyMeshing || 'NO') !== 'NO' ? '-CPKEYMESHING' : '')) +\r\n      (algorithm.procreator ? '/' + algorithm.procreator : '') +\r\n      (typeof algorithm.sBox === 'string' ? '/' + algorithm.sBox : '');\r\n\r\n    // Algorithm procreator\r\n    this.procreator = algorithm.procreator;\r\n\r\n    switch (algorithm.version || 1989) {\r\n        case 1:\r\n            this.process = processRC2;\r\n            this.keySchedule = keyScheduleRC2;\r\n            this.blockLength = 64;\r\n            this.effectiveLength = algorithm.length || 32;\r\n            this.keySize = 8 * Math.ceil(this.effectiveLength / 8); // Max 128\r\n            this.blockSize = this.blockLength >> 3;\r\n            break;\r\n        case 2015:\r\n            this.version = 2015;\r\n            if (this.blockLength === 64) {\r\n                this.process = process15;\r\n                this.keySchedule = keySchedule15;\r\n            } else if (this.blockLength === 128) {\r\n                this.process = process128;\r\n                this.keySchedule = keySchedule128;\r\n            } else\r\n                throw new DataError('Invalid block length');\r\n            this.processMAC = processMAC15;\r\n            break;\r\n        case 1989:\r\n            this.version = 1989;\r\n            this.process = process89;\r\n            this.processMAC = processMAC89;\r\n            this.keySchedule = keySchedule89;\r\n            if (this.blockLength !== 64)\r\n                throw new DataError('Invalid block length');\r\n            break;\r\n        default:\r\n            throw new NotSupportedError('Algorithm version ' + algorithm.version + ' not supported');\r\n    }\r\n\r\n    switch (algorithm.mode || (algorithm.keyWrapping && 'KW') || 'ES') {\r\n\r\n        case 'ES':\r\n            switch (algorithm.block || 'ECB') {\r\n                case 'ECB':\r\n                    this.encrypt = encryptECB;\r\n                    this.decrypt = decryptECB;\r\n                    break;\r\n                case 'CTR':\r\n                    if (this.version === 1989) {\r\n                        this.encrypt = processCTR89;\r\n                        this.decrypt = processCTR89;\r\n                    } else {\r\n                        this.encrypt = processCTR15;\r\n                        this.decrypt = processCTR15;\r\n                        this.shiftBits = algorithm.shiftBits || this.blockLength;\r\n                    }\r\n                    break;\r\n                case 'CBC':\r\n                    this.encrypt = encryptCBC;\r\n                    this.decrypt = decryptCBC;\r\n                    break;\r\n                case 'CFB':\r\n                    this.encrypt = encryptCFB;\r\n                    this.decrypt = decryptCFB;\r\n                    this.shiftBits = algorithm.shiftBits || this.blockLength;\r\n                    break;\r\n                case 'OFB':\r\n                    this.encrypt = processOFB;\r\n                    this.decrypt = processOFB;\r\n                    this.shiftBits = algorithm.shiftBits || this.blockLength;\r\n                    break;\r\n                default:\r\n                    throw new NotSupportedError('Block mode ' + algorithm.block + ' not supported');\r\n            }\r\n            switch (algorithm.keyMeshing) {\r\n                case 'CP':\r\n                    this.keyMeshing = keyMeshingCP;\r\n                    break;\r\n                default:\r\n                    this.keyMeshing = noKeyMeshing;\r\n            }\r\n            if (this.encrypt === encryptECB || this.encrypt === encryptCBC) {\r\n                switch (algorithm.padding) {\r\n                    case 'PKCS5P':\r\n                        this.pad = pkcs5Pad;\r\n                        this.unpad = pkcs5Unpad;\r\n                        break;\r\n                    case 'RANDOM':\r\n                        this.pad = randomPad;\r\n                        this.unpad = noPad;\r\n                        break;\r\n                    case 'BIT':\r\n                        this.pad = bitPad;\r\n                        this.unpad = bitUnpad;\r\n                        break;\r\n                    default:\r\n                        this.pad = zeroPad;\r\n                        this.unpad = noPad;\r\n                }\r\n            } else {\r\n                this.pad = noPad;\r\n                this.unpad = noPad;\r\n            }\r\n            this.generateKey = generateKey;\r\n            break;\r\n        case 'MAC':\r\n            this.sign = signMAC;\r\n            this.verify = verifyMAC;\r\n            this.generateKey = generateKey;\r\n            this.macLength = algorithm.macLength || (this.blockLength >> 1);\r\n            this.pad = noPad;\r\n            this.unpad = noPad;\r\n            this.keyMeshing = noKeyMeshing;\r\n            break;\r\n        case 'KW':\r\n            this.pad = noPad;\r\n            this.unpad = noPad;\r\n            this.keyMeshing = noKeyMeshing;\r\n            switch (algorithm.keyWrapping) {\r\n                case 'CP':\r\n                    this.wrapKey = wrapKeyCP;\r\n                    this.unwrapKey = unwrapKeyCP;\r\n                    this.generateKey = generateKey;\r\n                    this.shiftBits = algorithm.shiftBits || this.blockLength;\r\n                    break;\r\n                case 'SC':\r\n                    this.wrapKey = wrapKeySC;\r\n                    this.unwrapKey = unwrapKeySC;\r\n                    this.generateKey = generateWrappingKeySC;\r\n                    break;\r\n                default:\r\n                    this.wrapKey = wrapKeyGOST;\r\n                    this.unwrapKey = unwrapKeyGOST;\r\n                    this.generateKey = generateKey;\r\n            }\r\n            break;\r\n        case 'MASK':\r\n            this.wrapKey = wrapKeyMask;\r\n            this.unwrapKey = unwrapKeyMask;\r\n            this.generateKey = generateKey;\r\n            break;\r\n        default:\r\n            throw new NotSupportedError('Mode ' + algorithm.mode + ' not supported');\r\n    }\r\n\r\n    // Define sBox parameter\r\n    var sBox = algorithm.sBox, sBoxName;\r\n    if (!sBox)\r\n        sBox = this.version === 2015 ? sBoxes['E-Z'] : this.procreator === 'SC' ? sBoxes['E-SC'] : sBoxes['E-A'];\r\n    else if (typeof sBox === 'string') {\r\n        sBoxName = sBox.toUpperCase();\r\n        sBox = sBoxes[sBoxName];\r\n        if (!sBox)\r\n            throw new SyntaxError('Unknown sBox name: ' + algorithm.sBox);\r\n    } else if (!sBox.length || sBox.length !== sBoxes['E-Z'].length)\r\n        throw new SyntaxError('Length of sBox must be ' + sBoxes['E-Z'].length);\r\n    this.sBox = sBox;\r\n    // Initial vector\r\n    if (algorithm.iv) {\r\n        this.iv = new Uint8Array(algorithm.iv);\r\n        if (this.iv.byteLength !== this.blockSize && this.version === 1989)\r\n            throw new SyntaxError('Length of iv must be ' + this.blockLength + ' bits');\r\n        else if (this.iv.byteLength !== this.blockSize >> 1 && this.encrypt === processCTR15)\r\n            throw new SyntaxError('Length of iv must be ' + this.blockLength >> 1 + ' bits');\r\n        else if (this.iv.byteLength % this.blockSize !== 0 && this.encrypt !== processCTR15)\r\n            throw new SyntaxError('Length of iv must be a multiple of ' + this.blockLength + ' bits');\r\n    } else\r\n        this.iv = this.blockLength === 128 ? defaultIV128 : defaultIV;\r\n    // User key material\r\n    if (algorithm.ukm) {\r\n        this.ukm = new Uint8Array(algorithm.ukm);\r\n        if (this.ukm.byteLength * 8 !== this.blockLength)\r\n            throw new SyntaxError('Length of ukm must be ' + this.blockLength + ' bits');\r\n    }\r\n} // </editor-fold>\r\n","export function getRoot() {\r\n    return isInNode() ? global : self;\r\n}\r\n\r\nexport function getCryptoModule() {\r\n    const root = getRoot();\r\n    if (getRoot().hasOwnProperty('crypto')) {\r\n        return root.crypto;\r\n    } else if (root.hasOwnProperty('msCrypto')) {\r\n        return root.msCrypto;\r\n    } else if (isInNode()) {\r\n        return require('crypto');\r\n    }\r\n\r\n    throw new Error('Your environment does not have rypto module');\r\n}\r\n\r\nexport function isInNode() {\r\n    return typeof exports === 'object' && typeof module !== 'undefined';\r\n}\r\n\r\nexport function isBrowser() {\r\n    return typeof window !== 'undefined';\r\n}\r\n\r\nexport function isInWebWorker() {\r\n    return typeof importScripts !== 'undefined';\r\n}\r\n","/**\r\n * @file Implementation Web Crypto random generatore for GOST algorithms\r\n * @version 1.76\r\n * @copyright 2014-2016, Rudolf Nickolaev. All rights reserved.\r\n */\r\n\r\nimport { isBrowser, getCryptoModule } from './utils/environment';\r\n\r\n// Initialize mouse and time counters for random generator\r\nconst randomRing = {\r\n    seed: new Uint8Array(1024),\r\n    getIndex: 0,\r\n    setIndex: 0,\r\n    set: function (x) {\r\n        if (this.setIndex >= 1024)\r\n            this.setIndex = 0;\r\n        this.seed[this.setIndex++] = x;\r\n    },\r\n    get: function () {\r\n        if (this.getIndex >= 1024)\r\n            this.getIndex = 0;\r\n        return this.seed[this.getIndex++];\r\n    }\r\n};\r\n\r\nif (isBrowser()) {\r\n    try {\r\n        // Mouse move event to fill random array\r\n        document.addEventListener('mousemove', function (e) {\r\n            randomRing.set((new Date().getTime() & 255) ^\r\n              ((e.clientX || e.pageX) & 255) ^\r\n              ((e.clientY || e.pageY) & 255));\r\n        }, false);\r\n    } catch (e) {\r\n    }\r\n\r\n    try {\r\n        // Keypress event to fill random array\r\n        document.addEventListener('keydown', function (e) {\r\n            randomRing.set((new Date().getTime() & 255) ^\r\n              (e.keyCode & 255));\r\n        }, false);\r\n    } catch (e) {\r\n    }\r\n} // </editor-fold>\r\n\r\nclass TypeMismatchError extends Error {\r\n}\r\n\r\nclass QuotaExceededError extends Error {\r\n}\r\n\r\n/**\r\n * The gostCrypto provide general purpose cryptographic functionality for\r\n * GOST standards including a cryptographically strong pseudo-random number\r\n * generator seeded with truly random values.\r\n *\r\n * @Class GostRandom\r\n *\r\n */\r\nexport function GostRandom() {\r\n}\r\n\r\n/**\r\n * The getRandomValues method generates cryptographically random values. <br><br>\r\n *\r\n * Random generator based on JavaScript Web Crypto random genereator\r\n * (if it is possible) or  Math.random mixed with time and parameters of\r\n * mouse and keyboard events\r\n *\r\n * @memberOf GostRandom\r\n * @param {(ArrayBuffer|ArrayBufferView)} array Destination buffer for random data\r\n */\r\n\r\nconst rootCryptoModule = getCryptoModule();\r\n\r\nGostRandom.prototype.getRandomValues = function (array) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if (!array.byteLength)\r\n        throw new TypeMismatchError('Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)');\r\n\r\n    if (array.byteLength > 65536)\r\n        throw new QuotaExceededError('Byte length of array can\\'t be greate then 65536');\r\n\r\n    var u8 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\r\n    if (rootCryptoModule && rootCryptoModule.getRandomValues) {\r\n        // Native window cryptographic interface\r\n        rootCryptoModule.getRandomValues(u8);\r\n    } else {\r\n        // Standard Javascript method\r\n        for (var i = 0, n = u8.length; i < n; i++)\r\n            u8[i] = Math.floor(256 * Math.random()) & 255;\r\n    }\r\n\r\n    // Mix bio randomizator\r\n    for (var i = 0, n = u8.length; i < n; i++)\r\n        u8[i] = u8[i] ^ randomRing.get();\r\n    return array;\r\n}; // </editor-fold>\r\n","/**\r\n * @file GOST 34.10-2012 signature function with 1024/512 bits digest\r\n * @version 1.76\r\n * @copyright 2014-2016, Rudolf Nickolaev. All rights reserved.\r\n */\r\n\r\nimport { GostDigest } from './gostDigest';\r\nimport { DataError, NotSupportedError } from '../utils/errors';\r\nimport { getSeed } from '../utils/seeds';\r\n\r\n/*\r\n * Predefined curves and params collection\r\n *\r\n * http://tools.ietf.org/html/rfc5832\r\n * http://tools.ietf.org/html/rfc7091\r\n * http://tools.ietf.org/html/rfc4357\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\nvar CryptoOperationData = ArrayBuffer;\r\n\r\n// Predefined named curve collection\r\nvar ECGostParams = {\r\n    'S-256-TEST': {\r\n        a: 7,\r\n        b: '0x5FBFF498AA938CE739B8E022FBAFEF40563F6E6A3472FC2A514C0CE9DAE23B7E',\r\n        p: '0x8000000000000000000000000000000000000000000000000000000000000431',\r\n        q: '0x8000000000000000000000000000000150FE8A1892976154C59CFC193ACCF5B3',\r\n        x: 2,\r\n        y: '0x8E2A8A0E65147D4BD6316030E16D19C85C97F0A9CA267122B96ABBCEA7E8FC8'\r\n    },\r\n    'S-256-A': {\r\n        a: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD94',\r\n        b: 166,\r\n        p: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD97',\r\n        q: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C611070995AD10045841B09B761B893',\r\n        x: 1,\r\n        y: '0x8D91E471E0989CDA27DF505A453F2B7635294F2DDF23E3B122ACC99C9E9F1E14'\r\n    },\r\n    'S-256-B': {\r\n        a: '0x8000000000000000000000000000000000000000000000000000000000000C96',\r\n        b: '0x3E1AF419A269A5F866A7D3C25C3DF80AE979259373FF2B182F49D4CE7E1BBC8B',\r\n        p: '0x8000000000000000000000000000000000000000000000000000000000000C99',\r\n        q: '0x800000000000000000000000000000015F700CFFF1A624E5E497161BCC8A198F',\r\n        x: 1,\r\n        y: '0x3FA8124359F96680B83D1C3EB2C070E5C545C9858D03ECFB744BF8D717717EFC'\r\n    },\r\n    'S-256-C': {\r\n        a: '0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D7598',\r\n        b: 32858,\r\n        p: '0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D759B',\r\n        q: '0x9B9F605F5A858107AB1EC85E6B41C8AA582CA3511EDDFB74F02F3A6598980BB9',\r\n        x: 0,\r\n        y: '0x41ECE55743711A8C3CBF3783CD08C0EE4D4DC440D4641A8F366E550DFDB3BB67'\r\n    },\r\n    'P-256': {\r\n        p: '0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF',\r\n        a: '0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC',\r\n        b: '0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B',\r\n        x: '0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296',\r\n        y: '0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5',\r\n        q: '0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551'\r\n    },\r\n    'T-512-TEST': {\r\n        a: 7,\r\n        b: '0x1CFF0806A31116DA29D8CFA54E57EB748BC5F377E49400FDD788B649ECA1AC4361834013B2AD7322480A89CA58E0CF74BC9E540C2ADD6897FAD0A3084F302ADC',\r\n        p: '0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DF1D852741AF4704A0458047E80E4546D35B8336FAC224DD81664BBF528BE6373',\r\n        q: '0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DA82F2D7ECB1DBAC719905C5EECC423F1D86E25EDBE23C595D644AAF187E6E6DF',\r\n        x: '0x24D19CC64572EE30F396BF6EBBFD7A6C5213B3B3D7057CC825F91093A68CD762FD60611262CD838DC6B60AA7EEE804E28BC849977FAC33B4B530F1B120248A9A',\r\n        y: '0x2BB312A43BD2CE6E0D020613C857ACDDCFBF061E91E5F2C3F32447C259F39B2C83AB156D77F1496BF7EB3351E1EE4E43DC1A18B91B24640B6DBB92CB1ADD371E'\r\n    },\r\n    'T-512-A': {\r\n        p: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7',\r\n        a: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4',\r\n        b: '0xE8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879BD081CFD0B6265EE3CB090F30D27614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760',\r\n        q: '0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27E69532F48D89116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275',\r\n        x: 3,\r\n        y: '0x7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC1778064FDCBEFA921DF1626BE4FD036E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4'\r\n    },\r\n    'T-512-B': {\r\n        p: '0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006F',\r\n        a: '0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006C',\r\n        b: '0x687D1B459DC841457E3E06CF6F5E2517B97C7D614AF138BCBF85DC806C4B289F3E965D2DB1416D217F8B276FAD1AB69C50F78BEE1FA3106EFB8CCBC7C5140116',\r\n        q: '0x800000000000000000000000000000000000000000000000000000000000000149A1EC142565A545ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD',\r\n        x: 2,\r\n        y: '0x1A8F7EDA389B094C2C071E3647A8940F3C123B697578C213BE6DD9E6C8EC7335DCB228FD1EDF4A39152CBCAAF8C0398828041055F94CEEEC7E21340780FE41BD'\r\n    }\r\n};\r\nECGostParams['X-256-A'] = ECGostParams['S-256-A'];\r\nECGostParams['X-256-B'] = ECGostParams['S-256-C'];\r\nECGostParams['T-256-TEST'] = ECGostParams['S-256-TEST'];\r\nECGostParams['T-256-A'] = ECGostParams['S-256-A'];\r\nECGostParams['T-256-B'] = ECGostParams['S-256-B'];\r\nECGostParams['T-256-C'] = ECGostParams['S-256-C'];\r\n\r\n\r\nvar GostParams = {\r\n    'S-TEST': {\r\n        modulusLength: 512, // bit length of p (512 or 1024 bits)\r\n        p: '0xEE8172AE8996608FB69359B89EB82A69854510E2977A4D63BC97322CE5DC3386EA0A12B343E9190F23177539845839786BB0C345D165976EF2195EC9B1C379E3',\r\n        q: '0x98915E7EC8265EDFCDA31E88F24809DDB064BDC7285DD50D7289F0AC6F49DD2D',\r\n        a: '0x9e96031500c8774a869582d4afde2127afad2538b4b6270a6f7c8837b50d50f206755984a49e509304d648be2ab5aab18ebe2cd46ac3d8495b142aa6ce23e21c'\r\n    },\r\n    'S-A': {\r\n        modulusLength: 1024,\r\n        p: '0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF',\r\n        q: '0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF',\r\n        a: '0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A'\r\n    },\r\n    'S-B': {\r\n        modulusLength: 1024,\r\n        p: '0xC6971FC57524B30C9018C5E621DE15499736854F56A6F8AEE65A7A404632B1BCF0349FFCAFCB0A103177971FC1612ADCDB8C8CC938C70225C8FD12AFF01B1D064E0AD6FDE6AB9159166CB9F2FC171D92F0CC7B6A6B2CD7FA342ACBE2C9315A42D576B1ECCE77A963157F3D0BD96A8EB0B0F3502AD238101B05116334F1E5B7AB',\r\n        q: '0xB09D634C10899CD7D4C3A7657403E05810B07C61A688BAB2C37F475E308B0607',\r\n        a: '0x3D26B467D94A3FFC9D71BF8DB8934084137264F3C2E9EB16DCA214B8BC7C872485336744934FD2EF5943F9ED0B745B90AA3EC8D70CDC91682478B664A2E1F8FB56CEF2972FEE7EDB084AF746419B854FAD02CC3E3646FF2E1A18DD4BEB3C44F7F2745588029649674546CC9187C207FB8F2CECE8E2293F68395C4704AF04BAB5'\r\n    },\r\n    'S-C': {\r\n        modulusLength: 1024,\r\n        p: '0x9D88E6D7FE3313BD2E745C7CDD2AB9EE4AF3C8899E847DE74A33783EA68BC30588BA1F738C6AAF8AB350531F1854C3837CC3C860FFD7E2E106C3F63B3D8A4C034CE73942A6C3D585B599CF695ED7A3C4A93B2B947B7157BB1A1C043AB41EC8566C6145E938A611906DE0D32E562494569D7E999A0DDA5C879BDD91FE124DF1E9',\r\n        q: '0xFADD197ABD19A1B4653EECF7ECA4D6A22B1F7F893B641F901641FBB555354FAF',\r\n        a: '0x7447ED7156310599070B12609947A5C8C8A8625CF1CF252B407B331F93D639DDD1BA392656DECA992DD035354329A1E95A6E32D6F47882D960B8F10ACAFF796D13CD9611F853DAB6D2623483E46788708493937A1A29442598AEC2E0742022563440FE9C18740ECE6765AC05FAF024A64B026E7E408840819E962E7E5F401AE3'\r\n    },\r\n    'S-D': {\r\n        modulusLength: 1024,\r\n        p: '0x80F102D32B0FD167D069C27A307ADAD2C466091904DBAA55D5B8CC7026F2F7A1919B890CB652C40E054E1E9306735B43D7B279EDDF9102001CD9E1A831FE8A163EED89AB07CF2ABE8242AC9DEDDDBF98D62CDDD1EA4F5F15D3A42A6677BDD293B24260C0F27C0F1D15948614D567B66FA902BAA11A69AE3BCEADBB83E399C9B5',\r\n        q: '0xF0F544C418AAC234F683F033511B65C21651A6078BDA2D69BB9F732867502149',\r\n        a: '0x6BCC0B4FADB3889C1E06ADD23CC09B8AB6ECDEDF73F04632595EE4250005D6AF5F5ADE44CB1E26E6263C672347CFA26F9E9393681E6B759733784CDE5DBD9A14A39369DFD99FA85CC0D10241C4010343F34A91393A706CF12677CBFA1F578D6B6CFBE8A1242CFCC94B3B653A476E145E3862C18CC3FED8257CFEF74CDB205BF1'\r\n    },\r\n    'X-A': {\r\n        modulusLength: 1024,\r\n        p: '0xCA3B3F2EEE9FD46317D49595A9E7518E6C63D8F4EB4D22D10D28AF0B8839F079F8289E603B03530784B9BB5A1E76859E4850C670C7B71C0DF84CA3E0D6C177FE9F78A9D8433230A883CD82A2B2B5C7A3306980278570CDB79BF01074A69C9623348824B0C53791D53C6A78CAB69E1CFB28368611A397F50F541E16DB348DBE5F',\r\n        q: '0xCAE4D85F80C147704B0CA48E85FB00A9057AA4ACC44668E17F1996D7152690D9',\r\n        a: '0xBE27D652F2F1E339DA734211B85B06AE4DE236AA8FBEEB3F1ADCC52CD43853777E834A6A518138678A8ADBD3A55C70A7EAB1BA7A0719548677AAF4E609FFB47F6B9D7E45B0D06D83D7ADC53310ABD85783E7317F7EC73268B6A9C08D260B85D8485696CA39C17B17F044D1E050489036ABD381C5E6BF82BA352A1AFF136601AF'\r\n    },\r\n    'X-B': {\r\n        modulusLength: 1024,\r\n        p: '0x9286DBDA91ECCFC3060AA5598318E2A639F5BA90A4CA656157B2673FB191CD0589EE05F4CEF1BD13508408271458C30851CE7A4EF534742BFB11F4743C8F787B11193BA304C0E6BCA25701BF88AF1CB9B8FD4711D89F88E32B37D95316541BF1E5DBB4989B3DF13659B88C0F97A3C1087B9F2D5317D557DCD4AFC6D0A754E279',\r\n        q: '0xC966E9B3B8B7CDD82FF0F83AF87036C38F42238EC50A876CD390E43D67B6013F',\r\n        a: '0x7E9C3096676F51E3B2F9884CF0AC2156779496F410E049CED7E53D8B7B5B366B1A6008E5196605A55E89C3190DABF80B9F1163C979FCD18328DAE5E9048811B370107BB7715F82091BB9DE0E33EE2FED6255474F8769FCE5EAFAEEF1CB5A32E0D5C6C2F0FC0B3447072947F5B4C387666993A333FC06568E534AD56D2338D729'\r\n    },\r\n    'X-C': {\r\n        modulusLength: 1024,\r\n        p: '0xB194036ACE14139D36D64295AE6C50FC4B7D65D8B340711366CA93F383653908EE637BE428051D86612670AD7B402C09B820FA77D9DA29C8111A8496DA6C261A53ED252E4D8A69A20376E6ADDB3BDCD331749A491A184B8FDA6D84C31CF05F9119B5ED35246EA4562D85928BA1136A8D0E5A7E5C764BA8902029A1336C631A1D',\r\n        q: '0x96120477DF0F3896628E6F4A88D83C93204C210FF262BCCB7DAE450355125259',\r\n        a: '0x3F1817052BAA7598FE3E4F4FC5C5F616E122CFF9EBD89EF81DC7CE8BF56CC64B43586C80F1C4F56DD5718FDD76300BE336784259CA25AADE5A483F64C02A20CF4A10F9C189C433DEFE31D263E6C9764660A731ECCAECB74C8279303731E8CF69205BC73E5A70BDF93E5BB681DAB4EEB9C733CAAB2F673C475E0ECA921D29782E'\r\n    }\r\n}; // </editor-fold>\r\n\r\n/*\r\n * BigInteger arithmetic tools\r\n * optimized release of http://www-cs-students.stanford.edu/~tjw/jsbn/jsbn.js\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\n// Bits per one element\r\nvar DB = 28, DM = (1 << DB) - 1, DV = 1 << DB,\r\n  FV = Math.pow(2, 52), F1 = 52 - DB, F2 = 2 * DB - 52;\r\n\r\nfunction am(y, i, x, w, j, c, n) {\r\n    var xl = x & 0x3fff, xh = x >> 14;\r\n    while (--n >= 0) {\r\n        var l = y[i] & 0x3fff;\r\n        var h = y[i++] >> 14;\r\n        var m = xh * l + h * xl;\r\n        l = xl * l + ((m & 0x3fff) << 14) + w[j] + c;\r\n        c = (l >> 28) + (m >> 14) + xh * h;\r\n        w[j++] = l & 0xfffffff;\r\n    }\r\n    return c;\r\n}\r\n\r\nfunction nbi(words) {\r\n    var r = new Array(Math.ceil(words));\r\n    r.s = 0;\r\n    r.t = 0;\r\n    return r;\r\n}\r\n\r\nfunction copyTo(x, r) {\r\n    for (var i = x.t - 1; i >= 0; --i)\r\n        r[i] = x[i];\r\n    r.t = x.t;\r\n    r.s = x.s;\r\n    return r;\r\n}\r\n\r\nfunction copy(x) {\r\n    return copyTo(x, nbi(x.t));\r\n}\r\n\r\nfunction setInt(x, i) {\r\n    x.t = 1;\r\n    x.s = (i < 0) ? -1 : 0;\r\n    if (i > 0)\r\n        x[0] = i;\r\n    else if (i < -1)\r\n        x[0] = i + DV;\r\n    else\r\n        x.t = 0;\r\n    return x;\r\n}\r\n\r\nfunction nbv(i) {\r\n    var r = nbi(1);\r\n    setInt(r, i);\r\n    return r;\r\n}\r\n\r\nvar ZERO = nbv(0), ONE = nbv(1), THREE = nbv(3);\r\n\r\nfunction clamp(x) {\r\n    var c = x.s & DM;\r\n    while (x.t > 0 && x[x.t - 1] === c)\r\n        --x.t;\r\n    return x;\r\n}\r\n\r\nfunction subTo(x, a, r) {\r\n    var i = 0, c = 0, m = Math.min(a.t, x.t);\r\n    while (i < m) {\r\n        c += x[i] - a[i];\r\n        r[i++] = c & DM;\r\n        c >>= DB;\r\n    }\r\n    if (a.t < x.t) {\r\n        c -= a.s;\r\n        while (i < x.t) {\r\n            c += x[i];\r\n            r[i++] = c & DM;\r\n            c >>= DB;\r\n        }\r\n        c += x.s;\r\n    }\r\n    else {\r\n        c += x.s;\r\n        while (i < a.t) {\r\n            c -= a[i];\r\n            r[i++] = c & DM;\r\n            c >>= DB;\r\n        }\r\n        c -= a.s;\r\n    }\r\n    r.s = (c < 0) ? -1 : 0;\r\n    if (c < -1)\r\n        r[i++] = DV + c;\r\n    else if (c > 0)\r\n        r[i++] = c;\r\n    r.t = i;\r\n    return clamp(r);\r\n}\r\n\r\nfunction sub(x, y) {\r\n    return subTo(x, y, nbi(x.t));\r\n}\r\n\r\nfunction addTo(x, a, r) {\r\n    var i = 0, c = 0, m = Math.min(a.t, x.t);\r\n    while (i < m) {\r\n        c += x[i] + a[i];\r\n        r[i++] = c & DM;\r\n        c >>= DB;\r\n    }\r\n    if (a.t < x.t) {\r\n        c += a.s;\r\n        while (i < x.t) {\r\n            c += x[i];\r\n            r[i++] = c & DM;\r\n            c >>= DB;\r\n        }\r\n        c += x.s;\r\n    }\r\n    else {\r\n        c += x.s;\r\n        while (i < a.t) {\r\n            c += a[i];\r\n            r[i++] = c & DM;\r\n            c = c >> DB;\r\n        }\r\n        c += a.s;\r\n    }\r\n    r.s = (c < 0) ? -1 : 0;\r\n    if (c > 0)\r\n        r[i++] = c;\r\n    else if (c < -1)\r\n        r[i++] = DV + c;\r\n    r.t = i;\r\n    return clamp(r);\r\n}\r\n\r\nfunction add(x, y) {\r\n    return addTo(x, y, nbi(x.t));\r\n}\r\n\r\nfunction negTo(x, r) {\r\n    return subTo(ZERO, x, r);\r\n}\r\n\r\nfunction neg(x) {\r\n    return negTo(x, nbi(x.t));\r\n}\r\n\r\nfunction absTo(x, r) {\r\n    return (x.s < 0) ? negTo(r) : copyTo(r);\r\n}\r\n\r\nfunction abs(x) {\r\n    return (x.s < 0) ? neg(x) : x;\r\n}\r\n\r\nfunction compare(x, a) {\r\n    var r = x.s - a.s;\r\n    if (r !== 0)\r\n        return r;\r\n    var i = x.t;\r\n    r = i - a.t;\r\n    if (r !== 0)\r\n        return (x.s < 0) ? -r : r;\r\n    while (--i >= 0)\r\n        if ((r = x[i] - a[i]) !== 0)\r\n            return r;\r\n    return 0;\r\n}\r\n\r\nfunction equals(x, y) {\r\n    return (compare(x, y) === 0);\r\n}\r\n\r\nfunction min(x, y) {\r\n    return (compare(x, y) < 0) ? x : y;\r\n}\r\n\r\nfunction max(x, y) {\r\n    return (compare(x, y) > 0) ? x : y;\r\n}\r\n\r\nfunction nbits(x) {\r\n    var r = 1, t;\r\n    if ((t = x >>> 16) !== 0) {\r\n        x = t;\r\n        r += 16;\r\n    }\r\n    if ((t = x >> 8) !== 0) {\r\n        x = t;\r\n        r += 8;\r\n    }\r\n    if ((t = x >> 4) !== 0) {\r\n        x = t;\r\n        r += 4;\r\n    }\r\n    if ((t = x >> 2) !== 0) {\r\n        x = t;\r\n        r += 2;\r\n    }\r\n    if ((t = x >> 1) !== 0) {\r\n        x = t;\r\n        r += 1;\r\n    }\r\n    return r;\r\n}\r\n\r\nfunction dshlTo(x, n, r) {\r\n    var i;\r\n    for (i = x.t - 1; i >= 0; --i)\r\n        r[i + n] = x[i];\r\n    for (i = n - 1; i >= 0; --i)\r\n        r[i] = 0;\r\n    r.t = x.t + n;\r\n    r.s = x.s;\r\n    return r;\r\n}\r\n\r\nfunction dshrTo(x, n, r) {\r\n    for (var i = n; i < x.t; ++i)\r\n        r[i - n] = x[i];\r\n    r.t = Math.max(x.t - n, 0);\r\n    r.s = x.s;\r\n    return r;\r\n}\r\n\r\nfunction shlTo(x, n, r) {\r\n    var bs = n % DB;\r\n    var cbs = DB - bs;\r\n    var bm = (1 << cbs) - 1;\r\n    var ds = Math.floor(n / DB), c = (x.s << bs) & DM, i;\r\n    for (i = x.t - 1; i >= 0; --i) {\r\n        r[i + ds + 1] = (x[i] >> cbs) | c;\r\n        c = (x[i] & bm) << bs;\r\n    }\r\n    for (i = ds - 1; i >= 0; --i)\r\n        r[i] = 0;\r\n    r[ds] = c;\r\n    r.t = x.t + ds + 1;\r\n    r.s = x.s;\r\n    return clamp(r);\r\n}\r\n\r\nfunction shrTo(x, n, r) {\r\n    r.s = x.s;\r\n    var ds = Math.floor(n / DB);\r\n    if (ds >= x.t) {\r\n        r.t = 0;\r\n        return;\r\n    }\r\n    var bs = n % DB;\r\n    var cbs = DB - bs;\r\n    var bm = (1 << bs) - 1;\r\n    r[0] = x[ds] >> bs;\r\n    for (var i = ds + 1; i < x.t; ++i) {\r\n        r[i - ds - 1] |= (x[i] & bm) << cbs;\r\n        r[i - ds] = x[i] >> bs;\r\n    }\r\n    if (bs > 0)\r\n        r[x.t - ds - 1] |= (x.s & bm) << cbs;\r\n    r.t = x.t - ds;\r\n    return clamp(r);\r\n}\r\n\r\nfunction shl(x, n) {\r\n    var r = nbi(x.t);\r\n    if (n < 0)\r\n        shrTo(x, -n, r);\r\n    else\r\n        shlTo(x, n, r);\r\n    return r;\r\n}\r\n\r\nfunction shr(x, n) {\r\n    var r = nbi(x.t);\r\n    if (n < 0)\r\n        shlTo(x, -n, r);\r\n    else\r\n        shrTo(x, n, r);\r\n    return r;\r\n}\r\n\r\nfunction bitLength(x) {\r\n    if (x.t <= 0)\r\n        return 0;\r\n    return DB * (x.t - 1) + nbits(x[x.t - 1] ^ (x.s & DM));\r\n}\r\n\r\nfunction mulTo(b, a, r) {\r\n    var x = abs(b), y = abs(a);\r\n    var i = x.t;\r\n    r.t = i + y.t;\r\n    while (--i >= 0)\r\n        r[i] = 0;\r\n    for (i = 0; i < y.t; ++i)\r\n        r[i + x.t] = am(x, 0, y[i], r, i, 0, x.t);\r\n    r.s = 0;\r\n    if (b.s !== a.s)\r\n        subTo(ZERO, r, r);\r\n    return clamp(r);\r\n}\r\n\r\nfunction mul(x, y) {\r\n    return mulTo(x, y, nbi(x.t + y.t));\r\n}\r\n\r\nfunction sqrTo(a, r) {\r\n    var x = abs(a);\r\n    var i = r.t = 2 * x.t;\r\n    while (--i >= 0)\r\n        r[i] = 0;\r\n    for (i = 0; i < x.t - 1; ++i) {\r\n        var c = am(x, i, x[i], r, 2 * i, 0, 1);\r\n        if ((r[i + x.t] += am(x, i + 1, 2 * x[i], r, 2 * i + 1, c, x.t - i - 1)) >= x.DV) {\r\n            r[i + x.t] -= x.DV;\r\n            r[i + x.t + 1] = 1;\r\n        }\r\n    }\r\n    if (r.t > 0)\r\n        r[r.t - 1] += am(x, i, x[i], r, 2 * i, 0, 1);\r\n    r.s = 0;\r\n    return clamp(r);\r\n}\r\n\r\nfunction sqr(a) {\r\n    return sqrTo(a, nbi(a.t * 2));\r\n}\r\n\r\nfunction divRemTo(n, m, q, r) {\r\n    var pm = abs(m);\r\n    if (pm.t <= 0)\r\n        throw new OperationError('Division by zero');\r\n    var pt = abs(n);\r\n    if (pt.t < pm.t) {\r\n        if (q)\r\n            setInt(q, 0);\r\n        if (r)\r\n            copyTo(n, r);\r\n        return q;\r\n    }\r\n    if (!r)\r\n        r = nbi(m.t);\r\n    var y = nbi(m.t), ts = n.s, ms = m.s;\r\n    var nsh = DB - nbits(pm[pm.t - 1]);\r\n    if (nsh > 0) {\r\n        shlTo(pm, nsh, y);\r\n        shlTo(pt, nsh, r);\r\n    }\r\n    else {\r\n        copyTo(pm, y);\r\n        copyTo(pt, r);\r\n    }\r\n    var ys = y.t;\r\n    var y0 = y[ys - 1];\r\n    if (y0 === 0)\r\n        return q;\r\n    var yt = y0 * (1 << F1) + ((ys > 1) ? y[ys - 2] >> F2 : 0);\r\n    var d1 = FV / yt, d2 = (1 << F1) / yt, e = 1 << F2;\r\n    var i = r.t, j = i - ys, t = !q ? nbi(Math.max(n.t - m.t, 1)) : q;\r\n    dshlTo(y, j, t);\r\n    if (compare(r, t) >= 0) {\r\n        r[r.t++] = 1;\r\n        subTo(r, t, r);\r\n    }\r\n    dshlTo(ONE, ys, t);\r\n    subTo(t, y, y);\r\n    while (y.t < ys)\r\n        y[y.t++] = 0;\r\n    while (--j >= 0) {\r\n        var qd = (r[--i] === y0) ? DM : Math.floor(r[i] * d1 + (r[i - 1] + e) * d2);\r\n        if ((r[i] += am(y, 0, qd, r, j, 0, ys)) < qd) {\r\n            dshlTo(y, j, t);\r\n            subTo(r, t, r);\r\n            while (r[i] < --qd)\r\n                subTo(r, t, r);\r\n        }\r\n    }\r\n    if (q) {\r\n        dshrTo(r, ys, q);\r\n        if (ts !== ms)\r\n            subTo(ZERO, q, q);\r\n    }\r\n    r.t = ys;\r\n    clamp(r);\r\n    if (nsh > 0)\r\n        shrTo(r, nsh, r);\r\n    if (ts < 0)\r\n        subTo(ZERO, r, r);\r\n    return q;\r\n}\r\n\r\nfunction modTo(b, a, r) {\r\n    divRemTo(abs(b), a, null, r);\r\n    if (b.s < 0 && compare(r, ZERO) > 0)\r\n        subTo(a, r, r);\r\n    return r;\r\n}\r\n\r\nfunction mod(b, a) {\r\n    return modTo(b, a, nbi(a.t));\r\n}\r\n\r\nfunction div(b, a) {\r\n    return divRemTo(b, a, nbi(Math.max(b.t - a.t, 1)), null);\r\n}\r\n\r\nfunction isEven(x) {\r\n\r\n    return ((x.t > 0) ? (x[0] & 1) : x.s) === 0;\r\n}\r\n\r\nfunction isZero(x) {\r\n    return equals(x, ZERO);\r\n}\r\n\r\nfunction sig(x) {\r\n    if (x.s < 0)\r\n        return -1;\r\n    else if (x.t <= 0 || (x.t === 1 && x[0] <= 0))\r\n        return 0;\r\n    else\r\n        return 1;\r\n}\r\n\r\nfunction invMod(x, m) {\r\n    var ac = isEven(m);\r\n    if ((isEven(x) && ac) || sig(m) === 0)\r\n        return ZERO;\r\n    var u = copy(m), v = copy(x);\r\n    var a = nbv(1), b = nbv(0), c = nbv(0), d = nbv(1);\r\n    while (sig(u) !== 0) {\r\n        while (isEven(u)) {\r\n            shrTo(u, 1, u);\r\n            if (ac) {\r\n                if (!isEven(a) || !isEven(b)) {\r\n                    addTo(a, x, a);\r\n                    subTo(b, m, b);\r\n                }\r\n                shrTo(a, 1, a);\r\n            }\r\n            else if (!isEven(b))\r\n                subTo(b, m, b);\r\n            shrTo(b, 1, b);\r\n        }\r\n        while (isEven(v)) {\r\n            shrTo(v, 1, v);\r\n            if (ac) {\r\n                if (!isEven(c) || !isEven(d)) {\r\n                    addTo(c, x, c);\r\n                    subTo(d, m, d);\r\n                }\r\n                shrTo(c, 1, c);\r\n            }\r\n            else if (!isEven(d))\r\n                subTo(d, m, d);\r\n            shrTo(d, 1, d);\r\n        }\r\n        if (compare(u, v) >= 0) {\r\n            subTo(u, v, u);\r\n            if (ac)\r\n                subTo(a, c, a);\r\n            subTo(b, d, b);\r\n        }\r\n        else {\r\n            subTo(v, u, v);\r\n            if (ac)\r\n                subTo(c, a, c);\r\n            subTo(d, b, d);\r\n        }\r\n    }\r\n    if (compare(v, ONE) !== 0)\r\n        return ZERO;\r\n    if (compare(d, m) >= 0)\r\n        return subtract(d, m);\r\n    if (sig(d) < 0)\r\n        addTo(d, m, d);\r\n    else\r\n        return d;\r\n    if (sig(d) < 0)\r\n        return add(d, m);\r\n    else\r\n        return d;\r\n}\r\n\r\nfunction testBit(x, n) {\r\n    var j = Math.floor(n / DB);\r\n    if (j >= x.t)\r\n        return (x.s !== 0);\r\n    return ((x[j] & (1 << (n % DB))) !== 0);\r\n}\r\n\r\nfunction nothing(x) {\r\n    return x;\r\n}\r\n\r\nfunction extend(c, o) {\r\n    for (var i in o)\r\n        c.prototype[i] = o[i];\r\n} // </editor-fold>\r\n\r\n/*\r\n * Classic, Barret, Mongomery reductions, optimized ExpMod algorithms\r\n * optimized release of http://www-cs-students.stanford.edu/~tjw/jsbn/jsbn2.js\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\n// Classic reduction\r\nvar Classic = function (m) {\r\n    this.m = m;\r\n};\r\n\r\nextend(Classic, {\r\n    convert: function (x) {\r\n        if (x.s < 0 || compare(x, this.m) >= 0)\r\n            return mod(x, this.m);\r\n        else\r\n            return x;\r\n    },\r\n    revert: nothing,\r\n    reduce: function (x) {\r\n        modTo(x, this.m, x);\r\n    },\r\n    sqrTo: function (x, r) {\r\n        sqrTo(x, r);\r\n        this.reduce(r);\r\n    },\r\n    mulTo: function (x, y, r) {\r\n        mulTo(x, y, r);\r\n        this.reduce(r);\r\n    }\r\n});\r\n\r\nfunction invDig(a) {\r\n    if (a.t < 1)\r\n        return 0;\r\n    var x = a[0];\r\n    if ((x & 1) === 0)\r\n        return 0;\r\n    var y = x & 3;\r\n    y = (y * (2 - (x & 0xf) * y)) & 0xf;\r\n    y = (y * (2 - (x & 0xff) * y)) & 0xff;\r\n    y = (y * (2 - (((x & 0xffff) * y) & 0xffff))) & 0xffff;\r\n    y = (y * (2 - x * y % DV)) % DV;\r\n    return (y > 0) ? DV - y : -y;\r\n}\r\n\r\n// Montgomery reduction\r\nvar Montgomery = function (m) {\r\n    this.m = m;\r\n    this.mp = invDig(m);\r\n    this.mpl = this.mp & 0x7fff;\r\n    this.mph = this.mp >> 15;\r\n    this.um = (1 << (DB - 15)) - 1;\r\n    this.mt2 = 2 * m.t;\r\n};\r\n\r\nextend(Montgomery, {\r\n    // xR mod m\r\n    convert: function (x) {\r\n        var r = nbi(x.t);\r\n        dshlTo(abs(x), this.m.t, r);\r\n        divRemTo(r, this.m, null, r);\r\n        if (x.s < 0 && compare(r, ZERO) > 0)\r\n            subTo(this.m, r, r);\r\n        return r;\r\n    },\r\n    // x/R mod m\r\n    revert: function (x) {\r\n        var r = nbi(x.t);\r\n        copyTo(x, r);\r\n        this.reduce(r);\r\n        return r;\r\n    },\r\n    // x = x/R mod m (HAC 14.32)\r\n    reduce: function (x) {\r\n        while (x.t <= this.mt2)\r\n            x[x.t++] = 0;\r\n        for (var i = 0; i < this.m.t; ++i) {\r\n            var j = x[i] & 0x7fff;\r\n            var u0 = (j * this.mpl + (((j * this.mph + (x[i] >> 15) * this.mpl) & this.um) << 15)) & DM;\r\n            j = i + this.m.t;\r\n            x[j] += am(this.m, 0, u0, x, i, 0, this.m.t);\r\n            while (x[j] >= DV) {\r\n                x[j] -= DV;\r\n                x[++j]++;\r\n            }\r\n        }\r\n        clamp(x);\r\n        dshrTo(x, this.m.t, x);\r\n        if (compare(x, this.m) >= 0)\r\n            subTo(x, this.m, x);\r\n    },\r\n    // r = \"x^2/R mod m\"; x != r\r\n    sqrTo: function (x, r) {\r\n        sqrTo(x, r);\r\n        this.reduce(r);\r\n    },\r\n    // r = \"xy/R mod m\"; x,y != r\r\n    mulTo: function (x, y, r) {\r\n        mulTo(x, y, r);\r\n        this.reduce(r);\r\n    }\r\n});\r\n\r\nfunction dAddOffset(x, n, w) {\r\n    if (n === 0)\r\n        return;\r\n    while (x.t <= w)\r\n        x[x.t++] = 0;\r\n    x[w] += n;\r\n    while (x[w] >= DV) {\r\n        x[w] -= DV;\r\n        if (++w >= x.t)\r\n            x[x.t++] = 0;\r\n        ++x[w];\r\n    }\r\n}\r\n\r\nfunction mulLowerTo(x, a, n, r) {\r\n    var i = Math.min(x.t + a.t, n);\r\n    r.s = 0; // assumes a,x >= 0\r\n    r.t = i;\r\n    while (i > 0)\r\n        r[--i] = 0;\r\n    var j;\r\n    for (j = r.t - x.t; i < j; ++i)\r\n        r[i + x.t] = am(x, 0, a[i], r, i, 0, x.t);\r\n    for (j = Math.min(a.t, n); i < j; ++i)\r\n        am(x, 0, a[i], r, i, 0, n - i);\r\n    return clamp(r);\r\n}\r\n\r\nfunction mulUpperTo(x, a, n, r) {\r\n    --n;\r\n    var i = r.t = x.t + a.t - n;\r\n    r.s = 0; // assumes a,x >= 0\r\n    while (--i >= 0)\r\n        r[i] = 0;\r\n    for (i = Math.max(n - x.t, 0); i < a.t; ++i)\r\n        r[x.t + i - n] = am(x, n - i, a[i], r, 0, 0, x.t + i - n);\r\n    clamp(r);\r\n    return dshrTo(r, 1, r);\r\n}\r\n\r\n// Barrett modular reduction\r\nfunction Barrett(m) {\r\n    // setup Barrett\r\n    this.r2 = nbi(2 * m.t);\r\n    this.q3 = nbi(2 * m.t);\r\n    dshlTo(ONE, 2 * m.t, this.r2);\r\n    this.mu = div(this.r2, m);\r\n    this.m = m;\r\n}\r\n\r\nextend(Barrett, {\r\n    convert: function (x) {\r\n        if (x.s < 0 || x.t > 2 * this.m.t)\r\n            return mod(x, this.m);\r\n        else if (compare(x, this.m) < 0)\r\n            return x;\r\n        else {\r\n            var r = nbi(x.t);\r\n            copyTo(x, r);\r\n            this.reduce(r);\r\n            return r;\r\n        }\r\n    },\r\n    revert: function (x) {\r\n        return x;\r\n    },\r\n    // x = x mod m (HAC 14.42)\r\n    reduce: function (x) {\r\n        dshrTo(x, this.m.t - 1, this.r2);\r\n        if (x.t > this.m.t + 1) {\r\n            x.t = this.m.t + 1;\r\n            clamp(x);\r\n        }\r\n        mulUpperTo(this.mu, this.r2, this.m.t + 1, this.q3);\r\n        mulLowerTo(this.m, this.q3, this.m.t + 1, this.r2);\r\n        while (compare(x, this.r2) < 0)\r\n            dAddOffset(x, 1, this.m.t + 1);\r\n        subTo(x, this.r2, x);\r\n        while (compare(x, this.m) >= 0)\r\n            subTo(x, this.m, x);\r\n    },\r\n    // r = x^2 mod m; x != r\r\n    sqrTo: function (x, r) {\r\n        sqrTo(x, r);\r\n        this.reduce(r);\r\n    },\r\n    // r = x*y mod m; x,y != r\r\n    mulTo: function (x, y, r) {\r\n        mulTo(x, y, r);\r\n        this.reduce(r);\r\n    }\r\n\r\n});\r\n\r\n// x^e % m (HAC 14.85)\r\nfunction expMod(x, e, m) {\r\n    var i = bitLength(e), k, r = nbv(1), z;\r\n    if (i <= 0)\r\n        return r;\r\n    else if (i < 18)\r\n        k = 1;\r\n    else if (i < 48)\r\n        k = 3;\r\n    else if (i < 144)\r\n        k = 4;\r\n    else if (i < 768)\r\n        k = 5;\r\n    else\r\n        k = 6;\r\n    if (i < 8)\r\n        z = new Classic(m);\r\n    else if (isEven(m))\r\n        z = new Barrett(m);\r\n    else\r\n        z = new Montgomery(m);\r\n\r\n    // precomputation\r\n    var g = new Array(), n = 3, k1 = k - 1, km = (1 << k) - 1;\r\n    g[1] = z.convert(x);\r\n    if (k > 1) {\r\n        var g2 = nbi(m.t * 2);\r\n        z.sqrTo(g[1], g2);\r\n        while (n <= km) {\r\n            g[n] = nbi(m.t * 2);\r\n            z.mulTo(g2, g[n - 2], g[n]);\r\n            n += 2;\r\n        }\r\n    }\r\n\r\n    var j = e.t - 1, w, is1 = true, r2 = nbi(m.t * 2), t;\r\n    i = nbits(e[j]) - 1;\r\n    while (j >= 0) {\r\n        if (i >= k1)\r\n            w = (e[j] >> (i - k1)) & km;\r\n        else {\r\n            w = (e[j] & ((1 << (i + 1)) - 1)) << (k1 - i);\r\n            if (j > 0)\r\n                w |= e[j - 1] >> (DB + i - k1);\r\n        }\r\n\r\n        n = k;\r\n        while ((w & 1) == 0) {\r\n            w >>= 1;\r\n            --n;\r\n        }\r\n        if ((i -= n) < 0) {\r\n            i += DB;\r\n            --j;\r\n        }\r\n        if (is1) {\t// ret == 1, don't bother squaring or multiplying it\r\n            copyTo(g[w], r);\r\n            is1 = false;\r\n        }\r\n        else {\r\n            while (n > 1) {\r\n                z.sqrTo(r, r2);\r\n                z.sqrTo(r2, r);\r\n                n -= 2;\r\n            }\r\n            if (n > 0)\r\n                z.sqrTo(r, r2);\r\n            else {\r\n                t = r;\r\n                r = r2;\r\n                r2 = t;\r\n            }\r\n            z.mulTo(r2, g[w], r);\r\n        }\r\n        while (j >= 0 && (e[j] & (1 << i)) == 0) {\r\n            z.sqrTo(r, r2);\r\n            t = r;\r\n            r = r2;\r\n            r2 = t;\r\n            if (--i < 0) {\r\n                i = DB - 1;\r\n                --j;\r\n            }\r\n        }\r\n    }\r\n    return z.revert(r);\r\n} // </editor-fold>\r\n\r\n/*\r\n * EC Field Elements, Points, Curves\r\n * optimized release of http://www-cs-students.stanford.edu/~tjw/jsbn/ec.js\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\n// EC Field Elemets\r\nfunction newFE(a, x) {\r\n    a.r.reduce(x);\r\n    x.q = a.q;\r\n    x.r = a.r;\r\n    return x;\r\n}\r\n\r\nfunction copyFE(a, x) {\r\n    x.q = a.q;\r\n    x.r = a.r;\r\n    return x;\r\n}\r\n\r\nfunction negFE(a) {\r\n    return copyFE(a, sub(a.q, a));\r\n}\r\n\r\nfunction addFE(a, b) {\r\n    var r = add(a, b);\r\n    if (compare(r, a.q) > 0)\r\n        subTo(r, a.q, r);\r\n    return copyFE(a, r);\r\n}\r\n\r\nfunction subFE(a, b) {\r\n    var r = sub(a, b);\r\n    if (r.s < 0)\r\n        addTo(a.q, r, r);\r\n    return copyFE(a, r);\r\n}\r\n\r\nfunction mulFE(a, b) {\r\n    return newFE(a, mul(a, b));\r\n}\r\n\r\nfunction sqrFE(a) {\r\n    return newFE(a, sqr(a));\r\n}\r\n\r\nfunction shlFE(a, i) {\r\n    return newFE(a, shl(a, i));\r\n}\r\n\r\nfunction invFE(a) {\r\n    return copyFE(a, invMod(a, a.q));\r\n}\r\n\r\n// EC Points\r\nfunction newEC(curve, x, y, z) {\r\n    return {\r\n        curve: curve,\r\n        x: x,\r\n        y: y,\r\n        z: z || newFE(curve, ONE)\r\n    };\r\n}\r\n\r\nfunction getX(point) {\r\n    if (!point.zinv)\r\n        point.zinv = invFE(point.z);\r\n    return mulFE(point.x, point.zinv);\r\n}\r\n\r\nfunction getY(point) {\r\n    if (!point.zinv)\r\n        point.zinv = invFE(point.z);\r\n    return mulFE(point.y, point.zinv);\r\n}\r\n\r\nfunction isInfinity(a) {\r\n    if ((!a.x) && (!a.y))\r\n        return true;\r\n    return isZero(a.z) && !isZero(a.y);\r\n}\r\n\r\nfunction getInfinity(a) {\r\n    return a.curve.infinity;\r\n}\r\n\r\nfunction equalsEC(a, b) {\r\n    if (a === b)\r\n        return true;\r\n    if (isInfinity(a))\r\n        return isInfinity(b);\r\n    if (isInfinity(b))\r\n        return isInfinity(a);\r\n    var u, v;\r\n    // u = Y2 * Z1 - Y1 * Z2\r\n    u = subFE(mulFE(b.y, a.z), mulFE(a.y, b.z));\r\n    if (!isZero(u))\r\n        return false;\r\n    // v = X2 * Z1 - X1 * Z2\r\n    v = subFE(mulFE(b.x, a.z), mulFE(a.x, b.z));\r\n    return isZero(v);\r\n}\r\n\r\nfunction negEC(a) {\r\n    return newEC(a.curve, a.x, negFE(a.y), a.z);\r\n}\r\n\r\nfunction addEC(a, b) {\r\n    if (isInfinity(a))\r\n        return b;\r\n    if (isInfinity(b))\r\n        return a;\r\n\r\n    // u = Y2 * Z1 - Y1 * Z2\r\n    var u = subFE(mulFE(b.y, a.z), mulFE(a.y, b.z));\r\n    // v = X2 * Z1 - X1 * Z2\r\n    var v = subFE(mulFE(b.x, a.z), mulFE(a.x, b.z));\r\n\r\n    if (isZero(v)) {\r\n        if (isZero(u)) {\r\n            return twiceEC(a); // a == b, so double\r\n        }\r\n        return getInfinity(a); // a = -b, so infinity\r\n    }\r\n\r\n    var x1 = a.x;\r\n    var y1 = a.y;\r\n\r\n    var v2 = sqrFE(v);\r\n    var v3 = mulFE(v2, v);\r\n    var x1v2 = mulFE(x1, v2);\r\n    var zu2 = mulFE(sqrFE(u), a.z);\r\n\r\n    // x3 = v * (z2 * (z1 * u^2 - 2 * x1 * v^2) - v^3)\r\n    var x3 = mulFE(subFE(mulFE(subFE(zu2, shlFE(x1v2, 1)), b.z), v3), v);\r\n    // y3 = z2 * (3 * x1 * u * v^2 - y1 * v^3 - z1 * u^3) + u * v^3\r\n    var y3 = addFE(mulFE(subFE(subFE(mulFE(mulFE(x1v2, THREE), u), mulFE(y1, v3)), mulFE(zu2, u)), b.z), mulFE(u, v3));\r\n    // z3 = v^3 * z1 * z2\r\n    var z3 = mulFE(mulFE(v3, a.z), b.z);\r\n\r\n    return newEC(a.curve, x3, y3, z3);\r\n}\r\n\r\nfunction twiceEC(b) {\r\n    if (isInfinity(b))\r\n        return b;\r\n    if (sig(b.y) === 0)\r\n        return getInfinity(b);\r\n\r\n    var x1 = b.x;\r\n    var y1 = b.y;\r\n\r\n    var y1z1 = mulFE(y1, b.z);\r\n    var y1sqz1 = mulFE(y1z1, y1);\r\n    var a = b.curve.a;\r\n\r\n    // w = 3 * x1^2 + a * z1^2\r\n    var w = mulFE(sqrFE(x1), THREE);\r\n    if (!isZero(a)) {\r\n        w = addFE(w, mulFE(sqrFE(b.z), a));\r\n    }\r\n\r\n    // x3 = 2 * y1 * z1 * (w^2 - 8 * x1 * y1^2 * z1)\r\n    var x3 = mulFE(shlFE(subFE(sqrFE(w), mulFE(shlFE(x1, 3), y1sqz1)), 1), y1z1);\r\n    // y3 = 4 * y1^2 * z1 * (3 * w * x1 - 2 * y1^2 * z1) - w^3\r\n    var y3 = subFE(mulFE(shlFE(subFE(mulFE(mulFE(w, THREE), x1), shlFE(y1sqz1, 1)), 2), y1sqz1), mulFE(sqrFE(w), w));\r\n    // z3 = 8 * (y1 * z1)^3\r\n    var z3 = shlFE(mulFE(sqrFE(y1z1), y1z1), 3);\r\n\r\n    return newEC(b.curve, x3, y3, z3);\r\n}\r\n\r\n// Simple NAF (Non-Adjacent Form) multiplication algorithm\r\nfunction mulEC(a, k) {\r\n    if (isInfinity(a))\r\n        return a;\r\n    if (sig(k) === 0)\r\n        return getInfinity(a);\r\n\r\n    var e = k;\r\n    var h = mul(e, THREE);\r\n\r\n    var neg = negEC(a);\r\n    var R = a;\r\n\r\n    var i;\r\n    for (i = bitLength(h) - 2; i > 0; --i) {\r\n        R = twiceEC(R);\r\n\r\n        var hBit = testBit(h, i);\r\n        var eBit = testBit(e, i);\r\n\r\n        if (hBit !== eBit) {\r\n            R = addEC(R, hBit ? a : neg);\r\n        }\r\n    }\r\n\r\n    return R;\r\n}\r\n\r\nfunction mul2AndAddEC(a, k) {\r\n    var nbits = bitLength(k);\r\n    var R = a,\r\n      Q = getInfinity(a);\r\n\r\n    for (var i = 0; i < nbits - 1; i++) {\r\n        if (testBit(k, i) === 1)\r\n            Q = addEC(Q, R);\r\n\r\n        R = twiceEC(R);\r\n    }\r\n\r\n    if (testBit(k, nbits - 1) === 1)\r\n        Q = addEC(Q, R);\r\n\r\n    return Q;\r\n}\r\n\r\n// Compute a*j + x*k (simultaneous multiplication)\r\nfunction mulTwoEC(a, j, x, k) {\r\n    var i;\r\n    if (bitLength(j) > bitLength(k))\r\n        i = bitLength(j) - 1;\r\n    else\r\n        i = bitLength(k) - 1;\r\n\r\n    var R = getInfinity(a);\r\n    var both = addEC(a, x);\r\n    while (i >= 0) {\r\n        R = twiceEC(R);\r\n        if (testBit(j, i)) {\r\n            if (testBit(k, i)) {\r\n                R = addEC(R, both);\r\n            }\r\n            else {\r\n                R = addEC(R, a);\r\n            }\r\n        }\r\n        else {\r\n            if (testBit(k, i)) {\r\n                R = addEC(R, x);\r\n            }\r\n        }\r\n        --i;\r\n    }\r\n\r\n    return R;\r\n}\r\n\r\n// EC Curve\r\nfunction newCurve(q, a, b) {\r\n    var curve = {};\r\n    curve.q = q;\r\n    curve.r = new Barrett(q);\r\n    curve.a = newFE(curve, a);\r\n    curve.b = newFE(curve, b);\r\n    curve.infinity = newEC(curve);\r\n    return curve;\r\n} // </editor-fold>\r\n\r\n/*\r\n * Converion tools (hex, binary)\r\n *\r\n */ // <editor-fold defaultstate=\"collapsed\">\r\n\r\nfunction atobi(d) {\r\n    var k = 8;\r\n    var a = new Uint8Array(d);\r\n    var r = nbi(a.length * 8 / DB);\r\n    r.t = 0;\r\n    r.s = 0;\r\n    var sh = 0;\r\n    for (var i = 0, n = a.length; i < n; i++) {\r\n        var x = a[i];\r\n        if (sh === 0)\r\n            r[r.t++] = x;\r\n        else if (sh + k > DB) {\r\n            r[r.t - 1] |= (x & ((1 << (DB - sh)) - 1)) << sh;\r\n            r[r.t++] = (x >> (DB - sh));\r\n        }\r\n        else\r\n            r[r.t - 1] |= x << sh;\r\n        sh += k;\r\n        if (sh >= DB)\r\n            sh -= DB;\r\n    }\r\n    return clamp(r);\r\n}\r\n\r\nfunction bitoa(s, bitLength) {\r\n    var k = 8;\r\n    var km = (1 << k) - 1, d, m = false, r = [], i = s.t;\r\n    var p = DB - (i * DB) % k;\r\n    if (i-- > 0) {\r\n        if (p < DB && (d = s[i] >> p) > 0) {\r\n            m = true;\r\n            r.push(d);\r\n        }\r\n        while (i >= 0) {\r\n            if (p < k) {\r\n                d = (s[i] & ((1 << p) - 1)) << (k - p);\r\n                d |= s[--i] >> (p += DB - k);\r\n            }\r\n            else {\r\n                d = (s[i] >> (p -= k)) & km;\r\n                if (p <= 0) {\r\n                    p += DB;\r\n                    --i;\r\n                }\r\n            }\r\n            if (d > 0)\r\n                m = true;\r\n            if (m)\r\n                r.push(d);\r\n        }\r\n    }\r\n    var r8 = new Uint8Array(bitLength ? bitLength / 8 : r.length);\r\n    if (m)\r\n        r8.set(r.reverse());\r\n    return r8.buffer;\r\n}\r\n\r\n\r\nfunction htobi(s) {\r\n    if (typeof s === 'number' || s instanceof Number)\r\n        return nbv(s);\r\n    s = s.replace(/[^\\-A-Fa-f0-9]/g, '');\r\n    if (!s)\r\n        s = '0';\r\n    var k = 4;\r\n    var r = nbi(s.length / 7);\r\n    var i = s.length, mi = false, sh = 0;\r\n    while (--i >= 0) {\r\n        var c = s.charAt(i);\r\n        if (c === '-') {\r\n            mi = true;\r\n            continue;\r\n        }\r\n        var x = parseInt(s.charAt(i), 16);\r\n        mi = false;\r\n        if (sh === 0)\r\n            r[r.t++] = x;\r\n        else if (sh + k > DB) {\r\n            r[r.t - 1] |= (x & ((1 << (DB - sh)) - 1)) << sh;\r\n            r[r.t++] = (x >> (DB - sh));\r\n        }\r\n        else\r\n            r[r.t - 1] |= x << sh;\r\n        sh += k;\r\n        if (sh >= DB)\r\n            sh -= DB;\r\n    }\r\n    if (mi)\r\n        subTo(ZERO, r, r);\r\n    return clamp(r);\r\n}\r\n\r\nfunction bitoh(x) {\r\n    if (x.s < 0)\r\n        return \"-\" + bitoh(negTo(x, nbi(x.t)));\r\n    var k = 4;\r\n    var km = (1 << k) - 1, d, m = false, r = \"\", i = x.t;\r\n    var p = DB - (i * DB) % k;\r\n    if (i-- > 0) {\r\n        if (p < DB && (d = x[i] >> p) > 0) {\r\n            m = true;\r\n            r = d.toString(16);\r\n        }\r\n        while (i >= 0) {\r\n            if (p < k) {\r\n                d = (x[i] & ((1 << p) - 1)) << (k - p);\r\n                d |= x[--i] >> (p += DB - k);\r\n            }\r\n            else {\r\n                d = (x[i] >> (p -= k)) & km;\r\n                if (p <= 0) {\r\n                    p += DB;\r\n                    --i;\r\n                }\r\n            }\r\n            if (d > 0)\r\n                m = true;\r\n            if (m)\r\n                r += d.toString(16);\r\n        }\r\n    }\r\n    return \"0x\" + (m ? r : \"0\");\r\n}\r\n\r\n// biginteger to big-endian integer bytearray\r\nfunction bitoi(s) {\r\n    var i = s.t, r = [];\r\n    r[0] = s.s;\r\n    var p = DB - (i * DB) % 8, d, k = 0;\r\n    if (i-- > 0) {\r\n        if (p < DB && (d = s[i] >> p) !== (s.s & DM) >> p)\r\n            r[k++] = d | (s.s << (DB - p));\r\n        while (i >= 0) {\r\n            if (p < 8) {\r\n                d = (s[i] & ((1 << p) - 1)) << (8 - p);\r\n                d |= s[--i] >> (p += DB - 8);\r\n            }\r\n            else {\r\n                d = (s[i] >> (p -= 8)) & 0xff;\r\n                if (p <= 0) {\r\n                    p += DB;\r\n                    --i;\r\n                }\r\n            }\r\n            if ((d & 0x80) !== 0)\r\n                d |= -256;\r\n            if (k === 0 && (s.s & 0x80) !== (d & 0x80))\r\n                ++k;\r\n            if (k > 0 || d !== s.s)\r\n                r[k++] = d;\r\n        }\r\n    }\r\n    return new Uint8Array(r).buffer;\r\n}\r\n\r\n// big-endian integer bytearray to biginteger\r\nfunction itobi(d) {\r\n    var k = 8, s = new Uint8Array(d),\r\n      r = nbi(s.length / 7);\r\n    r.t = 0;\r\n    r.s = 0;\r\n    var i = s.length, sh = 0;\r\n    while (--i >= 0) {\r\n        var x = s[i] & 0xff;\r\n        if (sh === 0)\r\n            r[r.t++] = x;\r\n        else if (sh + k > DB) {\r\n            r[r.t - 1] |= (x & ((1 << (DB - sh)) - 1)) << sh;\r\n            r[r.t++] = (x >> (DB - sh));\r\n        }\r\n        else\r\n            r[r.t - 1] |= x << sh;\r\n        sh += k;\r\n        if (sh >= DB)\r\n            sh -= DB;\r\n    }\r\n    if ((s[0] & 0x80) !== 0) {\r\n        r.s = -1;\r\n        if (sh > 0)\r\n            r[r.t - 1] |= ((1 << (DB - sh)) - 1) << sh;\r\n    }\r\n    return clamp(r);\r\n}\r\n\r\n\r\n// Swap bytes in buffer\r\nfunction swap(s) {\r\n    var src = new Uint8Array(s),\r\n      dst = new Uint8Array(src.length);\r\n    for (var i = 0, n = src.length; i < n; i++)\r\n        dst[n - i - 1] = src[i];\r\n    return dst.buffer;\r\n}\r\n\r\n// Calculate hash of data\r\nfunction hash(d) {\r\n    if (this.hash)\r\n        d = this.hash.digest(d);\r\n    // Swap hash for SignalCom\r\n    if (this.procreator === 'SC' ||\r\n      (this.procreator === 'VN' && this.hash.version === 2012))\r\n        d = swap(d);\r\n    return d;\r\n}\r\n\r\n// Check buffer\r\nfunction buffer(d) {\r\n    if (d instanceof CryptoOperationData)\r\n        return d;\r\n    else if (d && d.buffer && d.buffer instanceof CryptoOperationData)\r\n        return d.byteOffset === 0 && d.byteLength === d.buffer.byteLength ?\r\n          d.buffer : new Uint8Array(new Uint8Array(d, d.byteOffset, d.byteLength)).buffer;\r\n    else\r\n        throw new DataError('CryptoOperationData or CryptoOperationDataView required');\r\n}\r\n\r\n// Check double buffer\r\nfunction to2(d) {\r\n    var b = buffer(d);\r\n    if (b.byteLength % 2 > 0)\r\n        throw new DataError('Buffer length must be even');\r\n    var n = b.byteLength / 2;\r\n    return [atobi(new Uint8Array(b, 0, n)), atobi(new Uint8Array(b, n, n))];\r\n}\r\n\r\nfunction from2(x, y, bitLength) {\r\n    var a = bitoa(x, bitLength),\r\n      b = bitoa(y, bitLength),\r\n      d = new Uint8Array(a.byteLength + b.byteLength);\r\n    d.set(new Uint8Array(a));\r\n    d.set(new Uint8Array(b), a.byteLength);\r\n    return d.buffer;\r\n}\r\n\r\n// </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * The sign method returns sign data generated with the supplied privateKey.<br>\r\n *\r\n * @memberOf GostSign\r\n * @method sign\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} privateKey Private key\r\n * @param {(CryptoOperationData|TypedArray)} data Data\r\n * @returns {CryptoOperationData} Signature\r\n */\r\nfunction sign(privateKey, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n\r\n    // Stage 1\r\n    var b = buffer(data);\r\n    var alpha = atobi(hash.call(this, b));\r\n\r\n    var q = this.q;\r\n    var x = mod(atobi(buffer(privateKey)), q);\r\n\r\n    // Stage 2\r\n    var e = mod(alpha, q);\r\n    if (isZero(e))\r\n        e = ONE;\r\n\r\n    var s = ZERO;\r\n    while (isZero(s)) {\r\n        var r = ZERO;\r\n        while (isZero(r)) {\r\n\r\n            // Stage 3\r\n            var k = mod(atobi(this.ukm ||\r\n              getSeed(this.bitLength)), q); // pseudo random 0 < k < q\r\n            // Stage 4\r\n            if (this.curve) {\r\n                // Gost R 34.10-2001 || Gost R 34.10-2012\r\n                var P = this.P;\r\n                var C = mulEC(P, k);\r\n                r = mod(getX(C), q);\r\n            } else {\r\n                // Gost R 34.10-94\r\n                var p = this.p, a = this.a;\r\n                r = mod(expMod(a, k, p), q);\r\n            }\r\n        }\r\n        // Stage 5\r\n        s = mod(add(mul(r, x), mul(k, e)), q);\r\n    }\r\n    // Stage 6\r\n    // console.log('s', bitoh(s));\r\n    // console.log('r', bitoh(r));\r\n    var zetta;\r\n    // Integer structure for SignalCom algorithm\r\n    if (this.procreator === 'SC') {\r\n        zetta = {\r\n            r: bitoh(r),\r\n            s: bitoh(s)\r\n        };\r\n    } else {\r\n        zetta = from2(r, s, this.bitLength);\r\n        // Swap bytes for CryptoPro algorithm\r\n        if (this.procreator === 'CP' || this.procreator === 'VN')\r\n            zetta = swap(zetta);\r\n    }\r\n    return zetta;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * The verify method returns signature verification for the supplied publicKey.<br>\r\n *\r\n * @memberOf GostSign\r\n * @method sign\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} publicKey Public key\r\n * @param {(CryptoOperationData|TypedArray)} signature Signature\r\n * @param {(CryptoOperationData|TypedArray)} data Data\r\n * @returns {boolean} Signature verified = true\r\n */\r\nfunction verify(publicKey, signature, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n\r\n    // Stage 1\r\n    var q = this.q;\r\n    var r, s;\r\n    // Ready int for SignalCom algorithm\r\n    if (this.procreator === 'SC') {\r\n        r = htobi(signature.r);\r\n        s = htobi(signature.s);\r\n    } else {\r\n        if (this.procreator === 'CP' || this.procreator === 'VN')\r\n            signature = swap(signature);\r\n        var zetta = to2(signature);\r\n        // Swap bytes for CryptoPro algorithm\r\n        s = zetta[1]; //  first 32 octets contain the big-endian representation of s\r\n        r = zetta[0]; //  and second 32 octets contain the big-endian representation of r\r\n    }\r\n    if (compare(r, q) >= 0 || compare(s, q) >= 0)\r\n        return false;\r\n    // Stage 2\r\n    var b = buffer(data);\r\n    var alpha = atobi(hash.call(this, b));\r\n    // Stage 3\r\n    var e = mod(alpha, q);\r\n    if (isZero(e) === 0)\r\n        e = ONE;\r\n    // Stage 4\r\n    var v = invMod(e, q);\r\n    // Stage 5\r\n    var z1 = mod(mul(s, v), q);\r\n    var z2 = sub(q, mod(mul(r, v), q));\r\n    // Stage 6\r\n    if (this.curve) {\r\n        // Gost R 34.10-2001 || Gost R 34.10-2012\r\n        var k2 = to2(publicKey),\r\n          curve = this.curve,\r\n          P = this.P,\r\n          x = newFE(curve, k2[0]), // first 32 octets contain the little-endian representation of x\r\n          y = newFE(curve, k2[1]), // and second 32 octets contain the little-endian representation of y.\r\n          Q = new newEC(curve, x, y); // This corresponds to the binary representation of (<y>256||<x>256)\r\n        var C = mulTwoEC(P, z1, Q, z2);\r\n        var R = mod(getX(C), q);\r\n    } else {\r\n        // Gost R 34.10-94\r\n        var p = this.p, a = this.a;\r\n        var y = atobi(publicKey);\r\n        var R = mod(mod(mul(expMod(a, z1, p), expMod(y, z2, p)), p), q);\r\n    }\r\n    // Stage 7\r\n    return (compare(R, r) === 0);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * The generateKey method returns a new generated key pair using the specified\r\n * AlgorithmIdentifier.\r\n *\r\n * @memberOf GostSign\r\n * @method generateKey\r\n * @instance\r\n * @returns {Object} Object with two CryptoOperationData members: privateKey and publicKey\r\n */\r\nfunction generateKey() // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var curve = this.curve;\r\n    if (curve) {\r\n\r\n        var Q = curve.infinity;\r\n        while (isInfinity(Q)) {\r\n\r\n            // Generate random private key\r\n            var d = ZERO;\r\n            if (this.ukm) {\r\n                d = atobi(this.ukm);\r\n            } else {\r\n                while (isZero(d))\r\n                    d = mod(atobi(getSeed(this.bitLength)), this.q); // 0 < d < q\r\n            }\r\n\r\n            // Calculate public key\r\n            Q = mulEC(this.P, d);\r\n            var x = getX(Q), y = getY(Q);\r\n            // console.log('d', bitoh(d));\r\n            // console.log('x', bitoh(x));\r\n            // console.log('y', bitoh(y));\r\n        }\r\n\r\n        // Return result\r\n        return {\r\n            privateKey: bitoa(d, this.bitLength),\r\n            publicKey: from2(x, y, this.bitLength) // This corresponds to the binary representation of (<y>256||<x>256)\r\n        };\r\n\r\n    } else\r\n        throw new NotSupportedError('Key generation for GOST R 34.10-94 not supported');\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10 mode MASK<br><br>\r\n *\r\n * The generateMaskKey method returns a new generated key mask using for wrapping.\r\n *\r\n * @memberOf GostSign\r\n * @method generateMaskKey\r\n * @instance\r\n * @returns {Object} Object with two CryptoOperationData members: privateKey and publicKey\r\n */\r\nfunction generateMaskKey() // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var curve = this.curve;\r\n    if (curve) {\r\n        // Generate random private key\r\n        var d = ZERO;\r\n        while (isZero(d))\r\n            d = mod(atobi(getSeed(this.bitLength)), this.q); // 0 < d < q\r\n\r\n        // Return result\r\n        return bitoa(d, this.bitLength);\r\n    } else\r\n        throw new NotSupportedError('Key generation for GOST R 34.10-94 not supported');\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * Unwrap private key from private key and ukm (mask)\r\n *\r\n * @memberOf GostSign\r\n * @method unwrap\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} baseKey Unwrapping key\r\n * @param {(CryptoOperationData|TypedArray)} data Wrapped key\r\n * @returns {Object} CryptoOperationData unwrapped privateKey\r\n */\r\nfunction unwrapKey(baseKey, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var curve = this.curve;\r\n    if (curve) {\r\n        var q = this.q;\r\n        var x = mod(atobi(buffer(data)), q);\r\n        var y = mod(atobi(buffer(baseKey)), q);\r\n        var z = this.procreator === 'VN' ? mod(mul(x, y), q) : mod(mul(x, invMod(y, q)), q);\r\n        return bitoa(z);\r\n    } else\r\n        throw new NotSupportedError('Key wrapping GOST R 34.10-94 not supported');\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * Wrap private key with private key and ukm (mask)\r\n *\r\n * @memberOf GostSign\r\n * @method unwrap\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} baseKey Wrapping key\r\n * @param {(CryptoOperationData|TypedArray)} data Key\r\n * @returns {Object} CryptoOperationData unwrapped privateKey\r\n */\r\nfunction wrapKey(baseKey, data) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var curve = this.curve;\r\n    if (curve) {\r\n        var q = this.q;\r\n        var x = mod(atobi(buffer(data)), q);\r\n        var y = mod(atobi(buffer(baseKey)), q);\r\n        var z = this.procreator === 'VN' ? mod(mul(x, invMod(y, q)), q) : mod(mul(x, y), q);\r\n        return bitoa(z);\r\n    } else\r\n        throw new NotSupportedError('Key wrapping GOST R 34.10-94 not supported');\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * @memberOf GostSign\r\n * @method derive\r\n * @instance\r\n * @private\r\n * @param {CryptoOperationData} baseKey Key for deriviation\r\n * @returns {CryptoOperationData}\r\n */\r\nfunction derive(baseKey) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n\r\n    var k, ukm = atobi(this.ukm);\r\n    var q = this.q;\r\n    var x = mod(atobi(buffer(baseKey)), q);\r\n\r\n    if (this.curve) {\r\n        // 1) Let K(x,y,UKM) = ((UKM*x)(mod q)) . (y.P) (512 bit), where\r\n        // x - senders private key (256 bit)\r\n        // x.P - senders public key (512 bit)\r\n        // y - recipients private key (256 bit)\r\n        // y.P - recipients public key (512 bit)\r\n        // UKM - non-zero integer, produced as in step 2 p. 6.1 [GOSTR341001]\r\n        // P - base point on the elliptic curve (two 256-bit coordinates)\r\n        // UKM*x - x multiplied by UKM as integers\r\n        // x.P - a multiple point\r\n        var K = mulEC(this.peer_Q, mod(mul(ukm, x), q));\r\n        k = from2(getX(K), getY(K), // This corresponds to the binary representation of (<y>256||<x>256)\r\n          this.bitLength);\r\n    } else {\r\n        // 1) Let K(x,y) = a^(x*y) (mod p), where\r\n        // x - senders private key, a^x - senders public key\r\n        // y - recipients private key, a^y - recipients public key\r\n        // a, p - parameters\r\n        var p = this.p, a = this.a;\r\n        k = bitoa(expMod(this.peer_y, x, p));\r\n    }\r\n    // 2) Calculate a 256-bit hash of K(x,y,UKM):\r\n    // KEK(x,y,UKM) = gostSign (K(x,y,UKM)\r\n    return hash.call(this, k);\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * The deriveBits method returns length bits on baseKey.\r\n *\r\n * @memberOf GostSign\r\n * @method deriveBits\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} baseKey Key for deriviation\r\n * @param {number} length output bit-length\r\n * @returns {CryptoOperationData} result\r\n */\r\nfunction deriveBits(baseKey, length) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    if (length < 8 || length > this.bitLength || length % 8 > 0)\r\n        throw new DataError('Length must be no more than ' + this.bitLength + ' bits and multiple of 8');\r\n    var n = length / 8,\r\n      b = derive.call(this, baseKey),\r\n      r = new Uint8Array(n);\r\n\r\n    r.set(new Uint8Array(b, 0, n));\r\n    return r.buffer;\r\n} // </editor-fold>\r\n\r\n/**\r\n * Algorithm name GOST R 34.10<br><br>\r\n *\r\n * The deriveKey method returns 256 bit Key encryption key on baseKey.\r\n *\r\n * This algorithm creates a key encryption key (KEK) using 64 bit UKM,\r\n * the senders private key, and the recipients public key (or the\r\n * reverse of the latter pair\r\n *\r\n * @memberOf GostSign\r\n * @method deriveKey\r\n * @instance\r\n * @param {(CryptoOperationData|TypedArray)} baseKey Key for deriviation\r\n * @returns {CryptoOperationData} result\r\n */\r\nfunction deriveKey(baseKey) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    var b = derive.call(this, baseKey),\r\n      r = new Uint8Array(32);\r\n\r\n    r.set(new Uint8Array(b, 0, 32));\r\n    return r.buffer;\r\n} // </editor-fold>\r\n\r\n\r\n/**\r\n * Gost R 34.10 universal object<br><br>\r\n *\r\n * References: {@link http://tools.ietf.org/html/rfc6986} and {@link http://tools.ietf.org/html/rfc5831}<br><br>\r\n *\r\n * Normalized algorithm identifier common parameters:\r\n *\r\n *  <ul>\r\n *      <li><b>name</b> Algorithm name 'GOST R 34.10'</li>\r\n *      <li><b>version</b> Algorithm version\r\n *          <ul>\r\n *              <li><b>1994</b> - Old-style GOST R 34.10-94 ExpMod algorithm with GOST R 34.11-94 hash</li>\r\n *              <li><b>2001</b> - GOST R 34.10-2001 Eliptic curve algorithm with old GOST R 34.11-94 hash</li>\r\n *              <li><b>2012</b> - GOST R 34.10-2012 Eliptic curve algorithm with GOST R 34.11-12 hash, default mode</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>length</b> Length of hash and signature. Key length == hash length for EC algorithms and 2 * hash length for ExpMod algorithm\r\n *          <ul>\r\n *              <li><b>GOST R 34.10-256</b> - 256 bits digest, default mode</li>\r\n *              <li><b>GOST R 34.10-512</b> - 512 bits digest only for GOST R 34.11-2012 hash</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>mode</b> Algorithm mode\r\n *          <ul>\r\n *              <li><b>SIGN</b> Digital signature mode (default)</li>\r\n *              <li><b>DH</b> Diffie-Hellman key generation and key agreement mode</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li><b>sBox</b> Paramset sBox for GOST 34.11-94. Used only if version = 1994 or 2001</li>\r\n *  </ul>\r\n *\r\n * Supported algorithms, modes and parameters:\r\n *\r\n *  <ul>\r\n *      <li>Sign/Verify mode (SIGN)</li>\r\n *      <li>DeriveKey/DeriveBits mode (DH)\r\n *          <ul>\r\n *              <li>{@link CryptoOperationData} <b>ukm</b> User key material. Default - random generated value</li>\r\n *              <li>{@link CryptoOperationData} <b>public</b> The peer's EC public key data</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>GenerateKey mode (SIGN and DH) version = 1994\r\n *          <ul>\r\n *              <li><b>namedParam</b> Paramset for key generation algorithm. If specified no additianal parameters required</li>\r\n *          </ul>\r\n *          Additional parameters, if namedParam not specified\r\n *          <ul>\r\n *              <li><b>modulusLength</b> Bit length of p (512 or 1024 bits). Default = 1024</li>\r\n *              <li><b>p</b> {@link CryptoOperationData} Modulus, prime number, 2^(t-1)<p<2^t</li>\r\n *              <li><b>q</b> {@link CryptoOperationData} Order of cyclic group, prime number, 2^254<q<2^256, q is a factor of p-1</li>\r\n *              <li><b>a</b> {@link CryptoOperationData} Generator, integer, 1<a<p-1, at that aq (mod p) = 1</li>\r\n *          </ul>\r\n *      </li>\r\n *      <li>GenerateKey mode (SIGN and DH) version = 2001 or 2012\r\n *          <ul>\r\n *              <li><b>namedCurve</b> Paramset for key generation algorithm. If specified no additianal parameters required</li>\r\n *          </ul>\r\n *          Additional EC parameters, if namedCurve not specified\r\n *          <ul>\r\n *              <li><b>p</b> {@link CryptoOperationData} Prime number - elliptic curve modulus</li>\r\n *              <li><b>a</b> {@link CryptoOperationData} Coefficients a of the elliptic curve E</li>\r\n *              <li><b>b</b> {@link CryptoOperationData} Coefficients b of the elliptic curve E</li>\r\n *              <li><b>q</b> {@link CryptoOperationData} Prime number - order of cyclic group</li>\r\n *              <li><b>x</b> {@link CryptoOperationData} Base point p x-coordinate</li>\r\n *              <li><b>y</b> {@link CryptoOperationData} Base point p y-coordinate</li>\r\n *          </ul>\r\n *      </li>\r\n *  </ul>\r\n *\r\n * @class GostSign\r\n * @param {AlgorithmIndentifier} algorithm\r\n */\r\nexport function GostSign(algorithm) // <editor-fold defaultstate=\"collapsed\">\r\n{\r\n    algorithm = algorithm || {};\r\n    this.name = (algorithm.name || 'GOST R 34.10') + '-' +\r\n      ((algorithm.version || 2012) % 100) + '-' + (algorithm.length || 256) +\r\n      (((algorithm.mode || 'SIGN') !== 'SIGN') ? '-' + algorithm.mode : '') +\r\n      (typeof algorithm.namedParam === 'string' ? '/' + algorithm.namedParam : '') +\r\n      (typeof algorithm.namedCurve === 'string' ? '/' + algorithm.namedCurve : '') +\r\n      (typeof algorithm.sBox === 'string' ? '/' + algorithm.sBox : '');\r\n\r\n    var version = algorithm.version || 2012;\r\n\r\n    // Functions\r\n    switch (algorithm.mode || 'SIGN') {\r\n        case 'SIGN':\r\n            this.sign = sign;\r\n            this.verify = verify;\r\n            this.generateKey = generateKey;\r\n            break;\r\n        case 'DH':\r\n            this.deriveBits = deriveBits;\r\n            this.deriveKey = deriveKey;\r\n            this.generateKey = generateKey;\r\n            break;\r\n        case 'MASK':\r\n            this.wrapKey = wrapKey;\r\n            this.unwrapKey = unwrapKey;\r\n            this.generateKey = generateMaskKey;\r\n            break;\r\n    }\r\n\r\n    // Define parameters\r\n    if (version === 1994) {\r\n        // Named or parameters algorithm\r\n        var param = algorithm.param;\r\n        if (!param)\r\n            param = GostParams[this.namedParam = (algorithm.namedParam || 'S-A').toUpperCase()];\r\n        this.modulusLength = algorithm.modulusLength || param.modulusLength || 1024;\r\n        this.p = htobi(param.p);\r\n        this.q = htobi(param.q);\r\n        this.a = htobi(param.a);\r\n        // Public key for derive\r\n        if (algorithm['public'])\r\n            this.peer_y = atobi(algorithm['public']);\r\n    } else {\r\n        // Named or parameters algorithm\r\n        var param = algorithm.curve;\r\n        if (!param)\r\n            param = ECGostParams[this.namedCurve = (algorithm.namedCurve || 'S-256-A').toUpperCase()];\r\n        var curve = this.curve = newCurve(htobi(param.p), htobi(param.a), htobi(param.b));\r\n        this.P = newEC(curve,\r\n          newFE(curve, htobi(param.x)),\r\n          newFE(curve, htobi(param.y)));\r\n        this.q = htobi(param.q);\r\n        // Public key for derive\r\n        if (algorithm['public']) {\r\n            var k2 = to2(algorithm['public']);\r\n            this.peer_Q = new newEC(this.curve, // This corresponds to the binary representation of (<y>256||<x>256)\r\n              newFE(this.curve, k2[0]), // first 32 octets contain the little-endian representation of x\r\n              newFE(this.curve, k2[1])); // and second 32 octets contain the little-endian representation of y.\r\n        }\r\n    }\r\n\r\n    // Check bit length\r\n    var hashLen, keyLen;\r\n    if (this.curve) {\r\n        keyLen = algorithm.length || bitLength(this.q);\r\n        if (keyLen > 508 && keyLen <= 512)\r\n            keyLen = 512;\r\n        else if (keyLen > 254 && keyLen <= 256)\r\n            keyLen = 256;\r\n        else\r\n            throw new NotSupportedError('Support keys only 256 or 512 bits length');\r\n        hashLen = keyLen;\r\n    } else {\r\n        keyLen = algorithm.modulusLength || bitLength(this.p);\r\n        if (keyLen > 1016 && keyLen <= 1024)\r\n            keyLen = 1024;\r\n        else if (keyLen > 508 && keyLen <= 512)\r\n            keyLen = 512;\r\n        else\r\n            throw new NotSupportedError('Support keys only 512 or 1024 bits length');\r\n        hashLen = 256;\r\n    }\r\n    this.bitLength = hashLen;\r\n    this.keyLength = keyLen;\r\n\r\n    // Algorithm proceator for result conversion\r\n    this.procreator = algorithm.procreator;\r\n\r\n    // Hash function definition\r\n    var hash = algorithm.hash;\r\n    if (hash) {\r\n        if (typeof hash === 'string' || hash instanceof String)\r\n            hash = { name: hash };\r\n        if (algorithm.version === 1994 || algorithm.version === 2001) {\r\n            hash.version = 1994;\r\n            hash.length = 256;\r\n            hash.sBox = algorithm.sBox || hash.sBox;\r\n        } else {\r\n            hash.version = 2012;\r\n            hash.length = hashLen;\r\n        }\r\n        hash.procreator = hash.procreator || algorithm.procreator;\r\n\r\n        this.hash = new GostDigest(hash);\r\n    }\r\n\r\n    // Pregenerated seed for key exchange algorithms\r\n    if (algorithm.ukm) // Now don't check size\r\n        this.ukm = algorithm.ukm;\r\n\r\n} // </editor-fold>\r\n\r\n\r\n","module.exports = require(\"crypto\");","/**\r\n * Copyright (c) 2014, Rudolf Nickolaev.\r\n * All rights reserved.\r\n *\r\n * Tests for GOST 34.12 signature.\r\n *\r\n */\r\n\r\nimport { GostCoding } from '../src/crypto/gostCoding';\r\nimport { GostSign } from '../src/engine/gostSign';\r\n\r\nconst gostCoding = new GostCoding();\r\n\r\n/* ========== Tests ========== */\r\n\r\nfunction println(s, h) {\r\n    if (typeof importScripts !== 'undefined') {\r\n        var tag = h ? 'h3' : 'span';\r\n        if (typeof postMessage !== 'undefined') {\r\n            postMessage({ log: '<' + tag + '>' + (s || '&nbsp') + '</' + tag + '>' });\r\n        } else {\r\n            console.log(s, h);\r\n        }\r\n    } else {\r\n        if (typeof document !== 'undefined') {\r\n            var el = document.createElement(h ? 'h3' : 'div');\r\n            el.innerHTML = s || '&nbsp';\r\n            (document.getElementById('output') || document.body).appendChild(el);\r\n        }\r\n        if (typeof console !== 'undefined')\r\n            console.log((s || '') + (h ? '' : '\\n'));\r\n    }\r\n}\r\n\r\nfunction perform(id, algorithm, message, privateKey, publicKey, output) {\r\n    var Hex = gostCoding.Hex;\r\n    if (algorithm.ukm)\r\n        (algorithm.ukm = Hex.decode(algorithm.ukm, true));\r\n    else\r\n        output = false;\r\n\r\n    var cipher = new GostSign(algorithm);\r\n    var result = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    var data = typeof message === 'string' ? Hex.decode(message, true) : message;\r\n\r\n    if (!privateKey) {\r\n        var keyPair = cipher.generateKey();\r\n        privateKey = keyPair.privateKey;\r\n        publicKey = keyPair.publicKey;\r\n        output = false;\r\n    } else {\r\n        privateKey = Hex.decode(privateKey, true);\r\n        publicKey = Hex.decode(publicKey, true);\r\n    }\r\n\r\n    try {\r\n        var start, signed, verified;\r\n        start = (new Date).getTime();\r\n        var out = Hex.encode(cipher.sign(privateKey, data), true);\r\n        var test = 0 + (output && out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== output.toLowerCase());\r\n        if (!test) {\r\n            signed = (new Date).getTime();\r\n            test = 0 + (!cipher.verify(publicKey, Hex.decode(out, true), data));\r\n            verified = (new Date).getTime();\r\n            if (!test)\r\n                result += 'PASSED Sign ' + (signed - start) / 1000 + ' sec, Verify ' + (verified - signed) / 1000 + ' sec';\r\n            else\r\n                result += 'FAILED - Verify return (false)';\r\n        } else\r\n            result += 'FAILED - Sign expected ' + output.toLowerCase() + \" got \" + out.toLowerCase();\r\n    } catch (e) {\r\n        result += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n\r\n    println(result);\r\n    return test;\r\n}\r\n\r\nfunction performDerive(id, algorithm) {\r\n    var ukm = algorithm.ukm;\r\n    delete algorithm.ukm;\r\n    var cipher = new GostSign(algorithm);\r\n    var result = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    var keyPair1 = cipher.generateKey(),\r\n      keyPair2 = cipher.generateKey(),\r\n      privateKey1 = keyPair1.privateKey,\r\n      publicKey1 = keyPair1.publicKey,\r\n      privateKey2 = keyPair2.privateKey,\r\n      publicKey2 = keyPair2.publicKey;\r\n\r\n    try {\r\n        if (ukm)\r\n            (algorithm.ukm = gostCoding.Hex.decode(ukm));\r\n\r\n        var start = (new Date).getTime();\r\n        algorithm.public = publicKey2;\r\n        cipher = new GostSign(algorithm);\r\n        var kek1 = gostCoding.Hex.encode(cipher.deriveKey(privateKey1));\r\n        var finish = (new Date).getTime();\r\n\r\n        algorithm.public = publicKey1;\r\n        cipher = new GostSign(algorithm);\r\n        var kek2 = gostCoding.Hex.encode(cipher.deriveKey(privateKey2));\r\n\r\n        var test = 0 + (kek1 !== kek2);\r\n        if (!test)\r\n            result += 'PASSED DeriveKey ' + (finish - start) / 1000 + ' sec';\r\n        else\r\n            result += 'PASSED DeriveKey - one side got ' + kek1 + ' but other side got ' + kek2;\r\n    } catch (e) {\r\n        result += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n    println(result);\r\n    return test;\r\n}\r\n\r\nexport default function () {\r\n    // GOST R 34.10 tests\r\n    var tests = 0, i = 0;\r\n    println('GOST R 34.10-94 TEST', true);\r\n\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.10',\r\n          version: 1994,\r\n          namedParam: 'S-TEST',\r\n          ukm: '90F3A564439242F5186EBB224C8E223811B7105C64E4F5390807E6362DF4C72A',\r\n      }, '3534454132454236443134453437313943363345374143423445413631454230',\r\n      '3036314538303830343630454235324435324234314132373832433138443046',\r\n      'ee1902a40692d273edc1b5adc55f91128e35f9d165fa9901caf00d27018ba6df324519c11a6e272526589cd6e6a2eddaafe1c3081259be9fcee667a2701f4352',\r\n      '3F0DD5D4400D47C08E4CE505FF7434B6DBF729592E37C74856DAB85115A609553E5F895E276D81D2D52C0763270A458157B784C57ABDBD807BC44FD43A32AC06');\r\n\r\n    println();\r\n    println('TOTAL ' + (tests ? tests + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    var tests2 = 0;\r\n    i = 0;\r\n    println('GOST R 34.10-2012 TEST', true);\r\n\r\n    tests2 += perform(++i, {\r\n          name: 'GOST R 34.10',\r\n          namedCurve: 'S-256-TEST',\r\n          ukm: '77105C9B20BCD3122823C8CF6FCC7B956DE33814E95B7FE64FED924594DCEAB3',\r\n      }, '2DFBC1B372D89A1188C09C52E0EEC61FCE52032AB1022E8E67ECE6672B043EE5',\r\n      '7A929ADE789BB9BE10ED359DD39A72C11B60961F49397EEE1D19CE9891EC3B28',\r\n      '26F1B489D6701DD185C8413A977B3CBBAF64D1C593D26627DFFB101A87FF77DA7F2B49E270DB6D90D8595BEC458B50C58585BA1D4E9B788F6689DBD8E56FD80B',\r\n      '01456C64BA4642A1653C235A98A60249BCD6D3F746B631DF928014F6C5BF9C4041AA28D2F1AB148280CD9ED56FEDA41974053554A42767B83AD043FD39DC0493');\r\n\r\n    tests2 += perform(++i, {\r\n          name: 'GOST R 34.10',\r\n          namedCurve: 'T-512-TEST',\r\n          ukm: '359E7F4B1410FEACC570456C6801496946312120B39D019D455986E364F365886748ED7A44B3E794434006011842286212273A6D14CF70EA3AF71BB1AE679F1',\r\n      }, '3754F3CFACC9E0615C4F4A7C4D8DAB531B09B6F9C170C533A71D147035B0C5917184EE536593F4414339976C647C5D5A407ADEDB1D560C4FC6777D2972075B8C',\r\n      'BA6048AADAE241BA40936D47756D7C93091A0E8514669700EE7508E508B102072E8123B2200A0563322DAD2827E2714A2636B7BFD18AADFC62967821FA18DD4',\r\n      '37C7C90CD40B0F5621DC3AC1B751CFA0E2634FA0503B3D52639F5D7FB72AFD61EA199441D943FFE7F0C70A2759A3CDB84C114E1F9339FDF27F35ECA93677BEEC115DC5BC96760C7B48598D8AB9E740D4C4A85A65BE33C1815B5C320C854621DD5A515856D13314AF69BC5B924C8B4DDFF75C45415C1D9DD9DD33612CD530EFE1',\r\n      '1081B394696FFE8E6585E7A9362D26B6325F56778AADBC081C0BFBE933D52FF5823CE288E8C4F362526080DF7F70CE406A6EEB1F56919CB92A9853BDE73E5B4A2F86FA60A081091A23DD795E1E3C689EE512A3C82EE0DCC2643C78EEA8FCACD35492558486B20F1C9EC197C90699850260C93BCBCD9C5C3317E19344E173AE36');\r\n\r\n    // Free random generator\r\n    tests2 += perform(++i, {\r\n          name: 'GOST R 34.10',\r\n          namedCurve: 'S-256-TEST',\r\n      }, '2DFBC1B372D89A1188C09C52E0EEC61FCE52032AB1022E8E67ECE6672B043EE5',\r\n      '7A929ADE789BB9BE10ED359DD39A72C11B60961F49397EEE1D19CE9891EC3B28',\r\n      '26F1B489D6701DD185C8413A977B3CBBAF64D1C593D26627DFFB101A87FF77DA7F2B49E270DB6D90D8595BEC458B50C58585BA1D4E9B788F6689DBD8E56FD80B');\r\n\r\n    // Free key & random generator\r\n    tests2 += perform(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'S-256-TEST',\r\n    }, '2DFBC1B372D89A1188C09C52E0EEC61FCE52032AB1022E8E67ECE6672B043EE5');\r\n\r\n    // GostDigest-94-with-Gost-3410-2001\r\n    tests2 += perform(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'S-256-TEST',\r\n        hash: {\r\n            name: 'GOST R 34.11',\r\n            version: 1994\r\n        }\r\n    }, gostCoding.Chars.decode('Suppose the original message has length = 50 bytes'));\r\n\r\n    // GostDigest-2012-with-Gost-3410-2012\r\n    tests2 += perform(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'T-512-TEST',\r\n        hash: {\r\n            name: 'GOST R 34.11'\r\n        }\r\n    }, gostCoding.Chars.decode(' ,  ,        '));\r\n\r\n    // Derive key\r\n    println();\r\n    println('Key exchange scenario');\r\n    performDerive(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'S-256-TEST',\r\n        mode: 'DH',\r\n        ukm: '77105C9B20BCD312'\r\n    });\r\n    performDerive(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'X-256-A',\r\n        mode: 'DH',\r\n        ukm: '77105C9B20BCD312',\r\n        hash: {\r\n            name: 'GOST R 34.11'\r\n        }\r\n    });\r\n    performDerive(++i, {\r\n        name: 'GOST R 34.10',\r\n        namedCurve: 'X-256-A',\r\n        mode: 'DH',\r\n        ukm: '77105C9B20BCD312',\r\n        hash: {\r\n            name: 'GOST R 34.11',\r\n            version: 1994\r\n        }\r\n    });\r\n\r\n    println();\r\n\r\n    println('TOTAL ' + (tests2 ? tests2 + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    return tests + tests2;\r\n};\r\n\r\n\r\nvar pk = '34BF9806FD77DF19F2BD0E3085FF53C1E18C3B58A0CD82BDA7466D9CC259FA23';\r\nvar maskdb = '5d6f4f794c0f584718252fb2d9ffffe6d2adc4c86616466fe032ed28790e6af6';\r\nvar mkdb = '\\\r\n2208cd6bc96a009f05175f635bee6cc09c78260b9b7eee1e070d346462e6881b\\\r\nbf572f436df5716b1212a9fba3d022db4aed0a18530ae6c62d9bdd206479805c\\\r\ne652c17bc9cc07dcdce25cba19276285f6c54dfa940ab55473bde2d8338eaaed\\\r\nc59cdd808619f75296db91e016b588c0650686ff6929258a76d5ca7ba91b7fa8\\\r\n7f41b2deb535a66b489a5485ac68971e00658836ce358dcda04b358621ebf08c\\\r\ne062b671d84a30706495ee2ed7d0f0a6a3e171a9daba04b582c3b7113905053a\\\r\n5b9254c7e08bea27cb66e19699db55444f1e1f1b5a3b7db7cbcc04728e225e67\\\r\nab8099dc82b1';\r\nvar kek = '7c34bf4e03d0bc120768164f355cf6180b32851e2ad6fc22b386bbea17fa1d5f1789eb95';\r\n\r\n//var sign0 = 'EE92016C722C08F2FED0310E7D1C8D4EFD7224F52E53C3499E8A5392A2F41D04575BE6077F8E4008B3C3CCEC2EAC3BEC0AA0AA2AF6EFCB1D3906F2426D0394C2';\r\n//var pubkey =  '51cd2d8d96c67e0cf1ee74319cf89043c5f30ba34b68c8fc2284b5ef9e574eea0783c50ea37a2d3f2e222c038980ab0a182fe38945911e9513dfa6b1e87df63a';\r\n\r\nvar sign0 = '575BE6077F8E4008B3C3CCEC2EAC3BEC0AA0AA2AF6EFCB1D3906F2426D0394C2EE92016C722C08F2FED0310E7D1C8D4EFD7224F52E53C3499E8A5392A2F41D04';\r\nvar pubkey = '0783c50ea37a2d3f2e222c038980ab0a182fe38945911e9513dfa6b1e87df63a51cd2d8d96c67e0cf1ee74319cf89043c5f30ba34b68c8fc2284b5ef9e574eea';\r\n\r\n","/**\r\n * Copyright (c) 2014, Rudolf Nickolaev.\r\n * All rights reserved.\r\n *\r\n * Tests for GOST R 34.11-2012 hash function with 512/256 bits digest.\r\n *\r\n */\r\n\r\nimport { GostCoding } from '../src/crypto/gostCoding';\r\nimport { GostDigest } from '../src/engine/gostDigest';\r\n\r\nconst gostCoding = new GostCoding();\r\n\r\n/* ========== Tests ========== */\r\n\r\nfunction println(s, h) {\r\n    if (typeof importScripts !== 'undefined') {\r\n        var tag = h ? 'h3' : 'div';\r\n        if (typeof postMessage !== 'undefined') {\r\n            postMessage({ log: '<' + tag + '>' + (s || '&nbsp') + '</' + tag + '>' });\r\n        } else {\r\n            console.log(s, h);\r\n        }\r\n\r\n    } else {\r\n        if (typeof document !== 'undefined') {\r\n            var el = document.createElement(h ? 'h3' : 'div');\r\n            el.innerHTML = s || '&nbsp';\r\n            (document.getElementById('output') || document.body).appendChild(el);\r\n        }\r\n        if (typeof console !== 'undefined')\r\n            console.log((s || '') + (h ? '' : '\\n'));\r\n    }\r\n}\r\n\r\nfunction perform(cipher, id, array, digest, method, param) {\r\n    var start, finish, out, r, test;\r\n\r\n    start = (new Date).getTime();\r\n    r = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    try {\r\n        method = method || 'digest';\r\n        out = gostCoding.Hex.encode(cipher[method](array, param));\r\n        finish = (new Date).getTime();\r\n        out = out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase();\r\n        test = 0 + (out !== digest.toLowerCase());\r\n        if (test)\r\n            r += 'FAILED: Expected ' + digest + \" got \" + out;\r\n        else\r\n            r += 'PASSED ' + (finish - start) / 1000 + ' sec';\r\n    } catch (e) {\r\n        r += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n\r\n    println(r);\r\n    return test;\r\n}\r\n\r\nexport default function (performance) {\r\n    // GOST R 34.11-94 tests\r\n    var tests = 0, i = 0;\r\n    println('GOST R 34.11-94 TEST', true);\r\n\r\n    var cipher = new GostDigest({ name: 'GOST R 34.11', version: 1994 });\r\n\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode(''),\r\n      '981e5f3ca30c841487830f84fb433e13ac1101569b9c13584ac483234cd656c0');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('This is message, length=32 bytes'),\r\n      '2cefc2f7b7bdc514e18ea57fa74ff357e7fa17d652c75f69cb1be7893ede48eb');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('Suppose the original message has length = 50 bytes'),\r\n      'c3730c5cbccacf915ac292676f21e8bd4ef75331d9405e5f1a61dc3130a65011');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'),\r\n      '73b70a39497de53a6e08c67b6d4db853540f03e9389299d9b0156ef7e85d0f61');\r\n    println();\r\n\r\n    cipher = new GostDigest({ name: 'GOST R 34.11', version: 1994, sBox: 'D-TEST' });\r\n\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode(''),\r\n      'ce85b99cc46752fffee35cab9a7b0278abb4c2d2055cff685af4912c49490f8d');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('This is message, length=32 bytes'),\r\n      'b1c466d37519b82e8319819ff32595e047a28cb6f83eff1c6916a815a637fffa');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('Suppose the original message has length = 50 bytes'),\r\n      '471aba57a60a770d3a76130635c1fbea4ef14de51f78b4ae57dd893b62f55208');\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'),\r\n      '95c1af627c356496d80274330b2cff6a10c67b5f597087202f94d06d2338cf8e');\r\n    println();\r\n\r\n    println('PBKDF2 tests');\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        version: 1994,\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 1\r\n    });\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('password'),\r\n      '7314e7c04fb2e662c543674253f68bd0b73445d07f241bed872882da21662d58', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        version: 1994,\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 2\r\n    });\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('password'),\r\n      '990dfa2bd965639ba48b07b792775df79f2db34fef25f274378872fed7ed1bb3', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        version: 1994,\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 1000\r\n    });\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('password'),\r\n      '2b6e0a5cc2103274dd3353fb86e4983c6451f8025a51cd9ddfd33361c6cb572b', 'deriveKey');\r\n    println();\r\n\r\n    if (performance) {\r\n\r\n        println('PBKDF2 4096 iterations tests');\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            version: 1994,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('salt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('password'),\r\n          '1f1829a94bdff5be10d0aeb36af498e7a97467f3b31116a5a7c1afff9deadafe', 'deriveKey');\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            version: 1994,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('saltSALTsaltSALTsaltSALTsaltSALTsalt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('passwordPASSWORDpassword'),\r\n          '788358c69cb2dbe251a7bb17d5f4241f265a792a35becde8d56f326b49c85047b7638acb4764b1fd', 'deriveBits', 320);\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            version: 1994,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('sa\\0lt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('pass\\0word'),\r\n          '43e06c5590b08c0225242373127edf9c8e9c3291', 'deriveBits', 160);\r\n\r\n        println();\r\n\r\n\r\n        cipher = new GostDigest({ name: 'GOST R 34.11', version: 1994 });\r\n        println('Million \"a\" TEST');\r\n        var million_a = new Array(1000001).join('a');\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode(million_a),\r\n          '8693287aa62f9478f7cb312ec0866b6c4e4a0f11160441e8f4ffcd2715dd554f');\r\n        println();\r\n    }\r\n    println('TOTAL ' + (tests ? tests + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    // GOST R 34.11-2012 tests\r\n    var tests2 = 0;\r\n    i = 0;\r\n    println('GOST R 34.11-2012 TEST', true);\r\n\r\n    cipher = new GostDigest();\r\n    tests2 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('012345678901234567890123456789012345678901234567890123456789012'),\r\n      '9d151eefd8590b89daa6ba6cb74af9275dd051026bb149a452fd84e5e57b5500');\r\n    tests2 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode(' ,  ,        '),\r\n      '9dd2fe4e90409e5da87f53976d7405b0c0cac628fc669a741d50063c557e8f50');\r\n    tests2 += perform(cipher, ++i, new Uint8Array(0),\r\n      '3f539a213e97c802cc229d474c6aa32a825a360b2a933a949fd925208d9ce1bb');\r\n    tests2 += perform(cipher, ++i, new Uint8Array([\r\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\r\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),\r\n      'df1fda9ce83191390537358031db2ecaa6aa54cd0eda241dc107105e13636b95');\r\n    println();\r\n\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11', version: 2012, mode: 'KDF', context: gostCoding.Hex.decode('af21434145656378'),\r\n        label: gostCoding.Hex.decode('26bdb878')\r\n    });\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f'),\r\n      'a1aa5f7de402d7b3d323f2991c8d4534013137010a83754fd0af6d7cd4922ed9', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11', version: 2012, mode: 'KDF', context: gostCoding.Hex.decode('af21434145656378'),\r\n        label: gostCoding.Hex.decode('26bdb878')\r\n    });\r\n    tests += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f'),\r\n      '22b6837845c6bef65ea71672b265831086d3c76aebe6dae91cad51d83f79d16b074c9330599d7f8d712fca54392f4ddde93751206b3584c8f43f9e6dc51531f9', 'deriveBits', 512);\r\n    println();\r\n\r\n    println('HMAC/PBKDF2 tests');\r\n    cipher = new GostDigest({ name: 'GOST R 34.11', mode: 'HMAC' });\r\n    tests += perform(cipher, ++i, gostCoding.Hex.decode('000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f'),\r\n      'a1aa5f7de402d7b3d323f2991c8d4534013137010a83754fd0af6d7cd4922ed9', 'sign', gostCoding.Hex.decode('0126bdb87800af214341456563780100'));\r\n    cipher = new GostDigest({ name: 'GOST R 34.11', length: 512, mode: 'HMAC' });\r\n    tests += perform(cipher, ++i, gostCoding.Hex.decode('000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f'),\r\n      'a59bab22ecae19c65fbde6e5f4e9f5d8549d31f037f9df9b905500e171923a773d5f1530f2ed7e964cb2eedc29e9ad2f3afe93b2814f79f5000ffc0366c251e6',\r\n      'sign', gostCoding.Hex.decode('0126bdb87800af214341456563780100'));\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 1000\r\n    });\r\n    tests += perform(cipher, ++i, gostCoding.Chars.decode('password'),\r\n      'c5f66589be62e183038e5dee22ea3d7a32afb314abd9970dc8f66858d1a924f4', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        length: 512,\r\n        procreator: 'VN',\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 1\r\n    });\r\n    tests += perform(cipher, ++i, gostCoding.Chars.decode('password'),\r\n      'bcd19a1c423a63e72e47ef0f56566c726745d96ac1a1c127b2edadb45fb45b307aca15999e91f640f4818f68af716e30fd543c52026bbb295d100eb471339f46', 'deriveBits', 512);\r\n    cipher = new GostDigest({\r\n        name: 'GOST R 34.11',\r\n        length: 512,\r\n        procreator: 'VN',\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 2\r\n    });\r\n    tests += perform(cipher, ++i, gostCoding.Chars.decode('password'),\r\n      '088fec3b0f1ffaf0615eb267de92907fd4e0bb89d2f5ef9d4111a80e3cbf231af07ba3ce96065395f8f1a7505f9781f97e99a26b8314907dbf3510bc3ca2000c', 'deriveBits', 512);\r\n    println();\r\n\r\n    cipher = new GostDigest({ name: 'GOST R 34.11', length: 512 });\r\n\r\n    tests2 += perform(cipher, ++i, gostCoding.Chars.decode('012345678901234567890123456789012345678901234567890123456789012'),\r\n      '1b54d01a4af5b9d5cc3d86d68d285462b19abc2475222f35c085122be4ba1ffa00ad30f8767b3a82384c6574f024c311e2a481332b08ef7f41797891c1646f48');\r\n    tests2 += perform(cipher, ++i, gostCoding.Chars.decode(' ,  ,        '),\r\n      '1e88e62226bfca6f9994f1f2d51569e0daf8475a3b0fe61a5300eee46d961376035fe83549ada2b8620fcd7c496ce5b33f0cb9dddc2b6460143b03dabac9fb28');\r\n    tests2 += perform(cipher, ++i, new Uint8Array(0),\r\n      '8e945da209aa869f0455928529bcae4679e9873ab707b55315f56ceb98bef0a7362f715528356ee83cda5f2aac4c6ad2ba3a715c1bcd81cb8e9f90bf4c1c1a8a');\r\n    tests2 += perform(cipher, ++i, new Uint8Array([\r\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,\r\n          0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]),\r\n      'b0fd29ac1b0df441769ff3fdb8dc564df67721d6ac06fb28ceffb7bbaa7948c6c014ac999235b58cb26fb60fb112a145d7b4ade9ae566bf2611402c552d20db7');\r\n    println();\r\n\r\n    if (performance) {\r\n\r\n        println('PBKDF2 4096 iterations tests');\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('salt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('password'),\r\n          'd744dc35ddfe10c7679af205ceb6492fb3680f861db598ee8110b30e3a0f3cb4', 'deriveKey');\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('saltSALTsaltSALTsaltSALTsaltSALTsalt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('passwordPASSWORDpassword'),\r\n          '8452d34400e6404864f12206a2ac3f932fe7fe55026b1dd8f21a645cf340cbf0cca377e603024e82', 'deriveBits', 320);\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('sa\\0lt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('pass\\0word'),\r\n          '5023f9b3cc41e5aa491ea3e9eb65b6c01ffbeb63', 'deriveBits', 160);\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            length: 512,\r\n            procreator: 'VN',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('salt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i, gostCoding.Chars.decode('password'),\r\n          '596f63971eae970a4eac9c18bff42ec52b936c1ccac6d17caa308afe12d4ff31943180ce02e42956524e991392c4bddeb7077edc1d2abf52eaf72b9e32a8c605', 'deriveBits', 512);\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            length: 512,\r\n            procreator: 'VN',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('saltSALTsaltSALTsaltSALTsaltSALTsalt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i, gostCoding.Chars.decode('passwordPASSWORDpassword'),\r\n          'e457ee6126f07c09be004ba512adc90c611c2b3fa11141c21196dae5a48a50d83ccf163233f014fb6ade71695bf37159e9062443b75dac911fa7a181d24c4ed2a910499d72aba93284c78dbc1acba2789bd8ef50b5052f33ec6e2491f4f74eda05723864', 'deriveBits', 800);\r\n\r\n        cipher = new GostDigest({\r\n            name: 'GOST R 34.11',\r\n            length: 512,\r\n            procreator: 'VN',\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('sa\\0lt'),\r\n            iterations: 4096\r\n        });\r\n        tests += perform(cipher, ++i, gostCoding.Chars.decode('pass\\0word'),\r\n          'eed92e8d76e18d6a632f2da65c9b2859af555c3335ea30095989dea14d9d093114668e329deb034cc1565c3d731de0b5ca11acbdf85ab9eaab15295df05b9805', 'deriveBits', 512);\r\n\r\n        println();\r\n\r\n        cipher = new GostDigest();\r\n        println('Million \"a\" TEST');\r\n        var million_a = gostCoding.Chars.decode(new Array(1000001).join('a'));\r\n        tests += perform(cipher, ++i, million_a,\r\n          '841af1a0b2f92a800fb1b7e4aabc8e48763153c448a0fc57c90ba830e130f152');\r\n        cipher = new GostDigest({ name: 'GOST R 34.11', length: '512' });\r\n        tests += perform(cipher, ++i, million_a,\r\n          'd396a40b126b1f324465bfa7aa159859ab33fac02dcdd4515ad231206396a266d0102367e4c544ef47d2294064e1a25342d0cd25ae3d904b45abb1425ae41095');\r\n        println();\r\n    }\r\n\r\n    println('TOTAL ' + (tests2 ? tests2 + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    // SHA-1 tests\r\n    var tests3 = 0;\r\n    i = 0;\r\n    println('SHA-1 TEST', true);\r\n\r\n    var cipher = new GostDigest({ name: 'SHA', version: 1 });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('abc'),\r\n      'a9993e364706816aba3e25717850C26c9cd0d89d');\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq'),\r\n      '84983e441c3bd26ebaae4aa1f95129e5e54670f1');\r\n\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode(new Array(11).join('0123456701234567012345670123456701234567012345670123456701234567')),\r\n      'dea356a2cddd90c7a7ecedc5ebb563934f460452');\r\n\r\n    println();\r\n\r\n    println('PBKDF2 tests');\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 1\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('password'),\r\n      '0c60c80f961f0e71f3a9b524af6012062fe037a6', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PBKDF2',\r\n        salt: gostCoding.Chars.decode('salt'),\r\n        iterations: 2\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Chars.decode('password'),\r\n      'ea6c014dc72d6f8ccd1ed92ace1d41f0d8de8957', 'deriveKey');\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PFXKDF',\r\n        salt: gostCoding.Hex.decode('0A58CF64530D823F'),\r\n        iterations: 1\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('0073006D006500670000'),\r\n      '8aaae6297b6cb04642ab5b077851284eb7128f1a2a7fbca3', 'deriveBits', 192);\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PFXKDF',\r\n        salt: gostCoding.Hex.decode('0A58CF64530D823F'),\r\n        iterations: 1,\r\n        diversifier: 2\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('0073006D006500670000'),\r\n      '79993dfe048d3b76', 'deriveBits', 64);\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PFXKDF',\r\n        salt: gostCoding.Hex.decode('3D83C0E4546AC140'),\r\n        iterations: 1,\r\n        diversifier: 3\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('0073006D006500670000'),\r\n      '8D967D88F6CAA9D714800AB3D48051D63F73A312', 'deriveBits', 160);\r\n    cipher = new GostDigest({\r\n        name: 'SHA',\r\n        version: 1,\r\n        mode: 'PFXKDF',\r\n        salt: gostCoding.Hex.decode('05DEC959ACFF72F7'),\r\n        iterations: 1000,\r\n        diversifier: 1\r\n    });\r\n    tests3 += perform(cipher, ++i,\r\n      gostCoding.Hex.decode('007100750065006500670000'),\r\n      'ED2034E36328830FF09DF1E1A07DD357185DAC0D4F9EB3D4', 'deriveBits', 192);\r\n    println();\r\n\r\n    if (performance) {\r\n        println('PBKDF2 4096 iterations tests');\r\n        cipher = new GostDigest({\r\n            name: 'SHA',\r\n            version: 1,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('salt'),\r\n            iterations: 4096\r\n        });\r\n        tests3 += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('password'),\r\n          '4b007901b765489abead49d926f721d065a429c1', 'deriveKey');\r\n        cipher = new GostDigest({\r\n            name: 'SHA',\r\n            version: 1,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('saltSALTsaltSALTsaltSALTsaltSALTsalt'),\r\n            iterations: 4096\r\n        });\r\n        tests3 += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('passwordPASSWORDpassword'),\r\n          '3d2eec4fe41c849b80c8d83662c0e44a8b291a964cf2f07038', 'deriveBits', 200);\r\n        cipher = new GostDigest({\r\n            name: 'SHA',\r\n            version: 1,\r\n            mode: 'PBKDF2',\r\n            salt: gostCoding.Chars.decode('sa\\0lt'),\r\n            iterations: 4096\r\n        });\r\n        tests3 += perform(cipher, ++i,\r\n          gostCoding.Chars.decode('pass\\0word'),\r\n          '56fa6aa75548099dcc37d7f03425e0c3', 'deriveBits', 128);\r\n        println();\r\n\r\n        println('Million \"a\" TEST');\r\n        var million_a = new Array(1000001).join('a');\r\n        tests3 += perform(cipher, ++i,\r\n          gostCoding.Chars.decode(million_a),\r\n          '34aa973cd4c4daa4f61eeb2bdbad27316534016f');\r\n        println();\r\n    }\r\n\r\n    println('TOTAL ' + (tests3 ? tests3 + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    return tests + tests2;\r\n};\r\n","/**\r\n * Copyright (c) 2015, Rudolf Nickolaev.\r\n * All rights reserved.\r\n *\r\n * GOST 28147-89 Encryption Algorithm\r\n *\r\n */\r\n\r\nimport { GostCoding } from '../src/crypto/gostCoding';\r\nimport { GostCipher } from '../src/engine/gostCipher';\r\n\r\nconst gostCoding = new GostCoding();\r\n\r\nfunction println(s, h) {\r\n    if (typeof importScripts !== 'undefined') {\r\n        var tag = h ? 'h3' : 'div';\r\n        if (typeof postMessage !== 'undefined') {\r\n            postMessage({ log: '<' + tag + '>' + (s || '&nbsp') + '</' + tag + '>' });\r\n        } else {\r\n            console.log(s, h);\r\n        }\r\n    } else {\r\n        if (typeof document !== 'undefined') {\r\n            var el = document.createElement(h ? 'h3' : 'div');\r\n            el.innerHTML = s || '&nbsp';\r\n            (document.getElementById('output') || document.body).appendChild(el);\r\n        }\r\n        if (typeof console !== 'undefined')\r\n            console.log((s || '') + (h ? '' : '\\n'));\r\n    }\r\n}\r\n\r\nfunction perform(id, algorithm, key, input, output) {\r\n    var Hex = gostCoding.Hex;\r\n    if (algorithm.iv)\r\n        (algorithm.iv = Hex.decode(algorithm.iv));\r\n\r\n    var cipher = new GostCipher(algorithm);\r\n    var result = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    try {\r\n        var out = Hex.encode(cipher.encrypt(Hex.decode(key), Hex.decode(input)));\r\n        var test = 0 + (output && out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== output.toLowerCase());\r\n        if (!test) {\r\n            var out = Hex.encode(cipher.decrypt(Hex.decode(key), Hex.decode(out)));\r\n            test = 0 + (out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== input.toLowerCase());\r\n            if (!test)\r\n                result += 'PASSED';\r\n            else\r\n                result += 'FAILED - Decrypt expected ' + input + \" got \" + out;\r\n        } else\r\n            result += 'FAILED - Encrypt expected ' + output + \" got \" + out;\r\n    } catch (e) {\r\n        result += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n    println(result);\r\n    return test;\r\n}\r\n\r\nfunction performMac(id, algorithm, key, input, output) {\r\n    var Hex = gostCoding.Hex;\r\n    if (algorithm.iv)\r\n        (algorithm.iv = Hex.decode(algorithm.iv));\r\n\r\n    var cipher = new GostCipher(algorithm);\r\n    var result = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    try {\r\n        var out = Hex.encode(cipher.sign(Hex.decode(key), Hex.decode(input)));\r\n        var test = 0 + (output && out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== output.toLowerCase());\r\n        if (!test) {\r\n            var res = cipher.verify(Hex.decode(key), Hex.decode(out), Hex.decode(input));\r\n            test = 0 + (!res);\r\n            if (!test)\r\n                result += 'PASSED';\r\n            else\r\n                result += 'FAILED - Verify return (false)';\r\n        } else\r\n            result += 'FAILED - Sign expected ' + output + \" got \" + out;\r\n    } catch (e) {\r\n        result += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n    println(result);\r\n    return test;\r\n}\r\n\r\nfunction performWrap(id, algorithm, key, input, output) {\r\n    var Hex = gostCoding.Hex;\r\n    if (algorithm.ukm)\r\n        (algorithm.ukm = Hex.decode(algorithm.ukm));\r\n\r\n    var cipher = new GostCipher(algorithm);\r\n    var result = 'Test ' + ' ' + ('0' + id).slice(-2) + ' ' + (cipher.name + ' ' + new Array(61).join('.')).substring(0, 60) + ' ';\r\n    try {\r\n        var out = Hex.encode(cipher.wrapKey(Hex.decode(key), Hex.decode(input)));\r\n        var test = 0 + (output && out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== output.toLowerCase());\r\n        if (!test) {\r\n            var out = Hex.encode(cipher.unwrapKey(Hex.decode(key), Hex.decode(out)));\r\n            test = 0 + (out.replace(/[^\\-A-Fa-f0-9]/g, '').toLowerCase() !== input.toLowerCase());\r\n            if (!test)\r\n                result += 'PASSED';\r\n            else\r\n                result += 'FAILED - Unwrap key expected ' + input + \" got \" + out;\r\n        } else\r\n            result += 'FAILED - Wrap key expected ' + output + \" got \" + out;\r\n    } catch (e) {\r\n        result += 'FAILED - Throw error: ' + e.message;\r\n    }\r\n    println(result);\r\n    return test;\r\n}\r\n\r\n/**\r\n * Test cases\r\n *\r\n * @returns {number} of tests\r\n */\r\nexport default function () {\r\n    var input1 = \"0000000000000000\";\r\n    var output1 = \"1b0bbc32cebcab42\";\r\n    var input2 = \"bc350e71aac5f5c2\";\r\n    var output2 = \"d35ab653493b49f5\";\r\n    var input3 = \"bc350e71aa11345709acde\";\r\n    var output3 = \"8824c124c4fd14301fb1e8\";\r\n    var input4 = \"000102030405060708090a0b0c0d0e0fff0102030405060708090a0b0c0d0e0f\";\r\n    var output4 = \"29b7083e0a6d955ca0ec5b04fdb4ea41949f1dd2efdf17baffc1780b031f3934\";\r\n\r\n    var TestSBox = new Uint8Array([\r\n        0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,\r\n        0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0,\r\n        0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,\r\n        0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0,\r\n        0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,\r\n        0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0,\r\n        0x0, 0x1, 0x2, 0x3, 0x4, 0x5, 0x6, 0x7, 0x8, 0x9, 0xA, 0xB, 0xC, 0xD, 0xE, 0xF,\r\n        0xF, 0xE, 0xD, 0xC, 0xB, 0xA, 0x9, 0x8, 0x7, 0x6, 0x5, 0x4, 0x3, 0x2, 0x1, 0x0\r\n    ]);\r\n\r\n\r\n    // Basic chiper mode tests\r\n    var tests = 0, i = 0;\r\n    println('GOST 28147-89/GOST R 34.12-2015 TEST', true);\r\n\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', input1, output1);\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CBC', iv: '1234567890abcdef', sBox: 'D-TEST' },\r\n      '00112233445566778899AABBCCDDEEFF00112233445566778899AABBCCDDEEFF', input2, output2);\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CTR', iv: '1234567890abcdef', sBox: 'D-TEST' },\r\n      '0011223344556677889900112233445566778899001122334455667788990011', input3, output3);\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', iv: 'aafd12f659cae634', sBox: 'D-TEST' },\r\n      'aafd12f659cae63489b479e5076ddec2f06cb58faafd12f659cae63489b479e5', input4, output4);\r\n\r\n    // Tests with parameters, set S-box.\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', input1, output1); // default parameter S-box set to D-TEST\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', iv: '1234567890abcdef', sBox: 'D-TEST' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', 'b587f7a0814c911d'); //type S-box\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', iv: '1234567890abcdef', sBox: 'E-TEST' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', 'e8287f53f991d52b');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', shiftBits: 64, iv: '1234567890abcdef', sBox: 'E-A' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', 'c41009dba22ebe35');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', iv: '1234567890abcdef', sBox: 'E-B', shiftBits: 8 },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', '80d8723fcd3aba28');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', shiftBits: 8, iv: '1234567890abcdef', sBox: 'E-C' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', '739f6f95068499b5');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', shiftBits: 8, iv: '1234567890abcdef', sBox: 'E-D' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', '4663f720f4340f57');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CFB', shiftBits: 8, iv: '1234567890abcdef', sBox: 'D-A' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', '5bb0a31d218ed564');\r\n    tests += perform(++i, {\r\n          name: 'GOST 28147',\r\n          block: 'CFB',\r\n          shiftBits: 8,\r\n          iv: '1234567890abcdef',\r\n          sBox: TestSBox\r\n      },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', '0000000000000000', 'c3af96ef788667c5');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'CTR', iv: '1234567890abcdef', sBox: 'E-A' },\r\n      '4ef72b778f0b0bebeef4f077551cb74a927b470ad7d7f2513454569a247e989d', 'bc350e71aa11345709acde', '1bcc2282707c676fb656dc');\r\n    tests += perform(++i, { name: 'GOST 28147', block: 'ECB', sBox: 'E-Z' },\r\n      '8182838485868788898a8b8c8d8e8f80d1d2d3d4d5d6d7d8d9dadbdcdddedfd0',\r\n      '0102030405060708f1f2f3f4f5f6f7f8', 'ce5a5ed7e0577a5fd0cc85ce31635b8b');\r\n\r\n    var gkeyBytes5 = \"6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49\";\r\n    var gkeyBytes6 = \"6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49\";\r\n\r\n    var input5 = \"7768617420646f2079612077616e7420666f72206e6f7468696e673f\";\r\n    var input6 = \"7768617420646f2079612077616e7420666f72206e6f7468696e673f\";\r\n\r\n    var output5 = \"93468a46\";\r\n    var output6 = \"93468a46\";\r\n\r\n    // MAC\r\n    println();\r\n    println('MAC sing/verify');\r\n    tests += performMac(++i, { name: 'GOST 28147', mode: 'MAC', sBox: 'E-A' }, gkeyBytes5, input5, output5);\r\n    tests += performMac(++i, { name: 'GOST 28147', mode: 'MAC', sBox: 'E-A' }, gkeyBytes6, input6, output6);\r\n\r\n    // Padding\r\n    println();\r\n    println('Padding');\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST', padding: 'BIT' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', 'fedcba98765432');\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST', padding: 'BIT' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', 'fedcba9876543210');\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST', padding: 'PKCS5P' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', 'fedcba98765432');\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST', padding: 'PKCS5P' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', 'fedcba9876543210');\r\n    tests += perform(++i, { name: 'GOST 28147', sBox: 'D-TEST', padding: 'ZERO' },\r\n      '546d203368656c326973652073736e62206167796967747473656865202c3d73', 'fedcba9876543210');\r\n\r\n    // Key meshing\r\n    println();\r\n    println('Key meshing');\r\n    var input = new Array(10001).join('61'); // hex(a)\r\n    tests += perform(++i, {\r\n          name: 'GOST 28147',\r\n          block: 'CFB',\r\n          keyMeshing: 'CP',\r\n          iv: '1234567890abcdef',\r\n          sBox: 'E-A'\r\n      },\r\n      '4ef72b778f0b0bebeef4f077551cb74a927b470ad7d7f2513454569a247e989d', input);\r\n    tests += perform(++i, {\r\n          name: 'GOST 28147',\r\n          block: 'CBC',\r\n          keyMeshing: 'CP',\r\n          iv: '1234567890abcdef',\r\n          sBox: 'E-A'\r\n      },\r\n      '4ef72b778f0b0bebeef4f077551cb74a927b470ad7d7f2513454569a247e989d', input);\r\n    tests += perform(++i, {\r\n          name: 'GOST 28147',\r\n          block: 'CTR',\r\n          keyMeshing: 'CP',\r\n          iv: '1234567890abcdef',\r\n          sBox: 'E-A'\r\n      },\r\n      '4ef72b778f0b0bebeef4f077551cb74a927b470ad7d7f2513454569a247e989d', input);\r\n    tests += performMac(++i, {\r\n          name: 'GOST 28147',\r\n          mode: 'MAC',\r\n          keyMeshing: 'CP',\r\n          iv: '1234567890abcdef',\r\n          sBox: 'E-A'\r\n      },\r\n      '4ef72b778f0b0bebeef4f077551cb74a927b470ad7d7f2513454569a247e989d', input);\r\n\r\n    println();\r\n    println('Key wrapping');\r\n    var input = new Array(10001).join('61'); // hex(a)\r\n    tests += performWrap(++i, { name: 'GOST 28147', mode: 'KW', ukm: '1234567890abcdef', sBox: 'D-TEST' }, // Initial UKM seed\r\n      'aafd12f659cae63489b479e5076ddec2f06cb58faafd12f659cae63489b479e5',\r\n      '6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49',\r\n      'af502015229a831dc82b4d32dc00173f5d43d921e5e09cc09ce947c777414397022a90c7');\r\n    tests += performWrap(++i, { name: 'GOST 28147', mode: 'KW', ukm: '1234567890abcdef', sBox: 'E-A' }, // E-A\r\n      'aafd12f659cae63489b479e5076ddec2f06cb58faafd12f659cae63489b479e5',\r\n      '6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49');\r\n\r\n    tests += performWrap(++i, { name: 'GOST 28147', sBox: 'D-TEST', ukm: '1234567890abcdef', keyWrapping: 'CP' }, // CryptoPro.\r\n      'aafd12f659cae63489b479e5076ddec2f06cb58faafd12f659cae63489b479e5',\r\n      '6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49',\r\n      '16256f060dd3b3d8734a9fcc9ab4c3d04e777dc5c46a2f4c3e411e3597a5bfc32b41e492');\r\n\r\n    tests += performWrap(++i, {\r\n          name: 'GOST 28147',\r\n          mode: 'KW',\r\n          keyWrapping: 'CP',\r\n          ukm: '1234567890abcdef',\r\n          sBox: 'E-A'\r\n      }, // CryptoPro E-A\r\n      'aafd12f659cae63489b479e5076ddec2f06cb58faafd12f659cae63489b479e5',\r\n      '6d145dc993f4019e104280df6fcd8cd8e01e101e4c113d7ec4f469ce6dcd9e49');\r\n\r\n    tests += performWrap(++i, { name: 'GOST 28147', mode: 'KW', keyWrapping: 'SC', sBox: 'E-SC' },\r\n      '2208cd6bc96a' +\r\n      '009f05175f635bee6cc09c78260b9b7eee1e070d346462e6881bbf572f436df5' +\r\n      '716b1212a9fba3d022db4aed0a18530ae6c62d9bdd206479805ce652c17bc9cc' +\r\n      '07dcdce25cba19276285f6c54dfa940ab55473bde2d8338eaaedc59cdd808619' +\r\n      'f75296db91e016b588c0650686ff6929258a76d5ca7ba91b7fa87f41b2deb535' +\r\n      'a66b489a5485ac68971e00658836ce358dcda04b358621ebf08ce062b671d84a' +\r\n      '30706495ee2ed7d0f0a6a3e171a9daba04b582c3b7113905053a5b9254c7e08b' +\r\n      'ea27cb66e19699db55444f1e1f1b5a3b7db7cbcc04728e225e67ab8099dc82b1' + // mk.db3\r\n      '5d6f4f794c0f584718252fb2d9ffffe6d2adc4c86616466fe032ed28790e6af6', // masks.db3\r\n      '5a7145b0ee4c080e0fcf689e5222c25876ac9d2b25a68fb3357eea8f849d6272',\r\n      '7c34bf4e03d0bc120768164f355cf6180b32851e2ad6fc22b386bbea17fa1d5f1789eb95'); // kek.opq\r\n\r\n    // Tests for new GOST 2015\r\n    println();\r\n    println('GOST R 34.12-2015/64bits');\r\n    var key64 = 'ffeeddccbbaa99887766554433221100f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff';\r\n    var inp64 = '92def06b3c130a59db54c704f8189d204a98fb2e67a8024c8912409b17b57e41';\r\n    tests += perform(++i, { name: 'GOST R 34.12', version: 2015 }, key64, 'fedcba9876543210', '4ee901e5c2d8ca3d');\r\n    tests += perform(++i, { name: 'GOST R 34.12', version: 2015, block: 'ECB' }, key64, inp64,\r\n      '2b073f0494f372a0de70e715d3556e4811d8d9e9eacfbc1e7c68260996c67efb');\r\n    tests += perform(++i, { name: 'GOST R 34.12', version: 2015, block: 'CTR', iv: '12345678' }, key64, inp64,\r\n      '4e98110c97b7b93c3e250d93d6e85d69136d868807b2dbef568eb680ab52a12d');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12',\r\n          version: 2015,\r\n          block: 'CBC',\r\n          iv: '1234567890abcdef234567890abcdef134567890abcdef12'\r\n      },\r\n      key64, inp64, '96d1b05eea683919aff76129abb937b95058b4a1c4bc001920b78b1a7cd7e667');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12',\r\n          version: 2015,\r\n          block: 'CFB',\r\n          iv: '1234567890abcdef234567890abcdef1'\r\n      },\r\n      key64, inp64, 'db37e0e266903c830d46644c1f9a089c24bdd2035315d38bbcc0321421075505');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12',\r\n          version: 2015,\r\n          block: 'OFB',\r\n          iv: '1234567890abcdef234567890abcdef1'\r\n      },\r\n      key64, inp64, 'db37e0e266903c830d46644c1f9a089ca0f83062430e327ec824efb8bd4fdb05');\r\n    tests += performMac(++i, { name: 'GOST R 34.12', version: 2015, mode: 'MAC' },\r\n      key64, inp64, '154e7210');\r\n\r\n    println();\r\n    println('GOST R 34.12-2015/128bits');\r\n    var key128 = '8899aabbccddeeff0011223344556677fedcba98765432100123456789abcdef';\r\n    var inp128 = '1122334455667700ffeeddccbbaa998800112233445566778899aabbcceeff0a112233445566778899aabbcceeff0a002233445566778899aabbcceeff0a0011';\r\n    tests += perform(++i, { name: 'GOST R 34.12', version: 2015, length: 128 }, key128,\r\n      '1122334455667700ffeeddccbbaa9988', '7f679d90bebc24305a468d42b9d4edcd');\r\n    tests += perform(++i, { name: 'GOST R 34.12', version: 2015, length: 128 }, key128, inp128,\r\n      '7f679d90bebc24305a468d42b9d4edcdb429912c6e0032f9285452d76718d08bf0ca33549d247ceef3f5a5313bd4b157d0b09ccde830b9eb3a02c4c5aa8ada98');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12',\r\n          version: 2015,\r\n          length: 128,\r\n          block: 'CTR',\r\n          iv: '1234567890abcef0'\r\n      }, key128, inp128,\r\n      'f195d8bec10ed1dbd57b5fa240bda1b885eee733f6a13e5df33ce4b33c45dee4a5eae88be6356ed3d5e877f13564a3a5cb91fab1f20cbab6d1c6d15820bdba73');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12', version: 2015, length: 128, block: 'OFB',\r\n          iv: '1234567890abcef0a1b2c3d4e5f0011223344556677889901213141516171819'\r\n      }, key128, inp128,\r\n      '81800a59b1842b24ff1f795e897abd95ed5b47a7048cfab48fb521369d9326bf66a257ac3ca0b8b1c80fe7fc10288a13203ebbc066138660a0292243f6903150');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12', version: 2015, length: 128, block: 'CBC',\r\n          iv: '1234567890abcef0a1b2c3d4e5f0011223344556677889901213141516171819'\r\n      }, key128, inp128,\r\n      '689972d4a085fa4d90e52e3d6d7dcc272826e661b478eca6af1e8e448d5ea5acfe7babf1e91999e85640e8b0f49d90d0167688065a895c631a2d9a1560b63970');\r\n    tests += perform(++i, {\r\n          name: 'GOST R 34.12', version: 2015, length: 128, block: 'CFB',\r\n          iv: '1234567890abcef0a1b2c3d4e5f0011223344556677889901213141516171819'\r\n      }, key128, inp128,\r\n      '81800a59b1842b24ff1f795e897abd95ed5b47a7048cfab48fb521369d9326bf79f2a8eb5cc68d38842d264e97a238b54ffebecd4e922de6c75bd9dd44fbf4d1');\r\n    tests += performMac(++i, { name: 'GOST R 34.12', version: 2015, length: 128, mode: 'MAC' }, key128, inp128,\r\n      '336f4d296059fbe3');\r\n\r\n    println();\r\n    println('RC2');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 63\r\n    }, '0000000000000000', '0000000000000000', 'ebb773f993278eff');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 64\r\n    }, 'ffffffffffffffff', 'ffffffffffffffff', '278b27e42e2f0d49');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 64\r\n    }, '3000000000000000', '1000000000000001', '30649edf9be7d2c2');\r\n    tests += perform(++i, { name: 'RC2', version: 1, length: 64 }, '88', '0000000000000000', '61a8a244adacccf0');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 64\r\n    }, '88bca90e90875a', '0000000000000000', '6ccf4308974c267f');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 64\r\n    }, '88bca90e90875a7f0f79c384627bafb2', '0000000000000000', '1a807d272bbe5db1');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 128\r\n    }, '88bca90e90875a7f0f79c384627bafb2', '0000000000000000', '2269552ab0f85ca6');\r\n    tests += perform(++i, {\r\n        name: 'RC2',\r\n        version: 1,\r\n        length: 129\r\n    }, '88bca90e90875a7f0f79c384627bafb216f80a6f85920584c42fceb0be255daf1e', '0000000000000000', '5b78d3a43dfff1f1');\r\n    println();\r\n\r\n    println('TOTAL ' + (tests ? tests + ' ERRORS' : 'OK'));\r\n    println();\r\n\r\n    return tests;\r\n};\r\n","import gostCipherTests from './gostCipher.test';\r\nimport gostDigestTests from './gostDigest.test';\r\nimport gostSignTests from './gostSign.test';\r\n\r\n/* Running tests */\r\ngostCipherTests();\r\ngostDigestTests(true);\r\ngostSignTests();\r\n"],"sourceRoot":""}