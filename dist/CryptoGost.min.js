!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,r){!function(t,n){e.exports=n(r(1))}(0,function(e){function t(e,r){("string"==typeof e||e instanceof String)&&(e={name:e});var n=e.name;if(!n)throw new p("Algorithm name not defined");var i=n.split("/"),i=i[0].split("-").concat(i.slice(1)),o={};if(n=i[0].replace(/[\.\s]/g,""),i=i.slice(1),n.indexOf("28147")>=0)o={name:"GOST 28147",version:1989,mode:(e.mode||("sign"===r||"verify"===r?"MAC":"wrapKey"===r||"unwrapKey"===r?"KW":"ES")).toUpperCase(),length:e.length||64};else if(n.indexOf("3412")>=0)o={name:"GOST R 34.12",version:2015,mode:(e.mode||("sign"===r||"verify"===r?"MAC":"wrapKey"===r||"unwrapKey"===r?"KW":"ES")).toUpperCase(),length:e.length||64};else if(n.indexOf("3411")>=0)o={name:"GOST R 34.11",version:2012,mode:(e.mode||("deriveKey"===r||"deriveBits"===r?"KDF":"sign"===r||"verify"===r?"HMAC":"HASH")).toUpperCase(),length:e.length||256};else if(n.indexOf("3410")>=0)o={name:"GOST R 34.10",version:2012,mode:(e.mode||("deriveKey"===r||"deriveBits"===r?"DH":"SIGN")).toUpperCase(),length:e.length||256};else if(n.indexOf("SHA")>=0)o={name:"SHA",version:160===(e.length||160)?1:2,mode:(e.mode||("deriveKey"===r||"deriveBits"===r?"KDF":"sign"===r||"verify"===r?"HMAC":"HASH")).toUpperCase(),length:e.length||160};else if(n.indexOf("RC2")>=0)o={name:"RC2",version:1,mode:(e.mode||("sign"===r||"verify"===r?"MAC":"wrapKey"===r||"unwrapKey"===r?"KW":"ES")).toUpperCase(),length:e.length||32};else if(n.indexOf("PBKDF2")>=0)o=t(e.hash,"digest"),o.mode="PBKDF2";else if(n.indexOf("PFXKDF")>=0)o=t(e.hash,"digest"),o.mode="PFXKDF";else if(n.indexOf("CPKDF")>=0)o=t(e.hash,"digest"),o.mode="CPKDF";else{if(!(n.indexOf("HMAC")>=0))throw new g("Algorithm not supported");o=t(e.hash,"digest"),o.mode="HMAC"}switch(i.forEach(function(e){if(e=e.toUpperCase(),/^[0-9]+$/.test(e))if(["8","16","32"].indexOf(e)>=0||"128"===o.length&&"64"===e)if("ES"===o.mode)o.shiftBits=parseInt(e);else{if("MAC"!==o.mode)throw new g("Algorithm "+o.name+" mode "+e+" not supported");o.macLength=parseInt(e)}else if(["89","94","01","12","15","1989","1994","2001","2012","2015"].indexOf(e)>=0){var t=parseInt(e);t=t<1900?t<80?2e3+t:1900+t:t,o.version=t}else["1"].indexOf(e)>=0&&"SHA"===o.name?(o.version=1,o.length=160):["256","384","512"].indexOf(e)>=0&&"SHA"===o.name?(o.version=2,o.length=parseInt(e)):["40","128"].indexOf(e)>=0&&"RC2"===o.name?(o.version=1,o.length=parseInt(e)):["64","128","256","512"].indexOf(e)>=0?o.length=parseInt(e):["1000","2000"].indexOf(e)>=0&&(o.iterations=parseInt(e));else if(["E-TEST","E-A","E-B","E-C","E-D","E-SC","E-Z","D-TEST","D-A","D-SC"].indexOf(e)>=0)o.sBox=e;else if(["S-TEST","S-A","S-B","S-C","S-D","X-A","X-B","X-C"].indexOf(e)>=0)o.namedParam=e;else if(["S-256-TEST","S-256-A","S-256-B","S-256-C","P-256","T-512-TEST","T-512-A","T-512-B","X-256-A","X-256-B","T-256-TEST","T-256-A","T-256-B","S-256-B","T-256-C","S-256-C"].indexOf(e)>=0)o.namedCurve=e;else if(["SC","CP","VN"].indexOf(e)>=0)o.procreator=e;else if("GOST 28147"===o.name||"GOST R 34.12"===o.name||"RC2"===o.name)if(["ES","MAC","KW","MASK"].indexOf(e)>=0)o.mode=e;else if(["ECB","CFB","OFB","CTR","CBC"].indexOf(e)>=0)o.mode="ES",o.block=e;else if(["CPKW","NOKW","SCKW"].indexOf(e)>=0)o.mode="KW",o.keyWrapping=e.replace("KW","");else if(["ZEROPADDING","PKCS5PADDING","NOPADDING","RANDOMPADDING","BITPADDING"].indexOf(e)>=0)o.padding=e.replace("PADDING","");else{if(!(["NOKM","CPKM"].indexOf(e)>=0))throw new g("Algorithm "+o.name+" mode "+e+" not supported");o.keyMeshing=e.replace("KM","")}else if("GOST R 34.11"===o.name||"SHA"===o.name){if(!(["HASH","KDF","HMAC","PBKDF2","PFXKDF","CPKDF"].indexOf(e)>=0))throw new g("Algorithm "+o.name+" mode "+e+" not supported");o.mode=e}else if("GOST R 34.10"===o.name){var r=e.replace(/[\.\s]/g,"");if(r.indexOf("GOST")>=0&&r.indexOf("3411")>=0)o.hash=e;else{if(!["SIGN","DH","MASK"].indexOf(e))throw new g("Algorithm "+o.name+" mode "+e+" not supported");o.mode=e}}}),o.procreator=e.procreator||o.procreator||"CP",o.name){case"GOST R 34.10":o.keySize=o.length/(1994===o.version?4:8);break;case"GOST R 34.11":o.keySize=32;break;case"GOST 28147":case"GOST R 34.12":o.keySize=32;break;case"RC2":o.keySize=Math.ceil(o.length/8);break;case"SHA":o.keySize=o.length/8}switch("ES"===o.mode&&(e.block&&(o.block=e.block),o.block&&(o.block=o.block.toUpperCase()),e.padding&&(o.padding=e.padding),o.padding&&(o.padding=o.padding.toUpperCase()),e.shiftBits&&(o.shiftBits=e.shiftBits),e.keyMeshing&&(o.keyMeshing=e.keyMeshing),o.keyMeshing&&(o.keyMeshing=o.keyMeshing.toUpperCase()),"importKey"!==r&&"generateKey"!==r&&(o.block=o.block||"ECB",o.padding=o.padding||("CBC"===o.block||"ECB"===o.block?"ZERO":"NO"),"CFB"!==o.block&&"OFB"!==o.block||(o.shiftBits=o.shiftBits||o.length),o.keyMeshing=o.keyMeshing||"NO")),"KW"===o.mode&&(e.keyWrapping&&(o.keyWrapping=e.keyWrapping),o.keyWrapping&&(o.keyWrapping=o.keyWrapping.toUpperCase()),"importKey"!==r&&"generateKey"!==r&&(o.keyWrapping=o.keyWrapping||"NO")),["sBox","namedParam","namedCurve","curve","param","modulusLength"].forEach(function(t){e[t]&&(o[t]=e[t])}),"importKey"!==r&&"generateKey"!==r&&("GOST 28147"===o.name?o.sBox=o.sBox||("SC"===o.procreator?"E-SC":"E-A"):"GOST R 34.12"===o.name&&64===o.length?o.sBox="E-Z":"GOST R 34.11"===o.name&&1994===o.version?o.sBox=o.sBox||("SC"===o.procreator?"D-SC":"D-A"):"GOST R 34.10"===o.name&&1994===o.version?o.namedParam=o.namedParam||("DH"===o.mode?"X-A":"S-A"):"GOST R 34.10"===o.name&&2001===o.version?o.namedCurve=o.namedCurve||(256===o.length?"SC"===o.procreator?"P-256":"DH"===o.mode?"X-256-A":"S-256-A":"T-512-A"===o.mode):"GOST R 34.10"===o.name&&2012===o.version&&(o.namedCurve=o.namedCurve||(256===o.length?"SC"===o.procreator?"P-256":"DH"===o.mode?"X-256-A":"S-256-A":"T-512-A"===o.mode))),o.mode){case"DH":e.ukm&&(o.ukm=e.ukm),e.public&&(o.public=e.public);break;case"SIGN":case"KW":e.ukm&&(o.ukm=e.ukm);break;case"ES":case"MAC":e.iv&&(o.iv=e.iv);break;case"KDF":e.label&&(o.label=e.label),e.contex&&(o.context=e.contex);break;case"PBKDF2":case"PFXKDF":e.salt&&(o.salt=e.salt),e.iterations&&(o.iterations=e.iterations),e.diversifier&&(o.diversifier=e.diversifier);break;case"CPKDF":e.salt&&(o.salt=e.salt),e.iterations&&(o.iterations=e.iterations)}if(r&&("ES"!==o.mode&&"SIGN"!==o.mode&&"MAC"!==o.mode&&"HMAC"!==o.mode&&"KW"!==o.mode&&"DH"!==o.mode&&"MASK"!==o.mode&&"generateKey"===r||"ES"!==o.mode&&("encrypt"===r||"decrypt"===r)||"SIGN"!==o.mode&&"MAC"!==o.mode&&"HMAC"!==o.mode&&("sign"===r||"verify"===r)||"HASH"!==o.mode&&"digest"===r||"KW"!==o.mode&&"MASK"!==o.mode&&("wrapKey"===r||"unwrapKey"===r)||"DH"!==o.mode&&"PBKDF2"!==o.mode&&"PFXKDF"!==o.mode&&"CPKDF"!==o.mode&&"KDF"!==o.mode&&("deriveKey"===r||"deriveBits"===r)))throw new g("Algorithm mode "+o.mode+" not valid for method "+r);return e.hash&&(o.hash=e.hash),o.hash&&(("string"==typeof o.hash||o.hash instanceof String)&&o.procreator&&(o.hash=o.hash+"/"+o.procreator),o.hash=t(o.hash,"digest")),e.id&&(o.id=e.id),o}function r(e){if(!y||!y.subtle||!e)return!1;var t="string"==typeof e||e instanceof String?t=e:e.name;return!!t&&(t=t.toUpperCase(),(t.indexOf("KDF")>=0||t.indexOf("HMAC")>=0)&&e.hash?r(e.hash):-1===t.indexOf("GOST")&&-1===t.indexOf("SHA-1")&&-1===t.indexOf("RC2")&&-1===t.indexOf("?DES"))}function n(e,t){if(!e.algorithm)throw new p("Key algorithm not defined");if(!e.algorithm.name)throw new p("Key algorithm name not defined");var r=e.algorithm.name,n="GOST 28147"===r||"GOST R 34.12"===r||"RC2"===r,i="GOST R 34.11"===r||"SHA"===r,o="GOST R 34.10"===r;if(!n&&!o&&!i)throw new g("Key algorithm "+r+" is unsupproted");if(!e.type)throw new p("Key type not defined");if((n||i)&&"secret"!==e.type||o&&"public"!==e.type&&"private"!==e.type)throw new l("Key type "+e.type+" is not valid for algorithm "+r);if(!e.usages||!e.usages.indexOf)throw new p("Key usages not defined");for(var a=0,s=e.usages.length;a<s;a++){var c=e.usages[a];if(("encrypt"===c||"decrypt"===c)&&"secret"!==e.type||"sign"===c&&"public"===e.type||"verify"===c&&"private"===e.type)throw new v("Key type "+e.type+" is not valid for "+c)}if(t&&-1===e.usages.indexOf(t))throw new C("Key usages is not contain method "+t);if(!e.buffer)throw new p("Key buffer is not defined");var u=8*e.buffer.byteLength,f=8*e.algorithm.keySize;if("secret"===e.type&&u!==(f||256)&&(e.usages.indexOf("encrypt")>=0||e.usages.indexOf("decrypt")>=0)||"private"===e.type&&256!==u&&512!==u||"public"===e.type&&512!==u&&1024!==u)throw new p("Key buffer has wrong size "+u+" bit")}function i(e,t,r){if(n(r,e),t){var i;switch(t.mode){case"ES":i=["sBox","keyMeshing","padding","block"];break;case"SIGN":i=["namedCurve","namedParam","sBox","curve","param","modulusLength"];break;case"MAC":i=["sBox"];break;case"KW":i=["keyWrapping","ukm"];break;case"DH":i=["namedCurve","namedParam","sBox","ukm","curve","param","modulusLength"];break;case"KDF":i=["context","label"];break;case"PBKDF2":i=["sBox","iterations","salt"];break;case"PFXKDF":i=["sBox","iterations","salt","diversifier"];break;case"CPKDF":i=["sBox","salt"]}i&&i.forEach(function(e){r.algorithm[e]&&(t[e]=r.algorithm[e])})}return r.buffer}function o(e,t,r,i,o){var a={type:o||("GOST R 34.10"===e.name?"private":"secret"),extractable:t||"false",algorithm:e,usages:r||[],buffer:i};return n(a),a}function a(e,t,r,n,i,a){if(!n||!n.indexOf)throw new p("Key usages not defined");var s=n.filter(function(e){return"sign"!==e}),c=n.filter(function(e){return"verify"!==e});return{publicKey:o(e,r,s,i,"public"),privateKey:o(t,r,c,a,"private")}}function s(e){e instanceof E&&(e=new Uint8Array(e));for(var t=new Uint8Array(e.length),r=0,n=e.length;r<n;r++)t[n-r-1]=e[r];return t.buffer}function c(){if("undefined"!=typeof document)for(var e=0,t=arguments.length;e<t;e++){var r=arguments[e].split("."),n=A+r[0]+b+"."+r[1],i=document.querySelector('script[src="'+n+'"]');i||(i=document.createElement("script"),i.setAttribute("src",n),document.head.appendChild(i))}}function u(e,t,r){return new Promise(function(n,i){try{if(F){var o=++S;w.push({id:o,resolve:n,reject:i}),F.postMessage({id:o,algorithm:e,method:t,args:r})}else d.gostEngine?n(d.gostEngine.execute(e,t,r)):i(new m("Module gostEngine not found"))}catch(e){i(e)}})}function f(e){try{e()}catch(e){}}function h(){}var d=this,y=d.crypto||d.msCrypto,p=d.SyntaxError||d.Error,l=d.DataError||d.Error,g=d.NotSupportedError||d.Error,m=d.OperationError||d.Error,v=d.InvalidAccessError||d.Error,C=d.InvalidAccessError||d.Error;d.Promise||(d.Promise=function(){function e(e){return e&&null===e.oncomplete&&null===e.onerror?new t(function(t,r){e.oncomplete=function(){t(e.result)},e.onerror=function(){r(new m(e.toString()))}}):e}function t(r){function n(e){try{e()}catch(e){}}var i,o="pending",a=[],s=[];try{r(function(e){"pending"===o&&(o="fulfilled",i=e,a.forEach(n))},function(e){"pending"===o&&(o="rejected",i=e,s.forEach(n))})}catch(e){"pending"===o&&(o="rejected",i=e,s.forEach(n))}this.then=function(r,n){return new t(function(t,c){function u(){var n;try{n=r?r(i):i}catch(e){return void c(e)}n=e(n),n&&n.then&&n.then.call?n.then(t,c):t(n)}function f(){var r;try{r=n?n(i):i}catch(e){return void c(e)}r=e(r),r&&r.then&&r.then.call?r.then(t,c):c(r)}"fulfilled"===o?u():"rejected"===o?f():(a.push(u),s.push(f))})},this.catch=function(e){return this.then(void 0,e)}}return t.all=function(e){return new t(function(t,r){function n(e){o>0&&r(e),o=0}for(var i=[],o=0,a=0,s=e.length;a<s;a++){var c=e[a];c.then&&c.then.call?c.then(function(e){return o++,function(r){i[e]=r,0===--o&&t(i)}}(a),n):i[a]=c}0===o&&t(i)})},t}());var A="src/",b="";"undefined"!=typeof document&&function(){if(void 0!==typeof document)for(var e=/^(.*)gostCrypto(.*)\.js$/i,t=document.querySelectorAll("script"),r=0,n=t.length;r<n;r++){var i=t[r].getAttribute("src"),o=e.exec(i);o&&(A=o[1],b=o[2])}}();var F,w=[],S=0;if(!d.importScripts&&!d.gostEngine)try{F=new Worker(A+"gostEngine"+b+".js"),F.onmessage=function(e){for(var t=e.data.id,r=0,n=w.length;r<n&&w[r].id!==t;r++);if(r<n){var i=w[r];w.splice(r,1),e.data.error?i.reject(new m(e.data.error)):i.resolve(e.data.result)}},F.onerror=function(e){for(var t=0,r=w.length;t<r;t++)w[t].reject(e.error);w=[]}}catch(e){F=!1}d.importScripts||(d.importScripts=c),F||d.gostEngine||c("gostEngine.js");var E=d.ArrayBuffer,B={};return h.prototype.encrypt=function(e,n,o){return new Promise(f).then(function(){return r(e)?y.subtle.encrypt(e,n,o):(e=t(e,"encrypt"),u(e,"encrypt",[i("encrypt",e,n),o]))})},h.prototype.decrypt=function(e,n,o){return new Promise(f).then(function(){return r(e)?y.subtle.decrypt(e,n,o):(e=t(e,"decrypt"),u(e,"decrypt",[i("decrypt",e,n),o]))})},h.prototype.sign=function(e,n,o){return new Promise(f).then(function(){return r(e)?y.subtle.sign(e,n,o):(e=t(e,"sign"),u(e,"sign",[i("sign",e,n),o]).then(function(t){return"SC"===e.procreator&&"SIGN"===e.mode&&(t=B.asn1.GostSignature.encode(t)),t}))})},h.prototype.verify=function(e,n,o,a){return new Promise(f).then(function(){if(r(e))return y.subtle.verify(e,n,o,a);if(e=t(e,"verify"),"SC"===e.procreator&&"SIGN"===e.mode){var s=B.asn1.GostSignature.decode(o);o={r:s.r,s:s.s}}return u(e,"verify",[i("verify",e,n),o,a])})},h.prototype.digest=function(e,n){return new Promise(f).then(function(){return r(e)?y.subtle.digest(e,n):(e=t(e,"digest"),u(e,"digest",[n]))})},h.prototype.generateKey=function(e,n,i){return new Promise(f).then(function(){if(r(e))return y.subtle.generateKey(e,n,i);var s=e.privateKey,c=e.publicKey;return e=t(e,"generateKey"),s=s?t(s,"generateKey"):e,c=c?t(c,"generateKey"):e,u(e,"generateKey",[]).then(function(t){return t.publicKey&&t.privateKey?a(c,s,n,i,t.publicKey,t.privateKey):o(e,n,i,t)})})},h.prototype.deriveKey=function(e,n,a,s,c){return new Promise(f).then(function(){return r(e)?y.subtle.deriveKey(e,n,a,s,c):(e=t(e,"deriveKey"),a=t(a,"generateKey"),e.keySize=a.keySize,e.public&&(e.public.algorithm=t(e.public.algorithm),e.public=i("deriveKey",e,e.public)),u(e,"deriveKey",[i("deriveKey",e,n)]).then(function(e){return o(a,s,c,e)}))})},h.prototype.deriveBits=function(e,n,o){return new Promise(f).then(function(){return r(e)?y.subtle.deriveBits(e,n,o):(e=t(e,"deriveBits"),e.public&&(e.public=i("deriveBits",e,e.public)),u(e,"deriveBits",[i("deriveBits",e,n),o]))})},h.prototype.importKey=function(e,n,i,a,s){var c;return new Promise(f).then(function(){if(r(i))return y.subtle.importKey(e,n,i,a,s);if("raw"===e){if(i=t(i,"importKey"),s&&s.indexOf){var o=i.name.toUpperCase().replace(/[\.\s]/g,"");o.indexOf("3410")>=0&&s.indexOf("sign")>=0?c="private":o.indexOf("3410")>=0&&s.indexOf("verify")>=0&&(c="public")}return n}var f;if("pkcs8"===e)f=B.asn1.GostPrivateKeyInfo.decode(n).object;else{if("spki"!==e)throw new g("Key format not supported");f=B.asn1.GostSubjectPublicKeyInfo.decode(n).object}if(i=t(f.algorithm,"importKey"),c=f.type,!1!==a&&(a=a||f.extractable),s){for(var h=0;h<s.length;h++)if(f.usages.indexOf(s[h])<0)throw l("Key usage not valid for this key")}else s=f.usages;var d=f.buffer,p=i.keySize,m=d.byteLength;if("public"===c||p===m)return d;if(m%p>0)throw new l("Invalid key size");i.mode="MASK",i.procreator="VN";for(var v=[],h=p;h<m;h+=p)v.push(function(e){return function(t){return u(i,"unwrapKey",[e,t]).then(function(e){var t=v.pop();return t?t(e):(delete i.mode,e)})}}(new Uint8Array(d,h,p)));return v.pop()(new Uint8Array(d,0,p))}).then(function(e){return o(i,a,s,e,c)})},h.prototype.exportKey=function(e,t){return new Promise(f).then(function(){if(t&&r(t.algorithm))return y.subtle.exportKey(e,t);if(!t.extractable)throw new C("Key not extractable");var n=i(null,null,t);if("raw"===e)return n;if("pkcs8"===e&&t.algorithm&&t.algorithm.id){if("VN"===t.algorithm.procreator){var o,a=t.algorithm;return a.mode="MASK",u(a,"generateKey").then(function(e){return o=e,u(a,"wrapKey",[o,t.buffer])}).then(function(e){delete a.mode;var t=new Uint8Array(e.byteLength+o.byteLength);t.set(new Uint8Array(e,0,e.byteLength)),t.set(new Uint8Array(o,0,o.byteLength),e.byteLength);var r=t.buffer;return r.enclosed=!0,B.asn1.GostPrivateKeyInfo.encode({algorithm:a,buffer:r})})}return B.asn1.GostPrivateKeyInfo.encode(t)}if("spki"===e&&t.algorithm&&t.algorithm.id)return B.asn1.GostSubjectPublicKeyInfo.encode(t);throw new g("Key format not supported")})},h.prototype.wrapKey=function(e,n,o,a){return new Promise(f).then(function(){if(r(a))return y.subtle.wrapKey(e,n,o,a);a=t(a,"wrapKey");var c=i(null,null,n);return"SC"===a.procreator&&"private"===n.type&&(c=s(c)),u(a,"wrapKey",[i("wrapKey",a,o),c]).then(function(t){if("raw"===e)return t;throw new g("Key format not supported")})})},h.prototype.unwrapKey=function(e,n,a,c,h,d,p){return new Promise(f).then(function(){if(r(c))return y.subtle.unwrapKey(e,n,a,c,h,d,p);if(c=t(c,"unwrapKey"),h=t(h,"importKey"),"raw"!==e)throw new g("Key format not supported");return u(c,"unwrapKey",[i("unwrapKey",c,a),n]).then(function(e){var t;if(h&&h.name){var r=h.name.toUpperCase().replace(/[\.\s]/g,"");r.indexOf("3410")>=0&&p.indexOf("sign")>=0?t="private":r.indexOf("3410")>=0&&p.indexOf("verify")>=0&&(t="public")}return"SC"===c.procreator&&"private"===t&&(e=s(e)),o(h,d,p,e,t)})})},B.subtle=new h,B.getRandomValues=function(t){e=e||d.GostRandom;var r=e?new e:y;if(!r.getRandomValues)throw new g("Random generator not found");r.getRandomValues(t)},B})},function(e,t,r){!function(t,r){e.exports=r()}(0,function(){function e(){}var t=this,r=t.crypto||t.msCrypto,n=t.TypeMismatchError||Error,i=t.QuotaExceededError||Error,o={seed:new Uint8Array(1024),getIndex:0,setIndex:0,set:function(e){this.setIndex>=1024&&(this.setIndex=0),this.seed[this.setIndex++]=e},get:function(){return this.getIndex>=1024&&(this.getIndex=0),this.seed[this.getIndex++]}};if("undefiend"!=typeof document){try{document.addEventListener("mousemove",function(e){o.set(255&(new Date).getTime()^255&(e.clientX||e.pageX)^255&(e.clientY||e.pageY))},!1)}catch(e){}try{document.addEventListener("keydown",function(e){o.set(255&(new Date).getTime()^255&e.keyCode)},!1)}catch(e){}}return e.prototype.getRandomValues=function(e){if(!e.byteLength)throw new n("Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)");if(e.byteLength>65536)throw new i("Byte length of array can't be greate then 65536");var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(r&&r.getRandomValues)r.getRandomValues(t);else for(var a=0,s=t.length;a<s;a++)t[a]=255&Math.floor(256*Math.random());for(var a=0,s=t.length;a<s;a++)t[a]=t[a]^o.get();return e},e})},function(e,t,r){!function(t,n){e.exports=n(r(0),r(3),r(4))}(0,function(e){function t(){for(var e={},t=0,r=arguments.length;t<r;t++){var n=arguments[t];if("object"==typeof n)for(var i in n)e[i]=n[i]}return e}function r(e){e instanceof l&&(e=new Uint8Array(e));for(var t=new Uint8Array(e.length),r=0,n=e.length;r<n;r++)t[n-r-1]=e[r];return t.buffer}function n(e){return e instanceof l||e.buffer instanceof l}function i(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function o(e){return e<=2?e:e<=4?4:e<=8?8:e<=16?16:e<=32?32:e<=64?64:e<=128?128:e<=256?256:e<512?512:e<1024?1024:void 0}function a(e){if(e)throw Error("Invalid format")}function s(e,t,r,n){"object"!=typeof r&&(r={value:r}),void 0!==n&&(r.enumerable=n),Object.defineProperty(e,t,r)}function c(e,t,r){for(var n in t)s(e,n,t[n],r)}function u(e,t){return Object.getOwnPropertyDescriptor(e,t)}function f(e,t,r,n,i,o){a(void 0===t);var s={tagNumber:r,tagClass:n||0,tagConstructed:i||!1,object:t};return e=e||"DER","DER"!==e&&"CER"!==e||(s=b.encode(s,e)),"PEM"===e&&(s=F.encode(s,o)),s}function h(e,t,r,n,i){if(a(void 0===e),"string"==typeof e&&(e=F.decode(e,i,!1)),e instanceof l)try{e=F.decode(w.encode(e),i,!0)}catch(t){e=b.decode(e)}return r=r||0,n=n||!1,void 0===e.tagNumber&&(e=f(!0,e.object,t,r,e.object instanceof Array),e=b.decode(e)),a(e.tagClass!==r||e.tagNumber!==t||e.tagConstructed!==n),0===r&&5===t?null:e.object}function d(e,t,r,n){if("function"!=typeof t&&(n=r,r=t,t=function(){e.apply(this,arguments)}),t.prototype=Object.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}}),r&&c(t.prototype,r),e!==Object)for(var i in e)t[i]=e[i];return t.super=e,n&&c(t,n,!0),t}function y(){}var p=this,l=p.ArrayBuffer,g=(p.Date,e.security.algorithms),m=e.security.names,v=e.security.identifiers,C=e.security.attributes,A=e.security.parameters,b=e.coding.BER,F=e.coding.PEM,w=e.coding.Chars,S=e.coding.Hex,E=e.coding.Int16,B={encode:function(e,t){return"0x"+S.encode(e,t)},decode:function(e,t,r){"number"==typeof e&&(e=e.toString(16));var n=e.replace("0x","");return r=r||o(n.length),S.decode(i(n,r),t)}},D=d(Object,function(e){this.object=e},{_set:function(e,t,r){e.property(t).set.call(this,r)},_get:function(e,t){return e.property(t).get.call(this)},_call:function(e,t,r){return e.method(t).apply(this,r)},hasProperty:function(e){return this.hasOwnProperty(e)||!!this.constructor.property(e)},encode:function(){return this.object}},{decode:function(e){return new this(e)},property:function(e){for(var t=this.prototype;t;){var r=u(t,e);if(r)return r;t=t.superclass}},method:function(e){for(var t=this.prototype;t;){if(t[e])return t[e];t=t.superclass}}}),K=function(e){return d(D,{encode:function(t){return f(t,this.object,e)}},{decode:function(t){return new this(h(t,e))}})},P=D,k=K(1),R=K(22),I=K(18),T=K(19),x=K(20),G=K(12),U=K(23),O=K(24),N=K(28),M=K(30),H=d(K(5),{object:{get:function(){return null},set:function(e){a(null!==e)}}}),L=function(e){function t(t){return d(K(e),function(e){r.super.call(this,e)},{encode:function(r){return f(r,t[this.object],e)}},{decode:function(r){var n=h(r,e);for(var i in t)if(n===t[i])return new this(i);a(!0)}})}var r=d(K(e),function(e){if(!(this instanceof r))return t(e);r.super.apply(this,arguments)});return r},j=L(2),W=L(10),V=function(){function e(e){return e?d(e,{encode:function(t){return f(t,e.method("encode").call(this,!0),4)}},{decode:function(t){return e.decode.call(this,h(t,4))}}):t}var t=d(K(4),function(r){if(!(this instanceof t))return e(r);t.super.apply(this,arguments)});return t}(),q=function(){function e(e){return e?d(e,{encode:function(t){return f(t,e.method("encode").call(this,!0),3)}},{decode:function(t){return e.decode.call(this,h(t,3))}}):r}function t(e){return d(D,function(e,t){D.call(this,e),this.numbits=t||0},{encode:function(t){var r=this.object,n=[];if(r instanceof Array){for(var i=0,o=r.length;i<o;i++){var a=e[r[i]];void 0!==a&&(n[a]="1")}for(var i=0,o=Math.max(n.length,this.numbits);i<o;i++)n[i]||(n[i]="0");n=n.join("")}else n="0";return f(t,n,3)}},{decode:function(t){var r=h(t,3),n=[];for(var i in e){var o=e[i];"1"===r.charAt(o)&&n.push(i)}return new this(n,r.length)}})}var r=d(K(3),function(n){if(!(this instanceof r))return"object"==typeof n?t(n):e(n);r.super.apply(this,arguments)});return r}(),X=function(e){return e.combine=function(t,r){for(var n in e.prototype)e.prototype.hasOwnProperty(n)&&!t.hasProperty(n)&&s(t,n,function(e){return{get:function(){return this[r]&&this[r][e]},set:function(t){this[r]||(this[r]={}),this[r][e]=t},configurable:!1,enumerable:!0}}(n))},e},z=function(e,t){var r=d(D,function(e,t){s(this,"items",{writable:!0,value:{}}),"string"==typeof e||e instanceof l?this.decode(e):void 0!==e&&(this.object=e,t&&this.check())},{object:{get:function(){return this},set:function(t){if(t instanceof r){this.items=t.items;for(var n in e){var i=this.getItemClass(n,this.items);i.combine&&i.combine(this,n)}}else{var o={};for(var n in e){var a=t[n],i=this.getItemClass(n,o);void 0!==a?o[n]=new i(a):i.combine&&(o[n]=new i(t)),i.combine&&i.combine(this,n)}this.items=o}}},getItemClass:function(t,r){return e[t]},encode:function(r){var n=[],i=this.items;for(var o in e)if(i[o]){var a=i[o].encode(!0);void 0!==a&&n.push(a)}return f(r,n,16,0,!0,t)},decode:function(e){this.object=this.constructor.decode(e)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(e,t){return new this(e).encode(t)},decode:function(r){r=h(r,16,0,!0,t);var n=0,i=new this,o=i.items={};for(var a in e){var s=i.getItemClass(a,o),c=s.decode(r[n]);void 0!==c&&(o[a]=c,s.combine&&s.combine(i,a),n++)}return i}});for(var n in e)s(r.prototype,n,function(t){return{get:function(){return this.items[t]&&this.items[t].object},set:function(e){if(void 0!==e){var r=this.getItemClass(t,this.items);this.items[t]=new r(e)}else delete this.items[t]},configurable:!1,enumerable:!e[t].combine}}(n)),e[n].combine&&e[n].combine(r.prototype,n);return r},Y=function(e,t,r,n,i){var o=z(e,i),c=function(i,u){t=t||"type",r=r||"value",u=u||n||P;var f=d(o,function(e){if(!(this instanceof f))return c.apply(this,arguments);o.apply(this,arguments)},{getItemClass:function(n,o){var a=e[n];if(r===n){var s,c=o&&o[t];if(c){var f=c.object;i&&(s="function"==typeof i?i(f):i[f])}s=s||u||P,a=a===P?s:a(s)}return a}});return s(f.prototype,t,{get:function(){return this.items[t]&&this.items[t].object},set:function(){a(!0)},configurable:!1,enumerable:!0}),f};return c()},Z=d(D,{encode:function(e){var t=this.object;return t=/^(\d+\.)+\d+$/.test(t)?t:v[t],a(!t),f(e,t,6)}},{decode:function(e){var t=h(e,6);return new this(m[t]||t)}}),J=function(e){return e=e||P,d(e,{encode:function(t){var r=e.method("encode").call(this,t);return"string"==typeof r||r instanceof l?r:4===r.tagNumber||0!==r.tagClass||r.object instanceof Array?{object:r.object}:{object:b.encode(r,"DER",!0)}}},{decode:function(t){return"string"==typeof t||t instanceof l?e.decode.call(this,t):(t={object:t.object,header:t.header,content:t.content},e.decode.call(this,t))}})},Q=function(e){return e=e||P,d(e,{encode:function(t){var r=e.method("encode").call(this,t);return"string"==typeof r||r instanceof l?r:{object:[r]}}},{decode:function(t){return"string"==typeof t||t instanceof l?e.decode.call(this,t):e.decode.call(this,t.object[0])}})},_=function(e,t){function r(){t.apply(this,arguments)}return d(t,r,{encode:function(r){var n=t.method("encode").call(this,r);return"string"==typeof n||n instanceof l?n:(n.tagNumber=e,n.tagClass=2,n.tagConstructed=n.object instanceof Array,n)}},{decode:function(r){return a(void 0!==r.tagNumber&&(2!==r.tagClass||r.tagNumber!==e)),t.decode.call(this,r)}})},$=function(e){return function(t,r){t=t||P;var n=function(i,o){var a="function"==typeof t&&void 0!==i?t(i,o):t;if(r){var u=d(D,function(e){if(!(this instanceof u))return n.apply(this,arguments);s(this,"items",{writable:!0,value:{}}),D.call(this,e||{})},{object:{get:function(){return this.read(),this},set:function(e){if(e instanceof u)e.read(),this.items=e.items;else{var t={};for(var r in e){var n=e[r];t[r]=this.createItem(n,r)}this.items=t}this.reset()}},createItem:function(e,t){if(r){var n={};n[r.typeName]=t,n[r.valueName]=e}else n=e;return new a(n)},getItemValue:function(e){var t=this.items[e];return r?t.object[r.valueName]:t.object},setItemValue:function(e,t){var n=this.items[e];r?n.object[r.valueName]=t:n.object=t},isItemType:function(e){return r?v[e]:!isNaN(parseInt(e))},reset:function(){var e=this.items;for(var t in this)this.hasOwnProperty(t)&&!this.items[t]&&this.isItemType(t)&&delete this[t];for(var t in e)this[t]=this.getItemValue(t)},read:function(){var e=this.items;for(var t in this)this.isItemType(t)&&(this.items[t]?this.getItemValue(t)!==this[t]&&this.setItemValue(t,this[t]):(e[t]=this.createItem(this[t],t),this[t]=this.getItemValue(t)))},encode:function(t){this.read();var r=this.items,n=[];for(var i in r){var o=r[i].encode(!0);void 0!==o&&n.push(o)}return f(t,n,e,0,!0)},decode:function(e){this.object=this.constructor.decode(e)},check:function(){this.constructor.decode(this.encode(!0))}},{encode:function(e,t){return new this(e).encode(t)},decode:function(t){t=h(t,e,0,!0);for(var n=new this,i=n.items={},o=0,s=t.length;o<s;o++){var c=a.decode(t[o]);i[r?c.object[r.typeName]:o]=c}return n.reset(),n}});return u}var y=d(D,function(e){if(!(this instanceof y))return n.apply(this,arguments);c(this,{items:{writable:!0,value:[]},values:{writable:!0,value:[]}}),D.call(this,e||[])},{object:{get:function(){return this.read(),this.values},set:function(e){if(e instanceof y)e.read(),this.items=e.items;else{for(var t=[],r=0,n=e.length;r<n;r++)t[r]=new a(e[r]);this.items=t}this.reset()}},encode:function(t){this.read();for(var r=this.items,n=[],i=0,o=r.length;i<o;i++){var a=r[i].encode(!0);void 0!==a&&n.push(a)}return f(t,n,e,0,!0)},decode:function(e){this.object=this.constructor.decode(e)},check:function(){this.constructor.decode(this.encode(!0))},reset:function(){for(var e=0,t=this.items.length;e<t;e++)this.values.push(this.items[e].object)},read:function(){for(var e=this.items,t=this.values,r=0,n=t.length;r<n;r++)this.items[r]?e[r].object!==t[r]&&(e[r].object=t[r]):(e[r]=new a(t[r]),t[r]=e[r].object)}},{encode:function(e,t){return new this(e).encode(t)},decode:function(t){t=h(t,e,0,!0);var r=new this;r.items=[];for(var n=0,i=t.length;n<i;n++)r.items.push(a.decode(t[n]));return r.reset(),r}});return y};return n()}},ee=$(16),te=$(17),re=function(e,t){if(t){var r=d(D,{object:{get:function(){return this.item?t.decode(this.item.object):void 0},set:function(r){void 0!==r?this.item=new e(t.encode(r)):delete this.item}},encode:function(e){return this.item.encode(e)}},{decode:function(t){var r=new this;return r.item=e.decode(t),r}});for(var n in e)r[n]||(r[n]=e[n]);return r}return e},ne=function(e){return re(te(e),{encode:function(e){return[e]},decode:function(e){return e[0]}})},ie=function(e,t){return d(D,{object:{get:function(){return this.item&&this.item.object},set:function(r){if(r instanceof D)for(var n in e)if(r instanceof e[n])return void(this.item=r);var n="function"==typeof t?t(r):t;a(!n||!e[n]),r=new e[n](r),this.item=r}},encode:function(e){return this.item.encode(e)}},{decode:function(t){for(var r in e)try{var n=e[r].decode(t);if(void 0!==n)return new this(n)}catch(e){}a(!0)}})},oe=function(e){return e=e||P,d(e,{encode:function(){return b.encode(e.method("encode").call(this,!0))}},{encode:function(e,t){return new this(e).encode(t)},decode:function(t){return e.decode.call(this,b.decode(t))}})},ae=function(e,t){return e=e||P,d(e,{encode:function(r){if(this.object!==t)return e.method("encode").call(this,r)}},{decode:function(r){if(void 0===r)return new this(t);try{return e.decode.call(this,r)}catch(e){return}}})},se=function(e){return e=e||P,d(e,{},{decode:function(t){if(void 0!==t)try{return e.decode.call(this,t)}catch(e){return}}})},ce=ie({teletexString:x,printableString:T,universalString:N,utf8String:G,bmpString:M,numericString:I},function(e){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(e)?"printableString":"utf8String"}),ue=ie({utcTime:U,generalTime:O},function(e){return e.getYear()>=2050?"generalTime":"utcTime"}),fe=Z,he=P,de=Y({type:fe,value:he}),ye={typeName:"type",valueName:"value"},pe=ne(de({serialName:T,countryName:T,dnQualifier:T,emailAddress:R,domainComponent:R,SNILS:I,OGRN:I,INN:I},ce)),le=ee(pe,ye)(),ge=ie({rdnSequence:le},"rdnSequence"),me=X(z({notBefore:ue,notAfter:ue})),ve=j,Ce=Y({type:Z,value:P}),Ae=te(Ce,ye),be=ee(Ce,ye),Fe=j,we=z({a:Fe,b:Fe,seed:se(q)}),Se=V(d(D,{encode:function(){var e=this.object,t=Math.max(o(e.x.length-2),o(e.y.length-2))/2,r=new Uint8Array(2*t+1);return r[0]=4,r.set(new Uint8Array(B.decode(e.x,!1,t)),1),r.set(new Uint8Array(B.decode(e.y,!1,t)),t+1),r.buffer}},{decode:function(e){var t=(e.byteLength-1)/2;return new this({x:B.encode(new Uint8Array(e,1,t)),y:B.encode(new Uint8Array(e,t+1,t))})}})),Ee=z({fieldType:Z,parameters:j}),Be=z({version:ve,fieldID:Ee,curve:we,base:Se,order:j,cofactor:se(j)}),De=z({publicKeyParamSet:Z,digestParamSet:Z,encryptionParamSet:se(Z)}),Ke=function(e,t){return e=e||P,d(e,{encode:function(r){return this.object===t?new H(null).encode(r):e.method("encode").call(this,r)}},{decode:function(r){if(void 0!==r){if(null===r||5===r.tagNumber&&0===r.tagClass)return new this(t);try{return e.decode.call(this,r)}catch(e){return}}}})}(Z,"id-GostR3411-94-CryptoProParamSet"),Pe=ie({namedParameters:Z,ecParameters:Be,implicitly:se(H)},function(e){return"string"==typeof e||e instanceof String?"namedParameters":"ecParameters"}),ke=function(e,t){return re(z({algorithm:Z,parameters:se(e)}),t)},Re=function(){var e=ke(P),t=d(D,function(e){if(!(this instanceof t))return r(e);t.super.apply(this,arguments)},{encode:function(t){return new e(this.object).encode(t)}},{decode:function(t){return new this(e.decode(t).object)}}),r=function(e){return d(D,{object:{get:function(){return this.item?this.item.object:void 0},set:function(t){if(t){var r=e[t.id];if(!r)throw new Error("Algorithm not supported");this.item=new r(t)}else delete this.item}},encode:function(e){return this.item.encode(e)}},{decode:function(t){"string"==typeof t&&(t=F.decode(t,void 0,!1)),t instanceof l&&(t=b.decode(t));var r=e[m[t.object[0].object]];if(r){var n=new this;return n.item=r.decode(t),n}throw new Error("Algorithm not supported")}})};return t}(),Ie=ke(Pe,{encode:function(e){var t;return t="string"==typeof e.namedCurve?C.namedCurve[e.namedCurve]:{version:1,fieldID:{fieldType:"id-prime-Field",parameters:e.curve.p},curve:{a:e.curve.a,b:e.curve.b},base:{x:e.curve.x,y:e.curve.y},order:e.curve.q,cofactor:1},{algorithm:e.id,parameters:t}},decode:function(e){var r=e.parameters,n=g[e.algorithm];if("string"==typeof r||r instanceof String)n=t(n,A[r]);else{if("object"!=typeof r)throw new DataError("Invalid key paramters");n=t(n,{curve:{p:r.fieldID.parameters,a:r.curve.a,b:r.curve.b,x:r.base.x,y:r.base.y,q:r.order}})}return n}}),Te=ke(De,{encode:function(e){var t=e.namedCurve?"namedCurve":"namedParam",r=e.name.indexOf("-94")>=0||e.name.indexOf("-2001")>=0||1994===e.version||2001===e.version?e.sBox||"D-A":e.name.indexOf("-512")>=0||512===e.length?"D-512":"D-256";return{algorithm:e.id,parameters:{publicKeyParamSet:C[t][e[t]],digestParamSet:C.sBox[r],encryptionParamSet:e.encParams&&e.encParams.sBox?C.sBox[e.encParams.sBox]:void 0}}},decode:function(e){var r=e.parameters,n=t(g[e.algorithm],A[r.publicKeyParamSet],A[r.digestParamSet]);return r.encryptionParamSet&&(n.encParams=A[r.encryptionParamSet]),n}}),xe=ke(P,{encode:function(e){return{algorithm:e.id}},decode:function(e){return g[e.algorithm]}}),Ge=ke(H,{encode:function(e){return{algorithm:e.id,parameters:null}},decode:function(e){return g[e.algorithm]}}),Ue=ke(Ke,{encode:function(e){return{algorithm:e.id,parameters:C.sBox[e.sBox||e.hash&&e.hash.sBox||"D-A"]}},decode:function(e){var r=t(g[e.algorithm]),n=A[e.parameters];return r.hash?r.hash=t(r.hash,n):r=t(r,n),r}}),Oe=Re({ecdsa:Ie,noSignature:Ge,rsaEncryption:Ge,"id-sc-gostR3410-2001":Ie,"id-GostR3410-2001":Te,"id-GostR3410-94":Te,"id-GostR3410-2001DH":Te,"id-GostR3410-94DH":Te,"id-tc26-gost3410-12-256":Te,"id-tc26-gost3410-12-512":Te,"id-tc26-agreement-gost-3410-12-256":Te,"id-tc26-agreement-gost-3410-12-512":Te,"id-sc-gost28147-gfb":xe,"id-Gost28147-89":xe}),Ne=Re({noSignature:Ge,rsaEncryption:Ge,sha1withRSAEncryption:Ge,sha256withRSAEncryption:Ge,sha384withRSAEncryption:Ge,sha512withRSAEncryption:Ge,ecdsa:xe,"ecdsa-with-SHA1":xe,"ecdsa-with-SHA256":xe,"ecdsa-with-SHA384":xe,"ecdsa-with-SHA512":xe,"id-GostR3410-94":Ge,"id-GostR3410-2001":Ge,"id-GostR3411-94-with-GostR3410-2001":xe,"id-GostR3411-94-with-GostR3410-94":xe,"id-tc26-gost3410-12-256":Ge,"id-tc26-gost3410-12-512":Ge,"id-tc26-signwithdigest-gost3410-12-94":xe,"id-tc26-signwithdigest-gost3410-12-256":xe,"id-tc26-signwithdigest-gost3410-12-512":xe,"id-sc-gostR3410-94":Ge,"id-sc-gostR3410-2001":Ge,"id-sc-gostR3411-94-with-gostR3410-94":Ge,"id-sc-gostR3411-94-with-gostR3410-2001":Ge}),Me=Re({sha1:xe,sha256:Ge,sha384:Ge,sha512:Ge,"id-GostR3411-94":Ue,"id-tc26-gost3411-94":Ue,"id-tc26-gost3411-12-256":Ge,"id-tc26-gost3411-12-512":Ge,"id-sc-gostR3411-94":xe}),He=V,Le=V,je=Z,We=V,Ve=z({iv:We,encryptionParamSet:je}),qe=z({encryptionParamSet:je,ukm:se(V)}),Xe=ke(Ve,{encode:function(e){return{algorithm:e.id,parameters:{iv:e.iv,encryptionParamSet:C.sBox[e.sBox||"E-A"]}}},decode:function(e){var r=t(g[e.algorithm],A[e.parameters.encryptionParamSet]);return r.iv=e.parameters.iv,r}}),ze=ke(We,{encode:function(e){return{algorithm:e.id,parameters:e.iv}},decode:function(e){var r=t(g[e.algorithm]);return r.iv=e.parameters||new Uint8Array([0,0,0,0,0,0,0,0]),r}}),Ye=ke(qe,{encode:function(e){return{algorithm:e.id,parameters:{encryptionParamSet:C.sBox[e.sBox||"E-A"],ukm:e.ukm}}},decode:function(e){var r=t(g[e.algorithm],A[e.parameters.encryptionParamSet]);return e.parameters.ukm&&(r.ukm=e.parameters.ukm),r}}),Ze=Re({"id-Gost28147-89-None-KeyWrap":Ye,"id-Gost28147-89-CryptoPro-KeyWrap":Ye}),Je=ke(Ze,{encode:function(e){return{algorithm:e.id,parameters:e.wrapping}},decode:function(e){var r=t(g[e.algorithm]);return r.wrapping=e.parameters,r}}),Qe=Re({"id-sc-gost28147-gfb":ze,"id-Gost28147-89":Xe}),_e=Re({"id-Gost28147-89-MAC":Ve,"id-HMACGostR3411-94":Ue,"id-tc26-hmac-gost-3411-12-256":Ue,"id-tc26-hmac-gost-3411-12-512":Ue,hmacWithSHA1:xe,hmacWithSHA224:xe,hmacWithSHA256:xe,hmacWithSHA384:xe,hmacWithSHA512:xe,"id-sc-gost28147-mac":xe,"id-sc-hmacWithGostR3411":xe}),$e=z({salt:ie({specified:V,otherSource:Re},function(e){return n(e)?"specified":"otherSource"}),iterationCount:j,keyLength:se(j),prf:_e}),et=ke($e,{encode:function(e){return{algorithm:e.id,parameters:{salt:e.salt,iterationCount:e.iterations,prf:e.hmac}}},decode:function(e){var r=t(g[e.algorithm]);return r.salt=e.parameters.salt,r.iterations=e.parameters.iterationCount,r.hmac=e.parameters.prf,r.hash=r.hmac.hash,r}}),tt=Re({PBKDF2:et}),rt=z({salt:V,iterationCount:j}),nt=ke(rt,{paramType:rt,encode:function(e){return{algorithm:e.id,parameters:{salt:e.derivation.salt,iterationCount:e.derivation.iterations}}},decode:function(e){var r=t(g[e.algorithm]);return r.derivation=t(r.derivation,{salt:e.parameters.salt,iterations:e.parameters.iterationCount}),r}}),it=z({keyDerivationFunc:tt,encryptionScheme:Qe}),ot=ke(it,{encode:function(e){return{algorithm:e.id,parameters:{keyDerivationFunc:e.derivation,encryptionScheme:e.encryption}}},decode:function(e){var r=t(g[e.algorithm]);return r.derivation=e.parameters.keyDerivationFunc,r.encryption=e.parameters.encryptionScheme,r}}),at=(Re({"pbeWithSHAAndAES128-CBC":nt,"pbeWithSHAAndAES192-CBC":nt,"pbeWithSHAAndAES256-CBC":nt,"pbeWithSHA256AndAES128-CBC":nt,"pbeWithSHA256AndAES192-CBC":nt,"pbeWithSHA256AndAES256-CBC":nt,"id-sc-pbeWithGost3411AndGost28147":nt,"id-sc-pbeWithGost3411AndGost28147CFB":nt,"pbeWithSHAAnd3-KeyTripleDES-CBC":nt,"pbeWithSHAAnd2-KeyTripleDES-CBC":nt,"pbeWithSHAAnd128BitRC2-CBC":nt,"pbeWithSHAAnd40BitRC2-CBC":nt,pbeUnknownGost:nt,PBES2:ot}),Re({ecdsa:Ie,rsaEncryption:Ge,"id-sc-gost28147-gfb":ze,"id-Gost28147-89":Xe,"id-sc-gostR3410-2001":Ie,"id-GostR3410-2001":Te,"id-GostR3410-94":Te,"id-tc26-gost3410-12-256":Te,"id-tc26-gost3410-12-512":Te,"id-GostR3410-94-CryptoPro-ESDH":Je,"id-GostR3410-2001-CryptoPro-ESDH":Je,"id-tc26-agreement-gost-3410-12-256":Je,"id-tc26-agreement-gost-3410-12-512":Je,"id-sc-r3410-ESDH-r3411kdf":Ge,"id-Gost28147-89-None-KeyWrap":Ye,"id-Gost28147-89-CryptoPro-KeyWrap":Ye,"id-sc-cmsGostWrap":xe,"id-sc-cmsGost28147Wrap":xe,"pbeWithSHAAndAES128-CBC":nt,"pbeWithSHAAndAES192-CBC":nt,"pbeWithSHAAndAES256-CBC":nt,"pbeWithSHA256AndAES128-CBC":nt,"pbeWithSHA256AndAES192-CBC":nt,"pbeWithSHA256AndAES256-CBC":nt,"id-sc-pbeWithGost3411AndGost28147":nt,"id-sc-pbeWithGost3411AndGost28147CFB":nt,"pbeWithSHAAnd3-KeyTripleDES-CBC":nt,"pbeWithSHAAnd2-KeyTripleDES-CBC":nt,"pbeWithSHAAnd128BitRC2-CBC":nt,"pbeWithSHAAnd40BitRC2-CBC":nt,pbeUnknownGost:nt,PBES2:ot})),st=z({keyDerivationFunc:tt,messageAuthScheme:_e}),ct=ke(st,{encode:function(e){return{algorithm:e.id,parameters:{keyDerivationFunc:e.derivation,messageAuthScheme:e.hmac}}},decode:function(e){var r=t(g[e.algorithm]);return r.derivation=e.parameters.keyDerivationFunc,r.hmac=e.parameters.messageAuthScheme,r}}),ut=(Re({PBMAC1:ct}),Re({"id-sc-gost28147-gfb":ze,"id-Gost28147-89":Xe,"pbeWithSHAAndAES128-CBC":nt,"pbeWithSHAAndAES192-CBC":nt,"pbeWithSHAAndAES256-CBC":nt,"pbeWithSHA256AndAES128-CBC":nt,"pbeWithSHA256AndAES192-CBC":nt,"pbeWithSHA256AndAES256-CBC":nt,"id-sc-pbeWithGost3411AndGost28147":nt,"id-sc-pbeWithGost3411AndGost28147CFB":nt,"pbeWithSHAAnd3-KeyTripleDES-CBC":nt,"pbeWithSHAAnd2-KeyTripleDES-CBC":nt,"pbeWithSHAAnd128BitRC2-CBC":nt,"pbeWithSHAAnd40BitRC2-CBC":nt,pbeUnknownGost:nt,PBES2:ot})),ft=re,ht=ft(q(oe(j)),{encode:function(e){return E.encode(r(e))},decode:function(e){return r(E.decode(e))}}),dt=ft(q(oe(V)),{encode:function(e){var t=new Uint8Array(e.byteLength+1),n=r(e),i=e.byteLength/2;return t[0]=4,t.set(new Uint8Array(n,i,i),1),t.set(new Uint8Array(n,0,i),i+1),t.buffer},decode:function(e){a(0==(1&e.byteLength));var t=new Uint8Array(e.byteLength-1),n=t.byteLength/2;return t.set(new Uint8Array(e,n+1,n),0),t.set(new Uint8Array(e,1,n),n),r(t)}}),yt=q(oe(V)),pt=z({algorithm:Oe,subjectPublicKey:q},"PUBLIC KEY"),lt=function(e){return re(Y({algorithm:Oe,subjectPublicKey:P},"algorithm","subjectPublicKey")(function(t){return e[t.id]}),{encode:function(e){return{algorithm:e.algorithm,subjectPublicKey:e.buffer}},decode:function(e){return{algorithm:e.algorithm,type:"public",extractable:!0,usages:["verify","deriveKey","deriveBits"],buffer:e.subjectPublicKey}}})}({"id-sc-gostR3410-2001":dt,"id-sc-gostR3410-94":ht,"id-GostR3410-2001":yt,"id-GostR3410-94":yt,"id-tc26-gost3410-12-256":yt,"id-tc26-gost3410-12-512":yt}),gt=V,mt=ft(gt(oe(j)),{encode:function(e){return B.encode(e,!0)},decode:function(e){return B.decode(e,!0)}}),vt=V,Ct=z({keyValueMask:vt,keyValyePublicKey:V}),At=ie({privateKey:gt(oe(ie({keyValueMask:vt,keyValueInfo:Ct},function(e){return n(e)?"keyValueMask":"keyValueInfo"}))),keyValueMask:vt},function(e){return e.enclosed?"keyValueMask":"privateKey"}),bt=function(e){return Y({version:ve,privateKeyAlgorithm:Oe,privateKeyWrapped:ft(gt(oe(z({keyData:j,keyMac:j}))),{encode:function(e){var t=e.byteLength-4;return{keyData:B.encode(new Uint8Array(e,0,t)),keyMac:B.encode(new Uint8Array(e,t,4))}},decode:function(e){var t=B.decode(e.keyData),r=B.decode(e.keyMac),n=new Uint8Array(t.byteLength+r.byteLength);return n.set(new Uint8Array(t)),n.set(new Uint8Array(r),t.byteLength),n}}),attributes:P},"privateKeyAlgorithm","attributes")(function(t){return se(_(0,J(Ae({"id-sc-gostR3410-2001-publicKey":ne(e[t.id])}))))})}({"id-sc-gostR3410-2001":dt,"id-sc-gostR3410-94":ht,"id-GostR3410-2001":yt,"id-GostR3410-94":yt,"id-GostR3410-2001DH":yt,"id-GostR3410-94DH":yt,"id-tc26-gost3410-12-256":yt,"id-tc26-gost3410-12-512":yt,"id-tc26-agreement-gost-3410-12-256":yt,"id-tc26-agreement-gost-3410-12-512":yt}),Ft=z({version:ve,privateKeyAlgorithm:Oe,privateKey:gt,attributes:se(_(0,J(Ae)))},"PRIVATE KEY"),wt=Oe,St=q,Et=z({version:ve,privateKeyAlgorithm:wt,privateKey:gt,attributes:se(_(0,J(Ae))),publicKey:se(_(1,J(St)))}),Bt=ee(Et),Dt=function(e){return re(Y({version:ve,privateKeyAlgorithm:Oe,privateKey:P,attributes:se(_(0,J(Ae)))},"privateKeyAlgorithm","privateKey")(function(t){return e[t.id]}),{encode:function(e){return{version:0,privateKeyAlgorithm:e.algorithm,privateKey:e.buffer}},decode:function(e){return{algorithm:e.privateKeyAlgorithm,type:"private",extractable:!0,usages:["sign","deriveKey","deriveBits"],buffer:n(e.privateKey)?e.privateKey:e.privateKey.keyValueMask}}})}({"id-sc-gostR3410-2001":mt,"id-sc-gostR3410-94":mt,"id-GostR3410-2001":At,"id-GostR3410-94":At,"id-GostR3410-2001DH":At,"id-GostR3410-94DH":At,"id-tc26-gost3410-12-256":At,"id-tc26-gost3410-12-512":At,"id-tc26-agreement-gost-3410-12-256":At,"id-tc26-agreement-gost-3410-12-512":At}),Kt=V,Pt=z({encryptionAlgorithm:at,encryptedData:Kt},"ENCRYPTED PRIVATE KEY"),kt=q,Rt=j,It=z({cA:ae(k,!1),pathLenConstraint:se(j)}),Tt=q({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8}),xt=Z,Gt=ee(xt),Ut=V,Ot=z({type:Z,value:_(0,Q(P))}),Nt=z({nameAssigner:se(_(0,J(ce))),partyName:se(_(1,J(ce)))}),Mt=z({}),Ht=ie({otherName:_(0,J(Ot)),rfc822Name:_(1,J(ce)),dNSName:_(2,J(ce)),x400Address:_(3,J(Mt)),directoryName:_(4,Q(ge)),ediPartyName:_(5,J(Nt)),uniformResourceIdentifier:_(6,J(ce)),iPAddress:_(7,J(V)),registeredID:_(8,J(Z))},function(e){return"string"==typeof e||e instanceof String?e.indexOf("@")>=0?"rfc822Name":"dNSName":n(e)?"iPAddress":"directoryName"}),Lt=ee(Ht),jt=z({keyIdentifier:se(_(0,J(Ut))),authorityCertIssuer:se(_(1,J(Lt))),authorityCertSerialNumber:se(_(2,J(Rt)))}),Wt=z({notBefore:se(_(0,J(O))),notAfter:se(_(1,J(O)))}),Vt=Z,qt=Z,Xt=z({policyQualifierId:qt,qualifier:P}),zt=z({policyIdentifier:Vt,policyQualifiers:se(ee(Xt))}),Yt=z({issuerDomainPolicy:Vt,subjectDomainPolicy:Vt}),Zt=j,Jt=z({base:Ht,minimum:ae(_(0,J(Zt)),0),maximum:se(_(1,J(Zt)))}),Qt=ee(Jt),_t=z({permittedSubtrees:se(_(0,J(Qt))),excludedSubtrees:se(_(1,J(Qt)))}),$t=j,er=z({requireExplicitPolicy:se(_(0,J($t))),inhibitPolicyMapping:se(_(1,J($t)))}),tr=q({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8}),rr=ie({fullName:_(0,J(Lt)),nameRelativeToCRLIssuer:_(1,J(pe))},function(e){return e instanceof Array?"fullName":"nameRelativeToCRLIssuer"}),nr=z({distributionPoint:se(_(0,Q(rr))),reasons:se(_(1,J(tr))),cRLIssuer:se(_(2,J(Lt)))}),ir=ee(nr),or=ir,ar=z({accessMethod:Z,accessLocation:Ht}),sr=function(e,t){var r=Y({extnID:Z,critical:ae(k,!1),extnValue:function(e){return V(oe(e))}},"extnID","extnValue"),n=d(r(e),{object:{get:function(){var e=this._get(n.super,"object");return e&&"object"==typeof e.extnValue&&this.defineValue(e.extnValue),e},set:function(e){this._set(n.super,"object",e),e&&e.extnValue&&(void 0!==e.extnValue.critical?this.critical=e.extnValue.critical:void 0===this.critical&&t&&(this.critical=t(this.extnID,e.extnValue)))}},extnValue:{get:function(){var e=this._get(n.super,"extnValue");return"object"==typeof e&&this.defineValue(e),e},set:function(e){this._set(n.super,"extnValue",e),e&&(void 0!==e.critical?this.critical=e.critical:void 0===this.critical&&t&&(this.critical=t(this.extnID,e)))}},defineValue:function(e){if("object"==typeof e&&!u(e,"critical")){var t=this;s(e,"critical",{get:function(){return t.critical},set:function(e){t.critical=e},enumerable:!0,configurable:!1})}}});return n},cr=z({signTool:G,cATool:G,signToolCert:G,cAToolCert:G}),ur=ee(sr,{typeName:"extnID",valueName:"extnValue"}),fr=ur({authorityKeyIdentifier:jt,subjectKeyIdentifier:Ut,keyUsage:Tt,privateKeyUsagePeriod:Wt,certificatePolicies:ee(zt),policyMappings:ee(Yt),subjectAltName:Lt,issuerAltName:Lt,subjectDirectoryAttributes:be,basicConstraints:It,nameConstraints:_t,policyConstraints:er,extKeyUsage:Gt,cRLDistributionPoints:ir,inhibitAnyPolicy:$t,freshestCRL:or,authorityInfoAccess:ee(ar),subjectInfoAccess:ee(ar),subjectSignTool:G,issuerSignTool:cr},function(e,t){return"keyUsage"===e||"basicConstraints"===e&&void 0===t.pathLenConstraint}),hr=z({r:j,s:j}),dr=hr,yr=X(z({version:_(0,Q(ve)),serialNumber:Rt,signature:Ne,issuer:ge,validity:me,subject:ge,subjectPublicKeyInfo:pt,issuerUniqueID:se(_(1,J(kt))),subjectUniqueID:se(_(2,J(kt))),extensions:se(_(3,Q(fr)))})),pr=z({tbsCertificate:yr,signatureAlgorithm:Ne,signatureValue:q},"CERTIFICATE"),lr=fr,gr=Ae({challengePassword:ne(ce),extensionRequest:ne(lr),msCertExtensions:ne(fr),extendedCertificateAttributes:ne(Ae)}),mr=X(z({version:j,subject:ge,subjectPublicKeyInfo:pt,attributes:_(0,J(gr))})),vr=z({requestInfo:mr,signatureAlgorithm:Ne,signatureValue:q},"CERTIFICATE REQUEST"),Cr=j,Ar=W({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10}),br=z({distributionPoint:se(_(0,Q(rr))),onlyContainsUserCerts:ae(_(1,J(k)),!1),onlyContainsCACerts:ae(_(2,J(k)),!1),onlySomeReasons:se(_(3,J(tr))),indirectCRL:ae(_(4,J(k)),!1),onlyContainsAttributeCerts:ae(_(5,J(k)),!1)}),Fr=ur({authorityKeyIdentifier:jt,issuerAltName:Lt,cRLNumber:Cr,deltaCRLIndicator:Cr,issuingDistributionPoint:br,freshestCRL:or},function(e){return"cRLNumber"===e}),wr=ur({cRLReason:Ar,instructionCode:Z,invalidityDate:O,certificateIssuer:Lt}),Sr=X(z({version:se(ve),signature:Ne,issuer:ge,thisUpdate:ue,nextUpdate:se(ue),revokedCertificates:se(ee(z({userCertificate:Rt,revocationDate:ue,crlEntryExtensions:se(wr)}))),crlExtensions:se(_(0,Q(Fr)))})),Er=z({tbsCertList:Sr,signatureAlgorithm:Ne,signatureValue:q},"CRL"),Br=j,Dr=z({digestedObjectType:W({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:se(Z),digestAlgorithm:Me,objectDigest:q}),Kr=z({issuer:Lt,serial:Rt,issuerUID:se(kt)}),Pr=z({issuerName:se(Lt),baseCertificateID:se(_(0,J(Kr))),objectDigestInfo:se(_(1,J(Dr)))}),kr=z({targetCertificate:Kr,targetName:se(Ht),certDigestInfo:se(Dr)}),Rr=ie({targetName:_(0,Q(Ht)),targetGroup:_(1,Q(Ht)),targetCert:_(2,J(kr))}),Ir=ee(Rr),Tr=ur({auditIdentity:V,targetInformation:Ir,authorityKeyIdentifier:jt,authorityInfoAccess:ee(ar),cRLDistributionPoints:ir,noRevAvail:H},function(e){return"auditIdentity"===e||"targetInformation"===e}),xr=z({baseCertificateID:se(_(0,J(Kr))),entityName:se(_(1,J(Lt))),objectDigestInfo:se(_(2,J(Dr)))}),Gr=ie({v1Form:Lt,v2Form:_(0,J(Pr))},"v2Form"),Ur=z({notBeforeTime:O,notAfterTime:O}),Or=z({service:Ht,ident:Ht,authInfo:se(V)}),Nr=z({roleAuthority:se(_(0,J(Lt))),roleName:_(1,Q(Ht))}),Mr=q({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5}),Hr=z({type:_(0,J(Z)),value:_(1,J(P))}),Lr=z({policyId:_(0,J(Z)),classList:ae(_(1,J(Mr)),["unclassified"]),securityCategories:se(_(2,J(te(Hr))))}),jr=z({policyAuthority:se(_(0,J(Lt))),values:ee(ie({octets:V,oid:Z,string:G},function(e){return n?"octets":getIdentifier(e)?"oid":"string"}))}),Wr=X(z({version:Br,holder:xr,issuer:Gr,signature:Ne,serialNumber:Rt,attrCertValidityPeriod:Ur,attributes:be({authenticationInfo:te(Or),accessIdentity:te(Or),chargingIdentity:ne(jr),group:ne(jr),role:te(Nr),clearance:te(Lr)}),issuerUniqueID:se(kt),extensions:se(Tr)})),Vr=z({acinfo:Wr,signatureAlgorithm:Ne,signatureValue:q},"ATTRIBUTE CERTIFICATE"),qr=V,Xr=V,zr=V,Yr=V,Zr=(z({keyInfo:Ze,entityUInfo:se(_(0,Q(V))),suppPubInfo:_(2,Q(V))}),re(z({encryptedKey:He,maskKey:se(_(0,J(He))),macKey:Le}),{encode:function(e){return{encryptedKey:new Uint8Array(new Uint8Array(e,0,32)).buffer,macKey:new Uint8Array(new Uint8Array(e,32,4)).buffer}},decode:function(e){var t=e.encryptedKey,r=e.maskKey,n=e.macKey;if(r)for(var i=new Int32Array(r),o=new Int32Array(t),a=0,s=i.length/o.length;a<s;a++)for(var c=0,u=o.length;c<u;c++)o[c]=o[c]+i[u*a+c]&4294967295;var f=new Uint8Array(t.byteLength+n.byteLength);return f.set(new Uint8Array(t),0),f.set(new Uint8Array(n),32),f.buffer}})),Jr=z({encryptionParamSet:je,ephemeralPublicKey:se(_(0,J(lt))),ukm:V}),Qr=re(z({sessionEncryptedKey:Zr,transportParameters:se(_(0,J(Jr)))}),{encode:function(e){var t=e.algorithm;return{sessionEncryptedKey:e.sessionEncryptedKey,transportParameters:{encryptionParamSet:C.sBox[t.wrapping.sBox||"E-A"],ephemeralPublicKey:t.public,ukm:t.ukm}}},decode:function(e){return{algorithm:{wrapping:A[e.transportParameters.encryptionParamSet],ukm:e.transportParameters.ukm,public:e.transportParameters.ephemeralPublicKey},sessionEncryptedKey:e.sessionEncryptedKey}}}),_r=re(z({sessionEncryptedKey:Zr,ukm:z({ephemeralPublicKey:lt,addedukm:se(_(0,Q(Yr)))})}),{encode:function(e){var t=e.algorithm;return{sessionEncryptedKey:e.sessionEncryptedKey,ukm:{ephemeralPublicKey:t.public,addedukm:t.ukm}}},decode:function(e){return{algorithm:{ukm:e.ukm.addedukm,public:e.ukm.ephemeralPublicKey},sessionEncryptedKey:e.sessionEncryptedKey}}}),$r=function(e){return function(t){var r=e[t.id];return r?oe(r):P}}({"id-sc-gostR3410-2001":_r,"id-sc-gostR3410-94":_r,"id-GostR3410-2001":Qr,"id-GostR3410-94":Qr,"id-tc26-gost3410-12-256":Qr,"id-tc26-gost3410-12-512":Qr,"id-GostR3410-94-CryptoPro-ESDH":Zr,"id-GostR3410-2001-CryptoPro-ESDH":Zr,"id-tc26-agreement-gost-3410-12-256":Zr,"id-tc26-agreement-gost-3410-12-512":Zr,"id-sc-r3410-ESDH-r3411kdf":Zr,"id-Gost28147-89-None-KeyWrap":Zr,"id-Gost28147-89-CryptoPro-KeyWrap":Zr,"id-sc-cmsGostWrap":Zr,"id-sc-cmsGost28147Wrap":Zr}),en=q({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3}),tn=q({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5}),rn=z({attributes:se(tn),privateKeyAlgorithm:se(_(0,J(Oe)))}),nn=z({path:R,hmac:Le}),on=Re,an=z({containerAlgoritmIdentifier:se(_(0,J(Re))),containerName:se(R),attributes:en,primaryPrivateKeyParameters:rn,hmacPassword:se(_(2,J(Le))),secondaryEncryptedPrivateKey:se(_(3,J(Zr))),secondaryPrivateKeyParameters:se(_(4,J(rn))),primaryCertificate:se(_(5,J(V(oe(pr))))),secondaryCertificate:se(_(6,J(V(oe(pr))))),encryptionContainerName:se(_(7,J(R))),primaryCertificateLink:se(_(8,J(nn))),secondaryCertificateLink:se(_(9,J(nn))),primaryFP:se(_(10,J(V))),secondaryFP:se(_(11,J(V))),passwordPolicy:se(on),containerSecurityLevel:se(j),extensions:se(_(12,J(ur({keyValidity:z({notBefore:se(_(0,J(O))),notAfter:se(_(1,J(O)))})})))),secondaryEncryptionContainerName:se(_(13,J(R)))}),sn=z({keyContainerContent:an,hmacKeyContainerContent:Le}),cn=z({containerName:R,extElem1:se(P)}),un=z({primaryKey:He,secondaryKey:se(He),hmacKey:se(Le)}),fn=z({mask:He,randomStatus:V,hmacRandom:Le}),hn=z({keyClass:j,keyType:j,algorithm:se(_(0,Q(Oe))),serialNumber:se(_(1,Q(V))),addSerialNumber:se(_(2,Q(V))),certSerialNumber:se(_(3,Q(V))),subjectUID:se(_(4,Q(V))),recipientUID:se(_(5,Q(V))),validity:se(_(6,Q(ie({validity:me,keyValidity:z({notBefore:se(_(0,J(O))),notAfter:se(_(1,J(O)))})},function(){return"keyValidity"})))),keyUID:se(_(7,Q(q))),flags:se(_(10,Q(j)))}),dn=z({version:j,keyInfo:hn,defenceKeyInfo:hn,certificate:se(_(0,Q(pr))),publicKey:se(_(1,Q(V)))}),yn=j,pn=Z,ln=ue,zr=V,gn=V,mn=V,vn=j,Cn=ee(vn),An=z({bodyPartPath:Cn,identifier:Z,content:P}),bn=Ae({contentType:ne(pn),signingTime:ne(ln),messageDigest:ne(V)}),Fn=Ae(function(e){return{countersignature:te(Pn),unsignedData:te(An)}[e]}),wn=bn,Sn=Ae,En=Ae,Bn=z({issuer:ge,serialNumber:Rt}),Dn=ie({issuerAndSerialNumber:Bn,subjectKeyIdentifier:_(0,J(zr))},function(e){return n(e)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Kn=z({version:yn,sid:Dn,digestAlgorithm:Me,signedAttrs:se(_(0,J(bn))),signatureAlgorithm:Ne,signatureValue:V,unsignedAttrs:se(_(1,J(Fn)))}),Pn=Kn,kn=te(Kn),Rn=te(Me),In=Vr,Tn=X(z({version:yn,certificate:pr,attributes:Sn})),xn=z({extendedCertificateInfo:Tn,signatureAlgorithm:Ne,signatureValue:q}),Gn=z({otherCertFormat:Z,otherCert:P}),Un=X(z({version:j,subject:ie({baseCertificateID:_(0,J(Kr)),subjectName:_(1,J(Lt))},function(e){return e.issuer?"baseCertificateID":"subjectName"}),issuer:Lt,signature:Ne,serialNumber:Rt,attCertValidityPeriod:Ur,attributes:be,issuerUniqueID:se(kt),extensions:se(fr)})),On=z({acInfo:Un,signatureAlgorithm:Ne,signatureValue:q}),Nn=z({eContentType:pn,eContent:se(_(0,Q(V)))}),Mn=ie({certificate:pr,extendedCertificate:_(0,J(xn)),v1AttrCert:_(1,J(On)),v2AttrCert:_(2,J(In)),other:_(3,J(Gn))},function(e){return e.holder?"AttributeCertificateV2":e.certificate?"ExtendedCertificate":e.otherCertFormat?"other":"certificate"}),Hn=z({otherRevInfoFormat:Z,otherRevInfo:P}),Ln=ie({crl:Er,other:_(1,J(Hn))},function(e){return e.otherRevInfoFormat?"other":"crl"}),jn=te(Mn),Wn=te(Ln),Vn=z({version:yn,digestAlgorithms:Rn,encapContentInfo:Nn,certificates:se(_(0,J(jn))),crls:se(_(1,J(Wn))),signerInfos:kn}),qn=ie({issuerAndSerialNumber:Bn,subjectKeyIdentifier:_(0,J(zr))},function(e){return n(e)?"subjectKeyIdentifier":"issuerAndSerialNumber"}),Xn=z({version:yn,rid:qn,keyEncryptionAlgorithm:at,encryptedKey:qr}),zn=z({keyAttrId:Z,keyAttr:se(P)}),Yn=z({subjectKeyIdentifier:zr,date:se(O),other:se(zn)}),Zn=ie({issuerAndSerialNumber:Bn,rKeyId:_(0,J(Yn))},function(e){return n(e)?"rKeyId":"issuerAndSerialNumber"}),Jn=z({rid:Zn,encryptedKey:qr}),Qn=ee(Jn),_n=z({algorithm:Oe,publicKey:q}),$n=(z({ephemeralPublicKey:_n,addedukm:se(_(0,Q(Yr)))}),ie({issuerAndSerialNumber:Bn,subjectKeyIdentifier:_(0,J(zr)),originatorKey:_(1,J(_n))},function(e){return n(e)?"subjectKeyIdentifier":e.algorithm?"originatorKey":"issuerAndSerialNumber"})),ei=z({version:yn,originator:_(0,Q($n)),ukm:se(_(1,Q(Yr))),keyEncryptionAlgorithm:at,recipientEncryptedKeys:Qn}),ti=z({keyIdentifier:V,date:se(O),other:se(zn)}),ri=z({version:yn,kekid:ti,keyEncryptionAlgorithm:at,encryptedKey:qr}),ni=z({version:yn,friendlyName:se(_(0,J(tt))),keyEncryptionAlgorithm:at,encryptedKey:qr}),ii=z({oriType:Z,oriValue:P}),oi=ie({ktri:Xn,kari:_(1,J(ei)),kekri:_(2,J(ri)),pwri:_(3,J(ni)),ori:_(4,J(ii))},function(e){return e.rid?"ktri":e.originator?"kari":e.kekid?"kekri":e.oriType?"ori":"pwri"}),ai=z({certs:se(_(0,J(jn))),crls:se(_(1,J(Wn)))}),si=te(oi),ci=z({contentType:pn,contentEncryptionAlgorithm:ut,encryptedContent:se(_(0,J(Xr)))}),ui=z({version:yn,originatorInfo:se(_(0,J(ai))),recipientInfos:si,encryptedContentInfo:ci,unprotectedAttrs:se(_(1,J(En)))}),fi=z({version:yn,digestAlgorithm:Me,encapContentInfo:Nn,digest:gn}),hi=z({version:yn,encryptedContentInfo:ci,unprotectedAttrs:se(_(1,J(En)))}),di=z({version:yn,originatorInfo:se(_(0,J(ai))),recipientInfos:si,macAlgorithm:_e,digestAlgorithm:se(_(1,Me)),encapContentInfo:Nn,authAttrs:se(_(2,J(wn))),mac:mn,unauthAttrs:se(_(3,J(Sn)))}),yi=z({version:yn,originatorInfo:se(_(0,J(ai))),recipientInfos:si,authEncryptedContentInfo:ci,authAttrs:se(_(1,J(wn))),mac:mn,unauthAttrs:se(_(2,J(Sn)))}),pi=ie({encrypted:hi,enveloped:_(0,J(ui)),authEnveloped:_(1,J(yi))},function(e){return e.encryptedContentInfo?e.recipientInfos?"enveloped":"encrypted":"authEnveloped"}),pn=Z,li=Y({contentType:pn,content:function(e){return _(0,Q(e))}},"contentType","content",void 0,"CMS")({data:V,signedData:X(Vn),envelopedData:X(ui),digestedData:X(fi),encryptedData:X(hi),authData:X(di),encryptedKeyPkg:X(pi),aKeyPackage:X(Bt)}),gi=z({digestAlgorithm:Me,digest:gn}),mi=Ae({friendlyName:ne(M),keyProviderNameAttr:ne(M),localKeyId:ne(V),certKeyIdentifierPropId:ne(V)}),vi=Z,Ci=Z,Ai=Z,bi=Z,Fi=Ft,wi=Pt,Si=Y({certId:Ci,certValue:function(e){return _(0,Q(e))}},"certId","certValue")({x509Certificate:V(oe(pr)),sdsiCertificate:R},V),Ei=Y({crlId:Ai,crlValue:function(e){return _(0,Q(e))}},"crlId","crlValue")({x509CRL:V(oe(Er))},V),Bi=Y({secretTypeId:bi,secretValue:function(e){return _(0,Q(e))}},"secretTypeId","secretValue")({secret:V},V),Di=Y({bagId:vi,bagValue:function(e){return _(0,Q(e))},bagAttributes:se(mi)},"bagId","bagValue")(function(e){return{keyBag:Fi,pkcs8ShroudedKeyBag:wi,certBag:Si,crlBag:Ei,secretBag:Bi,safeContentsBag:Ki}[e]}),Ki=ee(Di),Pi=ee(li),ki=z({mac:gi,macSalt:V,iterations:ae(j,1)}),Ri=z({version:j,authSafe:li,macData:se(ki)},"PFX"),Ii=G,Ti=G,xi=z({issuer:Ht,serialNumber:j}),Gi=xi,Ui=pt,Oi=z({intendedAlg:se(_(0,J(Re))),symmAlg:se(_(1,J(Re))),encSymmKey:se(_(2,J(q))),keyAlg:se(_(3,J(Re))),valueHint:se(_(4,J(V))),encValue:q}),Ni=V,qr=ie({encryptedValue:Oi,envelopedData:_(0,J(ui))},function(e){return e.encryptedContentInfo?"envelopedData":"encryptedValue"}),Mi=ie({encryptedPrivKey:_(0,qr),keyGenParameters:_(1,J(Ni)),archiveRemGenPrivKey:_(2,J(k))}),Hi=z({pubMethod:j({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:se(Ht)}),Li=z({action:j({dontPublish:0,pleasePublish:1}),pubInfos:se(ee(Hi))}),ji=j({encrCert:0,challengeResp:1}),Wi=ie({thisMessage:_(0,J(q)),subsequentMessage:_(1,J(ji)),dhMAC:_(2,J(q)),agreeMAC:_(3,J(Vi)),encryptedKey:_(4,J(ui))}),Vi=(z({salt:V,owf:Re,iterationCount:j,mac:Re}),z({algId:Re,value:q})),qi=z({authInfo:ie({sender:_(0,Q(Ht)),publicKeyMAC:Vi}),publicKey:pt}),Xi=z({poposkInput:se(_(0,qi)),algorithmIdentifier:Re,signature:q}),zi=ie({raVerified:_(0,J(H)),signature:_(1,J(Xi)),keyEncipherment:_(2,J(Wi)),keyAgreement:_(3,J(Wi))}),Yi=ee(de({regToken:Ii,authenticator:Ti,pkiPublicationInfo:Li,pkiArchiveOptions:Mi,oldCertID:Gi,protocolEncrKey:Ui})),Zi=z({notBefore:se(_(0,J(ue))),notAfter:se(_(1,J(ue)))}),Ji=z({version:se(_(0,J(ve))),serialNumber:se(_(1,J(j))),signingAlg:se(_(2,J(Re))),issuer:se(_(3,J(ge))),validity:se(_(4,J(Zi))),subject:se(_(5,J(ge))),publicKey:se(_(6,J(pt))),issuerUID:se(_(7,J(kt))),subjectUID:se(_(8,J(kt))),extensions:se(_(9,J(ur)))}),Qi=z({certReqId:j,certTemplate:Ji,controls:se(Yi)}),_i=G,$i=Qi,eo=z({privateKey:Ft,identifier:se(ie({string:G,generalName:Ht},function(e){return"string"==typeof e||e instanceof String?"string":"generalName"}))}),to=z({certReq:Qi,popo:se(zi),regInfo:se(ee(de({utf8Pairs:_i,certReq:$i,encKeyWithID:eo})))}),ro=(ee(to),z({pendToken:V,pendTime:O})),no=j({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7}),io=j({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13}),oo=z({cMCStatus:no,bodyList:ee(vn),statusString:se(G),otherInfo:se(ie({failInfo:io,pendInfo:ro}))}),ao=z({pkiDataReference:vn,certReferences:ee(vn),extensions:ee(sr)}),so=z({pkiDataBodyid:vn,bodyIds:ee(vn)}),co=z({issuerName:Ht,serialNumber:j}),uo=z({issuerName:ge,cRLName:se(Ht),time:se(O),reasons:se(tr)}),fo=z({issuerName:ge,serialNumber:j,reason:Ar,invalidityDate:se(O),passphrase:se(V),comment:se(G)}),ho=z({bodyPartID:vn,thePOPAlgID:Re,thePOP:V}),yo=Bn,po=ie({bodyPartID:vn,bodyPartPath:Cn}),lo=z({cMCStatus:no,bodyList:ee(po),statusString:se(G),otherInfo:se(ie({failInfo:io,pendInfo:ro,extendedFailInfo:z({failInfoOID:Z,failInfoValue:he})}))}),go=z({seqNumber:j,hashAlgorithm:Re,anchorHashes:ee(V)}),mo=vn,vo=ee(vn),Co=z({hashAlg:Re,certHashes:ee(V),pubInfo:Li}),Ao=z({pkiDataReference:Cn,certReferences:vo,replace:ae(k,!0),certTemplate:Ji}),bo=z({bodyList:ee(po)}),Fo=z({proofAlgID:Re,macAlgId:Re,witness:V}),wo=z({keyGenAlgorithm:Re,macAlgorithm:Re,witness:V}),So=z({bodyPartID:vn,certificationRequest:vr}),Eo=z({bodyPartID:vn,contentInfo:li}),Bo=z({bodyPartID:vn,otherMsgType:Z,otherMsgValue:P}),Do=ie({tcr:_(0,J(So)),crm:_(1,J(to)),orm:_(2,J(z({bodyPartID:vn,requestMessageType:Z,requestMessageValue:P})))}),Ko=z({request:Do,cms:li,thePOPAlgID:Re,witnessAlgID:Re,witness:V}),Po=Y({bodyPartID:vn,attrType:Z,attrValues:function(e){return te(e)}},"attrType","attrValues",he)({statusInfo:oo,identification:G,identityProof:V,dataReturn:V,transactionId:j,senderNonce:V,recipientNonce:V,addExtensions:ao,encryptedPOP:Ko,decryptedPOP:ho,lraPOPWitness:so,getCert:co,getCRL:uo,revokeRequest:fo,regInfo:V,responseInfo:V,queryPending:V,popLinkRandom:V,popLinkWitness:V,confirmCertAcceptance:yo,statusInfoV2:lo,trustedAnchors:go,authPublish:mo,batchRequests:vo,batchResponses:vo,publishCert:Co,modCertTemplate:Ao,controlProcessed:bo,popLinkWitnessV2:wo,identityProofV2:Fo}),ko=z({controlSequence:ee(Po),reqSequence:ee(Do),cmsSequence:ee(Eo),otherMsgSequence:ee(Bo)},"PKI REQUEST"),Ro=z({controlSequence:ee(Po),cmsSequence:ee(Eo),otherMsgSequence:ee(Bo)},"PKI RESPONSE");return y.prototype={GostPrivateKeyInfo:Dt,GostSubjectPublicKeyInfo:lt,GostKeyContainer:sn,GostKeyContainerName:cn,GostPrivateKeys:un,GostPrivateMasks:fn,ViPNetInfo:dn,GostSignature:dr,GostEncryptedKey:$r,GostWrappedPrivateKey:bt,PrivateKeyInfo:Ft,EncryptedPrivateKeyInfo:Pt,SubjectPublicKeyInfo:pt,TBSCertificate:yr,Certificate:pr,CertificationRequestInfo:mr,CertificationRequest:vr,TBSCertList:Sr,CertificateList:Er,AttributeCertificateInfo:Wr,AttributeCertificate:Vr,SignedAttributes:bn,UnsignedAttributes:Fn,ContentInfo:li,SafeContents:Ki,AuthenticatedSafe:Pi,PFX:Ri,PKIData:ko,PKIResponse:Ro},e.asn1=new y,y})},function(e,t,r){!function(t,n){e.exports=n(r(0))}(0,function(e){function t(e){if(e instanceof o)return e;if(e&&e.buffer&&e.buffer instanceof o)return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;throw new i("CryptoOperationData required")}function r(){}var n=this,i=n.DataError||n.Error,o=n.ArrayBuffer,a=n.Date,s={decode:function(e){e=e.replace(/[^A-Za-z0-9\+\/]/g,"");for(var t,r,n=e.length,i=3*n+1>>2,o=new Uint8Array(i),a=0,s=0,c=0;c<n;c++){r=3&c;var u=e.charCodeAt(c);if(u=u>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:43===u?62:47===u?63:0,a|=u<<18-6*r,3===r||n-c==1){for(t=0;t<3&&s<i;t++,s++)o[s]=a>>>(16>>>t&24)&255;a=0}}return o.buffer},encode:function(e){for(var r=new Uint8Array(t(e)),n=2,i="",o=r.length,a=0,s=0;s<o;s++)if(n=s%3,s>0&&4*s/3%96==0&&(i+="\r\n"),a|=r[s]<<(16>>>n&24),2===n||o-s==1){for(var c=18;c>=0;c-=6){var u=a>>>c&63;u=u<26?u+65:u<52?u+71:u<62?u-4:62===u?43:63===u?47:65,i+=String.fromCharCode(u)}a=0}return i.substr(0,i.length-2+n)+(2===n?"":1===n?"=":"==")}};r.prototype.Base64=s;var c=function(){var e={1026:128,1027:129,8218:130,1107:131,8222:132,8230:133,8224:134,8225:135,8364:136,8240:137,1033:138,8249:139,1034:140,1036:141,1035:142,1039:143,1106:144,8216:145,8217:146,8220:147,8221:148,8226:149,8211:150,8212:151,8482:153,1113:154,8250:155,1114:156,1116:157,1115:158,1119:159,160:160,1038:161,1118:162,1032:163,164:164,1168:165,166:166,167:167,1025:168,169:169,1028:170,171:171,172:172,173:173,174:174,1031:175,176:176,177:177,1030:178,1110:179,1169:180,181:181,182:182,183:183,1105:184,8470:185,1108:186,187:187,1112:188,1029:189,1109:190,1111:191},r={};for(var n in e){r[e[n]]=n}return{decode:function(t,r){r=(r||"win1251").toLowerCase().replace("-","");for(var n=[],i=0,o=t.length;i<o;i++){var a=t.charCodeAt(i);if("utf8"===r)a<128?n.push(a):a<2048?(n.push(192+(a>>>6)),n.push(128+(63&a))):a<65536?(n.push(224+(a>>>12)),n.push(128+(a>>>6&63)),n.push(128+(63&a))):a<2097152?(n.push(240+(a>>>18)),n.push(128+(a>>>12&63)),n.push(128+(a>>>6&63)),n.push(128+(63&a))):a<67108864?(n.push(248+(a>>>24)),n.push(128+(a>>>18&63)),n.push(128+(a>>>12&63)),n.push(128+(a>>>6&63)),n.push(128+(63&a))):(n.push(252+(a>>>30)),n.push(128+(a>>>24&63)),n.push(128+(a>>>18&63)),n.push(128+(a>>>12&63)),n.push(128+(a>>>6&63)),n.push(128+(63&a)));else if("unicode"===r||"ucs2"===r||"utf16"===r){if(a<55296||a>=57344&&a<=65536)n.push(a>>>8),n.push(255&a);else if(a>=65536&&a<1114112){a-=65536;var s=55296+((1047552&a)>>10),c=56320+(1023&a);n.push(s>>>8),n.push(255&s),n.push(c>>>8),n.push(255&c)}}else"utf32"===r||"ucs4"===r?(n.push(a>>>24&255),n.push(a>>>16&255),n.push(a>>>8&255),n.push(255&a)):"win1251"===r?(a>=128&&(a>=1040&&a<1104?a-=848:a=e[a]||0),n.push(a)):n.push(255&a)}return new Uint8Array(n).buffer},encode:function(e,n){n=(n||"win1251").toLowerCase().replace("-","");for(var i=[],o=new Uint8Array(t(e)),a=0,s=o.length;a<s;a++){var c=o[a];if("utf8"===n)c=c>=252&&c<254&&a+5<s?1073741824*(c-252)+(o[++a]-128<<24)+(o[++a]-128<<18)+(o[++a]-128<<12)+(o[++a]-128<<6)+o[++a]-128:c>>248&&c<252&&a+4<s?(c-248<<24)+(o[++a]-128<<18)+(o[++a]-128<<12)+(o[++a]-128<<6)+o[++a]-128:c>>240&&c<248&&a+3<s?(c-240<<18)+(o[++a]-128<<12)+(o[++a]-128<<6)+o[++a]-128:c>=224&&c<240&&a+2<s?(c-224<<12)+(o[++a]-128<<6)+o[++a]-128:c>=192&&c<224&&a+1<s?(c-192<<6)+o[++a]-128:c;else if("unicode"===n||"ucs2"===n||"utf16"===n){if((c=(c<<8)+o[++a])>=55296&&c<57344){var u=c-55296<<10;c=o[++a],c=(c<<8)+o[++a];var f=c-56320;c=u+f+65536}}else"utf32"===n||"ucs4"===n?(c=(c<<8)+o[++a],c=(c<<8)+o[++a],c=(c<<8)+o[++a]):"win1251"===n&&c>=128&&(c>=192&&c<256?c+=848:c=r[c]||0);i.push(String.fromCharCode(c))}return i.join("")}}}();r.prototype.Chars=c;var u={decode:function(e,t){e=e.replace(/[^A-fa-f0-9]/g,"");var r=Math.ceil(e.length/2),n=new Uint8Array(r);if(e=(e.length%2>0?"0":"")+e,t&&("string"!=typeof t||t.toLowerCase().indexOf("little")<0))for(var i=0;i<r;i++)n[i]=parseInt(e.substr(2*(r-i-1),2),16);else for(var i=0;i<r;i++)n[i]=parseInt(e.substr(2*i,2),16);return n.buffer},encode:function(e,r){var n=[],i=new Uint8Array(t(e)),o=i.length;if(r&&("string"!=typeof r||r.toLowerCase().indexOf("little")<0))for(var a=0;a<o;a++){var s=o-a-1;n[s]=(s>0&&s%32==0?"\r\n":"")+("00"+i[a].toString(16)).slice(-2)}else for(var a=0;a<o;a++)n[a]=(a>0&&a%32==0?"\r\n":"")+("00"+i[a].toString(16)).slice(-2);return n.join("")}};r.prototype.Hex=u;var f={decode:function(e){e=(e||"").replace(/[^\-A-fa-f0-9]/g,""),0===e.length&&(e="0");var t=!1;for("-"===e.charAt(0)&&(t=!0,e=e.substring(1));"0"===e.charAt(0)&&e.length>1;)e=e.substring(1);e=(e.length%2>0?"0":"")+e,(!t&&!/^[0-7]/.test(e)||t&&!/^[0-7]|8[0]+$/.test(e))&&(e="00"+e);for(var r=e.length/2,n=new Uint8Array(r),i=0,o=r-1;o>=0;--o){var a=parseInt(e.substr(2*o,2),16);t&&a+i>0&&(a=256-a-i,i=1),n[o]=a}return n.buffer},encode:function(e){var r=new Uint8Array(t(e)),n=r.length;if(0===r.length)return"0x00";for(var i=[],o=r[0]>127,a=0,s=n-1;s>=0;--s){var c=r[s];o&&c+a>0&&(c=256-c-a,a=1),i[s]=("00"+c.toString(16)).slice(-2)}for(i=i.join("");"0"===i.charAt(0);)i=i.substring(1);return(o?"-":"")+"0x"+i}};r.prototype.Int16=f;var h=function(){function e(r,n,s){var h=r.object;void 0===h&&(h=r);var d=r.tagClass=r.tagClass||0;if(0===d){var y=r.tagNumber;if(void 0===y)if("string"==typeof h)y=""===h?5:/^\-?0x[0-9a-fA-F]+$/.test(h)?2:/^(\d+\.)+\d+$/.test(h)?6:/^[01]+$/.test(h)?3:/^(true|false)$/.test(h)?1:/^[0-9a-fA-F]+$/.test(h)?4:19;else if("number"==typeof h)y=2;else if("boolean"==typeof h)y=1;else if(h instanceof Array)y=16;else if(h instanceof a)y=24;else{if(!(h instanceof o||h&&h.buffer instanceof o))throw new i("Unrecognized type for "+h);y=4}}var p=r.tagConstructed;void 0===p&&(p=r.tagConstructed=h instanceof Array);var l;if(h instanceof o||h&&h.buffer instanceof o){if(l=new Uint8Array(t(h)),3===y){var g=new Uint8Array(t(l));l=new Uint8Array(g.length+1),l[0]=0,l.set(g,1)}}else if(p){if(!(h instanceof Array))throw new i("Constracted block can't be primitive");for(var m=0,v=[],C=0,A=0,b=h.length;A<b;A++)v[A]=e(h[A],n),m+=v[A].length;17===y&&v.sort(function(e,t){for(var r=0,n=Math.min(e.length,t.length);r<n;r++){var i=e[r]-t[r];if(0!==i)return i}return e.length-t.length}),"CER"===n&&(v[b]=new Uint8Array(2),m+=2),l=new Uint8Array(m);for(var A=0,b=v.length;A<b;A++)l.set(v[A],C),C+=v[A].length}else switch(y){case 1:l=new Uint8Array(1),l[0]=h?255:0;break;case 2:case 10:l=f.decode("number"==typeof h?h.toString(16):h);break;case 3:if("string"==typeof h){var F=7-(h.length+7)%8,b=Math.ceil(h.length/8);l=new Uint8Array(b+1),l[0]=F;for(var A=0;A<b;A++){for(var w=0,S=0;S<8;S++){var E=8*A+S;w=(w<<1)+(E<h.length&&"1"===h.charAt(E)?1:0)}l[A+1]=w}}break;case 4:l=u.decode("number"==typeof h?h.toString(16):h);break;case 6:for(var g=h.match(/\d+/g),B=[],A=1;A<g.length;A++){var b=+g[A],D=[];1===A&&(b+=40*g[0]);do{D.push(127&b),b>>>=7}while(b);for(S=D.length-1;S>=0;--S)B.push(D[S]+(0===S?0:128))}l=new Uint8Array(B);break;case 12:l=c.decode(h,"utf8");break;case 18:case 22:case 19:case 20:case 21:case 25:case 26:case 27:for(var A=0,b=h.length;A<b;A++)h.charCodeAt(A)>255&&(y=12);l=12===y?c.decode(h,"utf8"):c.decode(h,"ascii");break;case 23:case 24:var K=h.original;if(!K){var P=new a(h);P.setMinutes(P.getMinutes()+P.getTimezoneOffset());for(var k=24===y?P.getMilliseconds().toString():"";k.length>0&&"0"===k.charAt(k.length-1);)k=k.substring(0,k.length-1);k.length>0&&(k="."+k),K=(23===y?P.getYear().toString().slice(-2):P.getFullYear().toString())+("00"+(P.getMonth()+1)).slice(-2)+("00"+P.getDate()).slice(-2)+("00"+P.getHours()).slice(-2)+("00"+P.getMinutes()).slice(-2)+("00"+P.getSeconds()).slice(-2)+k+"Z"}l=c.decode(K,"ascii");break;case 28:l=c.decode(h,"utf32");break;case 30:l=c.decode(h,"utf16")}if(l||(l=new Uint8Array(0)),l instanceof o&&(l=new Uint8Array(l)),!p&&"CER"===n){var E;switch(y){case 3:E=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:E=E||0;for(var m=0,v=[],C=0,A=E,b=l.length;A<b;A+=1e3-E)v[A]=e({object:new Unit8Array(l.buffer,A,Math.min(1e3-E,b-A)),tagNumber:y,tagClass:0,tagConstructed:!1},n),m+=v[A].length;v[b]=new Uint8Array(2),m+=2,l=new Uint8Array(m);for(var A=0,b=v.length;A<b;A++)l.set(v[A],C),C+=v[A].length}}if(r.tagNumber=0===d?y:y=r.tagNumber||0,r.content=l,s)return l;var R=[],I=3===d?192:2===d?128:1===d?64:0;if(p&&(I|=32),y<31)I|=31&y,R.push(I);else{I|=31,R.push(I);var b=y,T=[];do{T.push(127&b),b>>>=7}while(b);for(var S=T.length-1;S>=0;--S)R.push(T[S]+(0===S?0:128))}if(p&&"CER"===n)R.push(128);else{var x=l.length;if(x>127){var G=x,U=[];do{U.push(255&G),G>>>=8}while(G);R.push(U.length+128);for(var S=U.length-1;S>=0;--S)R.push(U[S])}else R.push(x)}var O=r.header=new Uint8Array(R),N=new Uint8Array(O.length+l.length);return N.set(O,0),N.set(l,O.length),N}function r(e,t){var n,s,u,h,d,y,p,l,g=t||0,m=g;if(e.object)n=e.tagNumber,s=e.tagClass,u=e.tagConstructed,h=e.content,d=e.header,y=e.object instanceof o?new Uint8Array(e.object):null,p=e.object instanceof Array?e.object:null,l=y&&y.length||null;else{var v=e,C=v[g++];if(n=31&C,s=C>>6,u=0!=(32&C),31===n){n=0;do{if(n>9007199254740864)throw new i("Convertor not supported tag number more then (2^53 - 1) at position "+t);C=v[g++],n=(n<<7)+(127&C)}while(128&C)}if(C=v[g++],(l=127&C)!==C){if(l>6)throw new i("Length over 48 bits not supported at position "+t);if(0===l)l=null;else{C=0;for(var A=0;A<l;++A)C=(C<<8)+v[g++];l=C}}if(m=g,p=null,u)if(p=[],null!==l){for(var b=m+l;g<b;){var F=r(v,g);p.push(F),g+=F.header.length+F.content.length}if(g!==b)throw new i("Content size is not correct for container starting at offset "+m)}else try{for(;;){var F=r(v,g);if(g+=F.header.length+F.content.length,0===F.tagClass&&0===F.tagNumber)break;p.push(F)}l=g-m}catch(e){throw new i("Exception "+e+" while decoding undefined length content at offset "+m)}d=new Uint8Array(v.buffer,t,m-t),h=new Uint8Array(v.buffer,m,l),y=h}if(null!==p&&0===s){var w;switch(n){case 3:w=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:if(w=w||0,0===p.length)throw new i("No constructed encoding content of string type at offset "+m);l=w;for(var A=0,S=p.length;A<S;A++){var F=p[A];if(F.tagClass!==s||F.tagNumber!==n||F.tagConstructed)throw new i("Invalid constructed encoding of string type at offset "+m);l+=F.content.length-w}y=new Uint8Array(l);for(var A=0,S=p.length,E=w;A<S;A++){var F=p[A];w>0?y.set(F.content.subarray(1),E):y.set(F.content,E),E+=F.content.length-w}u=!1,p=null}}var B="";if(null===p){if(null===l)throw new i("Invalid tag with undefined length at offset "+m);if(0===s)switch(n){case 1:B=0!==y[0];break;case 2:case 10:if(l>6)B=f.encode(y);else{var D=y[0];y[0]>127&&(D-=256);for(var A=1;A<l;A++)D=256*D+y[A];B=D}break;case 3:if(l>5)B=new Uint8Array(y.subarray(1)).buffer;else{for(var K=y[0],P=K,F=[],A=l-1;A>=1;--A){for(var k=y[A],E=P;E<8;++E)F.push(k>>E&1?"1":"0");P=0}B=F.reverse().join("")}break;case 4:B=new Uint8Array(y).buffer;break;case 6:for(var F="",S=0,R=0,A=0;A<l;++A){var D=y[A];if(S=(S<<7)+(127&D),R+=7,!(128&D)){if(""===F){var I=S<80?S<40?0:1:2;F=I+"."+(S-40*I)}else F+="."+S.toString();S=0,R=0}}if(R>0)throw new i("Incompleted OID at offset "+m);B=F;break;case 16:case 17:B=[];break;case 12:B=c.encode(y,"utf8");break;case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:B=c.encode(y,"ascii");break;case 28:B=c.encode(y,"utf32");break;case 30:B=c.encode(y,"utf16");break;case 23:case 24:var T=23===n,F=c.encode(y,"ascii"),I=(T?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(F);if(!I)throw new i('Unrecognized time format "'+F+'" at offset '+m);T&&(I[1]=+I[1],I[1]+=I[1]<50?2e3:1900);var x=new a(I[1],+I[2]-1,+I[3],+(I[4]||"0"),+(I[5]||"0"),+(I[6]||"0"),+(I[7]||"0")),G=x.getTimezoneOffset();(I[8]||23===n)&&("Z"!==I[8].toUpperCase()&&I[9]&&(G+=parseInt(I[9])),x.setMinutes(x.getMinutes()-G)),x.original=F,B=x}else B=new Uint8Array(y).buffer}else B=p;return{tagConstructed:u,tagClass:s,tagNumber:n,header:d,content:h,object:B}}return{encode:function(t,r,n){return e(t,r,n).buffer},decode:function(e){return r(e.object?e:new Uint8Array(t(e)),0)}}}();r.prototype.BER=h;var d={encode:function(e,t){return(t?"-----BEGIN "+t.toUpperCase()+"-----\r\n":"")+s.encode(e instanceof o?e:h.encode(e))+(t?"\r\n-----END "+t.toUpperCase()+"-----":"")},decode:function(e,t,r,n){var o=/([A-Za-z0-9\+\/\s\=]+)/g,a=o.exec(e);if(a[1].length!==e.length&&(a=!1),!a&&t){a=new RegExp("-----\\s?BEGIN "+t.toUpperCase()+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+t.toUpperCase()+"-----","g").exec(e)}if(!a){a=new RegExp("-----\\s?BEGIN [A-Z0-9\\s]+-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END [A-Z0-9\\s]+-----","g").exec(e)}var c=a&&a[1+(n||0)];if(!c)throw new i("Not valid PEM format");var u=s.decode(c);return r&&(u=h.decode(u)),u}};return r.prototype.PEM=d,e&&(e.coding=new r),r})},function(e,t,r){!function(t,n){e.exports=n(r(0))}(0,function(e){function t(){for(var e={},t=0,r=arguments.length;t<r;t++){var n=arguments[t];if("object"==typeof n)for(var i in n)e[i]=n[i]}return e}function r(){}var n={"1.2.643.2.2":"CryptoPro","1.2.643.2.2.3":"id-GostR3411-94-with-GostR3410-2001","1.2.643.2.2.4":"id-GostR3411-94-with-GostR3410-94","1.2.643.2.2.9":"id-GostR3411-94","1.2.643.2.2.10":"id-HMACGostR3411-94","1.2.643.2.2.13.0":"id-Gost28147-89-None-KeyWrap","1.2.643.2.2.13.1":"id-Gost28147-89-CryptoPro-KeyWrap","1.2.643.2.2.14.0":"id-Gost28147-89-None-KeyMeshing","1.2.643.2.2.14.1":"id-Gost28147-89-CryptoPro-KeyMeshing","1.2.643.2.2.19":"id-GostR3410-2001","1.2.643.2.2.20":"id-GostR3410-94","1.2.643.2.2.20.1":"id-GostR3410-94-a","1.2.643.2.2.20.2":"id-GostR3410-94-aBis","1.2.643.2.2.20.3":"id-GostR3410-94-b","1.2.643.2.2.20.4":"id-GostR3410-94-bBis","1.2.643.2.2.21":"id-Gost28147-89","1.2.643.2.2.22":"id-Gost28147-89-MAC","1.2.643.2.2.30.0":"id-GostR3411-94-TestParamSet","1.2.643.2.2.30.1":"id-GostR3411-94-CryptoProParamSet","1.2.643.2.2.30.2":"id-GostR3411-94-CryptoPro-B-ParamSet","1.2.643.2.2.30.3":"id-GostR3411-94-CryptoPro-C-ParamSet","1.2.643.2.2.30.4":"id-GostR3411-94-CryptoPro-D-ParamSet","1.2.643.2.2.31.0":"id-Gost28147-89-TestParamSet","1.2.643.2.2.31.1":"id-Gost28147-89-CryptoPro-A-ParamSet","1.2.643.2.2.31.2":"id-Gost28147-89-CryptoPro-B-ParamSet","1.2.643.2.2.31.3":"id-Gost28147-89-CryptoPro-C-ParamSet","1.2.643.2.2.31.4":"id-Gost28147-89-CryptoPro-D-ParamSet","1.2.643.2.2.31.5":"id-Gost28147-89-CryptoPro-Oscar-1-1-ParamSet","1.2.643.2.2.31.6":"id-Gost28147-89-CryptoPro-Oscar-1-0-ParamSet","1.2.643.2.2.31.7":"id-Gost28147-89-CryptoPro-RIC-1-ParamSet ","1.2.643.2.2.31.12":"id-Gost28147-89-CryptoPro-tc26-1","1.2.643.2.2.31.13":"id-Gost28147-89-CryptoPro-tc26-2","1.2.643.2.2.31.14":"id-Gost28147-89-CryptoPro-tc26-3","1.2.643.2.2.31.15":"id-Gost28147-89-CryptoPro-tc26-4","1.2.643.2.2.31.16":"id-Gost28147-89-CryptoPro-tc26-5","1.2.643.2.2.31.17":"id-Gost28147-89-CryptoPro-tc26-6","1.2.643.2.2.32.0":"id-GostR3410-94-TestParamSet","1.2.643.2.2.32.2":"id-GostR3410-94-CryptoPro-A-ParamSet","1.2.643.2.2.32.3":"id-GostR3410-94-CryptoPro-B-ParamSet","1.2.643.2.2.32.4":"id-GostR3410-94-CryptoPro-C-ParamSet","1.2.643.2.2.32.5":"id-GostR3410-94-CryptoPro-D-ParamSet","1.2.643.2.2.33.1":"id-GostR3410-94-CryptoPro-XchA-ParamSet","1.2.643.2.2.33.2":"id-GostR3410-94-CryptoPro-XchB-ParamSet","1.2.643.2.2.33.3":"id-GostR3410-94-CryptoPro-XchC-ParamSet","1.2.643.2.2.34.2":"temporaryAccessToRC","1.2.643.2.2.34.3":"internetContentSignature","1.2.643.2.2.34.4":"adminRC","1.2.643.2.2.34.5":"operatorRC","1.2.643.2.2.34.6":"userRC","1.2.643.2.2.34.7":"clientRC","1.2.643.2.2.34.8":"serverRC","1.2.643.2.2.34.9":"sysAdminRC","1.2.643.2.2.34.10":"arcAdminRC","1.2.643.2.2.34.11":"authorityPersonRC","1.2.643.2.2.34.12":"clientCC","1.2.643.2.2.34.13":"sysAdminCC","1.2.643.2.2.34.14":"arcAdminCC","1.2.643.2.2.34.15":"accessIPSecCA","1.2.643.2.2.34.16":"auditAdminHSM","1.2.643.2.2.34.21":"adminHSM","1.2.643.2.2.34.22":"serverAdminHSH","1.2.643.2.2.34.24":"winlogonCA","1.2.643.2.2.34.25":"timestampServiceUser","1.2.643.2.2.34.26":"statusServiceUser","1.2.643.2.2.34.27":"arcAdminHSM","1.2.643.2.2.34.28":"auditorHSM","1.2.643.2.2.35.0":"id-GostR3410-2001-CryptoPro-TestParamSet","1.2.643.2.2.35.1":"id-GostR3410-2001-CryptoPro-A-ParamSet","1.2.643.2.2.35.2":"id-GostR3410-2001-CryptoPro-B-ParamSet","1.2.643.2.2.35.3":"id-GostR3410-2001-CryptoPro-C-ParamSet","1.2.643.2.2.36.0":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","1.2.643.2.2.36.1":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","1.2.643.2.2.37.1":"id-CryptoPro-GostPrivateKeys-V1","1.2.643.2.2.37.2":"id-CryptoPro-GostPrivateKeys-V2","1.2.643.2.2.37.2.1":"id-CryptoPro-GostPrivateKeys-V2-Full","1.2.643.2.2.37.2.2":"id-CryptoPro-GostPrivateKeys-V2-PartOf","1.2.643.2.2.37.3.1":"intermediateCertificates","1.2.643.2.2.37.3.2":"trustedCertificatesSignature","1.2.643.2.2.37.3.3":"trustedCertificatesExchange","1.2.643.2.2.37.3.10":"keyValidity","1.2.643.2.2.38.1":"personalBaseProlicy","1.2.643.2.2.38.2":"networkBasePolicy","1.2.643.2.2.47.1":"id-CryptoPro-ocsp-treats-exp-key-or-exp-cert-rev","1.2.643.2.2.47.2":"id-CryptoPro-ocsp-crl-locator","1.2.643.2.2.47.3":"id-CryptoPro-ocsp-instant-revocation-indicator","1.2.643.2.2.47.4":"id-CryptoPro-ocsp-revocation-announcement-reference","1.2.643.2.2.47.5":"id-CryptoPro-ocsp-historical-request","1.2.643.2.2.49.2":"limitedLicense","1.2.643.2.2.96":"id-GostR3410-2001-CryptoPro-ESDH","1.2.643.2.2.97":"id-GostR3410-94-CryptoPro-ESDH","1.2.643.2.2.98":"id-GostR3410-2001DH","1.2.643.2.2.99":"id-GostR3410-94DH","1.2.643.2.45.1.1.1":"signatureComment","1.2.643.2.45.1.1.2":"resourceName","1.2.643.2.45.1.1.3":"signatureUsage","1.2.643.3.131.1.1":"INN","1.2.643.3.141.1.1":"RNS FSS","1.2.643.3.141.1.2":"KP FSS","1.2.643.7.1":"tc26","1.2.643.7.1.1.1.1":"id-tc26-gost3410-12-256","1.2.643.7.1.1.1.2":"id-tc26-gost3410-12-512","1.2.643.7.1.1.2.1":"id-tc26-gost3411-94","1.2.643.7.1.1.2.2":"id-tc26-gost3411-12-256","1.2.643.7.1.1.2.3":"id-tc26-gost3411-12-512","1.2.643.7.1.1.3.1":"id-tc26-signwithdigest-gost3410-12-94","1.2.643.7.1.1.3.2":"id-tc26-signwithdigest-gost3410-12-256","1.2.643.7.1.1.3.3":"id-tc26-signwithdigest-gost3410-12-512","1.2.643.7.1.1.4.1":"id-tc26-hmac-gost-3411-12-256","1.2.643.7.1.1.4.2":"id-tc26-hmac-gost-3411-12-512","1.2.643.7.1.1.6.1":"id-tc26-agreement-gost-3410-12-256","1.2.643.7.1.1.6.2":"id-tc26-agreement-gost-3410-12-512","1.2.643.7.1.2.1.1.0":"id-tc26-gost-3410-12-256-paramSetTest","1.2.643.7.1.2.1.1.1":"id-tc26-gost-3410-12-256-paramSetA","1.2.643.7.1.2.1.1.2":"id-tc26-gost-3410-12-256-paramSetB","1.2.643.7.1.2.1.2.0":"id-tc26-gost-3410-12-512-paramSetTest","1.2.643.7.1.2.1.2.1":"id-tc26-gost-3410-12-512-paramSetA","1.2.643.7.1.2.1.2.2":"id-tc26-gost-3410-12-512-paramSetB","1.2.643.7.1.2.1.2.3":"id-tc26-gost-3410-12-512-paramSetC","1.2.643.7.1.2.1.2.4":"id-tc26-gost-3410-12-512-paramSetD","1.2.643.7.1.2.5.1.1":"id-tc26-gost-28147-param-Z","1.2.643.100.1":"OGRN","1.2.643.100.2.1":"SMEV-person","1.2.643.100.2.2":"SMEV-government","1.2.643.100.3":"SNILS","1.2.643.100.4":"KPP","1.2.643.100.5":"OGRNIP","1.2.643.100.6":"internal-government","1.2.643.100.111":"subjectSignTool","1.2.643.100.112":"issuerSignTool","1.2.643.100.113.1":"signToolClassKC1","1.2.643.100.113.2":"signToolClassKC2","1.2.643.100.113.3":"signToolClassKC3","1.2.643.100.113.4":"signToolClassKB1","1.2.643.100.113.5":"signToolClassKB2","1.2.643.100.113.6":"signToolClassKA1","1.2.643.100.114.1":"issuerToolClassKC1","1.2.643.100.114.2":"issuerToolClassKC2","1.2.643.100.114.3":"issuerToolClassKC3","1.2.643.100.114.4":"issuerToolClassKB2","1.2.643.100.114.5":"issuerToolClassKB1","1.2.643.100.114.6":"issuerToolClassKA1","1.2.840.10040.4":"x9cm","1.2.840.10040.4.1":"dsa","1.2.840.10040.4.3":"dsa-with-SHA1","1.2.840.10045":"ansi-x962","1.2.840.10045.1":"id-fieldType","1.2.840.10045.1.1":"id-prime-Field","1.2.840.10045.1.2":"id-characteristic-two-field","1.2.840.10045.2.1":"ecPublicKey","1.2.840.10045.3.0":"characteristicTwo","1.2.840.10045.3.1.1":"secp192r1","1.2.840.10045.3.1.2":"prime192v2","1.2.840.10045.3.1.3":"prime192v3","1.2.840.10045.3.1.4":"prime239v1","1.2.840.10045.3.1.5":"prime239v2","1.2.840.10045.3.1.6":"prime239v3","1.2.840.10045.3.1.7":"secp256r1","1.2.840.10045.4":"ecdsa","1.2.840.10045.4.1":"ecdsa-with-SHA1","1.2.840.10045.4.2":"ecdsa-with-Recommended","1.2.840.10045.4.4":"ecdsa-with-SHA2","1.2.840.10045.4.4.1":"ecdsa-with-SHA224","1.2.840.10045.4.4.2":"ecdsa-with-SHA256","1.2.840.10045.4.4.3":"ecdsa-with-SHA384","1.2.840.10045.4.4.4":"ecdsa-with-SHA512","1.2.840.113533.7.66.13":"PasswordBasedMac","1.3.6.1.4.1.22554.1.1.2.1.2":"pbeWithSHAAndAES128-CBC","1.3.6.1.4.1.22554.1.1.2.1.22":"pbeWithSHAAndAES192-CBC","1.3.6.1.4.1.22554.1.1.2.1.42":"pbeWithSHAAndAES256-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.2":"pbeWithSHA256AndAES128-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.22":"pbeWithSHA256AndAES192-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.42":"pbeWithSHA256AndAES256-CBC","1.2.840.113549":"rsa","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.113549.1.1.2":"md2withRSAEncryption","1.2.840.113549.1.1.3":"md4withRSAEncryption","1.2.840.113549.1.1.4":"md5withRSAEncryption","1.2.840.113549.1.1.5":"sha1withRSAEncryption","1.2.840.113549.1.1.7":"rsaes-oaep","1.2.840.113549.1.1.8":"mgf1","1.2.840.113549.1.1.9":"pSpecified","1.2.840.113549.1.1.10":"rsassa-pss","1.2.840.113549.1.1.11":"sha256withRSAEncryption","1.2.840.113549.1.1.12":"sha384withRSAEncryption","1.2.840.113549.1.1.13":"sha512withRSAEncryption","1.2.840.113549.1.2.7":"hmacWithSHA1","1.2.840.113549.1.2.8":"hmacWithSHA224","1.2.840.113549.1.2.9":"hmacWithSHA256","1.2.840.113549.1.2.10":"hmacWithSHA384","1.2.840.113549.1.2.11":"hmacWithSHA512","1.2.840.113549.1.3.1":"dhKeyAgreement","1.2.840.113549.1.5.12":"PBKDF2","1.2.840.113549.1.5.13":"PBES2","1.2.840.113549.1.5.14":"PBMAC1","1.2.840.113549.1.7.1":"data","1.2.840.113549.1.7.2":"signedData","1.2.840.113549.1.7.3":"envelopedData","1.2.840.113549.1.7.4":"signedAndEnvelopedData","1.2.840.113549.1.7.5":"digestedData","1.2.840.113549.1.7.6":"encryptedData","1.2.840.113549.1.9.1":"emailAddress","1.2.840.113549.1.9.2":"unstructuredName","1.2.840.113549.1.9.3":"contentType","1.2.840.113549.1.9.4":"messageDigest","1.2.840.113549.1.9.5":"signingTime","1.2.840.113549.1.9.6":"countersignature","1.2.840.113549.1.9.7":"challengePassword","1.2.840.113549.1.9.8":"unstructuredAddress","1.2.840.113549.1.9.9":"extendedCertificateAttributes","1.2.840.113549.1.9.10":"issuerAndSerialNumber","1.2.840.113549.1.9.11":"passwordCheck","1.2.840.113549.1.9.12":"publicKey","1.2.840.113549.1.9.13":"signingDescription","1.2.840.113549.1.9.14":"extensionRequest","1.2.840.113549.1.9.15":"sMimeCapabilities","1.2.840.113549.1.9.16":"sMimeObjectIdentifierRegistry","1.2.840.113549.1.9.16.1.2":"authData","1.2.840.113549.1.9.16.1.4 ":"timestampToken","1.2.840.113549.1.9.16.1.17 ":"firmwareLoadReceipt","1.2.840.113549.1.9.16.1.21":"encKeyWithID","1.2.840.113549.1.9.16.1.23":"authEnvelopedData","1.2.840.113549.1.9.16.2":"sMimeAttributes","1.2.840.113549.1.9.16.2.1":"receiptRequest","1.2.840.113549.1.9.16.2.12":"signingCertificate","1.2.840.113549.1.9.16.2.14":"timeStampToken","1.2.840.113549.1.9.16.2.2":"securityLabel","1.2.840.113549.1.9.16.2.3":"mlExpansionHistory","1.2.840.113549.1.9.16.2.34":"unsignedData","1.2.840.113549.1.9.16.2.47":"signingCertificateV2","1.2.840.113549.1.9.16.3.5":"ESDH","1.2.840.113549.1.9.20":"friendlyName","1.2.840.113549.1.9.21":"localKeyId","1.2.840.113549.1.9.22":"certTypes","1.2.840.113549.1.9.22.1":"x509Certificate","1.2.840.113549.1.9.22.2":"sdsiCertificate","1.2.840.113549.1.9.23":"crlTypes","1.2.840.113549.1.9.23.1":"x509CRL","1.2.840.113549.1.9.24":"secretTypes","1.2.840.113549.1.9.24.1":"secret","1.2.840.113549.1.9.25.1":"pkcs15Token","1.2.840.113549.1.9.25.2":"encryptedPrivateKeyInfo","1.2.840.113549.1.9.25.3":"randomNonce","1.2.840.113549.1.9.25.4":"sequenceNumber","1.2.840.113549.1.9.25.5":"pkcs7PDU","1.2.840.113549.1.9.26.1":"pkcs9String","1.2.840.113549.1.9.26.2":"signingTimeString","1.2.840.113549.1.9.27.1":"caseIgnoreMatch","1.2.840.113549.1.9.27.2":"signingTimeMatch","1.2.840.113549.1.12.0.1":"pkcs-12","1.2.840.113549.1.12.1":"pbe","1.2.840.113549.1.12.1.1":"pbeWithSHAAnd128BitRC4","1.2.840.113549.1.12.1.2":"pbeWithSHAAnd40BitRC4","1.2.840.113549.1.12.1.3":"pbeWithSHAAnd3-KeyTripleDES-CBC","1.2.840.113549.1.12.1.4":"pbeWithSHAAnd2-KeyTripleDES-CBC","1.2.840.113549.1.12.1.5":"pbeWithSHAAnd128BitRC2-CBC","1.2.840.113549.1.12.1.6":"pbeWithSHAAnd40BitRC2-CBC","1.2.840.113549.1.12.1.80":"pbeUnknownGost","1.2.840.113549.1.12.2.1":"pkcs8-key-shrouding","1.2.840.113549.1.12.3.1":"keyBagId","1.2.840.113549.1.12.3.2":"certAndCRLBagId","1.2.840.113549.1.12.3.3":"secretBagId","1.2.840.113549.1.12.3.4":"safeContentsId","1.2.840.113549.1.12.3.5":"pkcs-8ShroudedKeyBagId","1.2.840.113549.1.12.4.1":"x509CertCRLBagId","1.2.840.113549.1.12.4.2":"pkcs-12-SDSICertBag","1.2.840.113549.1.12.10.1.1":"keyBag","1.2.840.113549.1.12.10.1.2":"pkcs8ShroudedKeyBag","1.2.840.113549.1.12.10.1.3":"certBag","1.2.840.113549.1.12.10.1.4":"crlBag","1.2.840.113549.1.12.10.1.5":"secretBag","1.2.840.113549.1.12.10.1.6":"safeContentsBag","1.2.840.113549.2.5":"md-5","1.2.840.113549.3.7":"des-EDE3-CBC","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.3.132.112":"ecDH","1.3.14.3.2.26":"sha1","1.3.6.1.4.1.311.2.1.14":"msCertExtensions","1.3.6.1.4.1.311.17.1":"keyProviderNameAttr","1.3.6.1.4.1.311.17.2":"localMachineKeyset","1.3.6.1.4.1.311.17.3.20":"certKeyIdentifierPropId","1.3.6.1.4.1.5849":"SignalCom","1.3.6.1.4.1.5849.1.1.1":"id-sc-gost28147-ecb","1.3.6.1.4.1.5849.1.1.2":"id-sc-gost28147-gamma","1.3.6.1.4.1.5849.1.1.3":"id-sc-gost28147-gfb","1.3.6.1.4.1.5849.1.1.4":"id-sc-gost28147-mac","1.3.6.1.4.1.5849.1.1.5":"id-sc-gostR3410-94","1.3.6.1.4.1.5849.1.1.6.1.1.1":"id-sc-gostR3410-94-default","1.3.6.1.4.1.5849.1.1.6.1.1.2":"id-sc-gostR3410-94-test","1.3.6.1.4.1.5849.1.2.1":"id-sc-gostR3411-94","1.3.6.1.4.1.5849.1.3.1":"id-sc-gostR3411-94-with-gostR3410-94","1.3.6.1.4.1.5849.1.3.2":"id-sc-gostR3411-94-with-gostR3410-2001","1.3.6.1.4.1.5849.1.4.1":"id-sc-cmsGostWrap","1.3.6.1.4.1.5849.1.4.2":"id-sc-cmsGost28147Wrap","1.3.6.1.4.1.5849.1.5.1":"id-sc-pbeWithGost3411AndGost28147","1.3.6.1.4.1.5849.1.5.2":"id-sc-pbeWithGost3411AndGost28147CFB","1.3.6.1.4.1.5849.1.6.2":"id-sc-gostR3410-2001","1.3.6.1.4.1.5849.1.7.2":"id-sc-hmacWithGostR3411","1.3.6.1.4.1.5849.1.8.1":"id-sc-r3410-ESDH-r3411kdf","1.3.6.1.4.1.5849.1.8.3":"id-sc-ecdh-singlePass-cofactor-r3411kdf","1.3.6.1.4.1.5849.2.2.1":"id-sc-gostR3410-2001-publicKey","1.3.6.1.5.5.7.0.12":"attribute-cert","1.3.6.1.5.5.7.1.1":"authorityInfoAccess","1.3.6.1.5.5.7.1.4":"auditIdentity","1.3.6.1.5.5.7.1.6":"aaControls","1.3.6.1.5.5.7.1.10":"ac-proxying","1.3.6.1.5.5.7.1.11":"subjectInfoAccess","1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser","1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.5.1":"regCtrl","1.3.6.1.5.5.7.5.1.1":"regToken","1.3.6.1.5.5.7.5.1.2":"authenticator","1.3.6.1.5.5.7.5.1.3":"pkiPublicationInfo","1.3.6.1.5.5.7.5.1.4":"pkiArchiveOptions","1.3.6.1.5.5.7.5.1.5":"oldCertID","1.3.6.1.5.5.7.5.1.6":"protocolEncrKey","1.3.6.1.5.5.7.5.2":"regInfoAttr","1.3.6.1.5.5.7.5.2.1":"UTF8Pairs","1.3.6.1.5.5.7.5.2.2":"certReq","1.3.6.1.5.5.7.6.2":"noSignature","1.3.6.1.5.5.7.7.1":"statusInfo","1.3.6.1.5.5.7.7.2":"identification","1.3.6.1.5.5.7.7.3":"identityProof","1.3.6.1.5.5.7.7.4":"dataReturn","1.3.6.1.5.5.7.7.5":"transactionId","1.3.6.1.5.5.7.7.6":"senderNonce","1.3.6.1.5.5.7.7.7":"recipientNonce","1.3.6.1.5.5.7.7.8":"addExtensions","1.3.6.1.5.5.7.7.9":"encryptedPOP","1.3.6.1.5.5.7.7.10":"decryptedPOP","1.3.6.1.5.5.7.7.11":"lraPOPWitness","1.3.6.1.5.5.7.7.15":"getCert","1.3.6.1.5.5.7.7.16":"getCRL","1.3.6.1.5.5.7.7.17":"revokeRequest","1.3.6.1.5.5.7.7.18":"regInfo","1.3.6.1.5.5.7.7.19":"responseInfo","1.3.6.1.5.5.7.7.21":"queryPending","1.3.6.1.5.5.7.7.22":"popLinkRandom","1.3.6.1.5.5.7.7.23":"popLinkWitness","1.3.6.1.5.5.7.7.24":"confirmCertAcceptance","1.3.6.1.5.5.7.7.25":"statusInfoV2","1.3.6.1.5.5.7.7.26":"trustedAnchors","1.3.6.1.5.5.7.7.27":"authPublish","1.3.6.1.5.5.7.7.28":"batchRequests","1.3.6.1.5.5.7.7.29":"batchResponses","1.3.6.1.5.5.7.7.30":"publishCert","1.3.6.1.5.5.7.7.31":"modCertTemplate","1.3.6.1.5.5.7.7.32":"controlProcessed","1.3.6.1.5.5.7.7.33":"popLinkWitnessV2","1.3.6.1.5.5.7.7.34":"identityProofV2","1.3.6.1.5.5.7.9.1":"dateOfBirth","1.3.6.1.5.5.7.9.2":"placeOfBirth","1.3.6.1.5.5.7.9.3":"gender","1.3.6.1.5.5.7.9.4":"countryOfCitizenship","1.3.6.1.5.5.7.9.5":"countryOfResidence","1.3.6.1.5.5.7.10.1":"authenticationInfo","1.3.6.1.5.5.7.10.2":"accessIdentity","1.3.6.1.5.5.7.10.3":"chargingIdentity","1.3.6.1.5.5.7.10.4":"group","1.3.6.1.5.5.7.10.6":"encAttrs","1.3.6.1.5.5.7.12.2":"PKIData","1.3.6.1.5.5.7.12.3":"PKIResponse","1.3.6.1.5.5.7.48.1.1":"ocsp-basic","1.3.6.1.5.5.7.48.1.2":"ocsp-nonce","1.3.6.1.5.5.7.48.1.3":"ocsp-crl","1.3.6.1.5.5.7.48.1.4":"ocsp-response","1.3.6.1.5.5.7.48.1.5":"ocsp-nocheck","1.3.6.1.5.5.7.48.1.6":"ocsp-archive-cutoff","1.3.6.1.5.5.7.48.1.7":"ocsp-service-locator","2.16.840.1.101.2.1.2.78.2":"encryptedKeyPkg","2.16.840.1.101.2.1.2.78.3":"keyPackageReceipt","2.16.840.1.101.2.1.2.78.5":"aKeyPackage","2.16.840.1.101.2.1.2.78.6":"keyPackageError","2.16.840.1.101.3.4":"nistAlgorithms","2.16.840.1.101.3.4.1":"aes","2.16.840.1.101.3.4.1.1":"aes128-ECB","2.16.840.1.101.3.4.1.2":"aes128-CBC","2.16.840.1.101.3.4.1.3":"aes128-OFB","2.16.840.1.101.3.4.1.4":"aes128-CFB","2.16.840.1.101.3.4.1.5":"aes128-wrap","2.16.840.1.101.3.4.1.6":"aes128-GCM","2.16.840.1.101.3.4.1.7":"aes128-CCM","2.16.840.1.101.3.4.1.8":"aes128-wrap-pad","2.16.840.1.101.3.4.1.21":"aes192-ECB","2.16.840.1.101.3.4.1.22":"aes192-CBC","2.16.840.1.101.3.4.1.23":"aes192-OFB","2.16.840.1.101.3.4.1.24":"aes192-CFB","2.16.840.1.101.3.4.1.25":"aes192-wrap","2.16.840.1.101.3.4.1.26":"aes192-GCM","2.16.840.1.101.3.4.1.27":"aes192-CCM","2.16.840.1.101.3.4.1.28":"aes192-wrap-pad","2.16.840.1.101.3.4.1.41":"aes256-ECB","2.16.840.1.101.3.4.1.42":"aes256-CBC","2.16.840.1.101.3.4.1.43":"aes256-OFB","2.16.840.1.101.3.4.1.44":"aes256-CFB","2.16.840.1.101.3.4.1.45":"aes256-wrap","2.16.840.1.101.3.4.1.46":"aes256-GCM","2.16.840.1.101.3.4.1.47":"aes256-CCM","2.16.840.1.101.3.4.1.48":"aes256-wrap-pad","2.16.840.1.101.3.4.2.1":"sha256","2.16.840.1.101.3.4.2.2":"sha384","2.16.840.1.101.3.4.2.3":"sha512","2.16.840.1.113730.3.1.216":"userPKCS12","2.5.1.5.55":"clearance","2.5.4.0":"objectClass","2.5.4.1":"aliasedEntryName","2.5.4.2":"knowldgeinformation","2.5.4.3":"commonName","2.5.4.5":"serialName","2.5.4.6":"countryName","2.5.4.7":"localityName","2.5.4.8":"stateOrProvinceName","2.5.4.9":"streetAddress","2.5.4.10":"organizationName","2.5.4.11":"organizationalUnitName","2.5.4.12":"title","2.5.4.13":"description","2.5.4.14":"searchGuide","2.5.4.15":"businessCategory","2.5.4.16":"postalAddress","2.5.4.17":"postalCode","2.5.4.18":"postOfficeBox","2.5.4.19":"physicalDeliveryOfficeName","2.5.4.20":"telephoneNumber","2.5.4.21":"telexNumber","2.5.4.22":"teletexTerminalIdentifier","2.5.4.23":"facsimileTelephoneNumber","2.5.4.24":"x121Address","2.5.4.25":"internationalISDNNumber","2.5.4.26":"registeredAddress","2.5.4.27":"destinationIndicator","2.5.4.28":"preferredDeliveryMethod","2.5.4.29":"presentationAddress","2.5.4.30":"supportedApplicationContext","2.5.4.31":"member","2.5.4.32":"owner","2.5.4.33":"roleOccupant","2.5.4.34":"seeAlso","2.5.4.35":"userPassword","2.5.4.36":"userCertificate","2.5.4.37":"cACertificate","2.5.4.38":"authorityRevocationList","2.5.4.39":"certificateRevocationList","2.5.4.40":"crossCertificatePair","2.5.4.41":"name","2.5.4.42":"givenName","2.5.4.43":"initials","2.5.4.44":"generationQualifier","2.5.4.45":"uniqueIdentifier","2.5.4.46":"dnQualifier","2.5.4.47":"enhancedSearchGuide","2.5.4.48":"protocolInformation","2.5.4.49":"distinguishedName","2.5.4.50":"uniqueMember","2.5.4.51":"houseIdentifier","2.5.4.52":"supportedAlgorithms","2.5.4.53":"deltaRevocationList","2.5.4.58":"attributeCertificate","2.5.4.65":"pseudonym","2.5.4.72":"role","2.5.29.1":"authorityKeyIdentifierX","2.5.29.2":"keyAttributesX","2.5.29.3":"certificatePoliciesX","2.5.29.4":"keyUsageRestriction","2.5.29.5":"policyMapping","2.5.29.6":"subtreesConstraint","2.5.29.7":"subjectAltNameX","2.5.29.8":"issuerAltNameX","2.5.29.9":"subjectDirectoryAttributes","2.5.29.10":"basicConstraintsX","2.5.29.11":"nameConstraintsX","2.5.29.12":"policyConstraintsX","2.5.29.13":"basicConstraintsY","2.5.29.14":"subjectKeyIdentifier","2.5.29.15":"keyUsage","2.5.29.16":"privateKeyUsagePeriod","2.5.29.17":"subjectAltName","2.5.29.18":"issuerAltName","2.5.29.19":"basicConstraints","2.5.29.20":"cRLNumber","2.5.29.21":"cRLReason","2.5.29.22":"expirationDate","2.5.29.23":"instructionCode","2.5.29.24":"invalidityDate","2.5.29.25":"cRLDistributionPointsX","2.5.29.26":"issuingDistributionPointX","2.5.29.27":"deltaCRLIndicator","2.5.29.28":"issuingDistributionPoint","2.5.29.29":"certificateIssuer","2.5.29.30":"nameConstraints","2.5.29.31":"cRLDistributionPoints","2.5.29.32":"certificatePolicies","2.5.29.33":"policyMappings","2.5.29.34":"policyConstraintsY","2.5.29.35":"authorityKeyIdentifier","2.5.29.36":"policyConstraints","2.5.29.37":"extKeyUsage","2.5.29.46":"freshestCRL","2.5.29.54":"inhibitAnyPolicy","2.5.29.55":"targetInformation","2.5.29.56":"noRevAvail"},i={};for(var o in n)i[n[o]]=o;var a={"id-GostR3411-94-with-GostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94","id-GostR3411-94-with-GostR3410-94":"GOST R 34.10-94/GOST R 34.11-94","id-GostR3411-94":"GOST R 34.11-94","id-HMACGostR3411-94":{name:"HMAC",hash:{name:"GOST R 34.11-94"}},"id-Gost28147-89-None-KeyWrap":"GOST 28147-89-KW","id-Gost28147-89-CryptoPro-KeyWrap":"GOST 28147-89-CPKW","id-GostR3410-2001":"GOST R 34.10-2001","id-GostR3410-94":"GOST R 34.10-94","id-GostR3410-94-a":"GOST R 34.10-94","id-GostR3410-94-aBis":"GOST R 34.10-94","id-GostR3410-94-b":"GOST R 34.10-94","id-GostR3410-94-bBis":"GOST R 34.10-94","id-Gost28147-89":"GOST 28147-89","id-Gost28147-89-MAC":"GOST 28147-89-MAC","id-GostR3410-2001-CryptoPro-ESDH":"GOST R 34.10-2001-DH/GOST R 34.11-94","id-GostR3410-94-CryptoPro-ESDH":"GOST R 34.10-94-DH/GOST R 34.11-94","id-GostR3410-2001DH":"GOST R 34.10-2001-DH","id-GostR3410-94DH":"GOST R 34.10-94-DH","id-tc26-gost3410-12-256":"GOST R 34.10-256","id-tc26-gost3410-12-512":"GOST R 34.10-512","id-tc26-gost3411-94":"GOST R 34.11-94","id-tc26-gost3411-12-256":"GOST R 34.11-256","id-tc26-gost3411-12-512":"GOST R 34.11-512","id-tc26-signwithdigest-gost3410-12-94":"GOST R 34.10-256/GOST R 34.11-94","id-tc26-signwithdigest-gost3410-12-256":"GOST R 34.10-256/GOST R 34.11-256","id-tc26-signwithdigest-gost3410-12-512":"GOST R 34.10-512/GOST R 34.11-512","id-tc26-hmac-gost-3411-12-256":{name:"HMAC",hash:{name:"GOST R 34.11-256"}},"id-tc26-hmac-gost-3411-12-512":{name:"HMAC",hash:{name:"GOST R 34.11-512"}},"id-tc26-agreement-gost-3410-12-256":"GOST R 34.10-256-DH/GOST R 34.11-256","id-tc26-agreement-gost-3410-12-512":"GOST R 34.10-512-DH/GOST R 34.11-256","id-sc-gost28147-ecb":"GOST 28147-89-ECB/SC","id-sc-gost28147-gamma":"GOST 28147-89-CTR/SC","id-sc-gost28147-gfb":"GOST 28147-89-CFB/SC","id-sc-gost28147-mac":"GOST 28147-89-MAC/SC","id-sc-gostR3410-94":"GOST R 34.10-94/SC","id-sc-gostR3410-94-default":"GOST R 34.10-94/SC","id-sc-gostR3410-94-test":"GOST R 34.10-94/SC/S-TEST","id-sc-gostR3411-94":"GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-94":"GOST R 34.10-94/GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94/SC","id-sc-cmsGostWrap":"GOST 28147-89-SCKW/SC","id-sc-cmsGost28147Wrap":"GOST 28147-89-KW/SC","id-sc-pbeWithGost3411AndGost28147":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-ECB/SC"}},"id-sc-pbeWithGost3411AndGost28147CFB":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-CFB/SC"}},"id-sc-gostR3410-2001":"GOST R 34.10-2001/SC","id-sc-hmacWithGostR3411":{name:"HMAC",hash:{name:"GOST R 34.11-94/SC"}},"id-sc-r3410-ESDH-r3411kdf":"GOST R 34.10-2001-DH/GOST R 34.11-94/SC",noSignature:"NONE",rsaEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha1withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},sha256withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha384withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},sha512withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"rsaes-oaep":"RSA-OAEP","rsassa-pss":"RSA-PSS",ecdsa:"ECDSA","ecdsa-with-SHA1":{name:"ECDSA",hash:{name:"SHA-1"}},"ecdsa-with-SHA256":{name:"ECDSA",hash:{name:"SHA-256"}},"ecdsa-with-SHA384":{name:"ECDSA",hash:{name:"SHA-384"}},"ecdsa-with-SHA512":{name:"ECDSA",hash:{name:"SHA-512"}},"pbeWithSHAAndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHAAndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHAAndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHA256AndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHA256AndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHA256AndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHAAnd3-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"3DES",block:"CBC"}},"pbeWithSHAAnd2-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"2DES",block:"CBC"}},"pbeWithSHAAnd128BitRC2-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:128}},"pbeWithSHAAnd40BitRC2-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:40}},pbeUnknownGost:{derivation:{name:"PFXKDF",iterations:2e3,hash:"GOST R 34.11-94"},encryption:{name:"GOST 28147-89-CFB"}},ecDH:"ECDH",dhKeyAgreement:"DH","aes128-CBC":{name:"AES-CBC",length:128},"aes128-CFB":{name:"AES-CFB-8",length:128},"aes128-GCM":{name:"AES-GCM",length:128},"aes128-wrap":{name:"AES-KW",length:128},"aes192-CBC":{name:"AES-CBC",length:192},"aes192-CFB":{name:"AES-CFB-8",length:192},"aes192-GCM":{name:"AES-GCM",length:192},"aes192-wrap":{name:"AES-KW",length:192},"aes256-CBC":{name:"AES-CBC",length:256},"aes256-CFB":{name:"AES-CFB-8",length:256},"aes256-GCM":{name:"AES-GCM",length:256},"aes256-wrap":{name:"AES-KW",length:256},sha1:"SHA-1",sha256:"SHA-256",sha384:"SHA-384",sha512:"SHA-512",PBKDF2:"PBKDF2",PBES2:{derivation:{name:"PBKDF2"},encryption:{}},PBMAC1:{derivation:{name:"PBKDF2"},hmac:{}},hmacWithSHA1:"SHA-1-HMAC",hmacWithSHA256:{name:"HMAC",hash:{name:"SHA-256"}},hmacWithSHA384:{name:"HMAC",hash:{name:"SHA-384"}},hmacWithSHA512:{name:"HMAC",hash:{name:"SHA-512"}}};for(var o in a){var s=a[o];"string"==typeof s&&(s={name:s}),s.id=o,a[o]=s}var c={"id-GostR3410-94-TestParamSet":{namedParam:"S-TEST"},"id-GostR3410-94-CryptoPro-A-ParamSet":{namedParam:"S-A"},"id-GostR3410-94-CryptoPro-B-ParamSet":{namedParam:"S-B"},"id-GostR3410-94-CryptoPro-C-ParamSet":{namedParam:"S-C"},"id-GostR3410-94-CryptoPro-D-ParamSet":{namedParam:"S-D"},"id-GostR3410-94-CryptoPro-XchA-ParamSet":{namedParam:"X-A"},"id-GostR3410-94-CryptoPro-XchB-ParamSet":{namedParam:"X-B"},"id-GostR3410-94-CryptoPro-XchC-ParamSet":{namedParam:"X-C"},"id-GostR3410-2001-CryptoPro-TestParamSet":{namedCurve:"S-256-TEST"},"id-GostR3410-2001-CryptoPro-A-ParamSet":{namedCurve:"S-256-A"},"id-GostR3410-2001-CryptoPro-B-ParamSet":{namedCurve:"S-256-B"},"id-GostR3410-2001-CryptoPro-C-ParamSet":{namedCurve:"S-256-C"},"id-GostR3410-2001-CryptoPro-XchA-ParamSet":{namedCurve:"X-256-A"},"id-GostR3410-2001-CryptoPro-XchB-ParamSet":{namedCurve:"X-256-B"},"id-tc26-gost-3410-12-256-paramSetTest":{namedCurve:"T-256-TEST"},"id-tc26-gost-3410-12-256-paramSetA":{namedCurve:"T-256-A"},"id-tc26-gost-3410-12-256-paramSetB":{namedCurve:"T-256-B"},"id-tc26-gost-3410-12-512-paramSetTest":{namedCurve:"T-512-TEST"},"id-tc26-gost-3410-12-512-paramSetA":{namedCurve:"T-512-A"},"id-tc26-gost-3410-12-512-paramSetB":{namedCurve:"T-512-B"},"id-tc26-gost-3410-12-512-paramSetC":{namedCurve:"T-512-C"},"id-tc26-gost-3410-12-512-paramSetD":{namedCurve:"T-512-D"},secp256r1:{namedCurve:"P-256"},secp384r:{namedCurve:"P-384"},secp521r:{namedCurve:"P-521"},"id-GostR3411-94-TestParamSet":{sBox:"D-TEST"},"id-GostR3411-94-CryptoProParamSet":{sBox:"D-A"},"id-GostR3411-94-CryptoPro-A-ParamSet":{sBox:"D-B"},"id-GostR3411-94-CryptoPro-B-ParamSet":{sBox:"D-C"},"id-GostR3411-94-CryptoPro-C-ParamSet":{sBox:"D-D"},"id-Gost28147-89-TestParamSet":{block:"CTR",sBox:"E-TEST"},"id-Gost28147-89-CryptoPro-A-ParamSet":{block:"CFB",sBox:"E-A",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-B-ParamSet":{block:"CFB",sBox:"E-B",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-C-ParamSet":{block:"CFB",sBox:"E-C",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-D-ParamSet":{block:"CFB",sBox:"E-D",keyMeshing:"CP"},"id-Gost28147-89-None-KeyMeshing":{keyMeshing:"NO"},"id-Gost28147-89-CryptoPro-KeyMeshing":{keyMeshing:"CP"},"id-tc26-gost-28147-param-Z":{block:"CFB",sBox:"E-Z"}},u={sBox:{"D-TEST":"id-GostR3411-94-TestParamSet","D-A":"id-GostR3411-94-CryptoProParamSet","D-B":"id-GostR3411-94-CryptoPro-A-ParamSet","D-C":"id-GostR3411-94-CryptoPro-B-ParamSet","D-D":"id-GostR3411-94-CryptoPro-C-ParamSet","E-TEST":"id-Gost28147-89-TestParamSet","E-A":"id-Gost28147-89-CryptoPro-A-ParamSet","E-B":"id-Gost28147-89-CryptoPro-B-ParamSet","E-C":"id-Gost28147-89-CryptoPro-C-ParamSet","E-D":"id-Gost28147-89-CryptoPro-D-ParamSet","E-Z":"id-tc26-gost-28147-param-Z","D-256":"id-tc26-gost3411-12-256","D-512":"id-tc26-gost3411-12-512"},namedParam:{"S-TEST":"id-GostR3410-94-TestParamSet","S-A":"id-GostR3410-94-CryptoPro-A-ParamSet","S-B":"id-GostR3410-94-CryptoPro-B-ParamSet","S-C":"id-GostR3410-94-CryptoPro-C-ParamSet","S-D":"id-GostR3410-94-CryptoPro-D-ParamSet","X-A":"id-GostR3410-94-CryptoPro-XchA-ParamSet","X-B":"id-GostR3410-94-CryptoPro-XchB-ParamSet","X-C":"id-GostR3410-94-CryptoPro-XchC-ParamSet"},namedCurve:{"S-256-TEST":"id-GostR3410-2001-CryptoPro-TestParamSet","S-256-A":"id-GostR3410-2001-CryptoPro-A-ParamSet","S-256-B":"id-GostR3410-2001-CryptoPro-B-ParamSet","S-256-C":"id-GostR3410-2001-CryptoPro-C-ParamSet","X-256-A":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","X-256-B":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","P-256":"secp256r1","T-256-TEST":"id-tc26-gost-3410-12-256-paramSetTest","T-256-A":"id-tc26-gost-3410-12-256-paramSetA","T-256-B":"id-tc26-gost-3410-12-256-paramSetB","T-512-TEST":"id-tc26-gost-3410-12-512-paramSetTest","T-512-A":"id-tc26-gost-3410-12-512-paramSetA","T-512-B":"id-tc26-gost-3410-12-512-paramSetB"}},f={"CP-94":{title:"Crypto-Pro GOST R 34.10-94 Cryptographic Service Provider",signature:a["id-GostR3411-94-with-GostR3410-94"],publicKey:{id:"id-GostR3410-94",name:"GOST R 34.10-94",namedParam:"X-A"},privateKey:{id:"id-GostR3410-94DH",name:"GOST R 34.10-94-DH",namedParam:"X-A"},digest:a["id-GostR3411-94"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-94-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89",block:"CFB",sBox:"E-A",keyMeshing:"CP"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2e3}},"CP-01":{title:"Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider",signature:a["id-GostR3411-94-with-GostR3410-2001"],publicKey:{id:"id-GostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"X-256-A"},privateKey:{id:"id-GostR3410-2001DH",name:"GOST R 34.10-2001-DH",namedCurve:"X-256-A"},digest:{id:"id-GostR3411-94",name:"GOST R 34.11-94",sBox:"D-A"},wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-HMACGostR3411-94"],agreement:a["id-GostR3410-2001-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2e3}},"TC-256":{title:"Crypto-Pro GOST R 34.10-2012 Cryptographic Service Provider",signature:a["id-tc26-signwithdigest-gost3410-12-256"],publicKey:{id:"id-tc26-gost3410-12-256",name:"GOST R 34.10-256",namedCurve:"X-256-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-256",name:"GOST R 34.10-256-DH/GOST R 34.11-256",namedCurve:"X-256-A"},digest:a["id-tc26-gost3411-12-256"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-256"],agreement:a["id-tc26-agreement-gost-3410-12-256"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-12-PBKDF2",iterations:2e3}},"TC-512":{title:"Crypto-Pro GOST R 34.10-2012 Strong Cryptographic Service Provider",signature:a["id-tc26-signwithdigest-gost3410-12-512"],publicKey:{id:"id-tc26-gost3410-12-512",name:"GOST R 34.10-512",namedCurve:"T-512-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-512",name:"GOST R 34.10-512-DH/GOST R 34.11-256",namedCurve:"T-512-A"},digest:a["id-tc26-gost3411-12-512"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:a["id-tc26-hmac-gost-3411-12-512"],agreement:a["id-tc26-agreement-gost-3410-12-512"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-PBKDF2",iterations:2e3}},"SC-94":{title:"Signal-COM GOST Cryptographic Provider",signature:a["id-sc-gostR3411-94-with-gostR3410-94"],publicKey:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94/SC",namedParam:"S-A"},privateKey:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94/SC",modulusLength:1024,param:{p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"}},digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:a["id-sc-hmacWithGostR3411"],wrapping:["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"SC-01":{title:"Signal-COM ECGOST Cryptographic Provider",signature:a["id-sc-gostR3411-94-with-gostR3410-2001"],publicKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",namedCurve:"P-256"},privateKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",curve:{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"}},digest:a["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:a["id-sc-hmacWithGostR3411"],wrapping:a["id-sc-cmsGostWrap"],agreement:a["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"RSA-2048":{title:"Microsoft Strong Cryptographic Provider",signature:a.sha256withRSAEncryption,publicKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:a.sha256},privateKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:a.sha256},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256},"ECDSA-256":{title:"Microsoft Base DSS and Diffie-Hellman Cryptographic Provider",signature:a["ecdsa-with-SHA256"],publicKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},privateKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},digest:a.sha256,encryption:a["aes256-CFB"],hmac:a.hmacWithSHA256,agreement:a.ecDH}};["CP-94","CP-01","TC-256","TC-512","SC-94","SC-01"].forEach(function(e){var r=f[e];r.hmac=t(r.hmac,{hash:r.digest}),r.derivation=t(r.derivation,{hash:r.digest,hmac:r.hmac}),r.pbes=r.pbes||{id:"PBES2",derivation:r.derivation,encryption:r.encryption},r.pbmac=r.pbmac||{id:"PBMAC1",derivation:r.derivation,hmac:r.hmac},r.agreement=t(r.agreement,{wrapping:r.wrapping})}),["RSA-2048","ECDSA-256"].forEach(function(e){var t=f[e];t.derivation=t.derivation||{id:"PBKDF2",name:"PBKDF2",iterations:2048,hash:t.digest},t.pbes=t.pbes||{id:"PBES2",derivation:t.derivation,encryption:t.encryption},t.pbmac=t.pbmac||{id:"PBMAC1",derivation:t.derivation,hmac:t.hmac}}),r.prototype={names:n,identifiers:i,algorithms:a,parameters:c,attributes:u,providers:f},e.security=new r})},function(e,t,r){!function(t,n){e.exports=n(r(0),r(2))}(0,function(e){function t(e){for(var t=1,r=arguments.length;t<r;t++){var n=arguments[t];if("object"==typeof n)for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}function r(e){var r=function(){};r.prototype=e.prototype;for(var n=new r,i=[n],o=1;o<arguments.length;o++)i.push(arguments[o]);return t.apply(this,i)}function n(e){var t=new B;return t.setHours(0,0,0,0),e&&t.setDate(t.getDate()+e),t}function i(e){try{e()}catch(e){}}function o(){var t=new Uint8Array(4);return e.getRandomValues(t),t[0]=127&t[0],K.Int16.encode(t)}function a(e,t){for(var r in e)if(e[r]!==t[r])return!1;for(var r in t)if(e[r]!==t[r])return!1;return!0}function s(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;return!0}function c(e,t){var r=e.extensions&&e.extensions.subjectKeyIdentifier;return e&&t&&(!t.issuer||a(e.issuer,t.issuer))&&(!t.serialNumber||R(e.serialNumber,t.serialNumber))&&(!t.subjectKeyIdentifier||s(r,t.subjectKeyIdentifier))&&(!t.subject||a(e.subject,t.subject))&&(!t.date||e.notBefore.getTime()<=t.date.getTime()&&e.notAfter.getTime()>t.date.getTime())}function u(e,t,r){var n={subject:e.issuer,date:r},i=t&&t.authorityKeyIdentifier;return i&&(n.subjectKeyIdentifier=i.keyIdentifier,i.authorityCertIssuer&&i.authorityCertIssuer[0]&&i.authorityCertSerialNumber&&(n.issuer=i.authorityCertIssuer[0],n.serialNumber=i.authorityCertSerialNumber)),n}function f(e,t){for(var r=[],n=0,i=e.length;n<i;n++)c(e[n],t)&&r.push(e[n]);return r}function h(e,t){return(!t.issuer||a(e.issuer,t.issuer))&&(!t.date||e.thisUpdate.getTime()<t.date.getTime())}function d(e,t){for(var r=[],n=0,i=e.length;n<i;n++)h(e[n],t)&&r.push(e[n]);return r}function y(e){var t=e.id;for(var r in k){var n=k[r];if(n.publicKey.id===t)return n}}function p(e,t,r,n){"object"!=typeof r&&(r={value:r}),void 0!==n&&(r.enumerable=n),S.defineProperty(e,t,r)}function l(e,t,r){for(var n in t)p(e,n,t[n],r)}function r(e,t,r,n){if("function"!=typeof t&&(n=r,r=t,t=function(){e.apply(this,arguments)}),t.prototype=S.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}}),r&&l(t.prototype,r,!0),e!==S)for(var i in e)t[i]=e[i];return t.super=e,n&&l(t,n,!0),t}function g(){}function m(e){try{P.CertificationRequest.call(this,e,!0)}catch(t){e=e||{},P.CertificationRequest.call(this,{version:0,subject:e.subject||I.subject,subjectPublicKeyInfo:e.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new E(0)},attributes:e.attributes||{extensionRequest:{keyUsage:I.userKeyUsage,extKeyUsage:I.userExtKeyUsage}},signatureAlgorithm:{id:"noSignature"},signatureValue:new E(0)})}}function v(e,t){this.certificates=e||[],this.crls=t||[]}function C(e){this.certStore=e}function A(){}function b(e,t,r){this.trustedCACerts=e||[],this.requireCRL=t||!1,this.requireCA=r||!0}var F=this,w=F.Promise,S=F.Object,E=F.ArrayBuffer,B=F.Date,D=e.subtle,K=e.coding,P=e.asn1,k=e.security.providers,R=function(){var e=function(e){var t=typeof e;return"undefined"===t||""===e?"0":"number"===t||e instanceof Number?e.toString(16).toLowerCase():e.replace("0x","").toLowerCase()},t=function(e,t){return(new Array(t+1).join("0")+e).slice(-t)};return function(r,n){r=e(r),n=e(n);var i=Math.max(r.length,n.length);return t(r,i)===t(n,i)}}(),I={providerName:"CP-01",subject:{countryName:"RU",commonName:"Anonymous"},caKeyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign"],caExtKeyUsage:["serverAuth","clientAuth","codeSigning","emailProtection","ipsecEndSystem","ipsecTunnel","ipsecUser","timeStamping","OCSPSigning"],userKeyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement"],userExtKeyUsage:["clientAuth","emailProtection"],days:7305};g.prototype.options=I;var T=function(e){try{P.Certificate.call(this,e,!0)}catch(t){try{e=new P.CertificationRequest(e,!0)}catch(e){}e=e||{},P.Certificate.call(this,{version:2,serialNumber:e.serialNumber||o(),signature:e.signature||{id:"noSignature"},issuer:e.subject||I.subject,notBefore:e.notBefore||n(),notAfter:e.notAfter||n(e.days||I.days),subject:e.subject||I.subject,subjectPublicKeyInfo:e.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new E(0)},extensions:e.attributes&&(e.attributes.extensionRequest||e.attributes.msCertExtensions)||e.extensions,signatureAlgorithm:{id:"noSignature"},signatureValue:new E(0)})}};r(P.Certificate,T,{sign:function(e,t){var r=this,n=r.subjectPublicKeyInfo;return new w(i).then(function(){if(!n||!n.algorithm||"noSignature"===n.algorithm)throw new Error("Key pair was not generated for the certificate");if(!e)throw new Error("The private key of the issuer is not defined");return t=t||r,D.digest("SHA-1",n.subjectPublicKey)}).then(function(n){var i=t.getProvider()||k[I.providerName];r.signature&&"noSignature"!==r.signature.id||(r.signature=i.signature),r.signatureAlgorithm=r.signature,r.issuer=t.subject,r.extensions||(r.extensions={});var o=r.extensions,a=t.extensions;if(r===t)o.keyUsage=o.keyUsage||I.caKeyUsage,o.extKeyUsage=o.extKeyUsage||I.caExtKeyUsage,o.basicConstraints=o.basicConstraints||{cA:!0};else{if(!t.checkUsage("keyCertSign",r.notBefore))throw new Error("The issuer's certificate is not valid for signing a certificate");if(o.keyUsage=o.keyUsage||I.userKeyUsage,o.extKeyUsage=o.extKeyUsage||I.userExtKeyUsage,o.basicConstraints=o.basicConstraints||{cA:o.keyUsage.indexOf("keyCertSign")>=0},o.basicConstraints.cA){var s=a&&a.basicConstraints&&a.pathLenConstraint;if(void 0!==s){if(!(s>0))throw new Error("Path length constraint exceeded");o.basicConstraints.pathLenConstraint=s-1}}}return o.subjectKeyIdentifier=n,a&&a.subjectKeyIdentifier&&(o.authorityKeyIdentifier={keyIdentifier:a.subjectKeyIdentifier,authorityCertIssuer:[t.issuer],authorityCertSerialNumber:t.serialNumber}),D.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,!1,["sign"])}).then(function(e){return D.sign(r.signatureAlgorithm,e,r.tbsCertificate.encode())}).then(function(e){return r.signatureValue=e,r})},generate:function(e){var r,n,o=this;return n=e?k[e]:this.getProvider()||k[I.providerName],n&&(e=t(n.publicKey,{privateKey:n.privateKey})),new w(i).then(function(){return D.generateKey(e,"true",["sign","verify"])}).then(function(e){return r=e.privateKey,D.exportKey("spki",e.publicKey)}).then(function(e){return o.subjectPublicKeyInfo=new P.SubjectPublicKeyInfo(e),D.exportKey("pkcs8",r)}).then(function(e){return new P.PrivateKeyInfo(e)})},getPublicKey:function(){var e=this.subjectPublicKeyInfo,t="rsaEncryption"===e.algorithm.id?["verify"]:["verify","deriveKey","deriveBits"];return D.importKey("spki",e.encode(),e.algorithm,"false",t)},getProvider:function(){return y(this.subjectPublicKeyInfo.algorithm)},verify:function(e,t,r){var o=this,a=o.extensions;return new w(i).then(function(){if(r=r||n(),o.notBefore.getTime()>r.getTime()||o.notAfter.getTime()<=r.getTime())throw new Error("The certificate has not yet started or expired");for(var t in a){if(a[t].critical&&["authorityKeyIdentifier","subjectKeyIdentifier","keyUsage","certificatePolicies","policyMappings","basicConstraints","nameConstraints","policyConstraints","extKeyUsage"].indexOf(t)<0)throw new Error("The critical extension '"+t+"' is unrecognized")}var i=u(o,a,o.notBefore);if(!e&&c(o,i)&&(e=o),e){if(!c(e,i)||!e.checkUsage("keyCertSign",o.notBefore))throw new Error("The issuer's certificate is not valid");return e.verifySignature(o.tbsCertificate.encode(),o.signatureValue,o.signatureAlgorithm)}return!0}).then(function(e){if(!e)throw new Error("The certificate has invalid signature");if(t){if(!h(t,{issuer:o.issuer,date:r}))throw new Error("The issuer's CRL is not valid");if(t.isRevoked(o.serialNumber))throw new Error("The certificate is revoked")}return o})},verifySignature:function(e,t,r){return this.getPublicKey().then(function(n){return D.verify(r,n,t,e)})},checkUsage:function(e,t){var r=this,i=r.extensions;return t=t||n(),r.notBefore.getTime()<=t.getTime()&&r.notAfter.getTime()>t.getTime()&&(!i||!(["keyCertSign","cRLSign"].indexOf(e)>0&&i.basicConstraints&&!i.basicConstraints.cA||i.keyUsage&&i.keyUsage.indexOf(e)<0&&i.extKeyUsage&&i.extKeyUsage.indexOf(e)<0))}}),g.prototype.X509=T;var x=function(e){x.super.call(this,e),this.version||(this.version=1),this.revokedCertificates||(this.revokedCertificates=[]),this.thisUpdate||(this.thisUpdate=n())};return r(P.CertificateList,x,{sign:function(e,t){var r=this;return new w(i).then(function(){if(!e)throw new Error("The issuer's private key is not defined");if(!t)throw new Error("The issuer's certificate is not defined");if(r.issuer){if(!a(r.issuer,t.issuer))throw new Error("The CRL prototype and authority certificate have different issuers")}else r.issuer=t.issuer;if(!t.checkUsage("cRLSign",r.thisUpdate))throw new Error("The issuer's certificate is not valid for signing a CRL");var n=t.getProvider()||k[I.providerName];r.signature||(r.signature=n.signature),r.signatureAlgorithm=r.signature,r.issuer=t.subject,r.crlExtensions||(r.crlExtensions={});var i=r.crlExtensions,o=t.extensions;return o&&o.subjectKeyIdentifier&&(i.authorityKeyIdentifier={keyIdentifier:o.subjectKeyIdentifier,authorityCertIssuer:[t.issuer],authorityCertSerialNumber:t.serialNumber}),i.cRLNumber=i.cRLNumber||0,D.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,!1,["sign"])}).then(function(e){return D.sign(r.signatureAlgorithm,e,r.tbsCertList.encode())}).then(function(e){return r.signatureValue=e,r})},verify:function(e,t){var r=this,o=r.crlExtensions;return new w(i).then(function(){if(t=t||n(),!r.thisUpdate.getTime()>t.getTime())throw new Error("The CRL has not yet started");if(e){if(!c(e,u(r,o,r.thisUpdate))||!e.checkUsage("cRLSign",r.thisUpdate))throw new Error("The issuer's certificate is not valid");if(!r.signatureValue||!r.signatureAlgorithm)throw new Error("The has no signature");return e.verifySignature(r.tbsCertList.encode(),r.signatureValue,r.signatureAlgorithm)}}).then(function(e){if(!e)throw new Error("The CRL has invalid signature");return r})},isRevoked:function(e,t){var r=this.revokedCertificates;t=t||n();for(var i=0;i<r.length;i++)if(t.getTime()>=r[i].revocationDate.getTime()&&R(r[i].userCertificate,e))return!0;return!1}}),g.prototype.CRL=x,r(P.CertificationRequest,m,{generate:function(e){var r,n,o=this;return n=e?k[e]:this.getProvider()||k[I.providerName],n&&(e=t(n.publicKey,{privateKey:n.privateKey})),new w(i).then(function(){return D.generateKey(e,"true",["sign","verify"])}).then(function(e){return r=e.privateKey,D.exportKey("spki",e.publicKey)}).then(function(e){return o.subjectPublicKeyInfo=new P.SubjectPublicKeyInfo(e),D.exportKey("pkcs8",r)}).then(function(e){return r=new P.PrivateKeyInfo(e),o.sign(r)}).then(function(){return r})},getProvider:function(){return y(this.subjectPublicKeyInfo.algorithm)},sign:function(e){var t=this,r=t.subjectPublicKeyInfo;return new w(i).then(function(){if(!r||!r.algorithm||"noSignature"===r.algorithm)throw new Error("Key pair was not generated for the certificate");if(!e)throw new Error("The private key is not defined");var n=y(r.algorithm)||k[I.providerName];return t.signatureAlgorithm=n.signature,D.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,!1,["sign"])}).then(function(e){return D.sign(t.signatureAlgorithm,e,t.requestInfo.encode())}).then(function(e){return t.signatureValue=e,t})},verify:function(){var e=this,t=e.subjectPublicKeyInfo;return new w(i).then(function(){return D.importKey("spki",t.encode(),t.algorithm,"false",["verify"])}).then(function(t){return D.verify(e.signatureAlgorithm,t,e.signatureValue,e.requestInfo.encode())}).then(function(t){if(!t)throw new Error("The certification request has invalid signature");return e})}}),g.prototype.Request=m,r(S,v,{getCertificates:function(e){return f(this.certificates,e)},getCRLs:function(e){return d(this.certificates,e)},load:function(e){for(var t=new P.ContentInfo(e),r=t.certificates,n=t.crls,i=0;i<r.length;i++)this.certificates.push(new T(r[i]));for(var i=0;i<n.length;i++)this.crls.push(new x(n[i]));return this},store:function(){return new P.ContentInfo({contentType:"signedData",version:0,digestAlgorithms:[],encapContentInfo:{contentType:"data"},certificates:this.certs,crls:this.crls,signerInfos:[]})}}),g.prototype.CertStore=v,r(S,C,{build:function(e,t){var r=this;return new w(i).then(function(){for(var n=new T(e),i=[],o=!1,a=[];n;){var s=[],f=[];if(i.push(n),!o){s=r.certStore.getCRLs({issuer:n.issuer,date:t});var h=u(n,n.extensions,n.notBefore);c(n,h)?o=!0:f=r.certStore.getCertificates(h)}var d=f.length>0&&new T(f[0]),y=s.length>0&&new x(s[0]);y&&a.push(y.verify(d,t)),a.push(n.verify(d,y,t)),n=d}if(!o)throw new Error("Root certificate is not found");return w.all(a).then(function(e){for(var t=0;t<e;t++)if(!e[t])throw new Error("Certification path is not validated");return i})})}}),g.prototype.CertPath=C,r(S,A,{getValidCertificate:function(e,t,r){}}),g.prototype.CertificateTrustPolicy=A,r(A,b,{getValidCertificate:function(e,t,r,n){var o,a=this;return new w(i).then(function(){t=t||[],r=r||[];var i=f(a.trustedCACerts,e);if(i.length>0)return new T(i[0]);if(i=f(t,e),0!==i.length){var s=new T(i[0]),h=!1,y=[];for(o=[];s;){var p=[],l=[];if(o.push(s),!h){if(p=d(r,{issuer:s.issuer,date:n}),0===p.length&&a.requireCRL)return;if(e=u(s,s.extensions,s.notBefore),l=f(a.trustedCACerts,e),0===l.length){if(!c(s,e)){if(l=f(t,e),!(l.length>0))return;var g=l[0].extensions;if(a.requireCA){if(!g||!g.basicConstraints||!g.basicConstraints.cA)return;if(void 0!==g.basicConstraints.pathLenConstraint&&g.basicConstraints.pathLenConstraint<o.length-1)return}}}else h=!0}var m=l.length>0&&new T(l[0]),v=p.length>0&&new x(p[0]);v&&y.push(v.verify(m,n)),y.push(s.verify(m,v,n)),s=m}if(!h)throw new Error("Trusted root certificate is not found");return w.all(y).then(function(e){for(var t=0;t<e;t++)if(!e[t])throw new Error("Certification path is not validated");return o[0]})}})}}),g.prototype.TrustedCAPolicy=b,e.cert=new g,g})},function(e,t,r){!function(t,n){e.exports=n(r(1))}(0,function(e){function t(e){return e>=2147483648?e-4294967296:e}function r(e){return e<0?e+4294967296:e}function n(t){e=e||he.GostRandom;var r=e?new(e||he.GostRandom):de;if(!r.getRandomValues)throw new ge("Random generator not found");r.getRandomValues(t)}function i(e){if(e instanceof ye)return e;if(e&&e.buffer&&e.buffer instanceof ye)return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;throw new le("CryptoOperationData required")}function o(e){return new Uint8Array(i(e))}function a(e){return new Uint8Array(o(e))}function s(e){return new Int32Array(i(e))}function c(e){return(255&e)<<24|(65280&e)<<8|e>>8&65280|e>>24&255}function u(e){for(var t=0,r=0;r<16;r++)t^=Fe[we[r]][e[r]];for(var r=16;r>0;--r)e[r]=e[r-1];e[0]=t}function f(e){for(var t=e[0],r=0;r<15;r++)e[r]=e[r+1];e[15]=t;var n=0;for(r=0;r<16;r++)n^=Fe[we[r]][e[r]];e[15]=n}function h(e){for(var t=0;t<16;++t)e[t]=Se[e[t]]}function d(e){for(var t=0;t<16;++t)e[t]=Ee[e[t]]}function y(e,t){for(var r=0;r<16;++r)e[r]^=t[r]}function p(e){for(var t=0;t<16;++t)u(e)}function l(e){for(var t=0;t<16;++t)f(e)}function g(e,t){y(e,t),h(e),p(e)}function m(e,t){y(e,t),l(e),d(e)}function v(e,t,r){var n=new Uint8Array(e);g(e,r),y(e,t),t.set(n)}function C(e,t){for(var r=0;r<15;r++)t[r]=0;t[15]=e,p(t)}function A(e){var t=new Uint8Array(160),r=new Uint8Array(16);t.set(o(e));for(var n=0;n<4;n++){var i=32*n,a=32*(n+1);t.set(new Uint8Array(t.buffer,i,32),a);for(var s=1;s<9;s++)C(8*n+s,r),v(new Uint8Array(t.buffer,a,16),new Uint8Array(t.buffer,a+16,16),r)}return t}function b(e,t,r,n){r=r||t.byteOffset;var i=new Uint8Array(t.buffer,r,16);if(n){for(var o=0;o<9;o++)m(i,new Uint8Array(e.buffer,16*(9-o),16));y(i,new Uint8Array(e.buffer,0,16))}else{for(var o=0;o<9;o++)g(i,new Uint8Array(e.buffer,16*o,16));y(i,new Uint8Array(e.buffer,144,16))}}function F(e,t,r){var n=t[0]+r&4294967295,i=e[0+(n>>0&15)]<<0;i|=e[16+(n>>4&15)]<<4,i|=e[32+(n>>8&15)]<<8,i|=e[48+(n>>12&15)]<<12,i|=e[64+(n>>16&15)]<<16,i|=e[80+(n>>20&15)]<<20,i|=e[96+(n>>24&15)]<<24,i|=e[112+(n>>28&15)]<<28,n=i<<11|i>>>21,n^=t[1],t[1]=t[0],t[0]=n}function w(e,t,r){r=r||t.byteOffset;for(var n=this.sBox,i=new Int32Array(t.buffer,r,2),o=0;o<32;o++)F(n,i,e[o]);var a=i[0];i[0]=i[1],i[1]=a}function S(e,t,r){r=r||t.byteOffset;var n=this.sBox,i=new Int32Array(t.buffer,r,2),o=c(i[0]);i[0]=c(i[1]),i[1]=o;for(var a=0;a<32;a++)F(n,i,e[a]);i[0]=c(i[0]),i[1]=c(i[1])}function E(e,t){for(var r=new Int32Array(32),n=new Int32Array(i(e)),o=0;o<8;o++)r[o]=n[o];if(t){for(var o=0;o<8;o++)r[o+8]=r[7-o];for(var o=0;o<8;o++)r[o+16]=r[7-o]}else{for(var o=0;o<8;o++)r[o+8]=r[o];for(var o=0;o<8;o++)r[o+16]=r[o]}for(var o=0;o<8;o++)r[o+24]=r[7-o];return r}function B(e,t){for(var r=new Int32Array(32),n=new Int32Array(i(e)),o=0;o<8;o++)r[o]=c(n[o]);if(t){for(var o=0;o<8;o++)r[o+8]=r[7-o];for(var o=0;o<8;o++)r[o+16]=r[7-o]}else{for(var o=0;o<8;o++)r[o+8]=r[o];for(var o=0;o<8;o++)r[o+16]=r[o]}for(var o=0;o<8;o++)r[o+24]=r[7-o];return r}function D(e,t){for(var r=this.pad(o(t)),n=this.blockSize,i=r.byteLength/n,a=this.keySchedule(e),s=0;s<i;s++)this.process(a,r,n*s);return r.buffer}function K(e,t){for(var r=a(t),n=this.blockSize,i=r.byteLength/n,o=this.keySchedule(e,1),s=0;s<i;s++)this.process(o,r,n*s,1);return this.unpad(r).buffer}function P(e,t,r){for(var n=new Uint8Array(r||this.iv),i=a(t),o=n.length,s=new Uint8Array(o),c=this.shiftBits>>3,u=i.length,f=u%c,h=(u-f)/c,d=this.keySchedule(e),y=0;y<h;y++){for(var p=0;p<o;p++)s[p]=n[p];this.process(d,n);for(var p=0;p<c;p++)i[y*c+p]^=n[p];for(var p=0;p<o-c;p++)n[p]=s[c+p];for(var p=0;p<c;p++)n[o-c+p]=i[y*c+p];e=this.keyMeshing(e,n,y,d)}if(f>0){this.process(d,n);for(var y=0;y<f;y++)i[h*c+y]^=n[y]}return i.buffer}function k(e,t,r){for(var n=new Uint8Array(r||this.iv),i=a(t),o=n.length,s=new Uint8Array(o),c=this.shiftBits>>3,u=i.length,f=u%c,h=(u-f)/c,d=this.keySchedule(e),y=0;y<h;y++){for(var p=0;p<o;p++)s[p]=n[p];this.process(d,n);for(var p=0;p<c;p++)s[p]=i[y*c+p],i[y*c+p]^=n[p];for(var p=0;p<o-c;p++)n[p]=s[c+p];for(var p=0;p<c;p++)n[o-c+p]=s[p];e=this.keyMeshing(e,n,y,d)}if(f>0){this.process(d,n);for(var y=0;y<f;y++)i[h*c+y]^=n[y]}return i.buffer}function R(e,t,r){for(var n=new Uint8Array(r||this.iv),i=a(t),o=n.length,s=new Uint8Array(o),c=this.shiftBits>>3,u=new Uint8Array(c),f=i.length,h=f%c,d=(f-h)/c,y=this.keySchedule(e),p=0;p<d;p++){for(var l=0;l<o;l++)s[l]=n[l];this.process(y,n);for(var l=0;l<c;l++)u[l]=n[l];for(var l=0;l<c;l++)i[p*c+l]^=n[l];for(var l=0;l<o-c;l++)n[l]=s[c+l];for(var l=0;l<c;l++)n[o-c+l]=u[l];e=this.keyMeshing(e,n,p,y)}if(h>0){this.process(y,n);for(var p=0;p<h;p++)i[d*c+p]^=n[p]}return i.buffer}function I(e,n,i){var o=new Uint8Array(i||this.iv),s=a(n),c=this.blockSize,u=new Int8Array(c),f=s.length,h=f%c,d=(f-h)/c,y=this.keySchedule(e),p=new Int32Array(o.buffer);this.process(y,o);for(var l=0;l<d;l++){p[0]=p[0]+16843009&4294967295;var g=r(p[1])+16843012;p[1]=t(g<4294967296?g:g-4294967295);for(var m=0;m<c;m++)u[m]=o[m];this.process(y,p);for(var m=0;m<c;m++)s[l*c+m]^=o[m];for(var m=0;m<c;m++)o[m]=u[m];e=this.keyMeshing(e,o,l,y)}if(h>0){p[0]=p[0]+16843009&4294967295;var g=r(p[1])+16843012;p[1]=t(g<4294967296?g:g-4294967295),this.process(y,p);for(var l=0;l<h;l++)s[d*c+l]^=o[l]}return s.buffer}function T(e,t,r){var n=a(t),i=this.blockSize,o=this.shiftBits>>3,s=n.length,c=s%o,u=(s-c)/o,f=new Uint8Array(i),h=new Int32Array(i),d=this.keySchedule(e);f.set(r||this.iv);for(var y=0;y<u;y++){for(var p=0;p<i;p++)h[p]=f[p];this.process(d,f);for(var p=0;p<o;p++)n[o*y+p]^=f[p];for(var p=0;p<i;p++)f[p]=h[p];for(var p=i-1;y>=0;--y){if(!(f[p]>254)){f[p]++;break}f[p]-=254}}if(c>0){this.process(d,f);for(var p=0;p<c;p++)n[o*u+p]^=f[p]}return n.buffer}function x(e,t,r){for(var n=new Uint8Array(r||this.iv),i=this.blockSize,a=n.length,s=this.pad(o(t)),c=this.keySchedule(e),u=0,f=s.length/i;u<f;u++){for(var h=0;h<i;h++)n[h]^=s[u*i+h];this.process(c,n);for(var h=0;h<i;h++)s[u*i+h]=n[h];if(a!==i){for(var h=0;h<a-i;h++)n[h]=n[i+h];for(var h=0;h<i;h++)n[h+a-i]=s[u*i+h]}e=this.keyMeshing(e,n,u,c)}return s.buffer}function G(e,t,r){for(var n=new Uint8Array(r||this.iv),i=this.blockSize,o=n.length,s=a(t),c=new Uint8Array(i),u=this.keySchedule(e,1),f=0,h=s.length/i;f<h;f++){for(var d=0;d<i;d++)c[d]=s[f*i+d];this.process(u,s,f*i,1);for(var d=0;d<i;d++)s[f*i+d]^=n[d];if(o!==i)for(var d=0;d<o-i;d++)n[d]=n[i+d];for(var d=0;d<i;d++)n[d+o-i]=c[d];e=this.keyMeshing(e,n,f,u,1)}return this.unpad(s).buffer}function U(){var e=new Uint8Array(this.keySize);return n(e),e.buffer}function O(e,t,r){for(var n=ae.call(this,o(r)),i=this.blockSize,a=n.length/i,s=this.sBox,c=new Int32Array(t.buffer),u=0;u<a;u++){for(var f=0;f<i;f++)t[f]^=n[u*i+f];for(var f=0;f<16;f++)F(s,c,e[f])}}function N(e){for(var t=0,r=e.length,n=r-1;n>=0;--n){var i=e[n]>>>7;e[n]=e[n]<<1&255|t,t=i}0!==t&&(16===r?e[15]^=135:e[7]^=27)}function M(e,t,r){var n=this.blockSize,i=(this.sBox,o(r)),a=new Uint8Array(n);this.process(e,a),N(a),r.byteLength%n!=0&&(i=se.call(this,o(r)),N(a));for(var s=0,c=i.length/n;s<c;s++){for(var u=0;u<n;u++)t[u]^=i[s*n+u];if(s===c-1)for(var u=0;u<n;u++)t[u]^=a[u];this.process(e,t)}}function H(e,t,r){var n=this.keySchedule(e),i=new Uint8Array(r||this.iv),o=Math.ceil(this.macLength>>3)||this.blockSize>>1;this.processMAC(n,i,t);var a=new Uint8Array(o);return a.set(new Uint8Array(i.buffer,0,o)),a.buffer}function L(e,t,r,n){var i=new Uint8Array(H.call(this,e,r,n)),a=o(t);if(i.length!==a.length)return!1;for(var s=0,c=i.length;s<c;s++)if(i[s]!==a[s])return!1;return!0}function j(e,t){var r=this.blockSize,n=this.keySize,i=n+(r>>1);if(!this.ukm)throw new le("UKM must be defined");var o=new Uint8Array(this.ukm),a=H.call(this,e,t,o),s=D.call(this,e,t),c=new Uint8Array(i);return c.set(new Uint8Array(s),0),c.set(new Uint8Array(a),n),c.buffer}function W(e,t){var r=this.blockSize,n=this.keySize,o=n+(r>>1),a=i(t);if(a.byteLength!==o)throw new le("Wrapping key size must be "+o+" bytes");if(!this.ukm)throw new le("UKM must be defined");var s=new Uint8Array(this.ukm),c=new Uint8Array(a,0,n),u=new Uint8Array(a,n,r>>1),f=K.call(this,e,c);if(!L.call(this,e,u,f,s))throw new le("Error verify MAC of wrapping key");return f}function V(e,t){for(var r=this.blockSize,n=s(e),i=[],o=0;o<r;o++){i[o]=[];for(var a=0;a<8;a++)i[o][a]=t[o]>>>a&1}for(var o=0;o<r;o++){for(var c=new Int32Array(2),a=0;a<8;a++)i[o][a]?c[0]=c[0]+n[a]&4294967295:c[1]=c[1]+n[a]&4294967295;var u=new Uint8Array(c.buffer);n=new Int32Array(P.call(this,n,n,u))}return n}function q(e,t){var r=this.blockSize,n=this.keySize,i=n+(r>>1);if(!this.ukm)throw new le("UKM must be defined");var o=new Uint8Array(this.ukm),a=V.call(this,e,o),s=H.call(this,a,t,o),c=D.call(this,a,t),u=new Uint8Array(i);return u.set(new Uint8Array(c),0),u.set(new Uint8Array(s),n),u.buffer}function X(e,t){var r=this.blockSize,n=this.keySize,o=n+(r>>1),a=i(t);if(a.byteLength!==o)throw new le("Wrapping key size must be "+o+" bytes");if(!this.ukm)throw new le("UKM must be defined");var s=new Uint8Array(this.ukm),c=new Uint8Array(a,0,n),u=new Uint8Array(a,n,r>>1),f=V.call(this,e,s),h=K.call(this,f,c);if(!L.call(this,f,u,h,s))throw new le("Error verify MAC of wrapping key");return h}function z(e,t){var r=this.blockSize>>1,o=this.keySize,a=8,s=new Uint8Array(i(e));if(s.byteLength!==o)throw new le("Wrong cleartext size "+s.byteLength+" bytes");if(t=t||this.ukm){if(t=new Uint8Array(i(t)),!(t.byteLength>0&&t.byteLength%o==0))throw new le("Wrong rand size "+t.byteLength+" bytes");a=t.byteLength/o+1}else n(t=new Uint8Array((a-1)*o));var c=new Uint8Array(a*o+r+2),u=c.buffer,f=new Uint8Array(o),h=H.call(this,s,f);c[0]=34,c[1]=a,c.set(new Uint8Array(h),2),c.set(t,o+r+2);for(var d=1;d<a;d++)for(var y=new Uint8Array(u,2+r+o*d),p=0;p<o;p++)s[p]^=y[p];return c.set(s,r+2),c.buffer}function Y(e){var t=this.blockSize>>1,r=this.keySize,n=i(e);if(34!==new Uint8Array(n,0,1)[0])throw new le("Invalid magic number");for(var o=new Uint8Array(n,1,1)[0],a=new Uint8Array(n,2,t),s=new Uint8Array(r),c=0;c<o;c++)for(var u=new Uint8Array(n,2+t+r*c,r),f=0;f<r;f++)s[f]^=u[f];var h=new Uint8Array(r),d=L.call(this,s,a,h);if(!d)for(var y=["E-A","E-B","E-C","E-D","E-SC"],c=0,p=y.length;c<p&&(this.sBox=Ce[y[c]],!(d=L.call(this,s,a,h)));c++);if(!d)throw new le("Invalid main key MAC");return s.buffer}function Z(e,t){var r=this.blockSize>>1,n=this.keySize,o=i(e),a=i(t);o.byteLength!==n&&(o=Y.call(this,o));var s=D.call(this,o,a),c=H.call(this,o,a),u=new Uint8Array(r+n);return u.set(new Uint8Array(s),0),u.set(new Uint8Array(c),n),u.buffer}function J(e,t){var r=this.blockSize>>1,n=this.keySize,o=i(e),a=i(t);o.byteLength!==n&&(o=Y.call(this,o));var s=new Uint8Array(a,0,n),c=new Uint8Array(a,n,r),u=K.call(this,o,s);if(!L.call(this,o,c,u))throw new le("Invalid key MAC");return u}function Q(){return z.call(this,U.call(this))}function _(e,t,r,n){var o=n/4,a=new Int32Array(i(e)),s=new Int32Array(i(t)),c=new Int32Array(o);if(r)for(var u=0;u<o;u++)c[u]=s[u]+a[u]&4294967295;else for(var u=0;u<o;u++)c[u]=s[u]-a[u]&4294967295;return c.buffer}function $(e,t){return _(e,t,"VN"===this.procreator,this.keySize)}function ee(e,t){return _(e,t,"VN"!==this.procreator,this.keySize)}function te(e,t,r,n,i){return(r+1)*this.blockSize%1024==0&&(e=K.call(this,e,Ae),t.set(new Uint8Array(D.call(this,e,t))),n.set(this.keySchedule(e,i))),e}function re(e){return e}function ne(e){return new Uint8Array(e)}function ie(e){var t=e.byteLength,r=this.blockSize,n=r-t%r,i=Math.ceil((t+1)/r)*r,o=new Uint8Array(i);o.set(e);for(var a=t;a<i;a++)o[a]=n;return o}function oe(e){var t=e.byteLength,r=this.blockSize,n=e[t-1],i=t-n;if(n>r)throw le("Invalid padding");var o=new Uint8Array(i);return i>0&&o.set(new Uint8Array(e.buffer,0,i)),o}function ae(e){var t=e.byteLength,r=this.blockSize,n=Math.ceil(t/r)*r,i=new Uint8Array(n);i.set(e);for(var o=t;o<n;o++)i[o]=0;return i}function se(e){var t=e.byteLength,r=this.blockSize,n=Math.ceil((t+1)/r)*r,i=new Uint8Array(n);i.set(e),i[t]=1;for(var o=t+1;o<n;o++)i[o]=0;return i}function ce(e){for(var t=e.byteLength,r=t;r>1&&0===e[r-1];)r--;if(1!==e[r-1])throw le("Invalid padding");r--;var n=new Uint8Array(r);return r>0&&n.set(new Uint8Array(e.buffer,0,r)),n}function ue(e){var t=e.byteLength,r=this.blockSize,i=r-t%r,o=Math.ceil(t/r)*r,a=new Uint8Array(o),s=new Uint8Array(a.buffer,t,i);return a.set(e),n(s),a}function fe(e){if(!me)throw new ge("Big endian platform not supported");switch(e=e||{},this.keySize=32,this.blockLength=e.length||64,this.blockSize=this.blockLength>>3,this.name=(e.name||(1===e.version?"RC2":1989===e.version?"GOST 28147":"GOST R 34.12"))+(e.version>4?"-"+(e.version||1989)%100:"")+"-"+(64===this.blockLength?"":this.blockLength+"-")+("MAC"===e.mode?"MAC-"+(e.macLength||this.blockLength>>1):"KW"===e.mode||e.keyWrapping?("NO"!==(e.keyWrapping||"NO")?e.keyWrapping:"")+"KW":(e.block||"ECB")+(("CFB"===e.block||"OFB"===e.block||"CTR"===e.block&&2015===e.version)&&e.shiftBits&&e.shiftBits!==this.blockLength?"-"+e.shiftBits:"")+(e.padding?"-"+(e.padding||("CTR"===e.block||"CFB"===e.block||"OFB"===e.block?"NO":"ZERO"))+"PADDING":"")+("NO"!==(e.keyMeshing||"NO")?"-CPKEYMESHING":""))+(e.procreator?"/"+e.procreator:"")+("string"==typeof e.sBox?"/"+e.sBox:""),this.procreator=e.procreator,e.version||1989){case 1:this.process=De,this.keySchedule=Be,this.blockLength=64,this.effectiveLength=e.length||32,this.keySize=8*Math.ceil(this.effectiveLength/8),this.blockSize=this.blockLength>>3;break;case 2015:if(this.version=2015,64===this.blockLength)this.process=S,this.keySchedule=B;else{if(128!==this.blockLength)throw new le("Invalid block length");this.process=b,this.keySchedule=A}this.processMAC=M;break;case 1989:if(this.version=1989,this.process=w,this.processMAC=O,this.keySchedule=E,64!==this.blockLength)throw new le("Invalid block length");break;default:throw new ge("Algorithm version "+e.version+" not supported")}switch(e.mode||e.keyWrapping&&"KW"||"ES"){case"ES":switch(e.block||"ECB"){case"ECB":this.encrypt=D,this.decrypt=K;break;case"CTR":1989===this.version?(this.encrypt=I,this.decrypt=I):(this.encrypt=T,this.decrypt=T,this.shiftBits=e.shiftBits||this.blockLength);break;case"CBC":this.encrypt=x,this.decrypt=G;break;case"CFB":this.encrypt=P,this.decrypt=k,this.shiftBits=e.shiftBits||this.blockLength;break;case"OFB":this.encrypt=R,this.decrypt=R,this.shiftBits=e.shiftBits||this.blockLength;break;default:throw new ge("Block mode "+e.block+" not supported")}switch(e.keyMeshing){case"CP":this.keyMeshing=te;break;default:this.keyMeshing=re}if(this.encrypt===D||this.encrypt===x)switch(e.padding){case"PKCS5P":this.pad=ie,this.unpad=oe;break;case"RANDOM":this.pad=ue,this.unpad=ne;break;case"BIT":this.pad=se,this.unpad=ce;break;default:this.pad=ae,this.unpad=ne}else this.pad=ne,this.unpad=ne;this.generateKey=U;break;case"MAC":this.sign=H,this.verify=L,this.generateKey=U,this.macLength=e.macLength||this.blockLength>>1,this.pad=ne,this.unpad=ne,this.keyMeshing=re;break;case"KW":switch(this.pad=ne,this.unpad=ne,this.keyMeshing=re,e.keyWrapping){case"CP":this.wrapKey=q,this.unwrapKey=X,this.generateKey=U,this.shiftBits=e.shiftBits||this.blockLength;break;case"SC":this.wrapKey=Z,this.unwrapKey=J,this.generateKey=Q;break;default:this.wrapKey=j,this.unwrapKey=W,this.generateKey=U}break;case"MASK":this.wrapKey=$,this.unwrapKey=ee,this.generateKey=U;break;default:throw new ge("Mode "+e.mode+" not supported")}var t,r=e.sBox;if(r){if("string"==typeof r){if(t=r.toUpperCase(),!(r=Ce[t]))throw new pe("Unknown sBox name: "+e.sBox)}else if(!r.length||r.length!==Ce["E-Z"].length)throw new pe("Length of sBox must be "+Ce["E-Z"].length)}else r=2015===this.version?Ce["E-Z"]:"SC"===this.procreator?Ce["E-SC"]:Ce["E-A"];if(this.sBox=r,e.iv){if(this.iv=new Uint8Array(e.iv),this.iv.byteLength!==this.blockSize&&1989===this.version)throw new pe("Length of iv must be "+this.blockLength+" bits");if(this.iv.byteLength!==this.blockSize>>1&&this.encrypt===T)throw new pe("Length of iv must be "+this.blockLength>>"1 bits");if(this.iv.byteLength%this.blockSize!=0&&this.encrypt!==T)throw new pe("Length of iv must be a multiple of "+this.blockLength+" bits")}else this.iv=128===this.blockLength?be:ve;if(e.ukm&&(this.ukm=new Uint8Array(e.ukm),8*this.ukm.byteLength!==this.blockLength))throw new pe("Length of ukm must be "+this.blockLength+" bits")}var he=this,de=he.crypto||he.msCrypto,ye=he.ArrayBuffer,pe=he.SyntaxError||he.Error,le=he.DataError||he.Error,ge=he.NotSupportedError||he.Error,me=function(){var e=new ye(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}(),ve=new Uint8Array([0,0,0,0,0,0,0,0]),Ce={"E-TEST":[4,2,15,5,9,1,0,8,14,3,11,12,13,7,10,6,12,9,15,14,8,1,3,10,2,7,4,13,6,0,11,5,13,8,14,12,7,3,9,10,1,5,2,4,6,15,0,11,14,9,11,2,5,15,7,1,0,13,12,6,10,4,3,8,3,14,5,9,6,8,0,13,10,11,7,12,2,1,15,4,8,15,6,11,1,9,12,5,13,3,7,10,0,14,2,4,9,11,12,0,3,6,7,5,4,8,14,15,1,10,2,13,12,6,5,2,11,0,9,13,3,14,7,10,15,4,1,8],"E-A":[9,6,3,2,8,11,1,7,10,4,14,15,12,0,13,5,3,7,14,9,8,10,15,0,5,2,6,12,11,4,13,1,14,4,6,2,11,3,13,8,12,15,5,10,0,7,1,9,14,7,10,12,13,1,3,9,0,2,11,4,15,8,5,6,11,5,1,9,8,13,15,0,14,4,2,3,12,7,10,6,3,10,13,12,1,2,0,11,7,5,9,4,8,15,14,6,1,13,2,9,7,10,6,0,8,12,4,5,15,3,11,14,11,10,15,5,0,12,14,8,6,2,3,9,1,7,13,4],"E-B":[8,4,11,1,3,5,0,9,2,14,10,12,13,6,7,15,0,1,2,10,4,13,5,12,9,7,3,15,11,8,6,14,14,12,0,10,9,2,13,11,7,5,8,15,3,6,1,4,7,5,0,13,11,6,1,2,3,10,12,15,4,14,9,8,2,7,12,15,9,5,10,11,1,4,0,13,6,8,14,3,8,3,2,6,4,13,14,11,12,1,7,15,10,0,9,5,5,2,10,11,9,1,12,3,7,4,13,0,6,15,8,14,0,4,11,14,8,3,7,1,10,2,9,6,15,13,5,12],"E-C":[1,11,12,2,9,13,0,15,4,5,8,14,10,7,6,3,0,1,7,13,11,4,5,2,8,14,15,12,9,10,6,3,8,2,5,0,4,9,15,10,3,7,12,13,6,14,1,11,3,6,0,1,5,13,10,8,11,2,9,7,14,15,12,4,8,13,11,0,4,5,1,2,9,3,12,14,6,15,10,7,12,9,11,1,8,14,2,4,7,3,6,5,10,0,15,13,10,9,6,8,13,14,2,0,15,3,5,11,4,1,12,7,7,4,0,5,10,2,15,14,12,6,1,11,13,9,3,8],"E-D":[15,12,2,10,6,4,5,0,7,9,14,13,1,11,8,3,11,6,3,4,12,15,14,2,7,13,8,0,5,10,9,1,1,12,11,0,15,14,6,5,10,13,4,8,9,3,7,2,1,5,14,12,10,7,0,13,6,2,11,4,9,3,15,8,0,12,8,9,13,2,10,11,7,3,6,5,4,14,15,1,8,0,15,3,2,5,14,11,1,10,4,7,12,9,13,6,3,0,6,15,1,14,9,2,13,8,12,4,11,10,5,7,1,10,6,8,15,11,0,4,12,3,5,9,7,13,2,14],"E-SC":[3,6,1,0,5,7,13,9,4,11,8,12,14,15,2,10,7,1,5,2,8,11,9,12,13,0,3,10,15,14,4,6,15,1,4,6,12,8,9,2,14,3,7,10,11,13,5,0,3,4,15,12,5,9,14,0,6,8,7,10,1,11,13,2,6,9,0,7,11,8,4,12,2,14,10,15,1,13,5,3,6,1,2,15,0,11,9,12,7,13,10,5,8,4,14,3,0,2,14,12,9,1,4,7,3,15,6,8,10,13,11,5,5,2,11,8,4,12,7,1,10,6,14,0,9,3,13,15],"E-Z":[12,4,6,2,10,5,11,9,14,8,13,7,0,3,15,1,6,8,2,3,9,10,5,12,1,14,4,7,11,13,0,15,11,3,5,8,2,15,10,13,14,1,7,4,12,9,6,0,12,8,2,1,13,4,15,6,7,0,10,5,3,14,9,11,7,15,5,10,8,1,6,13,0,9,3,14,11,4,2,12,5,13,15,6,9,2,12,10,11,7,8,1,4,3,14,0,8,14,2,5,6,9,1,12,15,4,11,0,13,10,3,7,1,7,14,13,0,5,8,3,4,15,10,6,9,12,11,2],"D-TEST":[4,10,9,2,13,8,0,14,6,11,1,12,7,15,5,3,14,11,4,12,6,13,15,10,2,3,8,1,0,7,5,9,5,8,1,13,10,3,4,2,14,15,12,7,6,0,9,11,7,13,10,1,0,8,9,15,14,4,6,12,11,2,5,3,6,12,7,1,5,15,13,8,4,10,9,14,0,3,11,2,4,11,10,0,7,2,1,13,3,6,8,5,9,12,15,14,13,11,4,1,3,15,5,9,0,10,14,7,6,8,2,12,1,15,13,0,5,7,10,4,9,2,3,14,6,11,8,12],"D-A":[10,4,5,6,8,1,3,7,13,12,14,0,9,2,11,15,5,15,4,0,2,13,11,9,1,7,6,3,12,14,10,8,7,15,12,14,9,4,1,0,3,11,5,2,6,10,8,13,4,10,7,12,0,15,2,8,14,1,6,5,13,11,9,3,7,6,4,11,9,12,2,10,1,8,0,14,15,13,3,5,7,6,2,4,13,9,15,0,10,1,5,11,8,14,12,3,13,14,4,1,7,0,5,10,3,12,8,15,6,2,9,11,1,3,10,9,5,11,4,15,8,6,7,14,13,0,2,12],"D-SC":[11,13,7,0,5,4,1,15,9,14,6,10,3,12,8,2,1,2,7,9,13,11,15,8,14,12,4,0,5,6,10,3,5,1,13,3,15,6,12,7,9,8,11,2,4,14,0,10,13,1,11,4,9,12,14,0,7,5,8,15,6,2,10,3,2,13,10,15,9,11,3,7,8,12,5,14,6,0,1,4,0,4,6,12,5,3,8,13,10,11,15,2,1,9,7,14,1,3,12,8,10,6,11,0,2,14,7,9,15,4,5,13,10,11,6,0,1,3,4,7,14,13,5,15,8,2,9,12]},Ae=new Uint8Array([105,0,114,34,100,201,4,35,141,58,219,150,70,233,42,196,24,254,172,148,0,237,7,18,192,134,220,194,239,76,169,43]),be=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fe=function(){for(var e=[1,16,32,133,148,192,194,251],t=[],r=0;r<8;r++){t[r]=[];for(var n=0;n<256;n++)t[r][n]=function(e,t){var r,n,i=0;for(r=0;r<8;r++)1&t&&(i^=e),n=128&e,e=e<<1&255,n&&(e^=195),t>>=1;return 255&i}(e[r],n)}return t}(),we=[4,2,3,1,6,5,0,7,0,5,6,1,3,2,4,0],Se=[252,238,221,17,207,110,49,22,251,196,250,218,35,197,4,77,233,119,240,219,147,46,153,186,23,54,241,187,20,205,95,193,249,24,101,90,226,92,239,33,129,28,60,66,139,1,142,79,5,132,2,174,227,106,143,160,6,11,237,152,127,212,211,31,235,52,44,81,234,200,72,171,242,42,104,162,253,58,206,204,181,112,14,86,8,12,118,18,191,114,19,71,156,183,93,135,21,161,150,41,16,123,154,199,243,145,120,111,157,158,178,177,50,117,25,61,255,53,138,126,109,84,198,128,195,189,13,87,223,245,36,169,62,168,67,201,215,121,214,246,124,34,185,3,224,15,236,222,122,148,176,188,220,232,40,80,78,51,10,74,167,151,96,115,30,0,98,68,26,184,56,130,100,159,38,65,173,69,70,146,39,94,85,47,140,163,165,125,105,213,149,59,7,88,179,64,134,172,29,247,48,55,107,228,136,217,231,137,225,27,131,73,76,63,248,254,141,83,170,144,202,216,133,97,32,113,103,164,45,43,9,91,203,155,37,208,190,229,108,82,89,166,116,210,230,244,180,192,209,102,175,194,57,75,99,182],Ee=function(){for(var e=[],t=0,r=Se.length;t<r;t++)e[Se[t]]=t;return e}(),Be=function(){var e=new Uint8Array([217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173]);return function(t){for(var r=new Uint8Array(i(t)),n=Math.min(r.length,128),o=this.effectiveLength,a=Math.floor((o+7)/8),s=255%Math.pow(2,8+o-8*a),c=new Uint8Array(128),u=new Uint16Array(c.buffer),f=0;f<n;f++)c[f]=r[f];for(var f=n;f<128;f++)c[f]=e[(c[f-1]+c[f-n])%256];c[128-a]=e[c[128-a]&s];for(var f=127-a;f>=0;--f)c[f]=e[c[f+1]^c[f+a]];return u}}(),De=function(){function e(e,t){return 65535&(e<<t|e>>>16-t)}function t(e,t){return 65535&(e>>>t|e<<16-t)}function r(r){s?(c[r]=t(c[r],u[r]),c[r]=c[r]-o[a]-(c[(r+3)%4]&c[(r+2)%4])-(~c[(r+3)%4]&c[(r+1)%4]),a-=1):(c[r]=c[r]+o[a]+(c[(r+3)%4]&c[(r+2)%4])+(~c[(r+3)%4]&c[(r+1)%4]),a+=1,c[r]=e(c[r],u[r]))}function n(e){c[e]=s?c[e]-o[63&c[(e+3)%4]]:c[e]+o[63&c[(e+3)%4]]}function i(e,t){t=t||1;for(var r=0;r<t;r++)if(s)for(var n=3;n>=0;--n)e(n);else for(var n=0;n<4;n++)e(n)}var o,a,s,c=new Uint16Array(4),u=new Uint16Array([1,2,3,5]);return function(e,t,u,f){s=f,c=new Uint16Array(t.buffer,u||t.byteOffset,4),o=e,a=f?63:0,i(r,5),i(n),i(r,6),i(n),i(r,5)}}();return fe})},function(e,t,r){!function(t,n){e.exports=n(r(1),r(6))}(0,function(e,t){function r(e,t,r,n,i){for(var o=0;o<i;o++)r[n+o]=e[t+o]}function n(e){for(var t=new Uint8Array(e),r=new Uint8Array(t.length),n=0,i=t.length;n<i;n++)r[i-n-1]=t[n];return r.buffer}function i(e){for(var t,r,n=e.length,i=3*n+1>>2,o=new Uint8Array(i),a=0,s=0,c=0;c<n;c++){r=3&c;var u=e.charCodeAt(c);if(u=u>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:43===u?62:47===u?63:0,a|=u<<18-6*r,3===r||n-c==1){for(t=0;t<3&&s<i;t++,s++)o[s]=a>>>(16>>>t&24)&255;a=0}}return o.buffer}function o(t){e=e||g.GostRandom;var r=e?new(e||g.GostRandom):m;if(r.getRandomValues){var n=new Uint8Array(Math.ceil(t/8));return r.getRandomValues(n),n}throw new C("Random generator not found")}function a(e){if(e instanceof ArrayBuffer)return e;if(e&&e.buffer&&e.buffer instanceof ArrayBuffer)return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;throw new v("ArrayBuffer or ArrayBufferView required")}function s(e,t){var r,n=this.digest===b?32:64,i=this.bitLength/8,o=a(e),s=a(t);if(o.byteLength===n)r=new Uint8Array(o);else{var r=new Uint8Array(n);o.byteLength>n?r.set(new Uint8Array(this.digest(o))):r.set(new Uint8Array(o))}for(var c=new Uint8Array(n+s.byteLength),u=new Uint8Array(n+i),f=0;f<n;f++)c[f]=54^r[f],u[f]=92^r[f];return c.set(new Uint8Array(s),n),u.set(new Uint8Array(this.digest(c)),n),this.digest(u)}function c(e,t,r){var n=new Uint8Array(this.sign(e,r)),i=new Uint8Array(t);if(n.length!==i.length)return!1;for(var o=0,a=n.length;o<a;o++)if(n[o]!==i[o])return!1;return!0}function u(){return o(this.bitLength).buffer}function f(e,t){if(t%8>0)throw new v("Length must multiple of 8");for(var n=this.bitLength/8,i=this.digest===b?32:64,o=t/8,s=this.iterations,c=this.diversifier,u=new Uint8Array(i),f=0;f<i;f++)u[f]=c;for(var h=new Uint8Array(a(this.salt)),d=h.length,y=i*Math.ceil(d/i),p=new Uint8Array(y),f=0;f<y;f++)p[f]=h[f%d];for(var l=new Uint8Array(a(e)),g=l.length,m=i*Math.ceil(g/i),C=new Uint8Array(m),f=0;f<m;f++)C[f]=l[f%g];var A=new Uint8Array(y+m);r(p,0,A,0,y),r(C,0,A,y,m);for(var F=Math.ceil(o/n),w=new Uint8Array(F*n),f=0;f<F;f++){var S=new Uint8Array(i+y+m);r(u,0,S,0,i),r(A,0,S,i,y+m);for(var E=0;E<s;E++)S=new Uint8Array(this.digest(S));r(S,0,w,f*n,n);for(var B=new Uint8Array(i),E=0;E<i;E++)B[E]=S[E%n];var D=(y+m)/i;for(E=0;E<D;E++)for(var K,P=1,k=i-1;k>=0;--k)K=A[i*E+k]+B[k]+P,P=K>>>8,A[i*E+k]=255&K}var R=new Uint8Array(o);return r(w,0,R,0,o),R.buffer}function h(e,t){if(t%8>0)throw new v("Length must be multiple of 8");var r,n=t/8,i=new Uint8Array(a(this.context)),o=this.bitLength/8,c=Math.ceil(n/o);r=this.label?new Uint8Array(a(this.label)):new Uint8Array([38,189,184,120]);for(var u=new Uint8Array(n),f=0;f<c;f++){var h=new Uint8Array(r.length+i.length+4);h[0]=f+1,h.set(r,1),h[r.length+1]=0,h.set(i,r.length+2),h[h.length-2]=t>>>8,h[h.length-1]=255&t,u.set(new Uint8Array(s.call(this,e,h),0,f<c-1?o:n-f*o),f*o)}return u.buffer}function d(e,t){var n=this.diversifier||1;if((t*=n)<this.bitLength/2||t%8>0)throw new v("Length must be more than "+this.bitLength/2+" bits and multiple of 8");var i=this.bitLength/8,o=t/8,c=this.iterations,u=new Uint8Array(a(e)),f=new Uint8Array(a(this.salt)),h=f.byteLength,d=new Uint8Array(h+4);if(r(f,0,d,0,h),o>137438953408)throw new v("Invalid parameters: Length value");for(var y=Math.ceil(o/i),p=new Uint8Array(o),l=1;l<=y;l++){d[h]=l>>>24&255,d[h+1]=l>>>16&255,d[h+2]=l>>>8&255,d[h+3]=255&l;for(var g=new Uint8Array(s.call(this,u,d)),m=g,C=1;C<c;C++){g=new Uint8Array(s.call(this,u,g));for(var A=0;A<i;A++)m[A]=g[A]^m[A]}var b=(l-1)*i;r(m,0,p,b,Math.min(i,o-b))}if(n>1){var F=o/n,w=new Uint8Array(F);return r(p,o-F,w,0,F),w.buffer}return p.buffer}function y(e,t){if(t>this.bitLength||t%8>0)throw new v("Length can't be more than "+this.bitLength+" bits and multiple of 8");var n=this.digest===b?32:64,i=this.bitLength/8,o=!!(e&&e.byteLength>0)&&new Uint8Array(a(e)),s=o?o.length:0,c=this.iterations,u=new Uint8Array(a(this.salt)),f=u.length,h=new Uint8Array(f+s);r(u,0,h,0,f),o&&r(o,0,h,f,s);for(var d=new Uint8Array(this.digest(h)),y=new Uint8Array(n),p=new Uint8Array(n),l=new Uint8Array(n),g="DENEFH028.760246785.IUEFHWUIO.EF",m=0;m<g.length;m++)y[m]=g.charCodeAt(m);h=new Uint8Array(2*(n+i));for(var C=0;C<c;C++){for(var m=0;m<n;m++)p[m]=54^y[m],l[m]=92^y[m],y[m]=0;r(p,0,h,0,n),r(d,0,h,n,i),r(l,0,h,n+i,n),r(d,0,h,n+i+n,i),r(new Uint8Array(this.digest(h)),0,y,0,i)}for(var m=0;m<i;m++)p[m]=54^y[m],l[m]=92^y[m],y[m]=0;if(h=new Uint8Array(2*i+f+s),r(p,0,h,0,i),r(u,0,h,i,f),r(l,0,h,i+f,i),o&&r(o,0,h,i+f+i,s),d=this.digest(this.digest(h)),t===this.bitLength)return d;var A=t/8,F=new Uint8Array(A);return r(d,0,F,0,A),F.buffer}function p(e){return this.deriveBits(e,8*this.keySize)}function l(e){switch(e=e||{},this.name=(e.name||"GOST R 34.10")+"-"+(e.version||2012)%100+((e.version||2012)>1?"-"+(e.length||256):"")+("HASH"!==(e.mode||"HASH")?"-"+e.mode:"")+(e.procreator?"/"+e.procreator:"")+("string"==typeof e.sBox?"/"+e.sBox:""),this.procreator=e.procreator,this.bitLength=e.length||256,e.version||2012){case 1:this.digest=F,this.bitLength=160;break;case 1994:if(this.digest=b,this.sBox=(e.sBox||("SC"===e.procreator?"D-SC":"D-A")).toUpperCase(),t||(t=g.GostCipher),!t)throw new C("Object GostCipher not found");this.cipher=new t({name:"GOST 28147",block:"ECB",sBox:this.sBox,procreator:this.procreator});break;case 2012:this.digest=A;break;default:throw new C("Algorithm version "+e.version+" not supported")}switch(this.keySize=e.keySize||(e.version<=2?this.bitLength/8:32),e.mode||"HASH"){case"HASH":break;case"HMAC":this.sign=s,this.verify=c,this.generateKey=u;break;case"KDF":this.deriveKey=p,this.deriveBits=h,this.label=e.label,this.context=e.context;break;case"PBKDF2":this.deriveKey=p,this.deriveBits=d,this.generateKey=u,this.salt=e.salt,this.iterations=e.iterations||2e3,this.diversifier=e.diversifier||1;break;case"PFXKDF":this.deriveKey=p,this.deriveBits=f,this.generateKey=u,this.salt=e.salt,this.iterations=e.iterations||2e3,this.diversifier=e.diversifier||1;break;case"CPKDF":this.deriveKey=p,this.deriveBits=y,this.generateKey=u,this.salt=e.salt,this.iterations=e.iterations||2e3;break;default:throw new C("Algorithm mode "+e.mode+" not supported")}}var g=this,m=g.crypto||g.msCrypto,v=g.DataError||Error,C=g.NotSupportedError||Error,A=function(){function e(e,t){return e[t>>2]>>((3&t)<<3)&255}function t(e,t){for(var r,n,i=0,o=0;o<16;o++)r=(65535&e[o])+(65535&t[o])+(i||0),n=(e[o]>>>16)+(t[o]>>>16)+(r>>>16),e[o]=65535&r|n<<16,i=n>>>16}function r(e){return new Int32Array(e.buffer,e.byteOffset,16)}function o(e,t){for(var r=0;r<16;r++)e[r]=t[r]}function s(){return new Int32Array(16)}function c(e,t){for(var r=0;r<16;r++)e[r]=e[r]^t[r]}function u(t,r){o(A,t),c(A,r);for(var n=0;n<8;n++){var i,a,s=e(A,n)<<1;i=C[s],a=C[s+1];for(var u=1;u<8;u++)s=(u<<9)+(e(A,(u<<3)+n)<<1),i^=C[s],a^=C[s+1];t[n<<1]=i,t[1+(n<<1)]=a}}function f(e,t,r){var n;for(o(b,e),u(b,t),o(F,b),u(b,r),n=0;n<11;n++)u(F,v[n]),u(b,F);u(F,v[11]),c(b,F),c(e,b),c(e,r)}function h(e){var n=r(e);f(m,g,n),t(g,p),t(l,n)}function d(e){var n=e.length;if(!(n>63)){var i=new Int32Array(16);i[0]=n<<3;for(var o=new Uint8Array(64),a=0;a<n;a++)o[a]=e[a];o[n]=1;var s=r(o),c=r(i);f(m,g,s),t(g,c),t(l,s),f(m,y,g),f(m,y,l)}}var y=new Int32Array(16),p=new Int32Array(16);p[0]=512;var l,g,m,v=function(e){for(var t=new Int32Array(i("B0Wm8lllgN0jTXTMNnR2BRXTYKQIKkKiAWlnkpHgfEv8xIV1jbhOcRbQRS5DdmovH3xlwIEvy+vp2soe2lsIsbebsSFwBHnmVs3L1xui3VXKpwrbwmG1XFiZ1hJrF7WaMQG1Fg9e1WGYKyMKcur+89e1cA9GneNPGi+dqYq1o2+yCroK9ZYemTHbeoZD9LbCCdtiYDc6ycGxnjWQ5A/i03t7KbEUderyix+cUl9e8QY1hD1qKPw5Cscvzius3HT1LtHjhLy+DCLxN+iToepTNL4DUpMzE7fYddYD7YIs16k/NV5orRxynX08XDN+hY5I3eRxXaDhSPnSZhXos98f71f+bHz9WBdg9WPqqX6iVnoWGicjtwD/36P1OiVHF82/vf8PgNc1njVKEIYWHxwVf2MjqWwMQT+amUdHraxr6ktufWRGekBo+jVPkDZyxXG/tsa+wmYf8gq0t5oct6b6z8aO8Jq0mn8YbKRCUfnEZi3AOTB6O8Okb9nTOh2urk+uk9QUOk1WhojzSjyiTEUXNQQFSiiDaUcGNyyCLcWrkgnJk3oZMz5H08mHv+bHxp45VAkkv/6GrFHsxaruFg7H9B7nAr/UDX+k2ahRWTXCrDYvxKXRK43RaZAGm5LLK4n0msTbTTtEtIke3jaccfi3TkFBbgwCqucDp8mTTUJbH5vbWiODUURhcmAqH8uS3DgOVJwHppqKK3uxzrLbC0QKgIQJDeC3Vdk8JEKJJRs6fTreXxbs2JpMlJsiMRZUWo837ZxFmPvHtHTDtjsV0fqYNvRSdjswbB56SzNprwJn558DYTMbiuH/H9t4iv8c50GJ8/PkskjlKjhSbwWApt6+qxst84HNpMprXdhvwEpZot6Ybkd9Hc2678q5SOrvcR2KeWaEFCGAASBhB6vru2v62JT+WmPNxgIw+4nI79CezXsg1xvxSpK8SJkbstnVF/T6UijhiKqkHeeGzJEYne+AXZufITDUEiD4dx3fvDI8pM16sUkEsIAT0roxFvFn5443")),r=new Array(12),n=0;n<12;n++)r[n]=new Int32Array(t.buffer,64*n,16);return r}(),C=function(e){return new Int32Array(i("5vh+XFtxH9Alg3eACST6FshJ4H6FLqSoW0aGoY8GwWoLMumi13tBbqvaN6RngVxm9heWqBpoZnb13AtwY5GVS0hi84235kvx/1ximmi9hcXLgn2m/NdXlWbTba9pufCJNWyfdEg9g7B8vOyxI4yZoTanAqwxxHCNnrao0C+839aLGfpR5bOuN5zPtUCKEn0LvAx4tQggj1rlM+OEIojs7c7Cx9N3wV/S7HgXtlBdD165TMLAgzaHHYwgXbTLCwStdjyFWyigiS9YjRt59v8yVz/s9p5DEZM+D8DTn4A6GMnuAQom9fOtgxDv6PRBGXmmXc2hDH3pOhBKG+4dEkjpLFO/8tshhHM5tPUMz6aiPQlftLyc2EeYzeiKLYsHHFb5f3dxaVp1apzF8C5xoLoevKZj+atCFeZyLrGeIt5fu3gNuc4PJZS6FIJSDmOXZk2ELwMeagII6phcfyFEob5r8Ho3yxzRY2Lbg+COK0sxHGTPcEebq5YOMoVrqYa53ucetUeMh3r1bOm4/kKIX2HW/RvdAVaWYjjIYiFXkj74qS78l/9CEUR2+J19NQhWRSzrTJDJsOCnElYjCFAt+8sBbC16A/qnpkhF9G6LOL/GxKu9vvj91HfeujqsTOvIB5t58JyxBeiHnQwn+moQrIpYy4lg58FAHQzqGm+BHko1aSiQxPsHc9GW/0NQGi9gnQqf96UW4MY/N5Yc5KazuNqSUhMkdSw44IqbpahkczvsFU8r8SRXVUmzP9dm2xVEDcXHp9F5455Ct5La3xUaYZl/04agNF7AJxQjONVRe22pOaRlGPB3EEADtAJ5HZClrqLdiNJniZxKXQqTD2bfCihlwk7p1CBFCbCLMlU4kWaFKSpBKQe/xTOoQrJ+K2JUTcZzbFMERWKV4Ada9AbpU1GQih8vO2vBI2Fvw3sJ3FJV5cY5Z9Ezsf5oRCmIOcfw5xHiQJuH9xlk+aLpOK3D20sHGQwLTkf5w+v0VTTVdtNriENGEKBa64sC2CDDzfWCMvJRbeGEDb7Cseeg6N4GsPodCHuFS1QNNDM7QuKaZ7zKW3/YpgiKxDfdDsY7s6nZQ+2BIXFNvV5lo7FnYe3nte6haSQx98jVc6v21R/GheGjZxpeBjzUBBDJLSg6uY8ssEACj+vAbLLy95AX1k8Rb6HTPOBzWfGpnuSqeE7WjHTNwAZuKhnVxztC2ocStBYccEXDNxWC5O2TIW2s45BBSTn2/H7F8SGGIjt8wLCUBCusFvv510U3mlJ+v3N8Py6jtoFoM+e42brSeMqpoyo0wi/+u+SBY8z+370NjllAJG6lpnBRxu9LhCrR5CK60GUnnFCM2RSIwhhgjO4xnqVJH3zaF9OU4SgTTJxgCUv0MnLV47Ob9hKlpKrXkcy72kPSb/0PNN4fPJRq0lBPW1RomV7ha9+fr2/qj3eUJkjqWHDdCSu/x+Vtcdl8Z93msv9PIdVJPCdrRjroYAORdntPr4bHH2ihPng11LmgtowRXwMMn9QUHdLJFlggAZg9j33dUySsZKpwP8wXUlTCyYmUjgK0Jj5edtafRsLeUHRvA1h9gARF2z2CknLx5WBYSgKbVgvz+65Ypz/83GKhWl5ObK1M6EupblXOH7jMCPl0eq6CslPBAhRM9/tHG58EKJjz6442BosnrfLv+3rtypf+jApevneOBRP099jPMCwlAcMri/eNkt38F1xVTfhlxX9GBS9f6vMwG6Ky9CSqaLfsu9YNhpmPDzUBBHVMAAAAAAAAAADxLjFNNNDM7HEFIr4GGCO1rygNmTDABcGX/VziXWk8ZRmkHMYzzJoVlYRBcvjHnrjcVDK3k3aEqZQ2wTokkM9YgCsT8zLI71nEQq45fO1PXPoc2O/jq42C8uWslU0pP9Fq2CPokHobfU0iSfg88EO2A8ud2Hn58z3eLS8nNtgmdCpDpB+JHuLfb5iZnRtsEzrUrUbNPfQ2+rs131AmmCXAlk/cqoE+bYXrQbBTfuWlxAVAunWLFghHpBrkO+e7RK/juMQp0GcXl4GZk7vun765rpqN0eyXVCHzVyzdkX5uMWOT19rir/jOR6IgEjfcUzijI0PeyQPuNXn8VsSompHmAbKASNxXUeASlvVk5Lfbe3X3GINRWXoS222VUr3OLjMenbsjHXQwj1INcpP90yLZ4gpEYQwwRnf+7uLStOrUJcow/e4ggAZ1YerKSkcBWhPnSv4UhyZOMCzIg7J78RmlFmTPWbP2gtyoEap8HnivWx1WJvtkjcOytz6RF99bzjTQX3zwarVvXf0lfwrNEycYV03I5nbFKp4HOaflLriqmlSGVT4PPNmjVv9IrqqSe36+dWUlrY4th30ObPn/28hBOx7MoxRQyplpE74w6YPoQK1REAmVbqccsbW2ui20NU5Eab3KTiWgBRWvUoHKD3HhdEWYy40OK/JZP5sxKqhjt++zim4ppPxja2qjoEwtSp09lesO5r8x46KRw5YVVL/VGBacju+by/URXWi8nU4oRrqHXxj6z3Qg0e38uLbiPr2wBzby8eNkroTZKc5libb+cLei9tpPclUOclPXXG1JKQTyOj1XQVmnCoBp6gssEI5J0HPFa7EaEYqrehk55P/XzQlaCw44rO/J+2A2WXn1SJK95pfWfzQix4kz4QUUvGHhwdm5dcm1StImYWDPG82AmkSS7Xj9hnGzzKsqiBqXk3LOv2Z/4dCI1tRbXZhalCfIEagFjD9V3mX1tDGWtQYZ90+WsdZwbkOFnR6Ly0PTNlqrioXM+j2E+ce/mcKV/P2iH9Wh3ktjD82z73Y7i0VtgD9Z+Hz3w4WyfHO+XzGRPJjjrGYzsEghv2FnTCa4+BgP+8mVxMEwyKqghiAQdhqYYFfzQiEBFqr2PHYMBlTMNS3bRcxmfZBCvPRalkvUA4Jo6KDD7zxvPae9ktJp/3O8KQriAgHtIoe33jTN6IWBj9kB7qfdYQWb1vonMhmgNVPVbxrodMzOyeoxJFwug/VUcDRVXaB75JnOJtKsVue+9/0WGFelBU44ag59pFJ0NtFb2Go4HN6f8sr3dWIxdwwysJqu2eJ5yNBd7xCRxgZ02xEQRqJRXlBFI1Ns5HKYAvzFDLz39bY8+nOhaIfNFx8DfSlBr9nyjb0/Xj60Wk87nYTu/jYbZ3FAPbjj0+cHYnEaOij58g/SSH68fHW0nnYndOXyk8frVlwY3PWeT0eLpAxu9E+prctSxpmBLZjax2B4iwbcbkadDvxl+Op1IexOMKX3IZ6OC1Ur7D9lvKV7a93QSWm68bdemZBM2+OU6lcUsgHR5upA9ruwwIJBKErdUPIEY7+PHf/o1/k7k8usuE2Mto5HfIbowd0bOZImjj98WqESCdYvyy89mKvbNcmuZxNpViv9X/UVweFsNs7igB1+su3485sX2pTTfbAN/gGHe8PsdguK2suEld/hU65EBaJHc7e0ELMShXt4PDKr3463cNBoElE7U2c5udLj5mVYTVficbJkaNeJx4/JhJclqTW7+n0a4QKLFTej36ZBiNDNXZvDeN56Ssgsmk2Az7dCd38bg722IHLSiDodM711XnotS6tqj0H02qtruxyV2ZBc/+f9jTG2g6pkIhGbOB/ArvuEQgIsSaD5CMZjAzrjpCivCASTiCat5Bw0GopTx65xIe535qhdxH9cSiWSnoy1OOmqVc3YYwY3eqna2OspoYroe7MnmJVu39pqNeSEFGt9nRmCUJSn1Bz6VaTobL/lyu3J6kLFnKNsNRwOb8F5UYHk3m+rv4n/8MUwGE0X1J1B6xWEBFiSHA1SUCjXOWHxeOwYDKiFapoFcQGO+BHNQJGifD7178wZrxUjn2Mp0jR0UO/5HrmQ4RtKB43Sd1m5Vh3l/GATMZEvH1otqZPAFlTctluiGRo+Ld4JimuZ64pm1x4PguP+jFGtt9VaCNdFM+UPiUH/fwLm3We9SFns4Giqul321S/CSCbj/0p1pWw5Bw2IrN34ZIZUjEaRpG/Rvr0mE1x8DLMPkwOPFTNKgtmEn8G/mmmcMguoVCD65PpSgkOv+QdnntTWz+loowi4Jf1YLESxR5t2kbxe3LO7x+phkEj+ZRYQY6YfgXryM0fVOGg0CaaTY8LOmExt7TAqn9/YbIHZHXseOwYDKmaUZmCJ6/vZ/YMKWY7mc3UgewdEmhQK/ElfLKilcbZZMjQfmG+KRbvC+zgapKBQs3LCVCOjrdgfrzoXJzwLi4a7bP6DJY3IabWiKHkCv9HJgPH1qUvWazg3r4iACnmyyroSVVBDEAg7DUzfNpQOB7nusgTRp85nkLLFYSQT//EltNwm8SuXxSwST4YII1GmLyis75NjL5k35ec1B7BSKTob5ucsMK5XCpxw01hgQa4UJeDeRXSz151MxJK6IoBAxWha8AsMpdyMJxy+Eofx9pxabvOeMX+x4NyGSV0RQCDsNC1pm0B+PxjNS9yjqdRq1RUoDR0U8nmJaSQAAAAAAAAAAFk+t1+hlsYeLk54FgsRa9htSuewWIh/juZf0BOHLj4Gem3bu9MOxOKsl/yJyq7xsQnMszweGdvhifPqxGLuGGR3cM9JqoetxlbFfsplV/bWA5U92m1s+5o2ko2IRFbgfB7rjzeVn2CNMdYXnE6qqSNvrDrX5cAmYkMEn6ZTmRRWq9NmncBSuO6vAsFTp8IKKzzLA243I8AHk8nCPZDhyizDO8ZeL27X00z/VjOXWCSeselOZDJdaqY34W01lHJCCnn45mG+Yj94UhTZBALHRBNILvH98MiWWxP2m8XsFgmpDogpKBTlkr5OGYtUKhB9cszAD8vrr+cbG0nIRCIrcD4lZBZNqEDp1SDGUT4f9PlmusMgP5EM6Kvy7dHCYcR+8IFMuUWs02Hzlf64lEo5IQVcnPAsFiLWrZcYZfP3cXjpvYe6K5vwofREQAWyWWVdCe11vkgkf7wLdZYSLhfP9Cq0SwkXhel6FZZrhU4nVdqf7uCDkkkTR5EyQypGI8ZSuahGW0etPkN0+LRfJBKxXoskF/bweGRLo/shYv5/3aURS7vMJ52kbcEBc+C90CSidiIgjFmivKCKj8SQbbg2803kuQ10OmZn6nFHteBwX0bvJ4LLKhUIsDnsBl719FsefSG1sYPP0FsQ2+czwGApXHefpzZyOUwBfs9VMhGGwxyB2HIOGg1Fp+07j5l6Pd+JWDr8ecft+ysu6aQZhkPvDs5fCc32e04tN09qa+n6NN8Etq3UcDihI/mNIk0KBX6qocliSLhcG/eo4/2XYDCaLrULKm5bo1GCDetCxOH+p1cilI1YKZodg3N/z5zIZLrUUaVbT7XUtypQCL9Tgc49eZdGptjV5C0E5dIrgPx+MIeWV7aed7VzVKA5aUQdgJfQtDMwyvvz4vDP4o533eC+jMNisS4lnElPRqbOcm+529HKQeJCwe7RTbp2Ay/0eqMPsEWyaKk6zeTMr38L6IRUnQgEg1SzwUaCY5JUNcLIDv7S7k438n/f+6cWejOSDGDxTfsSO1LqA+WESgyrU/27kAed6vY4D3iKGctI7FWPDLMqtZ3Estb+9+Dc28oi9PPsthHfWBNUmpxA4z/e31aKztOgwcgSQyLpwwela4FY+m0NdyeVebHh893ZsYt0QirABLjsLZ//q8KU9Kz4qC11kU97v2mx7ytoeMT2L69Iesfhds6AnMZ+XQxnEdiPkuTBTGJ7mdkkPe3+I0qlw9+2i1GQmx8VJi2/bU9m6gVLYry1GuLPWlKqaui+oFP70M4BSO1oCMDmYxTJQ/4WzRWoJxDNBJIxoGlw9ue8imyXzEywM3zoNfyzucBl3vJYfMeA81IhTt5BMrtQlfFeQ5D0k9+HCDliXdLg8UExPBr7i2avkXIK8FGyEbxHfUJ+1O6lcy47TO72474lgmJ4NOsLzEOcA+PdeOckyCh3MorZhn35FLUZReJDsPJXSw+I9+uX4oi2+piapJQ6GcTwaMsWhYZQ7mQJrxH6733zF9XATqukelZ8VJi0xqm2u/uAT0IYjjzCK887xc0L0EM26qo5dxPwL6wb7DMTLCUG26fw00iN1+Zda/LDGh5eubIWH/gg9YQuBlDEbg+fcWvrHZ6EMAGpM3WMqzFe1D/kFP2ieSJlJ8nxcB7wCTJzpMHKcKdxvpQYS6bnaz0OQNgp/4wUyH4PvsP6x3Z0yzYWqWNKapVyjxORGcJe+Tf1Re1NWuo/nugCSZZQujh7ZDfnvQtYLiLmVZ+J4FPiYYCtUuMFKI38bcVaI+NLmTXeFOD1GtCtCcY5BXimWYZeltdhcQlIfLHi1ss6IRVgAgHpFeV3n67RrbAhP2p33LeYgLduuaGmq12fjSSGRM+b/V5FNsVmJljxxrn+m6y9/erNY0G+mXnE76ciFwhAVXZRB3Hs2I5UPsK6UctnHwQ9CtSCrHGvWHn+eHoEXNrJNrI4rzOOBJrtvYZsyUly7iZhXabrvYECkDKV/dCLLBcR+DQEYHO/CurzCZMpdY/8QhyusT59z6k0uiMHSBGIgysk785Ch0zmXA5X1h+w6doas9G61vmbNDzAdXsciTxFgitRDbhAOpKXXHaYwfHbYUo+DQEY1eaMtNYPSI6FXLTPrpYeDfPLM9k6jlWrFKAO10IXAyhiN4nBg4tt0ZyUYpKJX+997Ts668/LuOZOSjFJBkx+ZC9lw9w9Kz4qTFpj2lvT80CpIQxHtHTRV6FhWTGsWTTaHehyZm7jZRF693ZbyG7TZxawXESbpohcIB1JxbkFOHqINGxFExByxLq53f+/SUYep1GvmdUpd7wc4FuhsPeF5GAn21JUbTC6bld4jDBa1wdlD1auyYfGgmEv8pWlq4lE9fvFcX7VKOdZ8kTKjdy7zix9uIiqFUq+Mo2xuh5hm+mT7OiLCfK9nugTtxd0AapLKF0csyGFjxQxlcruSMOBhBOY0bj8t1DTsvmIiTmoapmNHOG5H4iODORzRlp4mVaDdpeHFgLPKtfuI0G/hccTtbPxoU7/kW/hK0Vn53waAjC30QV1DJj8yF7Km6Wj5/cg2p4GrWpgMaK7sfQ4lz50lH7X0mAs9GY5GMD/ml9Qp/NoZ44kNNmDtKRJ1M1orxt1VZK1h388PQIubeobq/xfW0USH2sNcektKVU1dN/99RBtTwPYCBuoe5+MGcbbfqGjrAmBu7vKEq1mFy36eXBDZgEIKccXkyZ3e/9fnAAAAAAAAAAA6yR2pMkG1xVyTdQvBzjfb7dS7mU43bZfN/+8hj31O6OO+oT8tcFX5unrXHMnJZaqGwvavyU1xDmG4SyHKk1OIJlpoovOPgh6+vsut52cS1UFakFWttksslo65qXevqKWIqOwJqgpJYBTyFs7Nq0VgbEekAEXuHWDxR86Sj/laTDgGeHtzzYhveyBHSWR/LoYRFt9TE1SSh2o2mBp3K7wBVj1zHIwneMp1MBiWWt/9XDOIq0DOdWfmFkc2ZdHAk34i5DFqgMYe1T2Y9J/w1bQ8NhYnpE1tW7VNTCWUdPWehwS+WchzSZzLtKMHD1EGjasSSqUYWQHf2ktHXPcb19RS28KcPQNaNiKYLSzDsoerEHTZQnYM4WYfQs9l0kGMPaonszJCpbEZXeiDuLFrQGofOSatV4OcKPepEKcoYJka6Dal7RG25Yvaszth9TX9t4nKrgYXTelPEafJdzv4VvLpsGcbvn+o+tTp2SjkxvYhM4v0lkLgXwQ9FaiGm2AdDkz5XOgu3nvDQ8VXAygldweI2wsT8aU1DfkEDZN9iMFMpHdMt/Hg2xCZwMmPzKZvO9uZvjNauV7b52MNa4rW+IWWTGzwuISkPh/k70gJ7+RUANpRg6QIg0bVimeJ2+uGdMoY5KMPFOiQy9wgv746Rue0LxveSw+7UD3TEDVN9LeU9t16L+uX8KyYk2pwNKlQf0KTo//4Dz9EmQmIOSVaW+n4+Hw9Ai4qY9s0aojD92m2cLH0BCd0cYoj4p50E90h9WFRpRXm6NxC6I4QX98+oNPaB1HpNsKUAflIGya8UYKZD+hKN33NL1HEoFERwZytyMt8uCGzAIQUpMYLeWNvIkrV8qh+bD4kx37a4kkR8wuWun53RGFBCCkO0vlvraKJD7WVYQlXxnI1l07Z0BOYz+gBqaNtnZsRyof94rHmrTJfiHDU0QuEICq7JpPnblXgucUBbp7yCybMiAxpUZl+LZeT7G2Ufd1R/TUi/oNhXukZoKFqWxaoWqYu5kPrvkI63nJoV43okf0pi12hX3NXSd0HvjFC4AKGCC8vmXcsgH3orRmbRuYb5Qm50zJIb9TxOZIlUEKD5PZykIgzcyqZHuk70KaQGCJChhxDE6k9psys4vM2jYt3jVM05bcI7x8Wy+pwwm7aKqFGrPSYTGnNkjgEwIdxSlB/E2yzVrat3BL5IqneWXZhO1x5jI4b9YXNLuk6C1t1TirckVcIUfqYXe0sV2hq3DPCRzorJB/znK4vf9XyF39lyJ4qKTkTGprb5QNOFGZW08f3+RiV4zK7XG8ntmIK7DAHSwKkXudXRE8UDuiwx4RqHZDxuRjySOjmcHO9xaGxX6odtyHtKlz4JbVCa8NVn2dOlgUtAwqP1ncxvQ2AviEldEh3dPh3T2YNkhK+UXnGqRmiOV1GFR+sqWR9ZNmWHRQwB2JnqgQGGWMBltPVAgMvEYDoy0DhMZRN7893DJQeOyGHirqMKj8eVc/9yFNIDDKBQy2ZfAyK4AWwwxpvpbdGyRwh9uV7pmB4WG40fwYFNnKBfiCDtK7zA3nKWPXYFBDDxTHO8yw6KCdOg+OQHZNVz9UojnRdcHhYXe9EvWjfHNPH0urN8EvH9/CbVZIsWc5XNDxbATtFTe/QqftlxYdFDBAZX1sZ9qrcrgH7Bf6h7pO6Dzfr3nLAwT7wXM/BgVxvEY+eNYcEofpiifQfPSOd7StobnCYlNskN0m4kSbWGCAFgWPwJrX+UH8+/rYzqlL5G0Oo0PyiwYI65+bEmvQSRc0e5qSh0rnaZwiGwF8QsTmnuA6TFxyDuOSVktun14+o5naa6NT9FrYPTXn/uCQTBskJSLQCYMlh+ldhCmAwA8UMOLGs8Cghh4okwh0M6QZ1ynyNB89rdQtbG/uCj+u+7Kljkruc8SQ3TGDqrcttbGhajSpKgQGXiOP33tLNaFoa2/MaiO/bvSmlWwZHLlrhRrTUlXVmNTW3jUayWBN5fKufvMcpsKjqYHhct4vlVGtelOYMCWq/1bI9hYVUh2dHihg2VBv4xz6RQc6GJxV8StkewsBgOyarn6oWXzsi0AFDBBeI1DlGYv5QQTvitM0VcwN1wenvuFtZ3+S5eMluQ3naZdaBhWRom5jerYR7xYYIItGCfTfPrepgaseuweK6H2swLeRA4y2XiMfD9ONRXSwVmBn7fcCweqOvrpfS+CDEjjN48R3ws7+vlwNzkhsNUwb0oxds2QWwxkQJuqe0adicyQDnSmz74Ll658o/ILL8q4CqKronPBdJ4ZDGqz6J3SwKM9HH54xt6k4WBvQuOOSLsi8eBmbQAvvBpD7cce/QvhiHzvrEEYDBJloPnpHtVrY3piPQmOmldGQ2AjHKm5jhFMGJ1J7wxnXy+uwRGbXKZeu5n4MCuJljHwU0vEHsFbIgHEiwywwQAuMinrhH9Xaztug3ts46YoOdK0Qk1TcxhWmC+kaF/ZVzBmN3V/+uL2xSb/lMCiviQrt1lum9bStemp5VvCIKZcifhDoZlUys1L5DlNh39rO/jnOx/MEn8kBYf9itWFnf18ul1zPJtIlh/BR7w+GVDuvYy8eQe8Qy/KPUnImNbu5SoiujbrnM0TwTUEHadNmiP2as6uU3jS7uWaAExeSjfGqm6VkoPDFETxU8THUvr2xoRd/caLz6o71tUCHhUnI9lXDfvFOaUTwXezURmPc9VE32PKs/Q1SM0T8AAAAAAAAAABfvG5ZjvVRWhbPNC7xqoUysDa9bds5XI0TdU/m3TG3Ervfp3otbJCUiefIrDpYKzA8aw4JzfpFncSuBYnH4mUhSXNad39f1GjK/WRWHSybGNoVAgMvn8nhiGckNpQmg2k3ghQeO6+JhJy11TEkcEvp19tKbxrT0jOm+YlDKpPZv501OauKDuOwU/LKrxXH4tFuGSg8dkMPFT3r4pNjhO3EXjyCwyCL+QMzuINMuUoT/WRw3rEuaGtVNZ/RN3pTxDZhyqV5AvNZdQQ6l1KC5Zp5/X9wSCaDEpzFLukTaZzNeCi5/w59rI0dVFV0TnignUPLfYjMs1IzQUS9EhtKE8+6TUnNJf26ThE+dssgjAYILz/2J7oieKB2wolX8gT7supFPf6B5G1n45TB5pU9p2IbLINoXP9JF2TzLBGX/E3spSsk1r2SLmj2sit4RJrFET9I87bt0SF8MS6erXW+tVrWF0/YtF/ULWtO1OSWEjir+pLmtO7+vrXQRqDXMgvvgghHIDuopZEqUST3W/jmnj6W8LE4JBPPCU7+4ln7yQH3dydqcksJHNt9vfj1Ae51R19ZmzwiTeyGkW2EAY+Zwer+dJi45BzbOazgWV5xIXxbtyqkOic8UMCv9QtD7D9UO26Djj4hYnNPcMCUkttFB/9Ycr/qn9/C7mcRaIrPnM36oBqBkNhqmDa5esvZO8YVx5XHMyw6KGCAyoY0RelO6H1Q9pZqX9DW3oXprYFPltXaHHCiL7aePqPVCmn2jVgrZEC4Qo7Jwu51f2BKSeOsjfEsW4b5CwwQyyPh2bLrjwLz7ik5E5TT0iVEyOChf1zQ1qq1jMal96JurYGT+wgjjwLC1caPRlsvn4H8/5zSiP26xXcFkVfzWdxHHSYuOQf/SSv7WCIz5ZrFV92yvOJC+LZzJXe3Ykjgls9vmcSm2D2nTMEUfkHreVcB9IuvdpEqkzc+8p0kmywKGenhYyK2+GIvVTaZQEd1f3qfTVbVpHsLM4IlZ0ZqoRdMuPUFfesIL7LMSMEL9EdfUzcwiNQnXew6lo9DJRgK7RAXPSMs9wFhUa5O0J+Ub8wT/UtHQcRTmHMbWz8N2ZM3ZS/8sJZ7ZEBS4CN20gqJhAyjrjpwMpsY10GcvSM13oUm+v6/EVt8MZkDlwdPhaqbDcWK1PtINrlwvsYL4/xBBKge/zbcS3CHchMf3DPthFO2CETjPjQXZNMP8RtuqzjNOWQ1Hwp3YbhaO1aU9QnPug4whXCEuHJF0Eevs70il6488rpcL29rVUp0vcR2H09w4c/fxkRx7cRe5hB4TB3ArxZ6yinWPBE/KC3tQRd2qFmvrF8hHpmj1e7UhPlJqH7zOzzjbKWW4BPk0SDwmDqdQyxrxARk3Fl1Y2nV9eXRlWyemulfBDaYuyTJ7MjaZqTvRNaVCMilsurGxAwiNcBQO4A4wZO6jGUhAxzux11GvJ6P0zEBGTdRWtHY4uVohuylD7E3EI1XecmRcJ87aQXKQgZP61CDFoDK7+xFavMkG9I4WNZzr+GBq74kL1Tnytm/jAIR8YENzBn9kLxNuw9DxgqVGERqnaB2HaG/y/E/VwEqK95PiWHhcrUnuFOoT3MkgbCx5kPfH0thGMw4Qlw5rGjSt/fXvzfYITEDhkowFMcgFKokY3Kr+lxuYA21TrrFdDlHZXQEA6PzCcIV8Lxx5iMqWLlH6YfwRXtM3xi0d73Ylwm165Bsb+BzCDwmgGDZC/7cQA5B+QN+KElIxuRL6bhyjsroCAZb+wYzDp4XSSsaWVCFYWnnKU665PT85sQ2T8p7z5XjDnRJfX/RhqM+lsJSg2EQ2FrWkE36oQIbTNMSkTq7dYclRPrdRuy5FA8VGD1lmmsehpEUwj8sq9cZEJrXE/4GLdRoNtCmBlay+8HcIhxaed2QlJbv0m28obFJNQ537aAjXk/Jy/05W2to9rkN4OrvpvTUxAQi/x8ahTLn+Wm4Xt7WqpR/biAHrvKPPzrQYjuBqTj+ZiTui3qtoae2gujdyFZge6eMxW8oHiowx5slekX6oI1bQXTgZCsws19ji/9+rgJUS8mvnAwF+AjOWTCK+YtGro/FjanMVcOIgDSWx2dtDrHzPKrh5w3XurtiAjJuorS/1QIPhyAYccudXKdUqbcSzoQWadh96DxWimGEeF62c59CC7pssHQeK/EtW2Dqwc5Hdqw19xKDaRwsa7fZ/s7bX/zNsY9MNRqDH3nAEsMWBYLwq62uYqdMt+GlgByC7wb8Z6IYRfLLI1dRFGZfXfBNnb9A/S10J4ZYoDk9P7cxg9oFpAnRkuOwF6n7KM8LQGX5JamiKUK/PXzbdeInA0Y+ArMm4QxatdBs55aOgpWmLea5c/OzY26tQt9XHTgZwwzl7lSbcinXy8USmSr9ZeLRRvjvTpBWsChktwQeE0Aw4ovALt0q2tUJZ5MrSvSK6V0Hb+b7e8bcR4Qjmqy3VfYWZkAaS+29uAfWSF6o04mvYwWkG8IgrbSxPXU7MriXKfIRmX5YS7MyICkdaDGTztocf/9atsDJn4GOFrvV4n9n46GlnTTuJdIzzZj4roU7VKLZbfcK+ssQXnl5XS6ZubukJY5De2dEM0F4AYb2zohmgvDr8JKjuzR70rzX+mLxjR1VrdnX0BHFVx4L0+Rxsb3/3qpsL4CO6v70XuV9MfbIgKT1D6R/8ET8oBrdycNR9bWV6nZkbTNS+SIAAAAAAAAAAIWQnxb1jr6mRilFc6rxLMwKVRK/Odt9Lnjb2Fcx3SbVKc++CGwta0ghi102WDoPmxUs0q36zXisg6ORiOLHlbzDudplX3+Sap7LoBssHYnDB7X4UJ8vqep+6NbJJpQNzza2fhqvO27KhgeYWXAkJav7eEnf0xqzaUx8V8yTKlHi2WQTpg6KJ/8mPqVmxxWmcWxx/DRDdtyJSk9ZUoRjevja8xTpiyC88lcnaMFKuWaHEIjbfGguyLuIcHX5U3pqYi56RljzAsKiYZEW2+WCCE2ofd4BgybnCdzAGnecaZfo7cOcPax9UMimCjOhoHiowMGoK+RSs4uXP3Rr6hNKiOmiKMy+uv2aJ6vq2U4GjHwE9IlSsXgiflBc9Iyw+wSZWWAX4BVt5Iq9RDi08qc9NTGMUormSf9YhbUV75JN/Pt2DGYcIS6SVjS0kxlcxZp5hpzaUZoh0ZA+MpSBBbW+XC0ZSs6M1F8umEONTKI4Epzbm2+pyr7+OdSBsmAJ7wuMQd7R6/aRpY4VTm2mTZ7mSB9UsG+OzxP9iknYXh0ByeH1r8gmURwJTuP2mKMwde5nrVrHgi7sTbJDjdR8KMGZ2nWJ9oM32xzoks3ON8V8Id2jUwWX3lA8VGBqQvKqVD/3k11yen5zYhup4jKHUwdFnfFWoZ4Pwt/kd8Yd07TNnCJ95Yd/A5hqNBuUnrKkFcb07WIGEZRgKJNAY4DnWuhOEbCL53K21tDxb1CSkJHVls9t6GeV7D6e4N98+SdIK1gUMshqPhTuwm20cRnNp42swPbkAYnNEAy265KtvDoCj9/3sqAXwtLTUpwgDav40FyNazSnj5ui93c347RxnY8jHwFFvkI8L1u3wfceVf79iOVdaFMDK1nz7m5ls+nE/wc6qncqwzma5evsh4Ful/hCp1sRDi2y4EhKSzMSd8s92N7dvVEMrHnrn6U1IXlVKpH1x4qwqWhG4GptQ8foC0vwszoIybNUaxYe5TnxwjXrqZC+wb7yN2YGx7IsIJIzYUVpqusBUjtvwyialGlTq5Nazt0nKDj2PhM0DosEVeyhK6BSd6GyxJeP+KKlUSLKE+VAhiJ2E1hi0/HN243f3gi3bP5dHhLInkoXig5WgWsDlphn7l95lTMD7Vmv7XSLq3jXHW2Sny35PlPu9dio+Lp5jCr2GbFpjjnPa5Xdry90kQTi7CqcgOCIZCfOXI/YgluV6sTg2Zk6xgJxRpnDpRcwdvk9GxUfUKKfQp7VBeorx1lGNGZaz9x/S5hhsftTKSNC98chwAgOhkEwhpPNFpb9e3SHJzGScTaxS9NEbIpjoXIbZpo16KZoDkrKtljyOVCaFqTl3k70Loq5N6dDXug/CNkTTmI54mx/loJ5Gjwt9nSIP27wCoMpFjyOWn5C/etlkVyq7kx5gd21GfI0eFrx6A0lXd3j7Zi9cFCJijKpnMysKMpFGdpOZlauWYgPTLMdIg2XmPo31tsmMvlo8LT/zRqgDwlkTyWFRfo61RdeJN5y9GxUfF2yRhVxPoD7/w9+IHhDzytz0qr6vRfqNq7fYrT9ERus0W+Sz0q6p9vHLWfgs0FrXa1J+tO8oxaySRSoixXRUAaK7PkU4nwd6+Me/EBP5Ix1m+2iI37c/RQbUix4TlBw8XwmaBzmlsrBWBXzvDXSpks7tIGngAz/Kf59/fYe2frD1bqksGwmY6ke9ZnRA8EZkTRAQ0H3rU3tafIFVM2dlkm2G9aryMO95+rbE2jRMYmfsCr7ZR0Y41Lh+ufx2jkjWu98psGhu/XgqO5PepE3eAXPmgseMThxYYC/jlvZ+DrL2zzlgAJ15RXTi4l+Ry0/IfD7vMYtlG63ho6jlbo8JI0hlC4J5yI2Rb/eOYP/ZP65AuQbscl3QWMNENlXw8sXIrWNTsyieuxxnK4MO5n+y1GkjBX7FGWsgm0nMyvhvQR6116/AXn3M6+UGWDFZy7JbEGjxHXCf+umUkaE82Tv0P1144c07Z5gBAdDrhj7jimTue8UTThFPrEMYlqBaXhIB0I1XBJIz0LOFKbunhysH9YGMS3Oe4LWukeS6budFBx7H4caB1YWuA3BHEouuEnBmPIfp3d8qRgByNmlBrE0jkh+wnOtQbINHph7OkR0YKtVo8+744TmKANFdvIKG4fRbYl6YXMP4n3v5F1SWIPN5rjKPb63DCNkftAdERl6Nio+oFkjhLYfQPPxiT8QddRX0UQEcdxFWNo0I3A1uNymEWWH/CBDjZtn08mrJtArC1yI7g4lF2/nejgqtdqQJpzEctnY/jFjxB5G+qjLibervHcWQvUvfR3khS8SbzmoxrowJDOboGAFB9fO6IjIj+6Cxhogr65XokSJJteAEfyl5yg2pFjwByvOu49LTL1Je75K820koTyv6Zu3aVV9EvqevQWntanowEuqW4Nr20JzFI+sO3kFkIOEgShRwSHlV9NQbFWw/XL/mWrLTz1hPtoMjmTi3APwhoNW5rlJ6QTq1yq7Cw/8F6S1E1lncGrjyOFvBNU2f/hPMAKNr1cMGEbI/L06IjJbgSD39sqRCNRvojHs6j6mM02UdFM0ByVYQDlmworSSb7W86eanyH1aMy0g6X+li3QhXUbV+ExWv7QAj3lL9GOSw5bXyDmrd8aMy3pbrGrTKPOEPV7ZcYEEI97qNYsPNerB6OhEHPY4WsNrRKRvtVs8vNmQzUywJcuVXcmss7g1AAAAAAAAAAAywKkdt6bUCnk4y/Ui556wnNLZe4shPdeblOGvM1+EK8BtPyE58vKP8/oc1xlkF/VNhO/2g/0wuYRO4csMef26C/hi6JVBSrr6XS3LrxIoeQKvFZBuJ2Xm7RqpeYiArZuROwmsMS7/4emkDtbJ6UDx39oAZD8meZHl6hKOqcajZzdEu3hYDfqfMVUJR3dDchOiMVMfZVr4xNNkWlgSGYrXbCAcsyZCbmStd5ZYsXJfFGBuAOtGbY3ybL1l9lKgjDsCwiqxV9WXaTxMn/SAXKD1q2YkZ54815jarlRlnZ1H1Mk6SFnClN3T7n9PRwV1G1IkvZhlPvaSF9aNdxzEQFbN97T9HBUd6k9wAoOs4HNDY27iNgJxl/kNhYQSZe+rLpVIbcKyVaTsoxZ9MXiJUEYdtXbXrULIfSZVdehnPVcCW+pcka0w/hRn4VS1IeivTg1VGNdGBKXw1Ajwu/chRg78p9h+W7MDJN5U0iTo53cj+1e3wtZqgpUy6wsbRqfOJRc1667oNiqfecqv6AMCcXvKNhMxk889y+/IAP2TbFYeLOnJMffwG7J+AafMj9ogIaCzClqzVHQHJQFXiuuXMDFw2Jw4sIdYwG2O4QnIDgiGcDS8JAOhGq4JFL8byd6F0XSxpU8jOlNiw/gCfj+MJV1PmVbLHmSKE0LmEo31UNH38Tqta6/iAjipZo/0sCQzFa6nKDg//hM0DhMJZXkr63hYt9nCPSzvGMCv2IPI31U68qTQp0QHBGCYAl9T9CM3dTajC+bVy5g7O9winx/GMS0Hzow26Tf6dP/QAbxmn+w8Htfa/fdTcGe9B9tBkcycW6P+fvMhmpknTMwjI3lZ3REZIlxsPlyoCks1hpHJD9ht9jv64UR1MgnZpYctr5A0UejqrNfJfe4Et52FU5AcEQynVE9drZOVwaT80eax9L5Cqibiy5EdwechSl+uZ09haxpfjfmLfx9QMN3byWk7pOeW+BFyFDdj7Wthu1bpxH/GVLpHQvZz2FrNTfgqyVuQI/7lgf2wDECWnoLAvXhFtI8nfPYSGv7UGUMYhz/J8QIdfV9QMtx+l/TSm2qZhbaopBin181SSPshOLshHw9xQfDswJaNmgEPOIFqL+ebE2sCxn6gIvi6b67lLW5nFJ3x0+jeNm8lfA5e8zjMuUM260mJMdPzhKTMnl+Fyns6y6nCavC1rn2mVTR+F2JjL+6uFUahZp2+xfditsb6FiGNi9/tfZBP4/xNs2K0xEPpbu341wKL+7VFMxNEegwEO3Nfxq5oedd5V9C1YHu3kpVwTshtvL1U1/5ThSADMG0bRiIdh684V/bZSmROy0l6JdacYHCcYF/HOLXpVQuUsXLXFMSS/n3pr7vnCgdnnIufSHy9W7OFw2bgdyn5g6bggUctJQbHnEvYjxJ1zMh5Fz6Qvn33MuOen+Lug9gjpiDGgEPtkZHTM8NjolbI6mShVhPsnqVjMK1cgUzVENC1bjphO/zpQEtGzQCHnGMV6Ziaq50GAv/GfwG49gTEjW6nU1qfG3+ydRMF4+G7WVQZSPmoC5SiAN3LVwGIpOJiwH0/gtpHsD42r2K7YJZkUxOOuyYW2e+sQ3wgn+/lqlqaSea1Pja4eeGidzT1f8ugS4aKx+lU9H7rZDW66DKGBrFQ7I0MQ45FgT33yy5eCemJBxpURifAnU1E8zqr3xeZPKln8hMTvokfSseSJ9fWttk1xirR0xIefSnofInCkAVc9qDKpvrrjSXhnloYhxyUUg40qIwIwTwr2U3/XL2hR0GAj46a0S6Z4WIw85u3XNmqJP3zHCs/9TSTim17anfOFYyFHDqamwHw0GMDlpKgyvLsi9WNbrNBLRs0Ah42QoG7lq4DEQ7DzshH0h2yPnlCVjDiRLu3pjRSznNv4sBWTl7KSBy9Bvgh8BAkxPhaN6tJumIR8qjn04UDIScZ4W71f9VHbfz2FOgykbRXVykDc1gIMeH/jRvhLdtzxXD+1fe/aD8oSHkzkuNe2CWAS09msZCrSmKLGQIddi9EPCvFLNXxup7g3SsTWMh2JpFFjLtqWcJxxmyP/dsJLvzKLwGxmLVJpEsCPI84l7EeJKzZrl4KD9vTzm9wIyPnp1oM/1PORewnnn0N1k94G+ywIwQ1oh4QbHRS9oZsm7uMhOdsLSUh2Z12T4vglk3dxmHwFiQ6ax4PUZhdfGCfgP/bIcJlF3AqDU+uH9FFvllirW5Jj+Vc5h+sCDvuFUzC21RSDEq5qkbVCvLQWMx5BPGFgR5QI+OgYDTEaDv81FhwyVQOtBmIvm9lXDViHbZog1LjUmlUzE1VzoMi+Fo02TfkcQh9BsJ5/UKL48SsJsPJMGhLdpJzCypWT3EH1w0Vj5Xpr9U0U82qFaLgq983+BD9kGa6momhclD+Lzl3L+01+kdK7J63d55nQUga0Q8rtbmq217rpHJ9hvoRT64aKx8rlFjEce2UyLjMqTSPBSRuamS0I+1mC4DEcfKcKxkKODJ1NiJW8KWD1X8xXZCPpDsje/Xb/BQft6ecmc9z0XweozC6kqgYFSUH1yxWBD7W7De/Zxe/qHjvJrGk27dS0rcgAPrdBgI+OixDdIUXsG3KIWaIii8n3NQFylEJwoGQk69zNOXKu30Mxwr9gWZd+QKZqiGJVAwKkqBLtbdio2gpwN3R8UV+HqXDpt7MCPqqWAaxXi346o6c/utpg+2mTEequWXAAAAAAAAAAAxDvGdYgS09CKTcaZE22RVDeyvWRqWB5JcpJeLuKYklhwrGQo4dTU2QaKVtYLNYCwyedzBZCYnfcGhlKqfdkJxE52AOybf0KGuUcTUQegwFtgT+kStZd/BrAvyvEXU0hMjvmqSRsUV2UnXTQiSPc84nQUDISfQZucvf97/Xk1jx6R+KgFVJH0HmbFv8S+ov+1GYdQ5jJcqr9/Qu8ijP5VC3KeWlKUdBsuwIOu2faHnJboPBWNpbao05PGkgNX3bKfEOONOlRDq95OegSQ7ZPL8je+uRgctJc8sCPOjWG/wTtelY3WzzzpWIMlHzkDnhlBD+KPdhvGCKVaLeV6sammHgAMBHx27Il31NhLT9xReAxifddowDew8lXDbnDcgyfO7Ih5Xa3PbuHL2UkDk9TbdRDviUYiryKriH/442bNXqP1Dym7n5PEXyqNhS4mkfuz+NOcy4cZinoN0LEMbmbHUzzoWr4PC1mqq5agESZDpHCYnHXZMo71fkcS3TD9YEPl8bdBF+EGixn8a/Rn+YzFPyPlXI42YnOmnCQddUwbujlX8VAKqSPoOSPpWPJAjvrRl376rylI/dmyHfSLYvOHuzE0784XgReO+u2mzYRVzPhDqrWcg/UMots6xDnHl3Cq9zETvZzfgt1I/FY6kErCNmJx0xS22zmGb61mZK5Rd6Ios78oJd29Mo71rjVt+N4TrRz2xy12JMMP7osKbSqB0nCgYFSXOF2toMxHy0MQ45F/Tute+hLcf/G7RWuX6gJs2zbARbF7+dymRhEdSCVjIopBwuVlgRghTEg66pgzBAToMBHx01ohpaR4KxtLaSWhz20l05utHUXqDiv30BZnJWkrNM7TiH5lgRslPwDSX8OarkujRy46iM1TH9WY4VvHZPuFwr3uuTWFr0nvCKuZ8krOaEDl6g3CryLMwS46YkL+WcodjCwKyW2fWB7b8bhXQMcOXzlU/5ha6WwGwBrUlqJut5ilucMhqH1Jdd9NDW24QNXBXPfoLZg77Khf8lat2Mnqel2NL9kutnWRiRYv18YMMrtvD90jFyPVCZpEx/5UEShzcSLDLiSli3zz4uGawueII6TDBNaFPs/BhGnZ8jSYF8hwWATbWtxki/sxUnjcIlDilkH2LC12jjlgD1JxaW8yc6m88vO2uJG07c//l0rh+D94i7c5eVKuxyoGF7B3n+I/oBWG5rV4ahwE1oIwvKtvWZc7MdleAtaeC9YNYPtyKLu3kez/J2Vw1Br7nD4O+ER1sTgXupgO5CVk2dBAQPIG0gJ/eXSxptgJ9DHdKOZCA19XIeVMJ1B4WSHQGtM3WOxgmUF5f+Z3C9JsCmOic0FQKlDy2f7yoS3+JHxfFcj0ds7eN8qZ4qm5x5ztPLhQz5pmgcWcNhPIb5FRiB4KY3zMntNIPL/BJ3OLTdp5c22xgGZZW63pkh0ayB4tHgzLNI1mNy63PHqSVW/DH2oXpoUNAG51Gtf2Spdm77CG4yBOMeQ4Ljhsu4AuabXulYvhXEriTt/H86yj+2AvqlJ1WSmXrikDqTGyZiOhHSigjRTWJixIdjy2r2MAyMazL9Loukcq5hny9eWC+Pe+OJjoMEal3YC/W8MtQ4a0WyTUn6uIulANf/YkoZtEvXeLOGv8bGEGrm/OQn5M53oz+DUOWRyfIxIoL91JFAsaqrlMcm5xe86wQtBNPovpJQqsypT8WWmLlURIrx0FI2nbm49eSSEDl5GSyp9NyrkPWl4TaIztyoQXhGoakigSRSUGmOLS2hSXJ3nhl3eq6rKbPgAIKl3PCULa9iMKE/7tevTOTi6DfRyyPak4q72y3TZUcMkJ5g3IqMY1Bc/fN/784m7IHTAr5OCwCbIpqDwskOgNab9rlPF+Ikx/Gi5iWflOKw0T/WccaqOY54vzgzkOekimiDN4kedjNQBnon6LI69jp9Ea7z/OYJwxDs1M+IoTkVdgvDc2OlFBGUQZvErJs6CDnOVeva8VCbQgezlpAwW+gOxk9T8W/q3t/5mSI3xdNQg6YFO9wWATYgTeshXw518axczJE4YWoIWlcP4lvEfhn9s8GV+Pv9SQaq/J20Clj1S2jZk51uR5eAom9mBB30iiQwf199BNgjzxVN7b9k6kXqhIQfjkZouAGhtq1MJlreNqmsFWe44Juw04v91YIWodtU1ikT/9BN/xYdZWzWUisfKUJXMfV9n77FH9si3VKwL/rJquR3az5aJbvxWekkXPKmjHhHnxcM7vkQYaxMxWpDdt5O2iav+RwtKArp/ogjuR6OntzB/lRjOzVvhSjaCLu7Um5I7FE2Rdwi024s9wxYIghnydl/tOz+o/c8fJ6CZELLTH8pgmbD1LEo3jtbcxQzL9eutmBNGvVghF/ZipPlM6aUNT92d8rJbz7RSB1JmfEK2YfSfy/SSQg/HIyWd0DQ23UGMK7PB9uRRf4crORoIVjvGmvH2jUPqS67ruGtgHK0EwItWkUrJTKywmAyZhUw9hzmjc4ZCb+xcAtusrC3qnXeL4NOz4ED2ctIO65UOWw6jd7spBF8wqxNsu0JWBiAZwHNxIs++hrkwwTKC+hzBzrVC7lN0tTj9KKohs6CBthIjrYnArBNsJEdK0lFJ96I9Pp90ydBr4h9ueZaMXtz1+GgDYnjHf3BdYb61qcME0rR9FS3OCNX557/cI07Pgkd3hYPc0Y6oZ7pnxEFdWqTOGXnVppiZkAAAAAAAAAAOxk9CEzxpbxtXxVacFrEXHBx5JvRn+Ir2VNlv4PPi6XFfk21ajEDhm4pyxSqfGulalRfaoh2xncWNJxBPoY7pRZGKFI8q2HgFzdFina9lfEgnTBUWT7bPrR+xPbxuBW8n1v2RDPYJ9qtj84vdmpqk09n+f69SbAA3S7xwaHFJne32MHNLa4Uio60+0DzQrCb/reryCDwCPUwA1CI07K4buFOMuoXNdulsQCJQ5uJFjrR7w0EwJqXQWv16cfEUJypJeN94TMP2LjuW38HqFEx4Ehss85FZbIrjGOTo2VCRbzzpVWzD6S5WM4WlCb3X0QRzWBKaC156+j5vOH42NwK3ngdV1WU+lAAXvpA6X/+fQSErU8LJDoDHUzB/MVhX7E24+vuGoMYdMe2eXdgYYhOVJ3+KrSn9Yi4iW9qBQ1eHH+dXEXSo+h8MoTf+xgmF1lYTBEnsGdvH/npUDU3UH0zyzcIGrgrnrpFluRHNDi2lWosjBfkPlHEx00S/nsvVLGt10XxmXSQz7QGCJP7sBesf2eWemShEtkV5pWjr+kpd0Ho8YOaHFtpFR+LLTE16IkVoexdjBMoLy+QTrupjLzNn2ZFeNrvGdmO0DwPuo6Rl9pHC0ow+CwCK1OaCoFSh5bsQXFt2EoW9BE4b+NGltcKRXywGF6wwFMdLf16PHRHMNZY8tMSz+nRe+dGoRGnInfa+M2MIJLK/s91fR09uYO76L1jGuD+y1OGEZ25F8K3zQRIHgfdR0jobq9Ypszgap+0a4dd1MZ9xuw/tHIDaMumoRVCQg/koJRcCmsAWNVV6cOp8lpRVGDHQSOZWgmBNS6ChH2UfiIKrdJ133JbvZ5PYrvJ5n1KwQtzUju8LB6hzDJIvGi7Q1Uc5JhQvHTL9CXx0pnTShq8OLhgP18yXSMvtJxfnBnr09JmpOCkKns0duziOOykzRN0XInNBWMJQ+j1g"))}(),A=s(),b=s(),F=s();return function(e){l=s(),g=s(),m=s();for(var t=0;t<16;t++)256===this.bitLength&&(m[t]=16843009);for(var r=new Uint8Array(a(e)),i=r.length,o=i%64,c=(i-o)/64,t=0;t<c;t++)h.call(this,new Uint8Array(r.buffer,64*t,64));d.call(this,new Uint8Array(r.buffer,64*c,o));var u;if(256===this.bitLength){u=new Int32Array(8);for(var t=0;t<8;t++)u[t]=m[8+t]}else{u=new Int32Array(16);for(var t=0;t<16;t++)u[t]=m[t]}return"SC"===this.procreator||"VN"===this.procreator?n(u.buffer):u.buffer}}(),b=function(){function e(e){for(var t=new Uint8Array(32),r=0;r<8;r++)t[4*r]=e[r],t[1+4*r]=e[8+r],t[2+4*r]=e[16+r],t[3+4*r]=e[24+r];return t}function t(e){for(var t=new Uint8Array(8),n=0;n<8;n++)t[n]=e[n]^e[n+8];return r(e,8,e,0,24),r(t,0,e,24,8),e}function i(e){var t=new Uint16Array(e.buffer,0,16),n=t[0]^t[1]^t[2]^t[3]^t[12]^t[15];r(t,1,t,0,15),t[15]=n}function o(e,t,n,i,o){var a=new Uint8Array(8);r(i,o,a,0,8),r(new Uint8Array(this.cipher.encrypt(e,a)),0,t,n,8)}function s(n,a){var s=new Uint8Array(32),c=new Uint8Array(32),d=new Uint8Array(32),y=new Uint8Array(32);r(n,a,h,0,32),r(f,0,c,0,32),r(h,0,d,0,32);for(var p=0;p<32;p++)y[p]=c[p]^d[p];o.call(this,e(y),s,0,f,0);for(var l=1;l<4;l++){for(var g=t(c),p=0;p<32;p++)c[p]=g[p]^u[l][p];d=t(t(d));for(var p=0;p<32;p++)y[p]=c[p]^d[p];o.call(this,e(y),s,8*l,f,8*l)}for(var m=0;m<12;m++)i(s);for(var m=0;m<32;m++)s[m]=s[m]^h[m];i(s);for(var m=0;m<32;m++)s[m]=f[m]^s[m];for(var m=0;m<61;m++)i(s);r(s,0,f,0,f.length)}function c(e){for(var t=0,r=0;r<d.length;r++){var n=(255&d[r])+(255&e[r])+t;d[r]=n,t=n>>>8}}var u,f,h,d,y=new Uint8Array([0,255,0,255,0,255,0,255,255,0,255,0,255,0,255,0,0,255,255,0,255,0,0,255,255,0,0,0,255,255,0,255]);return function(e){f=new Uint8Array(32),h=new Uint8Array(32),d=new Uint8Array(32),u=new Array(4);for(var t=0;t<4;t++)u[t]=new Uint8Array(32);r(y,0,u[2],0,y.length);for(var i=new Uint8Array(a(e)),o=i.length,p=o%32,l=(o-p)/32,t=0;t<l;t++){var g=new Uint8Array(i.buffer,32*t,32);c.call(this,g),s.call(this,g,0)}if(p>0){var g=new Uint8Array(i.buffer,32*l),m=new Uint8Array(32);r(g,0,m,0,p),c.call(this,m),s.call(this,m,0)}for(var v=new Uint8Array(32),C=8*o,A=0;C>0;)v[A++]=255&C,C=Math.floor(C/256);s.call(this,v,0),s.call(this,d,0);var b=f.buffer;return"SC"===this.procreator&&(b=n(b)),b}}(),F=function(){function e(e,t,r,n,i){return i+t+r+n+(e<<5|e>>>27)>>>0}function t(t,r,n,i,o,a){return e(t,o,a,1518500249,i^r&(n^i))}function r(t,r,n,i,o,a){return e(t,o,a,1859775393,r^n^i)}function n(t,r,n,i,o,a){return e(t,o,a,2400959708,r&n|i&(r|n))}function i(t,r,n,i,o,a){return e(t,o,a,3395469782,r^n^i)}function o(e,o){for(var a=e[0],s=e[1],c=e[2],u=e[3],f=e[4],h=t,d=0;d<80;d+=5)20===d?h=r:40===d?h=n:60===d&&(h=i),f=h(a,s,c,u,f,o[d]),s=(s<<30|s>>>2)>>>0,u=h(f,a,s,c,u,o[d+1]),a=(a<<30|a>>>2)>>>0,c=h(u,f,a,s,c,o[d+2]),f=(f<<30|f>>>2)>>>0,s=h(c,u,f,a,s,o[d+3]),u=(u<<30|u>>>2)>>>0,a=h(s,c,u,f,a,o[d+4]),c=(c<<30|c>>>2)>>>0;e[0]+=a,e[1]+=s,e[2]+=c,e[3]+=u,e[4]+=f}function s(e){return(255&e)<<24|(65280&e)<<8|e>>8&65280|e>>24&255}var c,u=new Uint32Array(80);return function(e){var t=new Uint8Array(a(e)),r=t.length,n=r+9;n%64&&(n+=64-n%64),c=new Uint32Array(5),c[0]=1732584193,c[1]=4023233417,c[2]=2562383102,c[3]=271733878,c[4]=3285377520;for(var i=0;i<n;i+=64){for(var f=0;f<64;f++){var h=0,d=i+f;if(d<r)h=t[d];else if(d===r)h=128;else{var y=n-d-1;y>=0&&y<4&&(h=r<<3>>>8*y&255)}f%4==0?u[f>>2]=h<<24:u[f>>2]|=h<<8*(3-f%4)}for(var f=16;f<80;f++){var p=u[f-3]^u[f-8]^u[f-14]^u[f-16];u[f]=p<<1|p>>>31}o(c,u)}for(var f=0;f<5;f++)c[f]=s(c[f]);return c.buffer}}();return l})},function(e,t,r){!function(t,n){e.exports=n(r(0),r(2),r(5))}(0,function(e){function t(){for(var e={},t=0,r=arguments.length;t<r;t++){var n=arguments[t];if("object"==typeof n)for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}function r(e,t,r,n){"object"!=typeof r&&(r={value:r}),void 0!==n&&(r.enumerable=n),E.defineProperty(e,t,r)}function n(e,t,n){for(var i in t)r(e,i,t[i],n)}function i(e,t,r,i){if("function"!=typeof t&&(i=r,r=t,t=function(){e.apply(this,arguments)}),t.prototype=E.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}}),r&&n(t.prototype,r,!0),e!==E)for(var o in e)t[o]=e[o];return t.super=e,i&&n(t,i,!0),t}function o(e){try{e()}catch(e){}}function a(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;return!0}function s(e,t){for(var r in e)if(e[r]!==t[r])return!1;for(var r in t)if(e[r]!==t[r])return!1;return!0}function c(e,t,r){for(var n=!1,i=0,o=e.length;i<o;i++)if(r(e[i],t)){n=!0;break}n||e.push(t)}function u(e,t){var r=e.content;switch(e.contentType){case"data":e.content=t.content;break;case"digestedData":case"signedData":case"authData":r.encapContentInfo={eContentType:t.contentType,eContent:t.content};break;case"envelopedData":case"encryptedData":r.encryptedContentInfo={contentType:t.contentType,encryptedContent:t.content}}}function f(e){var t=e.content;switch(e.contentType){case"data":return{contentType:e.contentType,content:e.content};case"digestedData":case"signedData":case"authData":var r=t.encapContentInfo;return{contentType:r.eContentType,content:r.eContent};case"envelopedData":case"encryptedData":var n=t.encryptedContentInfo;return{contentType:n.contentType,content:n.encryptedContent}}}function h(e){var t,r;if(e){if("string"==typeof e)try{e=k.PEM.decode(e)}catch(t){e=k.Chars.decode(e)}if(e instanceof B)try{e=P.ContentInfo.decode(e)}catch(t){e={contentType:"data",content:e}}if(!(r=e.contentType))throw new Error("Invalid content object");return t=e.content,t instanceof B||(t=t.encode()),{contentType:r,content:t}}return e={contentType:"data"}}function d(e){try{e=new P.ContentInfo(e.content,!0)}catch(e){}switch(e.contentType){case"data":return new v(e);case"digestedData":return new C(e);case"signedData":return new A(e);case"encryptedData":return new b(e);case"envelopedData":return new F(e);default:return new P.ContentInfo(e)}}function y(e,t){return e instanceof B?t.extensions&&a(e,t.extensions.subjectKeyIdentifier):s(t.issuer,e.issuer)&&T(t.serialNumber,e.serialNumber)}function p(t){var r=new Uint8Array(t);return e.getRandomValues(r),r.buffer}function l(e){switch(e.id){case"pbeWithSHAAnd40BitRC2-CBC":case"pbeWithSHAAnd128BitRC2-CBC":return 8;case"pbeUnknownGost":return 16;case"sha1":return 20;default:return 32}}function g(e,t){if(!t)return new B(0);if(t instanceof B)return t;if("string"!=typeof t)throw new Error("The password must be string or raw data type");if(e.name.indexOf("CPKDF")>=0){for(var r=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);r.push(255&i),r.push(i>>>8&255),r.push(0),r.push(0)}return new Uint8Array(r).buffer}return e.name.indexOf("PFXKDF")>=0?k.Chars.decode(t+"\0","unicode"):k.Chars.decode(t,"utf8")}function m(){}function v(e,t){if(P.ContentInfo.call(this,e||t||{contentType:"data"}),t&&this.contentType!==(t.contentType||"data"))throw new Error("Invalid content type")}function C(e){v.call(this,e,{contentType:"digestedData",version:0,digestAlgorithm:I[x.providerName].digest,encapContentInfo:{eContentType:"data"},digest:new B(0)})}function A(e){v.call(this,e,{contentType:"signedData",version:1,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},signerInfos:[]})}function b(e){v.call(this,e,{contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:I[x.providerName].encryption}})}function F(e){v.call(this,e,{contentType:"envelopedData",version:0,recipientInfos:[],encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:I[x.providerName].encryption}})}var w=this,S=w.Promise,E=w.Object,B=w.ArrayBuffer,D=w.Date,K=e.subtle,P=e.asn1,k=e.coding,R=e.cert,I=e.security.providers,T=function(){var e=function(e){var t=typeof e;return"undefined"===t||""===e?"0":"number"===t||e instanceof Number?e.toString(16).toLowerCase():e.replace("0x","").toLowerCase()},t=function(e,t){return(new Array(t+1).join("0")+e).slice(-t)};return function(r,n){r=e(r),n=e(n);var i=Math.max(r.length,n.length);return t(r,i)===t(n,i)}}(),x={providerName:"CP-01",autoAddCert:!1,useKeyIdentifier:!1};return m.prototype.options=x,i(P.ContentInfo,v,{isDetached:{value:!1,enumerable:!0,writable:!0},writeDetached:function(e){this.isDetached=e},encode:function(e){if(this.isDetached){var t=f(this);u(this,{contentType:t.contentType});var r=P.ContentInfo.method("encode").call(this,e);return u(this,t),r}return P.ContentInfo.method("encode").call(this,e)},encloseContent:function(e){var t=this;return new S(o).then(function(){return t.setEnclosed(e),t})},setEnclosed:function(e){u(this,h(e))},getEnclosed:function(){return d(f(this))}}),m.prototype.DataContentInfo=v,i(v,C,{encloseContent:function(e,t){var r=this;return new S(o).then(function(){if(r.setEnclosed(e),t){var n=I[t];r.digestAlgorithm=n&&n.digest||t}return K.digest(r.digestAlgorithm,r.encapContentInfo.eContent)}).then(function(e){r.digest=e})},verify:function(e){var t=this;return new S(o).then(function(){if(e&&t.setEnclosed(e),!(t.encapContentInfo&&t.encapContentInfo.eContent))throw new Error("Detached content is not found");return K.digest(t.digestAlgorithm,t.encapContentInfo.eContent)}).then(function(e){if(!a(e,t.digest))throw Error("Message digest is not verified");return d({contentType:t.encapContentInfo.eContentType,content:t.encapContentInfo.eContent})})}}),m.prototype.DigestedDataContentInfo=C,i(v,A,{addSignature:function(e,r,n,i){var a,u,f,h=this;return new S(o).then(function(){if(!e||!r)throw new Error("Signer key or certificate is not defined");r instanceof Array?(f=r,r=f[0]):f=[r];var t=r.getProvider()||I[x.providerName],o=x.useKeyIdentifier&&r.extensions&&r.extensions.subjectKeyIdentifier;if(u=h.encapContentInfo.eContent,a={version:o?2:0,sid:o?r.extensions.subjectKeyIdentifier:{issuer:r.issuer,serialNumber:r.serialNumber},digestAlgorithm:t.digest,signatureAlgorithm:r.subjectPublicKeyInfo.algorithm},i&&(a.unsignedAttrs=i),n)return"object"!=typeof n&&(n={}),K.digest(a.digestAlgorithm,u)}).then(function(t){return t&&(n.contentType=h.encapContentInfo.eContentType,n.messageDigest=t,n.signingTime=new D,a.signedAttrs=n,u=P.SignedAttributes.encode(a.signedAttrs)),K.importKey("pkcs8",P.PrivateKeyInfo.encode(e),e.privateKeyAlgorithm,!1,["sign"])}).then(function(e){var r=t(a.signatureAlgorithm,{hash:a.digestAlgorithm});return K.sign(r,e,u)}).then(function(e){if(a.signatureValue=e,c(h.digestAlgorithms,a.digestAlgorithm,function(e,t){return e.id===t.id}),x.autoAddCert){h.certificates||(h.certificates=[]);for(var t=0,r=f.length;t<r;t++)c(h.certificates,f[t],function(e,t){return s(e.issuer,t.issuer)&&T(e.serialNumber,t.serialNumber)})}h.signerInfos.push(a)})},isDegenerate:{get:function(){return!(this.signerInfos&&this.signerInfos.length>0)}},verify:function(e,t){var r,n=this;return new S(o).then(function(){if(t&&n.setEnclosed(t),!n.signerInfos||0===n.signerInfos.length)throw new Error("No signatures found");return S.all(n.signerInfos.map(function(t,r){var i,o=t.sid,a=o instanceof B?{subjectKeyIdentifier:o}:{issuer:o.issuer,serialNumber:o.serialNumber};return t.signedAttrs&&t.signedAttrs.signingTime&&(i=t.signedAttrs.signingTime),e.getValidCertificate(a,n.certificates,n.crls,i).catch(function(){})}))}).then(function(e){var t=[];if(e.forEach(function(e){e&&t.push(n.verifySignature(e).then(function(e){r=e},function(){}))}),0===t.length)throw new Error("Valid verification path not found");return S.all(t)}).then(function(){if(!r)throw Error("Verification path found but no valid signature");return r})},verifySignature:function(e,r){var n,i,s,c=this;return new S(o).then(function(){if(r&&c.setEnclosed(r),!(i=c.encapContentInfo&&c.encapContentInfo.eContent))throw new Error("Detached content is not found");for(var o=0;o<c.signerInfos.length;o++){if(y(c.signerInfos[o].sid,e)){n=c.signerInfos[o];break}}if(!n)throw new Error("Signature not found for the certificate");if(n.signedAttrs){if(!(s=n.signedAttrs.messageDigest))throw new Error("Message digest must present in signed attributes");i=n.signedAttrs.encode()}if(!i)throw new Error("Data for verification not found");var a=t(n.signatureAlgorithm,{hash:n.digestAlgorithm});return e.verifySignature(i,n.signatureValue,a)}).then(function(e){if(!e)throw new Error("Signature not verified");if(n.signedAttrs)return K.digest(n.digestAlgorithm,c.encapContentInfo.eContent)}).then(function(e){if(e&&!a(e,s))throw new Error("Message digest not verified");return d({contentType:c.encapContentInfo.eContentType,content:c.encapContentInfo.eContent})})}}),m.prototype.SignedDataContentInfo=A,i(v,b,{encloseContent:function(e,r,n){var i,a,s=this;return new S(o).then(function(){if(e=h(e),!e.content)throw new Error("Content for encryption must be specified");var o="string"==typeof r?"pbes":"encryption";if(n){var s=I[n];n=s&&s[o]||n}else n=I[x.providerName][o];if(n.derivation){a=t(n.derivation),i=t(n.encryption),a.salt=p(l(n));var c;return K.importKey("raw",g(a,r),a,!1,["deriveKey","deriveBits"]).then(function(e){if(c=e,a.name.indexOf("PFXKDF")>=0)return a.diversifier=2,K.deriveBits(a,c,64)}).then(function(e){return e&&(i.iv=e),a.diversifier=1,K.deriveKey(a,c,i,!1,["encrypt"])}).then(function(e){return e})}if(i=t(n),r instanceof B)return K.importKey("raw",r,i,!1,["encrypt"]);if("secret"===r.type)return r;throw new Error("Content encryption key must be raw data or secret key type")}).then(function(t){return i.iv||(i.iv=p(8)),K.encrypt(i,t,e.content)}).then(function(r){return n.derivation?(delete a.diversifier,n=t(n,{derivation:a,encryption:i})):n=i,s.encryptedContentInfo={contentType:e.contentType,contentEncryptionAlgorithm:n,encryptedContent:r},s})},getEnclosed:function(e,r){var n,i,a,s=this;return new S(o).then(function(){if(r&&s.setEnclosed(r),!(a=s.encryptedContentInfo.encryptedContent))throw new Error("Encrypted content must be specified");if(n=t(s.encryptedContentInfo.contentEncryptionAlgorithm),n.derivation){i=t(n.derivation),n=t(n.encryption);var o;return K.importKey("raw",g(i,e),i,!1,["deriveKey","deriveBits"]).then(function(e){if(o=e,i.name.indexOf("PFXKDF")>=0)return i.diversifier=2,K.deriveBits(i,o,64)}).then(function(e){return e&&(n.iv=e),i.diversifier=1,K.deriveKey(i,o,n,!1,["decrypt"])})}if(e instanceof B)return K.importKey("raw",e,n,!1,["decrypt"]);if("secret"===e.type)return e;throw new Error("Decryption key must be raw data or secret key type")}).then(function(e){return K.decrypt(n,e,a)}).then(function(e){return d({contentType:s.encryptedContentInfo.contentType,content:e})})}}),m.prototype.EncryptedDataContentInfo=b,i(v,F,{encloseContent:function(e,t){var r=this;return new S(o).then(function(){if(e=h(e),!e.content)throw new Error("Content for encryption must be specified");if(t){var r=I[t];t=r&&r.encryption||t}else t=I[x.providerName].encryption;return K.generateKey(t,!0,["encrypt"])}).then(function(n){return r.contentEncryptionKey=n,t.iv||(t.iv=p(8)),K.encrypt(t,n,e.content)}).then(function(n){return r.encryptedContentInfo={contentType:e.contentType,contentEncryptionAlgorithm:t,encryptedContent:n},r})},addRecipient:function(e,r,n,i){var a,u,f,h,d=this;return new S(o).then(function(){if(e=new R.X509(e),r&&"string"!=typeof r&&!r.algorithm&&(i=n,n=r,r=void 0),u=r?I[r]:e.getProvider(),!d.contentEncryptionKey)throw new Error("The content encryption key is not assigned");if(i){var o;if(i instanceof Array?(o=i,i=o[0]):o=[i],x.autoAddCert){d.originatorInfo?d.originatorInfo.certs||(d.originatorInfo.certs=[]):d.originatorInfo={certs:[]};for(var a=0,f=o.length;a<f;a++)c(d.originatorInfo.certs,o[a],function(e,t){return s(e.issuer,t.issuer)&&T(e.serialNumber,t.serialNumber)})}if(u?r=t(u.agreement):u=e.getProvider(),e.subjectPublicKeyInfo.algorithm.namedCurve!==i.subjectPublicKeyInfo.algorithm.namedCurve)throw new Error("The sender and the recipient have different public key algorithms");return K.importKey("pkcs8",n.encode(),n.privateKeyAlgorithm,!1,["deriveKey"])}return u?r=t(e.subjectPublicKeyInfo.algorithm):u=e.getProvider(),K.generateKey(r,!0,["deriveKey"]).then(function(e){return r.public=e.publicKey,e.privateKey})}).then(function(t){return a=t,K.importKey("spki",e.subjectPublicKeyInfo.encode(),e.subjectPublicKeyInfo.algorithm,!1,["deriveKey","deriveBits"])}).then(function(e){return r.ukm=p(8),f=t(u.agreement,{sBox:r.sBox,ukm:r.ukm,public:e}),h=t(r.wrapping||u.wrapping,{ukm:r.ukm}),K.deriveKey(f,a,h,!0,["wrapKey"])}).then(function(e){return r.wrapping=h,K.wrapKey("raw",d.contentEncryptionKey,e,h)}).then(function(t){var n,o=x.useKeyIdentifier&&e.extensions&&e.extensions.subjectKeyIdentifier,a=o?e.extensions.subjectKeyIdentifier:{issuer:e.issuer,serialNumber:e.serialNumber};if(i){var s=i.subjectPublicKeyInfo;n={version:3,originator:{algorithm:s.algorithm,publicKey:s.subjectPublicKey},ukm:r.ukm,keyEncryptionAlgorithm:r,recipientEncryptedKeys:[{rid:a,encryptedKey:P.GostEncryptedKey(r).encode(t)}]}}else n={version:0,rid:a,keyEncryptionAlgorithm:r,encryptedKey:P.GostEncryptedKey(r).encode({algorithm:r,sessionEncryptedKey:t})};return d.recipientInfos.push(n),d})},getEnclosed:function(e,r,n,i){var a,s,c,u,f,h=this;return new S(o).then(function(){var e=r.getProvider();if(n&&h.setEnclosed(n),!(s=h.encryptedContentInfo.encryptedContent))throw new Error("Encrypted content must be specified");f=h.encryptedContentInfo.contentEncryptionAlgorithm;for(var o=0;o<h.recipientInfos.length;o++){var d=h.recipientInfos[o],p=t(d.keyEncryptionAlgorithm);if(d.rid){if(y(d.rid,r)){var l=P.GostEncryptedKey(p).decode(d.encryptedKey).object;return a=l.sessionEncryptedKey,p=t(p,l.algorithm),c=t(e.agreement,{ukm:p.ukm,sBox:p.sBox}),u=t(e.wrapping,p.wrapping,{ukm:p.ukm}),p.public}}else{var g=d.recipientEncryptedKeys;if(g)for(var m=0;m<g.length;m++)if(y(g[m].rid,r)){p=t(e.agreement,p,{ukm:d.ukm}),a=P.GostEncryptedKey(p).decode(g[m].encryptedKey).object,c=p,u=t(p.wrapping||e.wrapping,{ukm:d.ukm});var v=d.originator;if(v.algorithm){var C=new P.SubjectPublicKeyInfo({algorithm:v.algorithm,subjectPublicKey:v.publicKey});return K.importKey("spki",C.encode(),C.algorithm,!1,["deriveKey","deriveBits"])}if(i&&y(v,i))return importKey("pkcs",i.subjectPublicKeyInfo.encode(),i.subjectPublicKeyInfo.algorithm,!1,["deriveKey","deriveBits"]);throw Error("Originator certificate not specified or not valid")}}}throw new Error("Recipient not found or format not supported")}).then(function(t){return c.public=t,K.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,!1,["deriveKey","deriveBits"])}).then(function(e){return K.deriveKey(c,e,u,!0,["unwrapKey"])}).then(function(e){return K.unwrapKey("raw",a,e,u,f,!1,["decrypt"])}).then(function(e){return K.decrypt(f,e,s)}).then(function(e){return d({contentType:h.encryptedContentInfo.contentType,content:e})})}}),m.prototype.EnvelopedDataContentInfo=F,e.cms=new m,m})},function(e,t,r){!function(t,n){e.exports=n(r(1),r(7))}(0,function(e,t){function r(e,t,r,n,i,o,a){for(var s=16383&r,c=r>>14;--a>=0;){var u=16383&e[t],f=e[t++]>>14,h=c*u+f*s;u=s*u+((16383&h)<<14)+n[i]+o,o=(u>>28)+(h>>14)+c*f,n[i++]=268435455&u}return o}function n(e){var t=new Array(Math.ceil(e));return t.s=0,t.t=0,t}function i(e,t){for(var r=e.t-1;r>=0;--r)t[r]=e[r];return t.t=e.t,t.s=e.s,t}function o(e){return i(e,n(e.t))}function a(e,t){return e.t=1,e.s=t<0?-1:0,t>0?e[0]=t:t<-1?e[0]=t+je:e.t=0,e}function s(e){var t=n(1);return a(t,e),t}function c(e){for(var t=e.s&Le;e.t>0&&e[e.t-1]===t;)--e.t;return e}function u(e,t,r){for(var n=0,i=0,o=Math.min(t.t,e.t);n<o;)i+=e[n]-t[n],r[n++]=i&Le,i>>=He;if(t.t<e.t){for(i-=t.s;n<e.t;)i+=e[n],r[n++]=i&Le,i>>=He;i+=e.s}else{for(i+=e.s;n<t.t;)i-=t[n],r[n++]=i&Le,i>>=He;i-=t.s}return r.s=i<0?-1:0,i<-1?r[n++]=je+i:i>0&&(r[n++]=i),r.t=n,c(r)}function f(e,t){return u(e,t,n(e.t))}function h(e,t,r){for(var n=0,i=0,o=Math.min(t.t,e.t);n<o;)i+=e[n]+t[n],r[n++]=i&Le,i>>=He;if(t.t<e.t){for(i+=t.s;n<e.t;)i+=e[n],r[n++]=i&Le,i>>=He;i+=e.s}else{for(i+=e.s;n<t.t;)i+=t[n],r[n++]=i&Le,i>>=He;i+=t.s}return r.s=i<0?-1:0,i>0?r[n++]=i:i<-1&&(r[n++]=je+i),r.t=n,c(r)}function d(e,t){return h(e,t,n(e.t))}function y(e,t){return u(Xe,e,t)}function p(e){return y(e,n(e.t))}function l(e){return e.s<0?p(e):e}function g(e,t){var r=e.s-t.s;if(0!==r)return r;var n=e.t;if(0!==(r=n-t.t))return e.s<0?-r:r;for(;--n>=0;)if(0!=(r=e[n]-t[n]))return r;return 0}function m(e,t){return 0===g(e,t)}function v(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function C(e,t,r){var n;for(n=e.t-1;n>=0;--n)r[n+t]=e[n];for(n=t-1;n>=0;--n)r[n]=0;return r.t=e.t+t,r.s=e.s,r}function A(e,t,r){for(var n=t;n<e.t;++n)r[n-t]=e[n];return r.t=Math.max(e.t-t,0),r.s=e.s,r}function b(e,t,r){var n,i=t%He,o=He-i,a=(1<<o)-1,s=Math.floor(t/He),u=e.s<<i&Le;for(n=e.t-1;n>=0;--n)r[n+s+1]=e[n]>>o|u,u=(e[n]&a)<<i;for(n=s-1;n>=0;--n)r[n]=0;return r[s]=u,r.t=e.t+s+1,r.s=e.s,c(r)}function F(e,t,r){r.s=e.s;var n=Math.floor(t/He);if(n>=e.t)return void(r.t=0);var i=t%He,o=He-i,a=(1<<i)-1;r[0]=e[n]>>i;for(var s=n+1;s<e.t;++s)r[s-n-1]|=(e[s]&a)<<o,r[s-n]=e[s]>>i;return i>0&&(r[e.t-n-1]|=(e.s&a)<<o),r.t=e.t-n,c(r)}function w(e,t){var r=n(e.t);return t<0?F(e,-t,r):b(e,t,r),r}function S(e){return e.t<=0?0:He*(e.t-1)+v(e[e.t-1]^e.s&Le)}function E(e,t,n){var i=l(e),o=l(t),a=i.t;for(n.t=a+o.t;--a>=0;)n[a]=0;for(a=0;a<o.t;++a)n[a+i.t]=r(i,0,o[a],n,a,0,i.t);return n.s=0,e.s!==t.s&&u(Xe,n,n),c(n)}function B(e,t){return E(e,t,n(e.t+t.t))}function D(e,t){for(var n=l(e),i=t.t=2*n.t;--i>=0;)t[i]=0;for(i=0;i<n.t-1;++i){var o=r(n,i,n[i],t,2*i,0,1);(t[i+n.t]+=r(n,i+1,2*n[i],t,2*i+1,o,n.t-i-1))>=n.DV&&(t[i+n.t]-=n.DV,t[i+n.t+1]=1)}return t.t>0&&(t[t.t-1]+=r(n,i,n[i],t,2*i,0,1)),t.s=0,c(t)}function K(e){return D(e,n(2*e.t))}function P(e,t,o,s){var f=l(t);if(f.t<=0)throw new Ge("Division by zero");var h=l(e);if(h.t<f.t)return o&&a(o,0),s&&i(e,s),o;s||(s=n(t.t));var d=n(t.t),y=e.s,p=t.s,m=He-v(f[f.t-1]);m>0?(b(f,m,d),b(h,m,s)):(i(f,d),i(h,s));var w=d.t,S=d[w-1];if(0===S)return o;var E=S*(1<<Ve)+(w>1?d[w-2]>>qe:0),B=We/E,D=(1<<Ve)/E,K=1<<qe,P=s.t,k=P-w,R=o||n(Math.max(e.t-t.t,1));for(C(d,k,R),g(s,R)>=0&&(s[s.t++]=1,u(s,R,s)),C(ze,w,R),u(R,d,d);d.t<w;)d[d.t++]=0;for(;--k>=0;){var I=s[--P]===S?Le:Math.floor(s[P]*B+(s[P-1]+K)*D);if((s[P]+=r(d,0,I,s,k,0,w))<I)for(C(d,k,R),u(s,R,s);s[P]<--I;)u(s,R,s)}return o&&(A(s,w,o),y!==p&&u(Xe,o,o)),s.t=w,c(s),m>0&&F(s,m,s),y<0&&u(Xe,s,s),o}function k(e,t,r){return P(l(e),t,null,r),e.s<0&&g(r,Xe)>0&&u(t,r,r),r}function R(e,t){return k(e,t,n(t.t))}function I(e,t){return P(e,t,n(Math.max(e.t-t.t,1)),null)}function T(e){return 0===(e.t>0?1&e[0]:e.s)}function x(e){return m(e,Xe)}function G(e){return e.s<0?-1:e.t<=0||1===e.t&&e[0]<=0?0:1}function U(e,t){var r=T(t);if(T(e)&&r||0===G(t))return Xe;for(var n=o(t),i=o(e),a=s(1),c=s(0),f=s(0),y=s(1);0!==G(n);){for(;T(n);)F(n,1,n),r?(T(a)&&T(c)||(h(a,e,a),u(c,t,c)),F(a,1,a)):T(c)||u(c,t,c),F(c,1,c);for(;T(i);)F(i,1,i),r?(T(f)&&T(y)||(h(f,e,f),u(y,t,y)),F(f,1,f)):T(y)||u(y,t,y),F(y,1,y);g(n,i)>=0?(u(n,i,n),r&&u(a,f,a),u(c,y,c)):(u(i,n,i),r&&u(f,a,f),u(y,c,y))}return 0!==g(i,ze)?Xe:g(y,t)>=0?subtract(y,t):G(y)<0?(h(y,t,y),G(y)<0?d(y,t):y):y}function O(e,t){var r=Math.floor(t/He);return r>=e.t?0!==e.s:0!=(e[r]&1<<t%He)}function N(e){return e}function M(e,t){for(var r in t)e.prototype[r]=t[r]}function H(e){if(e.t<1)return 0;var t=e[0];if(0==(1&t))return 0;var r=3&t;return r=r*(2-(15&t)*r)&15,r=r*(2-(255&t)*r)&255,r=r*(2-((65535&t)*r&65535))&65535,r=r*(2-t*r%je)%je,r>0?je-r:-r}function L(e,t,r){if(0!==t){for(;e.t<=r;)e[e.t++]=0;for(e[r]+=t;e[r]>=je;)e[r]-=je,++r>=e.t&&(e[e.t++]=0),++e[r]}}function j(e,t,n,i){var o=Math.min(e.t+t.t,n);for(i.s=0,i.t=o;o>0;)i[--o]=0;var a;for(a=i.t-e.t;o<a;++o)i[o+e.t]=r(e,0,t[o],i,o,0,e.t);for(a=Math.min(t.t,n);o<a;++o)r(e,0,t[o],i,o,0,n-o);return c(i)}function W(e,t,n,i){--n;var o=i.t=e.t+t.t-n;for(i.s=0;--o>=0;)i[o]=0;for(o=Math.max(n-e.t,0);o<t.t;++o)i[e.t+o-n]=r(e,n-o,t[o],i,0,0,e.t+o-n);return c(i),A(i,1,i)}function V(e){this.r2=n(2*e.t),this.q3=n(2*e.t),C(ze,2*e.t,this.r2),this.mu=I(this.r2,e),this.m=e}function q(e,t,r){var o,a,c=S(t),u=s(1);if(c<=0)return u;o=c<18?1:c<48?3:c<144?4:c<768?5:6,a=c<8?new Ze(r):T(r)?new V(r):new Je(r);var f=new Array,h=3,d=o-1,y=(1<<o)-1;if(f[1]=a.convert(e),o>1){var p=n(2*r.t);for(a.sqrTo(f[1],p);h<=y;)f[h]=n(2*r.t),a.mulTo(p,f[h-2],f[h]),h+=2}var l,g,m=t.t-1,C=!0,A=n(2*r.t);for(c=v(t[m])-1;m>=0;){for(c>=d?l=t[m]>>c-d&y:(l=(t[m]&(1<<c+1)-1)<<d-c,m>0&&(l|=t[m-1]>>He+c-d)),h=o;0==(1&l);)l>>=1,--h;if((c-=h)<0&&(c+=He,--m),C)i(f[l],u),C=!1;else{for(;h>1;)a.sqrTo(u,A),a.sqrTo(A,u),h-=2;h>0?a.sqrTo(u,A):(g=u,u=A,A=g),a.mulTo(A,f[l],u)}for(;m>=0&&0==(t[m]&1<<c);)a.sqrTo(u,A),g=u,u=A,A=g,--c<0&&(c=He-1,--m)}return a.revert(u)}function X(e,t){return e.r.reduce(t),t.q=e.q,t.r=e.r,t}function z(e,t){return t.q=e.q,t.r=e.r,t}function Y(e){return z(e,f(e.q,e))}function Z(e,t){var r=d(e,t);return g(r,e.q)>0&&u(r,e.q,r),z(e,r)}function J(e,t){var r=f(e,t);return r.s<0&&h(e.q,r,r),z(e,r)}function Q(e,t){return X(e,B(e,t))}function _(e){return X(e,K(e))}function $(e,t){return X(e,w(e,t))}function ee(e){return z(e,U(e,e.q))}function te(e,t,r,n){return{curve:e,x:t,y:r,z:n||X(e,ze)}}function re(e){return e.zinv||(e.zinv=ee(e.z)),Q(e.x,e.zinv)}function ne(e){return e.zinv||(e.zinv=ee(e.z)),Q(e.y,e.zinv)}function ie(e){return!e.x&&!e.y||x(e.z)&&!x(e.y)}function oe(e){return e.curve.infinity}function ae(e){return te(e.curve,e.x,Y(e.y),e.z)}function se(e,t){if(ie(e))return t;if(ie(t))return e;var r=J(Q(t.y,e.z),Q(e.y,t.z)),n=J(Q(t.x,e.z),Q(e.x,t.z));if(x(n))return x(r)?ce(e):oe(e);var i=e.x,o=e.y,a=_(n),s=Q(a,n),c=Q(i,a),u=Q(_(r),e.z),f=Q(J(Q(J(u,$(c,1)),t.z),s),n),h=Z(Q(J(J(Q(Q(c,Ye),r),Q(o,s)),Q(u,r)),t.z),Q(r,s)),d=Q(Q(s,e.z),t.z);return te(e.curve,f,h,d)}function ce(e){if(ie(e))return e;if(0===G(e.y))return oe(e);var t=e.x,r=e.y,n=Q(r,e.z),i=Q(n,r),o=e.curve.a,a=Q(_(t),Ye);x(o)||(a=Z(a,Q(_(e.z),o)));var s=Q($(J(_(a),Q($(t,3),i)),1),n),c=J(Q($(J(Q(Q(a,Ye),t),$(i,1)),2),i),Q(_(a),a)),u=$(Q(_(n),n),3);return te(e.curve,s,c,u)}function ue(e,t){if(ie(e))return e;if(0===G(t))return oe(e);var r,n=t,i=B(n,Ye),o=ae(e),a=e;for(r=S(i)-2;r>0;--r){a=ce(a);var s=O(i,r);s!==O(n,r)&&(a=se(a,s?e:o))}return a}function fe(e,t,r,n){var i;i=S(t)>S(n)?S(t)-1:S(n)-1;for(var o=oe(e),a=se(e,r);i>=0;)o=ce(o),O(t,i)?o=O(n,i)?se(o,a):se(o,e):O(n,i)&&(o=se(o,r)),--i;return o}function he(e,t,r){var n={};return n.q=e,n.r=new V(e),n.a=X(n,t),n.b=X(n,r),n.infinity=te(n),n}function de(e){var t=new Uint8Array(e),r=n(8*t.length/He);r.t=0,r.s=0;for(var i=0,o=0,a=t.length;o<a;o++){var s=t[o];0===i?r[r.t++]=s:i+8>He?(r[r.t-1]|=(s&(1<<He-i)-1)<<i,r[r.t++]=s>>He-i):r[r.t-1]|=s<<i,i+=8,i>=He&&(i-=He)}return c(r)}function ye(e,t){var r,n=!1,i=[],o=e.t,a=He-o*He%8;if(o-- >0)for(a<He&&(r=e[o]>>a)>0&&(n=!0,i.push(r));o>=0;)a<8?(r=(e[o]&(1<<a)-1)<<8-a,r|=e[--o]>>(a+=He-8)):(r=e[o]>>(a-=8)&255,a<=0&&(a+=He,--o)),r>0&&(n=!0),n&&i.push(r);var s=new Uint8Array(t?t/8:i.length);return n&&s.set(i.reverse()),s.buffer}function pe(e){if("number"==typeof e||e instanceof Number)return s(e);(e=e.replace(/[^\-A-Fa-f0-9]/g,""))||(e="0");for(var t=n(e.length/7),r=e.length,i=!1,o=0;--r>=0;){if("-"!==e.charAt(r)){var a=parseInt(e.charAt(r),16);i=!1,0===o?t[t.t++]=a:o+4>He?(t[t.t-1]|=(a&(1<<He-o)-1)<<o,t[t.t++]=a>>He-o):t[t.t-1]|=a<<o,o+=4,o>=He&&(o-=He)}else i=!0}return i&&u(Xe,t,t),c(t)}function le(e){if(e.s<0)return"-"+le(y(e,n(e.t)));var t,r=!1,i="",o=e.t,a=He-o*He%4;if(o-- >0)for(a<He&&(t=e[o]>>a)>0&&(r=!0,i=t.toString(16));o>=0;)a<4?(t=(e[o]&(1<<a)-1)<<4-a,t|=e[--o]>>(a+=He-4)):(t=e[o]>>(a-=4)&15,a<=0&&(a+=He,--o)),t>0&&(r=!0),r&&(i+=t.toString(16));return"0x"+(r?i:"0")}function ge(e){for(var t=new Uint8Array(e),r=new Uint8Array(t.length),n=0,i=t.length;n<i;n++)r[i-n-1]=t[n];return r.buffer}function me(e){return this.hash&&(e=this.hash.digest(e)),("SC"===this.procreator||"VN"===this.procreator&&2012===this.hash.version)&&(e=ge(e)),e}function ve(e){if(e instanceof xe)return e;if(e&&e.buffer&&e.buffer instanceof xe)return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;throw new Ue("CryptoOperationData or CryptoOperationDataView required")}function Ce(e){var t=ve(e);if(t.byteLength%2>0)throw new Ue("Buffer length must be even");var r=t.byteLength/2;return[de(new Uint8Array(t,0,r)),de(new Uint8Array(t,r,r))]}function Ae(e,t,r){var n=ye(e,r),i=ye(t,r),o=new Uint8Array(n.byteLength+i.byteLength);return o.set(new Uint8Array(n)),o.set(new Uint8Array(i),n.byteLength),o.buffer}function be(t){e=e||Ie.GostRandom;var r=e?new(e||Ie.GostRandom):Te;if(r.getRandomValues){var n=new Uint8Array(Math.ceil(t/8));return r.getRandomValues(n),n}throw new Oe("Random generator not found")}function Fe(e,t){var r=ve(t),n=de(me.call(this,r)),i=this.q,o=R(de(ve(e)),i),a=R(n,i);x(a)&&(a=ze);for(var s=Xe;x(s);){for(var c=Xe;x(c);){var u=R(de(this.ukm||be(this.bitLength)),i);if(this.curve){c=R(re(ue(this.P,u)),i)}else{var f=this.p;c=R(q(this.a,u,f),i)}}s=R(d(B(c,o),B(u,a)),i)}var h;return"SC"===this.procreator?h={r:le(c),s:le(s)}:(h=Ae(c,s,this.bitLength),"CP"!==this.procreator&&"VN"!==this.procreator||(h=ge(h))),h}function we(e,t,r){var n,i,o=this.q;if("SC"===this.procreator)n=pe(t.r),i=pe(t.s);else{"CP"!==this.procreator&&"VN"!==this.procreator||(t=ge(t));var a=Ce(t);i=a[1],n=a[0]}if(g(n,o)>=0||g(i,o)>=0)return!1;var s=ve(r),c=de(me.call(this,s)),u=R(c,o);0===x(u)&&(u=ze);var h=U(u,o),d=R(B(i,h),o),y=f(o,R(B(n,h),o));if(this.curve)var p=Ce(e),l=this.curve,m=this.P,v=X(l,p[0]),C=X(l,p[1]),A=new te(l,v,C),b=fe(m,d,A,y),F=R(re(b),o);else var w=this.p,S=this.a,C=de(e),F=R(R(B(q(S,d,w),q(C,y,w)),w),o);return 0===g(F,n)}function Se(){var e=this.curve;if(e){for(var t=e.infinity;ie(t);){var r=Xe;if(this.ukm)r=de(this.ukm);else for(;x(r);)r=R(de(be(this.bitLength)),this.q);t=ue(this.P,r);var n=re(t),i=ne(t)}return{privateKey:ye(r,this.bitLength),publicKey:Ae(n,i,this.bitLength)}}throw new Oe("Key generation for GOST R 34.10-94 not supported")}function Ee(){if(this.curve){for(var e=Xe;x(e);)e=R(de(be(this.bitLength)),this.q);return ye(e,this.bitLength)}throw new Oe("Key generation for GOST R 34.10-94 not supported")}function Be(e,t){if(this.curve){var r=this.q,n=R(de(ve(t)),r),i=R(de(ve(e)),r);return ye("VN"===this.procreator?R(B(n,i),r):R(B(n,U(i,r)),r))}throw new Oe("Key wrapping GOST R 34.10-94 not supported")}function De(e,t){if(this.curve){var r=this.q,n=R(de(ve(t)),r),i=R(de(ve(e)),r);return ye("VN"===this.procreator?R(B(n,U(i,r)),r):R(B(n,i),r))}throw new Oe("Key wrapping GOST R 34.10-94 not supported")}function Ke(e){var t,r=de(this.ukm),n=this.q,i=R(de(ve(e)),n);if(this.curve){var o=ue(this.peer_Q,R(B(r,i),n));t=Ae(re(o),ne(o),this.bitLength)}else{var a=this.p;this.a;t=ye(q(this.peer_y,i,a))}return me.call(this,t)}function Pe(e,t){if(t<8||t>this.bitLength||t%8>0)throw new Ue("Length must be no more than "+this.bitLength+" bits and multiple of 8");var r=t/8,n=Ke.call(this,e),i=new Uint8Array(r);return i.set(new Uint8Array(n,0,r)),i.buffer}function ke(e){var t=Ke.call(this,e),r=new Uint8Array(32);return r.set(new Uint8Array(t,0,32)),r.buffer}function Re(e){e=e||{},this.name=(e.name||"GOST R 34.10")+"-"+(e.version||2012)%100+"-"+(e.length||256)+("SIGN"!==(e.mode||"SIGN")?"-"+e.mode:"")+("string"==typeof e.namedParam?"/"+e.namedParam:"")+("string"==typeof e.namedCurve?"/"+e.namedCurve:"")+("string"==typeof e.sBox?"/"+e.sBox:"");var r=e.version||2012;switch(e.mode||"SIGN"){case"SIGN":this.sign=Fe,this.verify=we,this.generateKey=Se;break;case"DH":this.deriveBits=Pe,this.deriveKey=ke,this.generateKey=Se;break;case"MASK":this.wrapKey=De,this.unwrapKey=Be,this.generateKey=Ee}if(1994===r){var n=e.param;n||(n=Me[this.namedParam=(e.namedParam||"S-A").toUpperCase()]),this.modulusLength=e.modulusLength||n.modulusLength||1024,this.p=pe(n.p),this.q=pe(n.q),this.a=pe(n.a),e.public&&(this.peer_y=de(e.public))}else{var n=e.curve;n||(n=Ne[this.namedCurve=(e.namedCurve||"S-256-A").toUpperCase()]);var i=this.curve=he(pe(n.p),pe(n.a),pe(n.b));if(this.P=te(i,X(i,pe(n.x)),X(i,pe(n.y))),this.q=pe(n.q),e.public){var o=Ce(e.public);this.peer_Q=new te(this.curve,X(this.curve,o[0]),X(this.curve,o[1]))}}var a,s;if(this.curve){if((s=e.length||S(this.q))>508&&s<=512)s=512;else{if(!(s>254&&s<=256))throw new Oe("Support keys only 256 or 512 bits length");s=256}a=s}else{if((s=e.modulusLength||S(this.p))>1016&&s<=1024)s=1024;else{if(!(s>508&&s<=512))throw new Oe("Support keys only 512 or 1024 bits length");s=512}a=256}this.bitLength=a,this.keyLength=s,this.procreator=e.procreator;var c=e.hash;if(c){if(("string"==typeof c||c instanceof String)&&(c={name:c}),1994===e.version||2001===e.version?(c.version=1994,c.length=256,c.sBox=e.sBox||c.sBox):(c.version=2012,c.length=a),c.procreator=c.procreator||e.procreator,t||(t=Ie.GostDigest),!t)throw new Oe("Object GostDigest not found");this.hash=new t(c)}e.ukm&&(this.ukm=e.ukm)}var Ie=this,Te=Ie.crypto||Ie.msCrypto,xe=Ie.ArrayBuffer,Ge=Ie.OperationError||Ie.Error,Ue=Ie.DataError||Ie.Error,Oe=Ie.NotSupportedError||Ie.Error,Ne={"S-256-TEST":{a:7,b:"0x5FBFF498AA938CE739B8E022FBAFEF40563F6E6A3472FC2A514C0CE9DAE23B7E",p:"0x8000000000000000000000000000000000000000000000000000000000000431",q:"0x8000000000000000000000000000000150FE8A1892976154C59CFC193ACCF5B3",x:2,y:"0x8E2A8A0E65147D4BD6316030E16D19C85C97F0A9CA267122B96ABBCEA7E8FC8"},"S-256-A":{a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD94",b:166,p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD97",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C611070995AD10045841B09B761B893",x:1,y:"0x8D91E471E0989CDA27DF505A453F2B7635294F2DDF23E3B122ACC99C9E9F1E14"},"S-256-B":{a:"0x8000000000000000000000000000000000000000000000000000000000000C96",b:"0x3E1AF419A269A5F866A7D3C25C3DF80AE979259373FF2B182F49D4CE7E1BBC8B",p:"0x8000000000000000000000000000000000000000000000000000000000000C99",q:"0x800000000000000000000000000000015F700CFFF1A624E5E497161BCC8A198F",x:1,y:"0x3FA8124359F96680B83D1C3EB2C070E5C545C9858D03ECFB744BF8D717717EFC"},"S-256-C":{a:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D7598",b:32858,p:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D759B",q:"0x9B9F605F5A858107AB1EC85E6B41C8AA582CA3511EDDFB74F02F3A6598980BB9",x:0,y:"0x41ECE55743711A8C3CBF3783CD08C0EE4D4DC440D4641A8F366E550DFDB3BB67"},"P-256":{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"},"T-512-TEST":{a:7,b:"0x1CFF0806A31116DA29D8CFA54E57EB748BC5F377E49400FDD788B649ECA1AC4361834013B2AD7322480A89CA58E0CF74BC9E540C2ADD6897FAD0A3084F302ADC",p:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DF1D852741AF4704A0458047E80E4546D35B8336FAC224DD81664BBF528BE6373",q:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DA82F2D7ECB1DBAC719905C5EECC423F1D86E25EDBE23C595D644AAF187E6E6DF",x:"0x24D19CC64572EE30F396BF6EBBFD7A6C5213B3B3D7057CC825F91093A68CD762FD60611262CD838DC6B60AA7EEE804E28BC849977FAC33B4B530F1B120248A9A",y:"0x2BB312A43BD2CE6E0D020613C857ACDDCFBF061E91E5F2C3F32447C259F39B2C83AB156D77F1496BF7EB3351E1EE4E43DC1A18B91B24640B6DBB92CB1ADD371E"},"T-512-A":{p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7",a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4",b:"0xE8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879BD081CFD0B6265EE3CB090F30D27614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27E69532F48D89116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275",x:3,y:"0x7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC1778064FDCBEFA921DF1626BE4FD036E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4"},"T-512-B":{p:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006F",a:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006C",b:"0x687D1B459DC841457E3E06CF6F5E2517B97C7D614AF138BCBF85DC806C4B289F3E965D2DB1416D217F8B276FAD1AB69C50F78BEE1FA3106EFB8CCBC7C5140116",q:"0x800000000000000000000000000000000000000000000000000000000000000149A1EC142565A545ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD",x:2,y:"0x1A8F7EDA389B094C2C071E3647A8940F3C123B697578C213BE6DD9E6C8EC7335DCB228FD1EDF4A39152CBCAAF8C0398828041055F94CEEEC7E21340780FE41BD"}};Ne["X-256-A"]=Ne["S-256-A"],Ne["X-256-B"]=Ne["S-256-C"],Ne["T-256-TEST"]=Ne["S-256-TEST"],Ne["T-256-A"]=Ne["S-256-A"],Ne["T-256-B"]=Ne["S-256-B"],Ne["T-256-C"]=Ne["S-256-C"];var Me={"S-TEST":{modulusLength:512,p:"0xEE8172AE8996608FB69359B89EB82A69854510E2977A4D63BC97322CE5DC3386EA0A12B343E9190F23177539845839786BB0C345D165976EF2195EC9B1C379E3",q:"0x98915E7EC8265EDFCDA31E88F24809DDB064BDC7285DD50D7289F0AC6F49DD2D",a:"0x9e96031500c8774a869582d4afde2127afad2538b4b6270a6f7c8837b50d50f206755984a49e509304d648be2ab5aab18ebe2cd46ac3d8495b142aa6ce23e21c"},"S-A":{modulusLength:1024,p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"},"S-B":{modulusLength:1024,p:"0xC6971FC57524B30C9018C5E621DE15499736854F56A6F8AEE65A7A404632B1BCF0349FFCAFCB0A103177971FC1612ADCDB8C8CC938C70225C8FD12AFF01B1D064E0AD6FDE6AB9159166CB9F2FC171D92F0CC7B6A6B2CD7FA342ACBE2C9315A42D576B1ECCE77A963157F3D0BD96A8EB0B0F3502AD238101B05116334F1E5B7AB",q:"0xB09D634C10899CD7D4C3A7657403E05810B07C61A688BAB2C37F475E308B0607",a:"0x3D26B467D94A3FFC9D71BF8DB8934084137264F3C2E9EB16DCA214B8BC7C872485336744934FD2EF5943F9ED0B745B90AA3EC8D70CDC91682478B664A2E1F8FB56CEF2972FEE7EDB084AF746419B854FAD02CC3E3646FF2E1A18DD4BEB3C44F7F2745588029649674546CC9187C207FB8F2CECE8E2293F68395C4704AF04BAB5"},"S-C":{modulusLength:1024,p:"0x9D88E6D7FE3313BD2E745C7CDD2AB9EE4AF3C8899E847DE74A33783EA68BC30588BA1F738C6AAF8AB350531F1854C3837CC3C860FFD7E2E106C3F63B3D8A4C034CE73942A6C3D585B599CF695ED7A3C4A93B2B947B7157BB1A1C043AB41EC8566C6145E938A611906DE0D32E562494569D7E999A0DDA5C879BDD91FE124DF1E9",q:"0xFADD197ABD19A1B4653EECF7ECA4D6A22B1F7F893B641F901641FBB555354FAF",a:"0x7447ED7156310599070B12609947A5C8C8A8625CF1CF252B407B331F93D639DDD1BA392656DECA992DD035354329A1E95A6E32D6F47882D960B8F10ACAFF796D13CD9611F853DAB6D2623483E46788708493937A1A29442598AEC2E0742022563440FE9C18740ECE6765AC05FAF024A64B026E7E408840819E962E7E5F401AE3"},"S-D":{modulusLength:1024,p:"0x80F102D32B0FD167D069C27A307ADAD2C466091904DBAA55D5B8CC7026F2F7A1919B890CB652C40E054E1E9306735B43D7B279EDDF9102001CD9E1A831FE8A163EED89AB07CF2ABE8242AC9DEDDDBF98D62CDDD1EA4F5F15D3A42A6677BDD293B24260C0F27C0F1D15948614D567B66FA902BAA11A69AE3BCEADBB83E399C9B5",q:"0xF0F544C418AAC234F683F033511B65C21651A6078BDA2D69BB9F732867502149",a:"0x6BCC0B4FADB3889C1E06ADD23CC09B8AB6ECDEDF73F04632595EE4250005D6AF5F5ADE44CB1E26E6263C672347CFA26F9E9393681E6B759733784CDE5DBD9A14A39369DFD99FA85CC0D10241C4010343F34A91393A706CF12677CBFA1F578D6B6CFBE8A1242CFCC94B3B653A476E145E3862C18CC3FED8257CFEF74CDB205BF1"},"X-A":{modulusLength:1024,p:"0xCA3B3F2EEE9FD46317D49595A9E7518E6C63D8F4EB4D22D10D28AF0B8839F079F8289E603B03530784B9BB5A1E76859E4850C670C7B71C0DF84CA3E0D6C177FE9F78A9D8433230A883CD82A2B2B5C7A3306980278570CDB79BF01074A69C9623348824B0C53791D53C6A78CAB69E1CFB28368611A397F50F541E16DB348DBE5F",q:"0xCAE4D85F80C147704B0CA48E85FB00A9057AA4ACC44668E17F1996D7152690D9",a:"0xBE27D652F2F1E339DA734211B85B06AE4DE236AA8FBEEB3F1ADCC52CD43853777E834A6A518138678A8ADBD3A55C70A7EAB1BA7A0719548677AAF4E609FFB47F6B9D7E45B0D06D83D7ADC53310ABD85783E7317F7EC73268B6A9C08D260B85D8485696CA39C17B17F044D1E050489036ABD381C5E6BF82BA352A1AFF136601AF"},"X-B":{modulusLength:1024,p:"0x9286DBDA91ECCFC3060AA5598318E2A639F5BA90A4CA656157B2673FB191CD0589EE05F4CEF1BD13508408271458C30851CE7A4EF534742BFB11F4743C8F787B11193BA304C0E6BCA25701BF88AF1CB9B8FD4711D89F88E32B37D95316541BF1E5DBB4989B3DF13659B88C0F97A3C1087B9F2D5317D557DCD4AFC6D0A754E279",q:"0xC966E9B3B8B7CDD82FF0F83AF87036C38F42238EC50A876CD390E43D67B6013F",a:"0x7E9C3096676F51E3B2F9884CF0AC2156779496F410E049CED7E53D8B7B5B366B1A6008E5196605A55E89C3190DABF80B9F1163C979FCD18328DAE5E9048811B370107BB7715F82091BB9DE0E33EE2FED6255474F8769FCE5EAFAEEF1CB5A32E0D5C6C2F0FC0B3447072947F5B4C387666993A333FC06568E534AD56D2338D729"},"X-C":{modulusLength:1024,p:"0xB194036ACE14139D36D64295AE6C50FC4B7D65D8B340711366CA93F383653908EE637BE428051D86612670AD7B402C09B820FA77D9DA29C8111A8496DA6C261A53ED252E4D8A69A20376E6ADDB3BDCD331749A491A184B8FDA6D84C31CF05F9119B5ED35246EA4562D85928BA1136A8D0E5A7E5C764BA8902029A1336C631A1D",q:"0x96120477DF0F3896628E6F4A88D83C93204C210FF262BCCB7DAE450355125259",a:"0x3F1817052BAA7598FE3E4F4FC5C5F616E122CFF9EBD89EF81DC7CE8BF56CC64B43586C80F1C4F56DD5718FDD76300BE336784259CA25AADE5A483F64C02A20CF4A10F9C189C433DEFE31D263E6C9764660A731ECCAECB74C8279303731E8CF69205BC73E5A70BDF93E5BB681DAB4EEB9C733CAAB2F673C475E0ECA921D29782E"}},He=28,Le=(1<<He)-1,je=1<<He,We=Math.pow(2,52),Ve=52-He,qe=2*He-52,Xe=s(0),ze=s(1),Ye=s(3),Ze=function(e){this.m=e};M(Ze,{convert:function(e){return e.s<0||g(e,this.m)>=0?R(e,this.m):e},revert:N,reduce:function(e){k(e,this.m,e)},sqrTo:function(e,t){D(e,t),this.reduce(t)},mulTo:function(e,t,r){E(e,t,r),this.reduce(r)}});var Je=function(e){this.m=e,this.mp=H(e),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<He-15)-1,this.mt2=2*e.t};return M(Je,{convert:function(e){var t=n(e.t);return C(l(e),this.m.t,t),P(t,this.m,null,t),e.s<0&&g(t,Xe)>0&&u(this.m,t,t),t},revert:function(e){var t=n(e.t);return i(e,t),this.reduce(t),t},reduce:function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var n=32767&e[t],i=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&Le;for(n=t+this.m.t,e[n]+=r(this.m,0,i,e,t,0,this.m.t);e[n]>=je;)e[n]-=je,e[++n]++}c(e),A(e,this.m.t,e),g(e,this.m)>=0&&u(e,this.m,e)},sqrTo:function(e,t){D(e,t),this.reduce(t)},mulTo:function(e,t,r){E(e,t,r),this.reduce(r)}}),M(V,{convert:function(e){if(e.s<0||e.t>2*this.m.t)return R(e,this.m);if(g(e,this.m)<0)return e;var t=n(e.t);return i(e,t),this.reduce(t),t},revert:function(e){return e},reduce:function(e){for(A(e,this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,c(e)),W(this.mu,this.r2,this.m.t+1,this.q3),j(this.m,this.q3,this.m.t+1,this.r2);g(e,this.r2)<0;)L(e,1,this.m.t+1);for(u(e,this.r2,e);g(e,this.m)>=0;)u(e,this.m,e)},sqrTo:function(e,t){D(e,t),this.reduce(t)},mulTo:function(e,t,r){E(e,t,r),this.reduce(r)}}),Re})},function(e,t,r){r(2),r(5),r(6),r(8),r(3),r(7),r(11),r(1),r(4),r(9),r(12),e.exports={CryptoGost:r(0),GostEngine:r(13)}},function(e,t,r){!function(t,n){e.exports=n(r(0),r(2),r(5),r(8))}(0,function(e){function t(){for(var e={},t=0,r=arguments.length;t<r;t++){var n=arguments[t];if("object"==typeof n)for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}return e}function r(e,t,r,n){"object"!=typeof r&&(r={value:r}),void 0!==n&&(r.enumerable=n),K.defineProperty(e,t,r)}function n(e,t,n){for(var i in t)r(e,i,t[i],n)}function i(e,t,r,i){if("function"!=typeof t&&(i=r,r=t,t=function(){e.apply(this,arguments)}),t.prototype=K.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}}),r&&n(t.prototype,r,!0),e!==K)for(var o in e)t[o]=e[o];return t.super=e,i&&n(t,i,!0),t}function o(t){var r=new Uint8Array(t);return e.getRandomValues(r),r.buffer}function a(e){try{e()}catch(e){}}function s(e){if(e instanceof P)return e;if(e&&e.buffer&&e.buffer instanceof P)return 0===e.byteOffset&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;throw new DataError("CryptoOperationData required")}function c(e){var t=new k;return e&&t.setDate(t.getDate()+e),t}function u(e){var t=c(e);return t.setHours(0,0,0,0),t}function f(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return!1;for(var i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;return!0}function h(){for(var e=new Uint8Array(o(16)),t="",r=0;r<16;r++)t+=("00"+e[r].toString(16)).slice(-2);return t.substr(0,8)+"-"+t.substr(8,4)+"-4"+t.substr(13,3)+"-9"+t.substr(17,3)+"-"+t.substr(20,12)}function d(e,t){var r=new Uint8Array(e,t,4);return r[3]<<24|r[2]<<16|r[1]<<8|r[0]}function y(e,t,r){var n=new Uint8Array(e,t,4);return n[3]=r>>>24,n[2]=r>>>16&255,n[1]=r>>>8&255,n[0]=255&r,n}function p(e){switch(e.id){case"pbeWithSHAAnd40BitRC2-CBC":case"pbeWithSHAAnd128BitRC2-CBC":return 8;case"pbeUnknownGost":return 16;case"sha1":return 20;default:return 32}}function l(e,t){if(!t)return new P(0);if(e.name.indexOf("CPKDF")>=0){for(var r=[],n=0;n<t.length;n++){var i=t.charCodeAt(n);r.push(255&i),r.push(i>>>8&255),r.push(0),r.push(0)}return new Uint8Array(r).buffer}return e.name.indexOf("PFXKDF")>=0?T.Chars.decode(t+"\0","unicode"):T.Chars.decode(t,"utf8")}function g(){}function m(e){I.PrivateKeyInfo.call(this,e)}function v(e){I.EncryptedPrivateKeyInfo.call(this,e)}function C(e){if(e){var t=this;["mk.db3","masks.db3","kek.opq","rand.opq"].forEach(function(r){t[r]=e[r]})}}function A(e,t){I.GostWrappedPrivateKey.call(this,e),C.call(this,t)}function b(e){e&&(this.header=I.GostKeyContainer.decode(e.header),this.name=I.GostKeyContainerName.decode(e.name),this.primary=I.GostPrivateKeys.decode(e.primary),this.masks=I.GostPrivateMasks.decode(e.masks),e.primary2&&e.masks2&&(this.primary2=I.GostPrivateKeys.decode(e.primary2),this.masks2=I.GostPrivateMasks.decode(e.masks2)))}function F(e){I.ViPNetInfo.call(this,e||{version:3,keyInfo:{keyClass:1,keyType:43556,flags:1},defenceKeyInfo:{keyClass:1024,keyType:24622,keyUID:o(32),flags:-2147483648}})}function w(e){e&&(e instanceof P||e.buffer instanceof P||"string"==typeof e)?this.decode(e):(e=e||{},this.fileType=e.fileType||"ITCS",this.fileVersion=e.fileVersion||16,e.applicationHeader&&(this.applicationHeader=e.applicationHeader),this.entries=e.entries||[])}function S(e){I.PFX.call(this,e||{version:3,authSafe:{contentType:"data"}})}function E(e){if(this.entries={},e)for(var t in e)this.setEntry(t,e[t])}var B=this,D=B.Promise,K=B.Object,P=B.ArrayBuffer,k=B.Date,R=e.subtle,I=e.asn1,T=e.coding,x=e.security.providers,G=e.cert,U=e.cms,O={providerName:"CP-01",days:7305};return g.prototype.options=O,i(I.PrivateKeyInfo,m,{getPrivateKey:function(){var e="rsaEncryption"===this.privateKeyAlgorithm.id?["sign"]:["sign","deriveKey","deriveBits"];return R.importKey("pkcs8",this.encode(),this.privateKeyAlgorithm,"true",e)},setPrivateKey:function(e){var t=this;return R.exportKey("pkcs8",e).then(function(e){return I.PrivateKeyInfo.call(t,e),t})},generate:function(e,t){var r=this;return new D(a).then(function(){return e instanceof G.Request||(e=new G.Request(e)),e.generate(t)}).then(function(t){return I.PrivateKeyInfo.call(r,t),e})}}),g.prototype.PKCS8=m,i(I.EncryptedPrivateKeyInfo,v,{getKey:function(e){var t,r=this;return new D(a).then(function(){return t=new U.EncryptedDataContentInfo({contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:r.encryptionAlgorithm,encryptedContent:r.encryptedData}}),t.getEnclosed(e)}).then(function(e){return m.decode(e.content)})},getPrivateKey:function(e){return this.getKey(e).then(function(e){return e.getPrivateKey()})},setKey:function(e,t,r){var n,i=this;return new D(a).then(function(){return e=new m(e),n=new U.EncryptedDataContentInfo,n.encloseContent(e.encode(),t,r||O.providerName)}).then(function(){return i.encryptionAlgorithm=n.encryptedContentInfo.contentEncryptionAlgorithm,i.encryptedData=n.encryptedContentInfo.encryptedContent,i})},setPrivateKey:function(e,t,r){var n=this;return(new m).setPrivateKey(e).then(function(e){return n.setKey(e,t,r)})},generate:function(e,t,r,n){var i=this;return new D(a).then(function(){return e instanceof G.Request||(e=new G.Request(e)),e.generate(r)}).then(function(e){return i.setKey(e,t,n)}).then(function(){return e})}}),g.prototype.PKCS8Encrypted=v,i(K,C,{getEncryptionKey:function(e){var r=this,n=x["SC-01"].wrapping,i=x["SC-01"].encryption,o=x["SC-01"].derivation,s=r["masks.db3"],c=r["mk.db3"],u=r["kek.opq"];return new D(a).then(function(){if(!s||!c||!u)throw new Error("Not enougth key container files");if(s.byteLength>32){if(e)return R.importKey("raw",T.Chars.decode(e,"utf8"),o,!1,["deriveKey","deriveBits"]).then(function(e){return R.deriveKey(t(o,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),e,i,!1,["decrypt"])}).then(function(e){return new U.EncryptedDataContentInfo(s).getEnclosed(e)}).then(function(e){return e.verify()}).then(function(e){return e.content});throw new Error("Key password is required")}if(e)throw new Error("Key password is not required");return s}).then(function(e){s=e;var t=new Uint8Array(c.byteLength+s.byteLength);return t.set(new Uint8Array(c),0),t.set(new Uint8Array(s),c.byteLength),R.importKey("raw",t.buffer,n,!1,["unwrapKey"])}).then(function(e){return R.unwrapKey("raw",u,e,n,i,!1,["wrapKey","unwrapKey"])})},generateContainer:function(e){var r,n,i=this,o=x["SC-01"].wrapping,s=x["SC-01"].encryption,c=x["SC-01"].derivation,u=x["SC-01"].digest;return new D(a).then(function(){return R.generateKey(o,!0,["wrapKey"])}).then(function(r){n=r;var o=n.buffer.byteLength;i["mk.db3"]=new Uint8Array(new Uint8Array(n.buffer,0,o-32)).buffer;var a=new Uint8Array(new Uint8Array(n.buffer,o-32,32)).buffer;if(e){var f=new U.EncryptedDataContentInfo,h=new U.DigestedDataContentInfo;return h.encloseContent(a,u).then(function(){return h={contentType:"digestedData",content:h.encode()},R.importKey("raw",T.Chars.decode(e,"utf8"),c,!1,["deriveKey","deriveBits"])}).then(function(e){return R.deriveKey(t(c,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),e,s,!1,["encrypt"])}).then(function(e){return f.encloseContent(h,e,s)}).then(function(){return f.encode()})}return a}).then(function(e){return i["masks.db3"]=e,R.generateKey(s,!1,["wrapKey","unwrapKey"])}).then(function(e){return r=e,R.wrapKey("raw",e,n,o)}).then(function(e){return i["kek.opq"]=e,R.generateKey(s,!1,["wrapKey","unwrapKey"])}).then(function(e){return R.wrapKey("raw",e,n,o)}).then(function(e){return i["rand.opq"]=e,r})}}),g.prototype.SignalComKeyContainer=C,i(I.GostWrappedPrivateKey,A,{getKey:function(e){return this.getPrivateKey(e).then(function(e){return(new m).setPrivateKey(e)})},getPrivateKey:function(e){var r,n=this,i=x["SC-01"].wrapping;return new D(a).then(function(){return n.getEncryptionKey(e,!0)}).then(function(e){return R.unwrapKey("raw",n.privateKeyWrapped,e,i,n.privateKeyAlgorithm,!0,["sign","deriveKey","deriveBits"])}).then(function(e){return r=n.attributes&&n.attributes["id-sc-gostR3410-2001-publicKey"],r?R.generateKey(t(e.algorithm,{ukm:e.buffer}),e.extractable,e.usages):{privateKey:e}}).then(function(e){if(r&&!f(e.publicKey.buffer,r))throw new Error("Check public key failed");return e.privateKey})},setKey:function(e,t){var r=this;return new m(e).getPrivateKey().then(function(e){return r.setPrivateKey(e,t)})},setPrivateKey:function(e,r){var n,i=this,o=x["SC-01"].wrapping;return new D(a).then(function(){return i.getEncryptionKey(r).catch(function(){return i.generateContainer(r)})}).then(function(t){return R.wrapKey("raw",e,t,o)}).then(function(r){return n=r,R.generateKey(t(e.algorithm,{ukm:e.buffer}),!0,["sign","verify"])}).then(function(t){return i.object={version:0,privateKeyAlgorithm:e.algorithm,privateKeyWrapped:n,attributes:{"id-sc-gostR3410-2001-publicKey":t.publicKey.buffer}},i})},changePassword:function(e,t){var r=this;return r.getPrivateKey(e).then(function(e){return r.setPrivateKey(e,t)})},generate:function(e,t,r){var n,i=this;return new D(a).then(function(){return e instanceof G.Request||(e=new G.Request(e)),e.generate(r)}).then(function(e){return n=e,i.setKey(n,t)}).then(function(){return e})}}),n(A.prototype,C.prototype),g.prototype.SignalComPrivateKeyInfo=A,i(K,b,function(){function e(e){return!(e.name.indexOf("-94")>=0||e.name.indexOf("-2001")>=0||1994===e.version||2001===e.version)}function r(t,r,n){var i=e(t)?"GOST R 34.11-256":"GOST R 34.11-94/"+(t.sBox||"D-A"),o={name:"CPKDF",hash:i,salt:n,iterations:r?2e3:2};return R.importKey("raw",l(o,r),o,!1,["deriveKey","deriveBits"]).then(function(e){return R.deriveKey(o,e,"GOST 28147",!1,["sign","verify","encrypt","decrypt"])})}function n(e,n,i){var o=t({name:"GOST 28147-MAC"},e.encParams);return r(e,n,i).then(function(e){return R.sign(o,e,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))})}function i(e,r){var n=t({name:"GOST 28147-MAC"},e.encParams),i=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return R.importKey("raw",i,n,!1,["sign"]).then(function(e){return R.sign(n,e,r.encode())})}function s(e,r,n){var i=t({name:"GOST 28147-MAC"},e.encParams),o=64===r.byteLength?new Uint8Array(new Uint8Array(r,32,32)).buffer:r;return R.importKey("raw",o,i,!1,["sign"]).then(function(e){return R.sign(i,e,n)})}function u(e){var r,n=t(e,{mode:"MASK"}),i=o(12);return n.name=n.name.replace("-DH",""),R.generateKey(n,!0,["wrapKey","unwrapKey"]).then(function(e){return R.exportKey("raw",e)}).then(function(t){return r=t,s(e,r,i)}).then(function(e){return new I.GostPrivateMasks({mask:r,randomStatus:i,hmacRandom:e})})}function h(e){return R.generateKey(t(e.algorithm,{ukm:e.buffer}),!0,["sign","verify"]).then(function(e){return new Uint8Array(new Uint8Array(e.publicKey.buffer,0,8)).buffer})}function d(e,r,n,i,o){var a,s={name:"GOST 28147-ECB",sBox:e.encParams&&e.encParams.sBox},c=t(e,{mode:"MASK"});c.name=c.name.replace("-DH","");var u;return R.decrypt(s,r,n).then(function(e){return u=e,R.importKey("raw",i,c,"false",["sign","unwrapKey"])}).then(function(t){return R.unwrapKey("raw",u,t,c,e,"true",["sign"])}).then(function(e){return a=e,h(a)}).then(function(e){if(!f(e,o))throw new Error("Incorrect fp");return a})}function y(e,r,n,i){var o={name:"GOST 28147-ECB",sBox:e.encParams&&e.encParams.sBox},a=t(e,{mode:"MASK"});return a.name=a.name.replace("-DH",""),R.importKey("raw",i,a,!1,["sign","wrapKey"]).then(function(e){return R.wrapKey("raw",n,e,a)}).then(function(e){return R.encrypt(o,r,e)})}function p(e,t,n,i,o){var c=e.primaryPrivateKeyParameters.privateKeyAlgorithm;return new D(a).then(function(){if(t.hmacKey)throw new Error("Old key format");if(n.randomStatus.byteLength<12)throw new Error("Invalid random status length");return s(c,n.mask,n.randomStatus)}).then(function(e){if(!f(e,n.hmacRandom))throw new Error("Imita for mask is invalid");return r(c,i,new Uint8Array(n.randomStatus,0,12))}).then(function(r){return o&&t.secondaryKey?d(e.secondaryPrivateKeyParameters.privateKeyAlgorithm,r,t.secondaryKey,n.mask,e.secondaryFP):d(c,r,t.primaryKey,n.mask,e.primaryFP)})}function g(e,t,n,i,o,a){return r(e,i,new Uint8Array(n.randomStatus,0,12)).then(function(t){return y(e,t,a,n.mask)}).then(function(e){return t||(t=new I.GostPrivateKeys),o?t.secondaryKey=e:t.primaryKey=e,t})}return{getKey:function(e,t){return this.getPrivateKey(e,t).then(function(e){return(new m).setPrivateKey(e)})},getPrivateKey:function(e,t){var r=this,n=r.header.keyContainerContent;return p(n,r.primary,r.masks,e,t).catch(function(i){if(r.primary2&&r.masks2)return p(n,r.primary2,r.masks2,e,t);throw i})},getCertificate:function(e){var t=this,r=t.header.keyContainerContent;return new D(a).then(function(){return e?new G.X509(r.secondaryCertificate):new G.X509(r.primaryCertificate)})},getContainerName:function(){return this.name.containerName},setKey:function(e,t,r,n){var i=this;return new m(e).getPrivateKey().then(function(e){return i.setPrivateKey(e,t,r,n)})},setPrivateKey:function(e,r,o,s){var f,d,y=this;return new D(a).then(function(){y.header=y.header||new I.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary","kccaPrimaryKeyAbsent"],extensions:{keyValidity:{notAfter:c(s||O.days)}}}}),f=y.header.keyContainerContent;var r=o?f.secondaryPrivateKeyParameters:f.primaryPrivateKeyParameters;if(r)d=r.privateKeyAlgorithm;else if(d=t(e.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}}),r={attributes:["pkaExportable","pkaExchange","pkaDhAllowed"],privateKeyAlgorithm:d},o){if(!f.primaryPrivateKeyParameters)throw new Error("Primary key must be defined first");f.secondaryPrivateKeyParameters=r}else{f.primaryPrivateKeyParameters=r;var n=f.attributes.indexOf("kccaPrimaryKeyAbsent");n>=0&&f.attributes.splice(n,1)}var i=[];return[0,1].forEach(function(e){var t="masks"+(e>0?"2":"");y[t]||i.push(u(d).then(function(e){y[t]=e}))}),D.all(i)}).then(function(){var t=[];return[0,1].forEach(function(n){var i="primary"+(n>0?"2":""),a="masks"+(n>0?"2":"");t.push(g(d,y[i],y[a],r,o,e).then(function(e){y[i]=e}))}),D.all(t)}).then(function(){return h(e).then(function(e){o?f.secondaryFP=e:f.primaryFP=e})}).then(function(){var e=f.attributes.indexOf("kccaSoftPassword");if(r)return e<0&&f.attributes.push("kccaSoftPassword"),n(d,r,f.primaryFP);e>=0&&f.attributes.splice(e,1)}).then(function(e){return e&&(f.hmacPassword=e),i(d,f)}).then(function(e){return y.header.hmacKeyContainerContent=e,y})},setCertificate:function(e,r,n){var o,s,u=this;return new D(a).then(function(){return u.header=u.header||new I.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary","kccaPrimaryKeyAbsent"],extensions:{keyValidity:{notAfter:c(n||O.days)}}}}),o=u.header.keyContainerContent,e=new G.X509(e),s=o.primaryPrivateKeyParameters&&o.primaryPrivateKeyParameters.privateKeyAlgorithm||t(e.subjectPublicKeyInfo.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}}),e.getPublicKey()}).then(function(t){if(r){if(o.secondaryFP&&!f(o.secondaryFP,new Uint8Array(t.buffer,0,o.secondaryFP.byteLength)))throw new Error("The public key of the certificate does not match the private key");o.secondaryCertificate=e}else{if(o.primaryFP&&!f(o.primaryFP,new Uint8Array(t.buffer,0,o.primaryFP.byteLength)))throw new Error("The public key of the certificate does not match the private key");o.primaryCertificate=e}return i(s,o)}).then(function(e){return u.header.hmacKeyContainerContent=e,u})},setContainerName:function(e){this.name=new I.GostKeyContainerName({containerName:e})},verify:function(e){var t,r,o=this;return new D(a).then(function(){return t=o.header.keyContainerContent,r=t.primaryPrivateKeyParameters.privateKeyAlgorithm,i(r,t)}).then(function(i){if(!f(i,o.header.hmacKeyContainerContent))throw new Error("Container is not valid.");var a=t.attributes.indexOf("kccaSoftPassword")>=0;if(!e&&a)throw new Error("Password is required");if(e&&!a)throw new Error("Password is not reqiured.");return e?n(r,e,t.primaryFP).then(function(e){if(!f(e,t.hmacPassword))throw new Error("Password is not valid.");return o}):o})},changePassword:function(e,t){var r,n=this;return new D(a).then(function(){if(r=n.header.keyContainerContent,!r.primaryPrivateKeyParameters)throw new Error("Private key not yet defined");return n.getPrivateKey(e).then(function(e){return n.setPrivateKey(e,t)})}).then(function(){return r.secondaryPrivateKeyParameters?n.getPrivateKey(e,!0).then(function(e){return n.setPrivateKey(e,t,!0)}):n})},generate:function(e,t,r){var n,i,o=this;return new D(a).then(function(){return e instanceof G.Request||(e=new G.Request(e)),e.generate(r)}).then(function(e){return i=e,o.setKey(i,t)}).then(function(){return n=new G.X509(e),n.sign(i)}).then(function(){return o.setCertificate(n)}).then(function(){return e})},encode:function(e){return{header:this.header.encode(e),name:this.name.encode(e),masks:this.masks.encode(e),primary:this.primary.encode(e),masks2:this.masks2.encode(e),primary2:this.primary2.encode(e)}}}}()),g.prototype.CryptoProKeyContainer=b,i(I.ViPNetInfo,F,function(){function e(e){void 0===e&&(e="");var t,r=T.Chars.decode(e,"win1251");return R.digest("GOST R 34.11-94",r).then(function(e){t=e;var n=new Uint8Array(r.byteLength+t.byteLength);return n.set(new Uint8Array(r),0),n.set(new Uint8Array(t),r.byteLength),R.digest("GOST R 34.11-94",n)}).then(function(e){return R.importKey("raw",e,"GOST 28147",!1,["unwrapKey"])}).then(function(e){return R.unwrapKey("raw",t,e,"GOST 28147-MASK/VN","GOST 28147-89","false",["encrypt","decrypt","sign","verify"])})}return{getPrivateKey:function(r){var n,i,o=this;return new D(a).then(function(){return r&&"string"!=typeof r?r:e(r)}).then(function(e){r=e,n=o.keyPart,i=new Uint8Array(n,0,n.byteLength-4-8);var t=new Uint8Array(n,i.byteLength,4),a=o.keyInfo.encode(),s=new Uint8Array(i.byteLength+a.byteLength);return s.set(new Uint8Array(i),0),s.set(new Uint8Array(a),i.byteLength),R.verify({name:"GOST 28147-89-MAC"},r,t,s)}).then(function(e){if(!e)throw new Error("Invalid key password");var t=new Uint8Array(n,n.byteLength-8,8);return R.decrypt({name:"GOST 28147-89-CFB",iv:t},r,i)}).then(function(e){var r=e.byteLength/2;if(!1&o.keyInfo.keyClass)return R.importKey("raw",new Int32Array(e,r,r),"GOST 28147",!1,["unwrapKey"]).then(function(t){return R.unwrapKey("raw",new Int32Array(e,0,r),t,"GOST 28147-MASK/VN","GOST 28147-89","false",["encrypt","decrypt","sign","verify"])});var n=o.keyInfo.algorithm||o.certificate&&o.certificate.subjectPublicKeyInfo.algorithm;if(!n)throw new Error("Algorithm is not specified");var i=t(n,{mode:"MASK",procreator:"VN"});i.name=i.name.replace("-DH","");var a=new Uint8Array(e,0,r),s=new Uint8Array(e,r,r);return R.importKey("raw",s,i,"false",["sign","unwrapKey"]).then(function(e){return R.unwrapKey("raw",a,e,i,n,"true",["sign","deriveBits","deriveKey"])}).then(function(e){return o.publicKey?R.generateKey(t(e.algorithm,{ukm:e.buffer}),e.extractable,e.usages):{privateKey:e}}).then(function(e){if(o.publicKey&&!f(e.publicKey.buffer,o.publicKey))throw new Error("Check public key failed");return e.privateKey})})},setPrivateKey:function(r,n,i){var s,c,h,d,y=this;return new D(a).then(function(){return n&&"string"!=typeof n?n:e(n)}).then(function(e){n=e;var a=r.algorithm;if(y.keyInfo.algorithm=a,y.keyInfo.serialNumber=o(16),y.keyInfo.keyUID=o(8),y.keyInfo.validity={notBefore:u(),notAfter:u(i||O.days)},"private"===r.type)return s=t(a,{mode:"MASK",procreator:"VN"}),s.name=s.name.replace("-DH",""),y.keyInfo.keyClass=1,y.keyInfo.keyType=43556,R.generateKey(t(a,{ukm:r.buffer}),!0,["sign","verify"]).then(function(e){if(y.publicKey=e.publicKey.buffer,y.certificate){var t=y.certificate.subjectPublicKeyInfo;return R.importKey("spki",t.encode(),t.algorithm,!0,["verify"])}}).then(function(e){e&&!f(e.buffer,y.publicKey)&&delete y.certificate});if("secret"!==r.type)throw new Error("Invalid key type");s="GOST 28147/MASK/VN",delete y.certificate,delete y.publicKey,y.keyInfo.keyClass=64,y.keyInfo.keyType=24622}).then(function(){return R.generateKey(s,!0,["wrapKey","unwrapKey"])}).then(function(e){return c=e,R.wrapKey("raw",r,c,s)}).then(function(e){return h=new Uint8Array(2*e.byteLength),h.set(new Uint8Array(e)),R.exportKey("raw",c)}).then(function(e){h.set(new Uint8Array(e),e.byteLength),d=new Uint8Array(h.byteLength+12);var t={name:"GOST 28147-CFB",iv:o(8)};return d.set(new Uint8Array(t.iv),d.byteLength-8),R.encrypt(t,n,h)}).then(function(e){d.set(new Uint8Array(e));var t=y.keyInfo.encode(),r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),R.sign({name:"GOST 28147-89-MAC"},n,r)}).then(function(e){return d.set(new Uint8Array(e),d.byteLength-12),y.keyPart=d.buffer,y})},encode:function(e){var t=I.ViPNetInfo.method("encode").call(this),r=new Uint8Array(8+t.byteLength+this.keyPart.byteLength);return y(r.buffer,0,4+t.byteLength+this.keyPart.byteLength),r.set(new Uint8Array(t),4),y(r.buffer,4+t.byteLength,this.keyPart.byteLength),r.set(new Uint8Array(this.keyPart),8+t.byteLength),"PEM"===e?T.Base64.encode(r.buffer):r.buffer}}}(),{decode:function(e){"string"==typeof e&&(e=T.Base64.decode(e)),e=s(e);var t=d(e,0);if(e.byteLength!==t+4)throw new Error("Invalid container entry size");var r=T.BER.decode(new Uint8Array(e,4,t)),n=I.ViPNetInfo.decode.call(this,r),i=r.header.byteLength+r.content.byteLength,o=d(e,4+i);if(e.byteLength!==i+o+8)throw new Error("Invalid container key part size");return n.keyPart=new Uint8Array(new Uint8Array(e,i+8,o)).buffer,n}}),g.prototype.ViPNetContainerEntry=F,i(K,w,{getCertificate:function(e){var t=this;return new D(a).then(function(){var r=t.entries[e||0];if(!r)throw new Error("Entry not defined");if(r.certificate)return new G.X509(r.certificate)})},getKey:function(e,t){return this.getPrivateKey(e,t).then(function(e){return(new m).setPrivateKey(e)})},getPrivateKey:function(e,t){var r=this;return new D(a).then(function(){var n=r.entries[t||0];if(!n)throw new Error("Entry not defined");return n.getPrivateKey(e)})},setCertificate:function(e,t){var r,e,n=this;return new D(a).then(function(){if(r=n.entries[t||0]||(n.entries[t||0]=new F),e=new G.X509(e),r.publicKey)return e.getPublicKey()}).then(function(t){if(t&&!f(r.publicKey,t.buffer))throw new Error("Invalid certificate for private key");return r.certificate=e,n})},setKey:function(e,t,r,n){var i=this;return new m(e).getPrivateKey().then(function(e){return i.setPrivateKey(e,t,r,n)})},setPrivateKey:function(e,t,r,n){var i=this;return new D(a).then(function(){return(i.entries[r||0]||(i.entries[r||0]=new F)).setPrivateKey(e,t,n)}).then(function(){return i})},changePassword:function(e,t){var r=this;return new D(a).then(function(){return r.getPrivateKey(e).then(function(e){return r.setPrivateKey(e,t)})})},generate:function(e,t,r){var n,i,o=this;return new D(a).then(function(){return e instanceof G.Request||(e=new G.Request(e)),e.generate(r)}).then(function(e){return i=e,o.setKey(i,t)}).then(function(){return n=new G.X509(e),n.sign(i)}).then(function(){return o.setCertificate(n)}).then(function(){return e})},encode:function(e){var t=[],r=0;this.entries.forEach(function(e){var n=e.encode();r+=n.byteLength,t.push(n)});var n=this.applicationHeader?this.applicationHeader.byteLength:0,i=new Uint8Array(12+n+r);i.set(new Uint8Array(T.Chars.decode(this.fileType,"ascii"))),y(i.buffer,4,this.fileVersion),y(i.buffer,8,n),n>0&&i.set(new Uint8Array(this.applicationHeader),12);var o=12+n;return t.forEach(function(e){i.set(new Uint8Array(e),o),o+=e.byteLength}),"PEM"===e?T.Base64.encode(i.buffer):i.buffer},decode:function(e){e=this.constructor.decode(e),this.fileType=e.fileType,this.fileVersion=e.fileVersion,e.applicationHeader&&(this.applicationHeader=e.applicationHeader),this.entries=e.entries}},{encode:function(e,t){return new this(e).encode(t)},decode:function(e){"string"==typeof e&&(e=T.Base64.decode(e)),e=s(e);var t=T.Chars.encode(new Uint8Array(e,0,4),"ascii");if("ITCS"!==t&&"PKEY"!==t&&"_CCK"!==t&&"_LCK"!==t)throw new Error("Unsupported ViPNet container type");var r=d(e,4),n=r>>>16,i=65535&r;if(0!==n&&1!==n||i>255)throw new Error("Unsupported ViPNet container version");var o,a=d(e,8);a>0&&(o=s(new Uint8Array(e,12,a)));for(var c=12+a,u=[];c<e.byteLength;){var f=d(e,c);u.push(F.decode(new Uint8Array(e,c,f+4))),c=c+f+4}return new w({fileType:t,fileVersion:r,applicationHeader:o,entries:u})}}),g.prototype.ViPNetContainer=w,i(I.PFX,S,function(){function e(e,t,r){var n={name:"HMAC",hash:e.hash};return R.importKey("raw",l(e,t),e,!1,["deriveKey"]).then(function(t){return R.deriveKey(e,t,n,!1,["sign"])}).then(function(e){return R.sign(n,e,r)})}function r(t,r,n,i){return e(t,r,i).then(function(e){if(!f(n,e))throw new Error("Invalid password, MAC is not verified")})}return{sign:function(r,n){var i=this;return new D(a).then(function(){if(r){var a,s,c;n?c=x[n]:n=x[O.providerName].digest,c?(a=c.digest,s=c.derivation):(a=n,s={name:"PFXKDF",hash:a,iterations:2e3}),s=t(s,{salt:o(p(a)),diversifier:3});var u=i.authSafe.content;return e(s,r,u).then(function(e){return i.macData={mac:{digestAlgorithm:a,digest:e},macSalt:s.salt,iterations:s.iterations},i})}return i})},verify:function(e){var t,n=this,i=n.authSafe;return new D(a).then(function(){if("data"!==i.contentType)throw new Error("Unsupported format");if(n.macData){if(!e)throw new Error("Password must be defined for the MAC verification");t={name:"PFXKDF",hash:n.macData.mac.digestAlgorithm,salt:n.macData.macSalt,iterations:n.macData.iterations,diversifier:3};var o=n.authSafe.content,a=n.macData.mac.digest;return r(t,e,a,o).catch(function(){return t.name="PBKDF2",r(t,e,a,o)})}}).then(function(){return n})}}}()),g.prototype.PKCS12=S,i(K,E,{aliases:function(){var e=[];for(var t in this.entries)e.push(t);return e},containsAlias:function(e){return!!this.entries[e]},deleteEntry:function(e){delete this.entries[e]},setEntry:function(e,t){var r={};if(t.key)try{r.key=new m(t.key,!0)}catch(e){try{r.key=new v(t.key,!0)}catch(e){if(!(t.key instanceof P))throw new Error("Unknown Key format");r.key=t.key}}if(t.certs){for(var n=t.certs instanceof Array?t.certs:[t.certs],i=0;i<n.length;i++)try{n[i]=new G.X509(n[i])}catch(e){}r.certs=n}if(t.crls){for(var o=t.crls instanceof Array?t.crls:[t.crls],i=0;i<o.length;i++)try{o[i]=new G.CRL(o[i])}catch(e){}r.crls=o}this.entries[e]=r},getEntry:function(e){return this.entries[e]},load:function(e,t){var r=this;return new D(a).then(function(){return e=new S(e),e.verify(t)}).then(function(){if("data"!==e.authSafe.contentType)throw new Error("Unsupported PFX format");var r=I.AuthenticatedSafe.decode(e.authSafe.content).object,n=[];return r.forEach(function(e){if("data"===e.contentType)n.push(new U.DataContentInfo(e));else{if("encryptedData"!==e.contentType)throw new Error("Unsupported PFX format");n.push(new U.EncryptedDataContentInfo(e).getEnclosed(t))}}),D.all(n)}).then(function(e){var r={};e.forEach(function(e){I.SafeContents.decode(e.content).object.forEach(function(e){var t=T.Hex.encode(e.bagAttributes&&e.bagAttributes.localKeyId||o(4),!0),n=r[t]||(r[t]={});switch(e.bagId){case"keyBag":n.key=new m(e.bagValue);break;case"pkcs8ShroudedKeyBag":n.key=new v(e.bagValue);break;case"secretBag":"secret"===e.bagValue.secretTypeId&&(n.key=e.bagValue.secretValue);break;case"certBag":var i=n.certs||(n.certs=[]);"x509Certificate"===e.bagValue.certId&&i.push(new G.X509(e.bagValue.certValue));break;case"crlBag":var a=n.crls||(n.crls=[]);"x509CRL"===e.bagValue.crlId&&a.push(new G.CRL(e.bagValue.crlValue))}e.bagAttributes&&e.bagAttributes.friendlyName&&(n.friendlyName=e.bagAttributes.friendlyName)})});var n=[];for(var i in r)n.push(function(e){return e.key instanceof v?e.key.getKey(t).then(function(t){return e.key=t,e}).catch(function(){return e}):e}(r[i]));return D.all(n)}).then(function(e){return e.forEach(function(e){var t=e.friendlyName;t?(delete e.friendlyName,r.entries[t]=e):r.entries[h()]=e}),r})},store:function(e,t,r){var n=this,i=[],o=[],s=[];return new D(a).then(function(){r=r?x[r]?x[r].pbes:r:t&&x[t]?x[t].pbes:x[O.providerName].pbes;for(var a in n.entries){var s=new Uint32Array([1]),c=n.entries[a];c.key&&function(t,n){t instanceof P?o.push({bagId:"secretBag",bagValue:{secretTypeId:"secret",secretValue:t,bagAttributes:n}}):t instanceof m?r&&e?i.push((new v).setKey(t,e,r).then(function(e){return{bagId:"pkcs8ShroudedKeyBag",bagValue:e,bagAttributes:n}})):i.push({bagId:"keyBag",bagValue:t,bagAttributes:n}):t instanceof v&&i.push({bagId:"pkcs8ShroudedKeyBag",bagValue:t,bagAttributes:n})}(c.key,{localKeyId:s,friendlyName:a}),c.certs&&c.certs.forEach(function(e){var t={localKeyId:s};e instanceof G.X509&&o.push({bagId:"certBag",bagValue:{certId:"x509Certificate",certValue:e},bagAttributes:t})}),c.crls&&c.crls.forEach(function(e){var t={localKeyId:s};e instanceof G.CRL&&o.push({bagId:"crlBag",bagValue:{crlId:"x509CRL",crlValue:e},bagAttributes:t})})}if(i.length>0)return D.all(i)}).then(function(t){if(t){var n=I.SafeContents.encode(t);s.push(new U.DataContentInfo({contentType:"data",content:n}))}if(o.length>0)return o=I.SafeContents.encode(o),r&&e?(new U.EncryptedDataContentInfo).encloseContent(o,e,r):(new U.DataContentInfo).encloseContent(o)}).then(function(r){s.push(r),s=new I.AuthenticatedSafe(s);var n=new S;return n.authSafe={contentType:"data",content:s.encode()},n.sign(e,t)})}}),g.prototype.KeyStore=E,e.keys=new g,g})},function(e,t,r){!function(t,n){e.exports=n(r(0),r(3),r(4),r(2))}(0,function(e){function t(e,t,r){var n=document.getElementById("print");n&&n.parentNode.removeChild(n),n=document.createElement("div"),n.id="print",n.innerHTML='<span class="label">'+e+'</span><pre class="encoded">'+t+"</pre><button onclick=\"(function(x){x.parentNode.removeChild(x);})(document.getElementById('print'))\">Close View</button>";for(var i=r.nextElementSibling;"button"===i.nodeName.toLowerCase();)i=i.nextElementSibling;i.parentNode.insertBefore(n,i)}function r(e){t("ASN.1 Data",s(e.textContent),e)}function n(e,r){t("Syntax "+(r?"gostCrypto.asn1."+r+".decode(value):":"gostCrypto.coding.PEM.decode(value):"),c(e.textContent,r),e)}var i=e.coding,o=e.security.names,a=e.asn1,s=function(){function e(e,t){for(var r="",n=new Uint8Array(t),i=0;i<n.length;i++)r+=(i%16==0?(i>0?"</b>":"")+"\r\n"+e+"<b>":" ")+("00"+n[i].toString(16)).slice(-2);return r?r+"</b>":""}function t(e,t,n){var i="";return e.object.length>0?(i+=" {\r\n",e.object.forEach(function(e){i+=r(e,t,n+" "),t+=e.header.length+e.content.length}),i+="             : "+n+"}"):i+=" {}",i}function r(r,a,s){if(r.tagClass>2)throw new Error("Private and Application tags is not supported");a=a||0,s=s||"";var c=1===r.tagClass?"Application_"+r.tagNumber:2===r.tagClass?"["+r.tagNumber.toString()+"]":3===r.tagClass?"Private_"+r.tagNumber:n[r.tagNumber]||"Universal_"+r.tagNumber.toString(),u="             : ",f=("     "+a).slice(-5)+" "+("00"+r.header[0].toString(16)).slice(-2)+("     "+r.content.length).slice(-5)+": "+s+c;if(r.tagConstructed)f+=t(r,a+r.header.length,s);else switch(c.toUpperCase()){case"OBJECT IDENTIFIER":var h=r.object,d=o[h];f+=" <b>"+(d||"?")+"</b> ("+h+")";break;case"INTEGER":case"ENUMERATED":"number"==typeof r.object?f+=" <b>"+r.object+"</b>":f+=e(u+s+" ",r.content);break;case"GENERALIZEDTIME":case"UTCTIME":f+=" <b>"+r.object+"</b>";break;case"PRINTABLESTRING":case"IA5STRING":case"VISIBLESTRING":case"VIDEOTEXSTRING":case"NUMERICSTRING":case"BMPSTRING":case"UTF8STRING":case"UNIVERSALSTRING":f+=" <b>&quot;"+r.object+"&quot;</b>";break;case"BOOLEAN":f+=" <b>"+(r.object?"true":"false")+"</b>";break;case"OCTET STRING":try{f+=", encapsulates"+t({object:[i.BER.decode(r.content)]},a+r.header.length,s)}catch(t){f+=e(u+s+" ",r.content)}break;case"BIT STRING":if(f+=", unused "+r.content[0]+" bits",r.object instanceof ArrayBuffer)try{f+=", encapsulates"+t({object:[i.BER.decode(r.object)]},a+r.header.length,s)}catch(t){f+=e(u+s+" ",r.object)}else f+="\r\n"+u+s+" <b>"+r.object+"B</b>";break;default:try{f+=", encapsulates"+t({object:[i.BER.decode(r.content)]},a+r.header.length,s)}catch(t){f+=e(u+s+" ",r.content)}}return f+"\r\n"}var n={0:"EOC",1:"BOOLEAN",2:"INTEGER",3:"BIT STRING",4:"OCTET STRING",5:"NULL",6:"OBJECT IDENTIFIER",7:"ObjectDescriptor",8:"EXTERNAL",9:"REAL",10:"ENUMERATED",11:"EMBEDDED PDV",12:"UTF8String",16:"SEQUENCE",17:"SET",18:"NumericString",19:"PrintableString",20:"TeletexString",21:"VideotexString",22:"IA5String",23:"UTCTime",24:"GeneralizedTime",25:"GraphicString",26:"VisibleString",27:"GeneralString",28:"UniversalString",30:"BMPString"};return function(e){if("string"==typeof e||e instanceof String){var t=/([A-Fa-f0-9\s]+)/g.exec(e);e=t&&t[1].length===e.length?i.Hex.decode(e):i.PEM.decode(e)}else try{e=i.PEM.decode(i.Chars.encode(e,"ascii"))}catch(e){}return r(i.BER.decode(e))}}(),c=function(){function e(t,r){if(r=r||"",void 0===t)return"<b>undefined</b>";if(t instanceof Array){for(var n=[],i=0,o=0,a=t.length;o<a;o++)n[o]=e(t[o],r+"    "),i+=n[o].replace(/\<[^\>]+\>/g,"").length+2;if(i>80){for(var s="[",c=0,o=0,a=n.length;o<a;o++)s+=(o>0?", ":"")+(0===c&&i>80?"\r\n"+r+"    ":" ")+n[o],(c+=n[o].replace(/\<[^\>]+\>/g,"").length+2)>80&&(c=0);return s+=i>80?"\r\n"+r+"]":" ]"}return"[ "+n.join(", ")+" ]"}if("string"==typeof t||t instanceof String)return""===t.toString()?"<b>null</b>":'<b>"'+t.replace(/([\"])/g,"\\$1")+'"</b>';if("number"==typeof t||t instanceof Number)return"<b>"+t+"</b>";if(t instanceof Date)return"<b>"+JSON.stringify(t)+"</b>";if("boolean"==typeof t||t instanceof Boolean)return"<b>"+t+"</b>";if(t instanceof ArrayBuffer||t instanceof Uint8Array){for(var u=new Uint8Array(t),s="",o=0,a=u.length;o<a;o++)s+=(o>0&&o%16==0?"\r\n"+r+"    ":" ")+"<b>0x"+("00"+u[o].toString(16)).slice(-2)+"</b>"+(o<a-1?",":"");return u.length>16?"[\r\n"+r+"   "+s+"\r\n"+r+"]":"["+s+" ]"}if("object"==typeof t){var f=!0,s="{";for(var h in t)if("function"!=typeof t[h]&&void 0!==t[h]){var d=/^[a-zA-Z\_][a-zA-Z0-9\_]*$/.test(h);f?f=!1:s+=",",s+="\r\n"+r+"    "+(d?"":'"')+h+(d?"":'"')+": "+e(t[h],r+"    ")}return s+=(f?"":"\r\n"+r)+"}"}return"unrecognized"}return function(t,r){if("string"==typeof t||t instanceof String){var n=/([A-Fa-f0-9\s]+)/g.exec(t);t=n&&n[1].length===t.length?i.Hex.decode(t):i.PEM.decode(t)}else try{t=i.PEM.decode(i.Chars.encode(t,"ascii"))}catch(e){}return e(r?a[r].decode(t):i.BER.decode(t))}}();return{printASN1:s,printSyntax:c,openASN1:r,openSyntax:n}})},function(e,t,r){!function(t,n){e.exports=n(r(1),r(6),r(7),r(9))}(0,function(e,t,r,n){function i(e,t){if(!t)throw new(o.SyntaxError||Error)("Algorithm not defined");if(!t.name)throw new(o.SyntaxError||Error)("Algorithm name not defined");var r=t.name,n=t.mode;if("GOST 28147"!==r&&"GOST R 34.12"!==r&&"RC2"!==r||"generateKey"!==e&&("MAC"!==n||"sign"!==e&&"verify"!==e)&&("KW"!==n&&"MASK"!==n||"wrapKey"!==e&&"unwrapKey"!==e)&&(n&&"ES"!==n||"encrypt"!==e&&"decrypt"!==e)){if("GOST R 34.11"!==r&&"SHA"!==r||"digest"!==e&&("HMAC"!==n||"sign"!==e&&"verify"!==e&&"generateKey"!==e)&&("KDF"!==n&&"PBKDF2"!==n&&"PFXKDF"!==n&&"CPKDF"!==n||"deriveKey"!==e&&"deriveBits"!==e&&"generateKey"!==e)){if("GOST R 34.10"!==r||"generateKey"!==e&&(n&&"SIGN"!==n||"sign"!==e&&"verify"!==e)&&("MASK"!==n||"wrapKey"!==e&&"unwrapKey"!==e)&&("DH"!==n||"deriveKey"!==e&&"deriveBits"!==e))throw new(o.NotSupportedError||Error)("Algorithm "+r+"-"+n+" is not valid for "+e);return"GostSign"}return"GostDigest"}return"GostCipher"}var o=this,a={execute:function(e,t,r){var n=i(t,e),o=this["get"+n](e);return o[t].apply(o,r)},getGostCipher:function(e){return new(t||(t=o.GostCipher))(e)},getGostDigest:function(e){return new(r||(r=o.GostDigest))(e)},getGostSign:function(e){return new(n||(n=o.GostSign))(e)}};if(o.importScripts)o.onmessage=function(e){try{postMessage({id:e.data.id,result:a.execute(e.data.algorithm,e.data.method,e.data.args)})}catch(t){postMessage({id:e.data.id,error:t.message})}};else{var s="",c="";"undefined"!=typeof document&&function(){for(var e=/^(.*)gostCrypto(.*)\.js$/i,t=document.querySelectorAll("script"),r=0,n=t.length;r<n;r++){var i=t[r].getAttribute("src"),o=e.exec(i);o&&(s=o[1],c=o[2])}}();var u=function(){for(var e=0,t=arguments.length;e<t;e++){var r=arguments[e].split("."),n=s+r[0]+c+"."+r[1],i=document.querySelector('script[src="'+n+'"]');i||(i=document.createElement("script"),i.setAttribute("src",n),document.head.appendChild(i))}};e||u("gostRandom.js"),t||u("gostCipher.js"),r||u("gostDigest.js"),n||u("gostSign.js")}return a})}])});