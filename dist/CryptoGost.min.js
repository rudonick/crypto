(function webpackUniversalModuleDefinition(e,t){if(typeof exports==="object"&&typeof module==="object")module.exports=t();else if(typeof define==="function"&&define.amd)define([],t);else if(typeof exports==="object")exports["crypto-gost-js"]=t();else e["crypto-gost-js"]=t()})(global,function(){return function(e){var t={};function __webpack_require__(r){if(t[r]){return t[r].exports}var n=t[r]={i:r,l:false,exports:{}};e[r].call(n.exports,n,n.exports,__webpack_require__);n.l=true;return n.exports}__webpack_require__.m=e;__webpack_require__.c=t;__webpack_require__.d=function(e,t,r){if(!__webpack_require__.o(e,t)){Object.defineProperty(e,t,{enumerable:true,get:r})}};__webpack_require__.r=function(e){if(typeof Symbol!=="undefined"&&Symbol.toStringTag){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}Object.defineProperty(e,"__esModule",{value:true})};__webpack_require__.t=function(e,t){if(t&1)e=__webpack_require__(e);if(t&8)return e;if(t&4&&typeof e==="object"&&e&&e.__esModule)return e;var r=Object.create(null);__webpack_require__.r(r);Object.defineProperty(r,"default",{enumerable:true,value:e});if(t&2&&typeof e!="string")for(var n in e)__webpack_require__.d(r,n,function(t){return e[t]}.bind(null,n));return r};__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e["default"]}:function getModuleExports(){return e};__webpack_require__.d(t,"a",t);return t};__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=19)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var n=t.NotSupportedError=function(e){_inherits(NotSupportedError,e);function NotSupportedError(){_classCallCheck(this,NotSupportedError);return _possibleConstructorReturn(this,(NotSupportedError.__proto__||Object.getPrototypeOf(NotSupportedError)).apply(this,arguments))}return NotSupportedError}(Error);var i=t.DataError=function(e){_inherits(DataError,e);function DataError(){_classCallCheck(this,DataError);return _possibleConstructorReturn(this,(DataError.__proto__||Object.getPrototypeOf(DataError)).apply(this,arguments))}return DataError}(Error);var a=t.OperationError=function(e){_inherits(OperationError,e);function OperationError(){_classCallCheck(this,OperationError);return _possibleConstructorReturn(this,(OperationError.__proto__||Object.getPrototypeOf(OperationError)).apply(this,arguments))}return OperationError}(Error)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.getSeed=getSeed;t.randomSeed=randomSeed;var n=r(8);function getSeed(e){var t=new n.GostRandom;try{var r=new Uint8Array(Math.ceil(e/8));t.getRandomValues(r);return r}catch(e){throw new Error("Error occurred during random values generation")}}function randomSeed(e){try{var t=new n.GostRandom;return t.getRandomValues(e)}catch(e){throw new Error("Error occurred during random values generation")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostCodingInstance=undefined;t.GostCoding=GostCoding;var n=r(0);var i=ArrayBuffer;function buffer(e){if(e instanceof i)return e;else if(e&&e.buffer&&e.buffer instanceof i)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;else throw new n.DataError("CryptoOperationData required")}function GostCoding(){}var a={decode:function decode(e){e=e.replace(/[^A-Za-z0-9\+\/]/g,"");var t=e.length,r=t*3+1>>2,n=new Uint8Array(r);for(var i,a,o=0,s=0,c=0;c<t;c++){a=c&3;var u=e.charCodeAt(c);u=u>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:u===43?62:u===47?63:0;o|=u<<18-6*a;if(a===3||t-c===1){for(i=0;i<3&&s<r;i++,s++){n[s]=o>>>(16>>>i&24)&255}o=0}}return n.buffer},encode:function encode(e){var t=8,r=new Uint8Array(buffer(e));var n=2,i="";for(var a=r.length,o=0,s=0;s<a;s++){n=s%3;if(s>0&&s*4/3%(12*t)===0)i+="\r\n";o|=r[s]<<(16>>>n&24);if(n===2||a-s===1){for(var c=18;c>=0;c-=6){var u=o>>>c&63;u=u<26?u+65:u<52?u+71:u<62?u-4:u===62?43:u===63?47:65;i+=String.fromCharCode(u)}o=0}}return i.substr(0,i.length-2+n)+(n===2?"":n===1?"=":"==")}};GostCoding.prototype.Base64=a;var o=function(){var e={1026:128,1027:129,8218:130,1107:131,8222:132,8230:133,8224:134,8225:135,8364:136,8240:137,1033:138,8249:139,1034:140,1036:141,1035:142,1039:143,1106:144,8216:145,8217:146,8220:147,8221:148,8226:149,8211:150,8212:151,8482:153,1113:154,8250:155,1114:156,1116:157,1115:158,1119:159,160:160,1038:161,1118:162,1032:163,164:164,1168:165,166:166,167:167,1025:168,169:169,1028:170,171:171,172:172,173:173,174:174,1031:175,176:176,177:177,1030:178,1110:179,1169:180,181:181,182:182,183:183,1105:184,8470:185,1108:186,187:187,1112:188,1029:189,1109:190,1111:191};var t={};for(var r in e){var n=e[r];t[n]=r}return{decode:function decode(t,r){r=(r||"win1251").toLowerCase().replace("-","");var n=[];for(var i=0,a=t.length;i<a;i++){var o=t.charCodeAt(i);if(r==="utf8"){if(o<128){n.push(o)}else if(o<2048){n.push(192+(o>>>6));n.push(128+(o&63))}else if(o<65536){n.push(224+(o>>>12));n.push(128+(o>>>6&63));n.push(128+(o&63))}else if(o<2097152){n.push(240+(o>>>18));n.push(128+(o>>>12&63));n.push(128+(o>>>6&63));n.push(128+(o&63))}else if(o<67108864){n.push(248+(o>>>24));n.push(128+(o>>>18&63));n.push(128+(o>>>12&63));n.push(128+(o>>>6&63));n.push(128+(o&63))}else{n.push(252+(o>>>30));n.push(128+(o>>>24&63));n.push(128+(o>>>18&63));n.push(128+(o>>>12&63));n.push(128+(o>>>6&63));n.push(128+(o&63))}}else if(r==="unicode"||r==="ucs2"||r==="utf16"){if(o<55296||o>=57344&&o<=65536){n.push(o>>>8);n.push(o&255)}else if(o>=65536&&o<1114112){o-=65536;var s=((1047552&o)>>10)+55296;var c=(1023&o)+56320;n.push(s>>>8);n.push(s&255);n.push(c>>>8);n.push(c&255)}}else if(r==="utf32"||r==="ucs4"){n.push(o>>>24&255);n.push(o>>>16&255);n.push(o>>>8&255);n.push(o&255)}else if(r==="win1251"){if(o>=128){if(o>=1040&&o<1104)o-=848;else o=e[o]||0}n.push(o)}else n.push(o&255)}return new Uint8Array(n).buffer},encode:function encode(e,r){r=(r||"win1251").toLowerCase().replace("-","");var n=[],i=new Uint8Array(buffer(e));for(var a=0,o=i.length;a<o;a++){var s=i[a];if(r==="utf8"){s=s>=252&&s<254&&a+5<o?(s-252)*1073741824+(i[++a]-128<<24)+(i[++a]-128<<18)+(i[++a]-128<<12)+(i[++a]-128<<6)+i[++a]-128:s>>248&&s<252&&a+4<o?(s-248<<24)+(i[++a]-128<<18)+(i[++a]-128<<12)+(i[++a]-128<<6)+i[++a]-128:s>>240&&s<248&&a+3<o?(s-240<<18)+(i[++a]-128<<12)+(i[++a]-128<<6)+i[++a]-128:s>=224&&s<240&&a+2<o?(s-224<<12)+(i[++a]-128<<6)+i[++a]-128:s>=192&&s<224&&a+1<o?(s-192<<6)+i[++a]-128:s}else if(r==="unicode"||r==="ucs2"||r==="utf16"){s=(s<<8)+i[++a];if(s>=55296&&s<57344){var c=s-55296<<10;s=i[++a];s=(s<<8)+i[++a];var u=s-56320;s=c+u+65536}}else if(r==="utf32"||r==="ucs4"){s=(s<<8)+i[++a];s=(s<<8)+i[++a];s=(s<<8)+i[++a]}else if(r==="win1251"){if(s>=128){if(s>=192&&s<256)s+=848;else s=t[s]||0}}n.push(String.fromCharCode(s))}return n.join("")}}}();GostCoding.prototype.Chars=o;var s={decode:function decode(e,t){e=e.replace(/[^A-fa-f0-9]/g,"");var r=Math.ceil(e.length/2),n=new Uint8Array(r);e=(e.length%2>0?"0":"")+e;if(t&&(typeof t!=="string"||t.toLowerCase().indexOf("little")<0))for(var i=0;i<r;i++){n[i]=parseInt(e.substr((r-i-1)*2,2),16)}else for(var i=0;i<r;i++){n[i]=parseInt(e.substr(i*2,2),16)}return n.buffer},encode:function encode(e,t){var r=[],n=new Uint8Array(buffer(e)),i=n.length;if(t&&(typeof t!=="string"||t.toLowerCase().indexOf("little")<0))for(var a=0;a<i;a++){var o=i-a-1;r[o]=(o>0&&o%32===0?"\r\n":"")+("00"+n[a].toString(16)).slice(-2)}else for(var a=0;a<i;a++){r[a]=(a>0&&a%32===0?"\r\n":"")+("00"+n[a].toString(16)).slice(-2)}return r.join("")}};GostCoding.prototype.Hex=s;var c={decode:function decode(e){e=(e||"").replace(/[^\-A-fa-f0-9]/g,"");if(e.length===0)e="0";var t=false;if(e.charAt(0)==="-"){t=true;e=e.substring(1)}while(e.charAt(0)==="0"&&e.length>1){e=e.substring(1)}e=(e.length%2>0?"0":"")+e;if(!t&&!/^[0-7]/.test(e)||t&&!/^[0-7]|8[0]+$/.test(e))e="00"+e;var r=e.length/2,n=new Uint8Array(r),i=0;for(var a=r-1;a>=0;--a){var o=parseInt(e.substr(a*2,2),16);if(t&&o+i>0){o=256-o-i;i=1}n[a]=o}return n.buffer},encode:function encode(e){var t=new Uint8Array(buffer(e)),r=t.length;if(t.length===0)return"0x00";var n=[],i=t[0]>127,a=0;for(var o=r-1;o>=0;--o){var s=t[o];if(i&&s+a>0){s=256-s-a;a=1}n[o]=("00"+s.toString(16)).slice(-2)}n=n.join("");while(n.charAt(0)==="0"){n=n.substring(1)}return(i?"-":"")+"0x"+n}};GostCoding.prototype.Int16=c;var u=function(){function encodeBER(e,t,r){var a=e.object;if(a===undefined)a=e;var u=e.tagClass=e.tagClass||0;if(u===0){var f=e.tagNumber;if(typeof f==="undefined"){if(typeof a==="string"){if(a==="")f=5;else if(/^\-?0x[0-9a-fA-F]+$/.test(a))f=2;else if(/^(\d+\.)+\d+$/.test(a))f=6;else if(/^[01]+$/.test(a))f=3;else if(/^(true|false)$/.test(a))f=1;else if(/^[0-9a-fA-F]+$/.test(a))f=4;else f=19}else if(typeof a==="number"){f=2}else if(typeof a==="boolean"){f=1}else if(a instanceof Array){f=16}else if(a instanceof Date){f=24}else if(a instanceof i||a&&a.buffer instanceof i){f=4}else throw new n.DataError("Unrecognized type for "+a)}}var d=e.tagConstructed;if(typeof d==="undefined")d=e.tagConstructed=a instanceof Array;var h;if(a instanceof i||a&&a.buffer instanceof i){h=new Uint8Array(buffer(a));if(f===3){var y=new Uint8Array(buffer(h));h=new Uint8Array(y.length+1);h[0]=0;h.set(y,1)}}else if(d){if(a instanceof Array){var l=0,p=[],v=0;for(var g=0,m=a.length;g<m;g++){p[g]=encodeBER(a[g],t);l+=p[g].length}if(f===17)p.sort(function(e,t){for(var r=0,n=Math.min(e.length,t.length);r<n;r++){var i=e[r]-t[r];if(i!==0)return i}return e.length-t.length});if(t==="CER"){p[m]=new Uint8Array(2);l+=2}h=new Uint8Array(l);for(var g=0,m=p.length;g<m;g++){h.set(p[g],v);v=v+p[g].length}}else throw new n.DataError("Constracted block can't be primitive")}else{switch(f){case 1:h=new Uint8Array(1);h[0]=a?255:0;break;case 2:case 10:h=c.decode(typeof a==="number"?a.toString(16):a);break;case 3:if(typeof a==="string"){var C=7-(a.length+7)%8;var m=Math.ceil(a.length/8);h=new Uint8Array(m+1);h[0]=C;for(var g=0;g<m;g++){var b=0;for(var A=0;A<8;A++){var w=g*8+A;b=(b<<1)+(w<a.length?a.charAt(w)==="1"?1:0:0)}h[g+1]=b}}break;case 4:h=s.decode(typeof a==="number"?a.toString(16):a);break;case 6:var y=a.match(/\d+/g),F=[];for(var g=1;g<y.length;g++){var m=+y[g],S=[];if(g===1)m=m+y[0]*40;do{S.push(m&127);m=m>>>7}while(m);for(A=S.length-1;A>=0;--A){F.push(S[A]+(A===0?0:128))}}h=new Uint8Array(F);break;case 12:h=o.decode(a,"utf8");break;case 18:case 22:case 19:case 20:case 21:case 25:case 26:case 27:for(var g=0,m=a.length;g<m;g++){if(a.charCodeAt(g)>255)f=12}if(f===12)h=o.decode(a,"utf8");else h=o.decode(a,"ascii");break;case 23:case 24:var E=a.original;if(!E){var K=new Date(a);K.setMinutes(K.getMinutes()+K.getTimezoneOffset());var P=f===24?K.getMilliseconds().toString():"";while(P.length>0&&P.charAt(P.length-1)==="0"){P=P.substring(0,P.length-1)}if(P.length>0)P="."+P;E=(f===23?K.getYear().toString().slice(-2):K.getFullYear().toString())+("00"+(K.getMonth()+1)).slice(-2)+("00"+K.getDate()).slice(-2)+("00"+K.getHours()).slice(-2)+("00"+K.getMinutes()).slice(-2)+("00"+K.getSeconds()).slice(-2)+P+"Z"}h=o.decode(E,"ascii");break;case 28:h=o.decode(a,"utf32");break;case 30:h=o.decode(a,"utf16");break}}if(!h)h=new Uint8Array(0);if(h instanceof i)h=new Uint8Array(h);if(!d&&t==="CER"){var w;switch(f){case 3:w=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:w=w||0;var B=1e3;var l=0,p=[],v=0;for(var g=w,m=h.length;g<m;g+=B-w){p[g]=encodeBER({object:new Unit8Array(h.buffer,g,Math.min(B-w,m-g)),tagNumber:f,tagClass:0,tagConstructed:false},t);l+=p[g].length}p[m]=new Uint8Array(2);l+=2;h=new Uint8Array(l);for(var g=0,m=p.length;g<m;g++){h.set(p[g],v);v=v+p[g].length}}}if(u===0)e.tagNumber=f;else e.tagNumber=f=e.tagNumber||0;e.content=h;if(r)return h;var D=[],k=u===3?192:u===2?128:u===1?64:0;if(d)k|=32;if(f<31){k|=f&31;D.push(k)}else{k|=31;D.push(k);var m=f,I=[];do{I.push(m&127);m=m>>>7}while(m);for(var A=I.length-1;A>=0;--A){D.push(I[A]+(A===0?0:128))}}if(d&&t==="CER"){D.push(128)}else{var x=h.length;if(x>127){var T=x,R=[];do{R.push(T&255);T=T>>>8}while(T);D.push(R.length+128);for(var A=R.length-1;A>=0;--A){D.push(R[A])}}else{D.push(x)}}var G=e.header=new Uint8Array(D);var U=new Uint8Array(G.length+h.length);U.set(G,0);U.set(h,G.length);return U}function decodeBER(e,t){var r=t||0,a=r;var s,u,f,d,h,y,l,p;if(e.object){s=e.tagNumber;u=e.tagClass;f=e.tagConstructed;d=e.content;h=e.header;y=e.object instanceof i?new Uint8Array(e.object):null;l=e.object instanceof Array?e.object:null;p=y&&y.length||null}else{var v=e;var g=v[r++];s=g&31;u=g>>6;f=(g&32)!==0;if(s===31){s=0;do{if(s>9007199254740864)throw new n.DataError("Convertor not supported tag number more then (2^53 - 1) at position "+t);g=v[r++];s=(s<<7)+(g&127)}while(g&128)}g=v[r++];p=g&127;if(p!==g){if(p>6)throw new n.DataError("Length over 48 bits not supported at position "+t);if(p===0)p=null;else{g=0;for(var m=0;m<p;++m){g=(g<<8)+v[r++]}p=g}}a=r;l=null;if(f){l=[];if(p!==null){var C=a+p;while(r<C){var b=decodeBER(v,r);l.push(b);r+=b.header.length+b.content.length}if(r!==C)throw new n.DataError("Content size is not correct for container starting at offset "+a)}else{try{for(;;){var b=decodeBER(v,r);r+=b.header.length+b.content.length;if(b.tagClass===0&&b.tagNumber===0)break;l.push(b)}p=r-a}catch(e){throw new n.DataError("Exception "+e+" while decoding undefined length content at offset "+a)}}}h=new Uint8Array(v.buffer,t,a-t);d=new Uint8Array(v.buffer,a,p);y=d}if(l!==null&&u===0){var A;switch(s){case 3:A=1;case 4:case 12:case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:case 28:case 30:A=A||0;if(l.length===0)throw new n.DataError("No constructed encoding content of string type at offset "+a);p=A;for(var m=0,w=l.length;m<w;m++){var b=l[m];if(b.tagClass!==u||b.tagNumber!==s||b.tagConstructed)throw new n.DataError("Invalid constructed encoding of string type at offset "+a);p+=b.content.length-A}y=new Uint8Array(p);for(var m=0,w=l.length,F=A;m<w;m++){var b=l[m];if(A>0)y.set(b.content.subarray(1),F);else y.set(b.content,F);F+=b.content.length-A}f=false;l=null;break}}var S="";if(l===null){if(p===null)throw new n.DataError("Invalid tag with undefined length at offset "+a);if(u===0){switch(s){case 1:S=y[0]!==0;break;case 2:case 10:if(p>6){S=c.encode(y)}else{var E=y[0];if(y[0]>127)E=E-256;for(var m=1;m<p;m++){E=E*256+y[m]}S=E}break;case 3:if(p>5){S=new Uint8Array(y.subarray(1)).buffer}else{var K=y[0],P=K,b=[];for(var m=p-1;m>=1;--m){var B=y[m];for(var F=P;F<8;++F){b.push(B>>F&1?"1":"0")}P=0}S=b.reverse().join("")}break;case 4:S=new Uint8Array(y).buffer;break;case 6:var b="",w=0,D=0;for(var m=0;m<p;++m){var E=y[m];w=(w<<7)+(E&127);D+=7;if(!(E&128)){if(b===""){var k=w<80?w<40?0:1:2;b=k+"."+(w-k*40)}else b+="."+w.toString();w=0;D=0}}if(D>0)throw new n.DataError("Incompleted OID at offset "+a);S=b;break;case 16:case 17:S=[];break;case 12:S=o.encode(y,"utf8");break;case 18:case 19:case 20:case 21:case 22:case 25:case 26:case 27:S=o.encode(y,"ascii");break;case 28:S=o.encode(y,"utf32");break;case 30:S=o.encode(y,"utf16");break;case 23:case 24:var I=s===23;var b=o.encode(y,"ascii"),k=(I?/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/:/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/).exec(b);if(!k)throw new n.DataError('Unrecognized time format "'+b+'" at offset '+a);if(I){k[1]=+k[1];k[1]+=k[1]<50?2e3:1900}var x=new Date(k[1],+k[2]-1,+k[3],+(k[4]||"0"),+(k[5]||"0"),+(k[6]||"0"),+(k[7]||"0")),T=x.getTimezoneOffset();if(k[8]||s===23){if(k[8].toUpperCase()!=="Z"&&k[9]){T=T+parseInt(k[9])}x.setMinutes(x.getMinutes()-T)}x.original=b;S=x;break}}else S=new Uint8Array(y).buffer}else S=l;return{tagConstructed:f,tagClass:u,tagNumber:s,header:h,content:d,object:S}}return{encode:function encode(e,t,r){return encodeBER(e,t,r).buffer},decode:function decode(e){return decodeBER(e.object?e:new Uint8Array(buffer(e)),0)}}}();GostCoding.prototype.BER=u;var f={encode:function encode(e,t){return(t?"-----BEGIN "+t.toUpperCase()+"-----\r\n":"")+a.encode(e instanceof i?e:u.encode(e))+(t?"\r\n-----END "+t.toUpperCase()+"-----":"")},decode:function decode(e,t,r,i){var o=/([A-Za-z0-9\+\/\s\=]+)/g,s=o.exec(e);if(s[1].length!==e.length)s=false;if(!s&&t){var c=new RegExp("-----\\s?BEGIN "+t.toUpperCase()+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+t.toUpperCase()+"-----","g");s=c.exec(e)}if(!s){var f=new RegExp("-----\\s?BEGIN [A-Z0-9\\s]+"+"-----([A-Za-z0-9\\+\\/\\s\\=]+)-----\\s?END "+"[A-Z0-9\\s]+-----","g");s=f.exec(e)}var d=s&&s[1+(i||0)];if(!d)throw new n.DataError("Not valid PEM format");var h=a.decode(d);if(r)h=u.decode(h);return h}};GostCoding.prototype.PEM=f;var d=t.gostCodingInstance=new GostCoding},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GostDigest=GostDigest;var n=r(1);var i=r(4);var a=r(0);function arraycopy(e,t,r,n,i){for(var a=0;a<i;a++){r[n+a]=e[t+a]}}function swap(e){var t=new Uint8Array(e),r=new Uint8Array(t.length);for(var n=0,i=t.length;n<i;n++){r[i-n-1]=t[n]}return r.buffer}function b64decode(e){var t=e.length,r=t*3+1>>2,n=new Uint8Array(r);for(var i,a,o=0,s=0,c=0;c<t;c++){a=c&3;var u=e.charCodeAt(c);u=u>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:u===43?62:u===47?63:0;o|=u<<18-6*a;if(a===3||t-c===1){for(i=0;i<3&&s<r;i++,s++){n[s]=o>>>(16>>>i&24)&255}o=0}}return n.buffer}function buffer(e){if(e instanceof ArrayBuffer)return e;else if(e&&e.buffer&&e.buffer instanceof ArrayBuffer)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;else throw new a.DataError("ArrayBuffer or ArrayBufferView required")}var o=function(){var e=new Int32Array(16);var t=new Int32Array(16);t[0]=512;var r=function(e){var t=new Int32Array(b64decode(e)),r=new Array(12);for(var n=0;n<12;n++){r[n]=new Int32Array(t.buffer,n*64,16)}return r}("B0Wm8lllgN0jTXTMNnR2BRXTYKQIKkKiAWlnkpHgfEv8xIV1jbhOcRbQRS5DdmovH3xlwIEvy+vp2soe2lsIsbebsSFwBHnmVs3L1xui3VXKpwrbwmG1XFiZ1hJrF7WaMQG1Fg9e1WGYKyMKcur+89e1cA9GneNPGi+dqYq1o2+yCroK9ZYemTHbeoZD9LbCCdtiYDc6ycGxnjWQ5A/i03t7KbEUderyix+cUl9e8QY1hD1qKPw5Cscvzius3HT1LtHjhLy+DCLxN+iToepTNL4DUpMzE7fYddYD7YIs16k/NV5orRxynX08XDN+hY5I3eRxXaDhSPnSZhXos98f71f+bHz9WBdg9WPqqX6iVnoWGicjtwD/36P1OiVHF82/vf8PgNc1njVKEIYWHxwVf2MjqWwMQT+amUdHraxr6ktufWRGekBo+jVPkDZyxXG/tsa+wmYf8gq0t5oct6b6z8aO8Jq0mn8YbKRCUfnEZi3AOTB6O8Okb9nTOh2urk+uk9QUOk1WhojzSjyiTEUXNQQFSiiDaUcGNyyCLcWrkgnJk3oZMz5H08mHv+bHxp45VAkkv/6GrFHsxaruFg7H9B7nAr/UDX+k"+"2ahRWTXCrDYvxKXRK43RaZAGm5LLK4n0msTbTTtEtIke3jaccfi3TkFBbgwCqucDp8mTTUJbH5vbWiODUURhcmAqH8uS3DgOVJwHppqKK3uxzrLbC0QKgIQJDeC3Vdk8JEKJJRs6fTreXxbs2JpMlJsiMRZUWo837ZxFmPvHtHTDtjsV0fqYNvRSdjswbB56SzNprwJn558DYTMbiuH/H9t4iv8c50GJ8/PkskjlKjhSbwWApt6+qxst84HNpMprXdhvwEpZot6Ybkd9Hc2678q5SOrvcR2KeWaEFCGAASBhB6vru2v62JT+WmPNxgIw+4nI79CezXsg1xvxSpK8SJkbstnVF/T6UijhiKqkHeeGzJEYne+AXZufITDUEiD4dx3fvDI8pM16sUkEsIAT0roxFvFn5443");var n=function(e){return new Int32Array(b64decode(e))}("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");var i,a,o;function get8(e,t){return e[t>>2]>>((t&3)<<3)&255}function add512(e,t){var r=0,n,i;for(var a=0;a<16;a++){n=(e[a]&65535)+(t[a]&65535)+(r||0);i=(e[a]>>>16)+(t[a]>>>16)+(n>>>16);e[a]=n&65535|i<<16;r=i>>>16}}function get512(e){return new Int32Array(e.buffer,e.byteOffset,16)}function copy512(e,t){for(var r=0;r<16;r++){e[r]=t[r]}}function new512(){return new Int32Array(16)}function xor512(e,t){for(var r=0;r<16;r++){e[r]=e[r]^t[r]}}var s=new512();function XLPS(e,t){copy512(s,e);xor512(s,t);for(var r=0;r<8;r++){var i,a,o=get8(s,r)<<1;i=n[o];a=n[o+1];for(var c=1;c<8;c++){o=(c<<9)+(get8(s,(c<<3)+r)<<1);i=i^n[o];a=a^n[o+1]}e[r<<1]=i;e[(r<<1)+1]=a}}var c=new512(),u=new512();function g(e,t,n){var i;copy512(c,e);XLPS(c,t);copy512(u,c);XLPS(c,n);for(i=0;i<11;i++){XLPS(u,r[i]);XLPS(c,u)}XLPS(u,r[11]);xor512(c,u);xor512(e,c);xor512(e,n)}function stage2(e){var r=get512(e);g(o,a,r);add512(a,t);add512(i,r)}function stage3(t){var r=t.length;if(r>63)return;var n=new Int32Array(16);n[0]=r<<3;var s=new Uint8Array(64);for(var c=0;c<r;c++){s[c]=t[c]}s[r]=1;var u=get512(s),f=get512(n);g(o,a,u);add512(a,f);add512(i,u);g(o,e,a);g(o,e,i)}return function(e){i=new512();a=new512();o=new512();for(var t=0;t<16;t++){if(this.bitLength===256)o[t]=16843009}var r=new Uint8Array(buffer(e));var n=r.length;var s=n%64,c=(n-s)/64;for(var t=0;t<c;t++){stage2.call(this,new Uint8Array(r.buffer,t*64,64))}stage3.call(this,new Uint8Array(r.buffer,c*64,s));var u;if(this.bitLength===256){u=new Int32Array(8);for(var t=0;t<8;t++){u[t]=o[8+t]}}else{u=new Int32Array(16);for(var t=0;t<16;t++){u[t]=o[t]}}if(this.procreator==="SC"||this.procreator==="VN")return swap(u.buffer);else return u.buffer}}();var s=function(){var e,t,r,n;function P(e){var t=new Uint8Array(32);for(var r=0;r<8;r++){t[4*r]=e[r];t[1+4*r]=e[8+r];t[2+4*r]=e[16+r];t[3+4*r]=e[24+r]}return t}function A(e){var t=new Uint8Array(8);for(var r=0;r<8;r++){t[r]=e[r]^e[r+8]}arraycopy(e,8,e,0,24);arraycopy(t,0,e,24,8);return e}function fw(e){var t=new Uint16Array(e.buffer,0,16);var r=t[0]^t[1]^t[2]^t[3]^t[12]^t[15];arraycopy(t,1,t,0,15);t[15]=r}function encrypt(e,t,r,n,i){var a=new Uint8Array(8);arraycopy(n,i,a,0,8);var o=new Uint8Array(this.cipher.encrypt(e,a));arraycopy(o,0,t,r,8)}function process(n,i){var a=new Uint8Array(32),o=new Uint8Array(32),s=new Uint8Array(32),c=new Uint8Array(32);arraycopy(n,i,r,0,32);arraycopy(t,0,o,0,32);arraycopy(r,0,s,0,32);for(var u=0;u<32;u++){c[u]=o[u]^s[u]}encrypt.call(this,P(c),a,0,t,0);for(var f=1;f<4;f++){var d=A(o);for(var u=0;u<32;u++){o[u]=d[u]^e[f][u]}s=A(A(s));for(var u=0;u<32;u++){c[u]=o[u]^s[u]}encrypt.call(this,P(c),a,f*8,t,f*8)}for(var h=0;h<12;h++){fw(a)}for(var h=0;h<32;h++){a[h]=a[h]^r[h]}fw(a);for(var h=0;h<32;h++){a[h]=t[h]^a[h]}for(var h=0;h<61;h++){fw(a)}arraycopy(a,0,t,0,t.length)}function summing(e){var t=0;for(var r=0;r<n.length;r++){var i=(n[r]&255)+(e[r]&255)+t;n[r]=i;t=i>>>8}}var i=new Uint8Array([0,255,0,255,0,255,0,255,255,0,255,0,255,0,255,0,0,255,255,0,255,0,0,255,255,0,0,0,255,255,0,255]);return function(a){t=new Uint8Array(32);r=new Uint8Array(32);n=new Uint8Array(32);e=new Array(4);for(var o=0;o<4;o++){e[o]=new Uint8Array(32)}arraycopy(i,0,e[2],0,i.length);var s=new Uint8Array(buffer(a));var c=s.length;var u=c%32,f=(c-u)/32;for(var o=0;o<f;o++){var d=new Uint8Array(s.buffer,o*32,32);summing.call(this,d);process.call(this,d,0)}if(u>0){var d=new Uint8Array(s.buffer,f*32),h=new Uint8Array(32);arraycopy(d,0,h,0,u);summing.call(this,h);process.call(this,h,0)}var y=new Uint8Array(32),l=c*8,p=0;while(l>0){y[p++]=l&255;l=Math.floor(l/256)}process.call(this,y,0);process.call(this,n,0);var v=t.buffer;if(this.procreator==="SC")v=swap(v);return v}}();var c=function(){var e,t=new Uint32Array(80);function common(e,t,r,n,i){return i+t+r+n+(e<<5|e>>>27)>>>0}function f1(e,t,r,n,i,a){return common(e,i,a,1518500249,n^t&(r^n))}function f2(e,t,r,n,i,a){return common(e,i,a,1859775393,t^r^n)}function f3(e,t,r,n,i,a){return common(e,i,a,2400959708,t&r|n&(t|r))}function f4(e,t,r,n,i,a){return common(e,i,a,3395469782,t^r^n)}function cycle(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4];var s=f1;for(var c=0;c<80;c+=5){if(c===20){s=f2}else if(c===40){s=f3}else if(c===60){s=f4}o=s(r,n,i,a,o,t[c]);n=(n<<30|n>>>2)>>>0;a=s(o,r,n,i,a,t[c+1]);r=(r<<30|r>>>2)>>>0;i=s(a,o,r,n,i,t[c+2]);o=(o<<30|o>>>2)>>>0;n=s(i,a,o,r,n,t[c+3]);a=(a<<30|a>>>2)>>>0;r=s(n,i,a,o,r,t[c+4]);i=(i<<30|i>>>2)>>>0}e[0]+=r;e[1]+=n;e[2]+=i;e[3]+=a;e[4]+=o}function swap32(e){return(e&255)<<24|(e&65280)<<8|e>>8&65280|e>>24&255}return function(r){var n=new Uint8Array(buffer(r)),i=n.length;var a=i+9;if(a%64){a+=64-a%64}e=new Uint32Array(5);e[0]=1732584193;e[1]=4023233417;e[2]=2562383102;e[3]=271733878;e[4]=3285377520;for(var o=0;o<a;o+=64){for(var s=0;s<64;s++){var c=0,u=o+s;if(u<i){c=n[u]}else if(u===i){c=128}else{var f=a-u-1;if(f>=0&&f<4){c=i<<3>>>f*8&255}}if(s%4===0){t[s>>2]=c<<24}else{t[s>>2]|=c<<(3-s%4)*8}}for(var s=16;s<80;s++){var d=t[s-3]^t[s-8]^t[s-14]^t[s-16];t[s]=d<<1|d>>>31}cycle(e,t)}for(var s=0;s<5;s++){e[s]=swap32(e[s])}return e.buffer}}();function signHMAC(e,t){var r=this.digest===s?32:64,n=this.bitLength/8,i=buffer(e),a=buffer(t),o;if(i.byteLength===r)o=new Uint8Array(i);else{var o=new Uint8Array(r);if(i.byteLength>r){o.set(new Uint8Array(this.digest(i)))}else{o.set(new Uint8Array(i))}}var c=new Uint8Array(r+a.byteLength),u=new Uint8Array(r+n);for(var f=0;f<r;f++){c[f]=o[f]^54;u[f]=o[f]^92}c.set(new Uint8Array(a),r);u.set(new Uint8Array(this.digest(c)),r);return this.digest(u)}function verifyHMAC(e,t,r){var n=new Uint8Array(this.sign(e,r)),i=new Uint8Array(t);if(n.length!==i.length)return false;for(var a=0,o=n.length;a<o;a++){if(n[a]!==i[a])return false}return true}function generateKey(){return(0,n.getSeed)(this.bitLength).buffer}function deriveBitsPFXKDF(e,t){if(t%8>0)throw new a.DataError("Length must multiple of 8");var r=this.bitLength/8,n=this.digest===s?32:64,i=t/8,o=this.iterations;var c=this.diversifier,u=new Uint8Array(n);for(var f=0;f<n;f++){u[f]=c}var d=new Uint8Array(buffer(this.salt)),h=d.length,y=n*Math.ceil(h/n),l=new Uint8Array(y);for(var f=0;f<y;f++){l[f]=d[f%h]}var p=new Uint8Array(buffer(e)),v=p.length,g=n*Math.ceil(v/n),m=new Uint8Array(g);for(var f=0;f<g;f++){m[f]=p[f%v]}var C=new Uint8Array(y+g);arraycopy(l,0,C,0,y);arraycopy(m,0,C,y,g);var b=Math.ceil(i/r);var A=new Uint8Array(b*r);for(var f=0;f<b;f++){var w=new Uint8Array(n+y+g);arraycopy(u,0,w,0,n);arraycopy(C,0,w,n,y+g);for(var F=0;F<o;F++){w=new Uint8Array(this.digest(w))}arraycopy(w,0,A,f*r,r);var S=new Uint8Array(n);for(var F=0;F<n;F++){S[F]=w[F%r]}var E=(y+g)/n;for(F=0;F<E;F++){var K=1,P;for(var B=n-1;B>=0;--B){P=C[n*F+B]+S[B]+K;K=P>>>8;C[n*F+B]=P&255}}}var D=new Uint8Array(i);arraycopy(A,0,D,0,i);return D.buffer}function deriveBitsKDF(e,t){if(t%8>0)throw new a.DataError("Length must be multiple of 8");var r=t/8,n,i=new Uint8Array(buffer(this.context)),o=this.bitLength/8,s=Math.ceil(r/o);if(this.label)n=new Uint8Array(buffer(this.label));else n=new Uint8Array([38,189,184,120]);var c=new Uint8Array(r);for(var u=0;u<s;u++){var f=new Uint8Array(n.length+i.length+4);f[0]=u+1;f.set(n,1);f[n.length+1]=0;f.set(i,n.length+2);f[f.length-2]=t>>>8;f[f.length-1]=t&255;c.set(new Uint8Array(signHMAC.call(this,e,f),0,u<s-1?o:r-u*o),u*o)}return c.buffer}function deriveBitsPBKDF1(e,t){if(t<this.bitLength/2||t%8>0)throw new a.DataError("Length must be more than "+this.bitLength/2+" bits and multiple of 8");var r=this.bitLength/8,n=t/8,i=this.iterations,o=new Uint8Array(buffer(e)),s=new Uint8Array(buffer(this.salt)),c=s.length,u=o.length,f=new Uint8Array(u+c),d=new Uint8Array(n);if(n>r)throw new a.DataError("Invalid parameters: Length value");arraycopy(o,0,f,0,u);arraycopy(s,0,f,u,c);for(var h=0;h<i;h++){f=new Uint8Array(this.digest(f))}arraycopy(f,0,d,0,n);return d.buffer}function deriveBitsPBKDF2(e,t){var r=this.diversifier||1;t=t*r;if(t<this.bitLength/2||t%8>0)throw new a.DataError("Length must be more than "+this.bitLength/2+" bits and multiple of 8");var n=this.bitLength/8,i=t/8,o=this.iterations,s=new Uint8Array(buffer(e)),c=new Uint8Array(buffer(this.salt));var u=c.byteLength,f=new Uint8Array(u+4);arraycopy(c,0,f,0,u);if(i>(4294967295-1)*32)throw new a.DataError("Invalid parameters: Length value");var d=Math.ceil(i/n),h=new Uint8Array(i);for(var y=1;y<=d;y++){f[u]=y>>>24&255;f[u+1]=y>>>16&255;f[u+2]=y>>>8&255;f[u+3]=y&255;var l=new Uint8Array(signHMAC.call(this,s,f)),p=l;for(var v=1;v<o;v++){l=new Uint8Array(signHMAC.call(this,s,l));for(var g=0;g<n;g++){p[g]=l[g]^p[g]}}var m=(y-1)*n;arraycopy(p,0,h,m,Math.min(n,i-m))}if(r>1){var C=i/r,b=new Uint8Array(C);arraycopy(h,i-C,b,0,C);return b.buffer}else return h.buffer}function deriveBitsCP(e,t){if(t>this.bitLength||t%8>0)throw new a.DataError("Length can't be more than "+this.bitLength+" bits and multiple of 8");var r=this.digest===s?32:64,n=this.bitLength/8,i=e&&e.byteLength>0?new Uint8Array(buffer(e)):false,o=i?i.length:0,c=this.iterations,u=new Uint8Array(buffer(this.salt)),f=u.length,d=new Uint8Array(f+o);arraycopy(u,0,d,0,f);if(i)arraycopy(i,0,d,f,o);var h=new Uint8Array(this.digest(d)),y=new Uint8Array(r),l=new Uint8Array(r),p=new Uint8Array(r);var v="DENEFH028.760246785.IUEFHWUIO.EF";for(var g=0;g<v.length;g++){y[g]=v.charCodeAt(g)}d=new Uint8Array(2*(r+n));for(var m=0;m<c;m++){for(var g=0;g<r;g++){l[g]=y[g]^54;p[g]=y[g]^92;y[g]=0}arraycopy(l,0,d,0,r);arraycopy(h,0,d,r,n);arraycopy(p,0,d,r+n,r);arraycopy(h,0,d,r+n+r,n);arraycopy(new Uint8Array(this.digest(d)),0,y,0,n)}for(var g=0;g<n;g++){l[g]=y[g]^54;p[g]=y[g]^92;y[g]=0}d=new Uint8Array(2*n+f+o);arraycopy(l,0,d,0,n);arraycopy(u,0,d,n,f);arraycopy(p,0,d,n+f,n);if(i)arraycopy(i,0,d,n+f+n,o);h=this.digest(this.digest(d));if(t===this.bitLength)return h;else{var C=t/8,b=new Uint8Array(C);arraycopy(h,0,b,0,C);return b.buffer}}function deriveKey(e){return this.deriveBits(e,this.keySize*8)}function GostDigest(e){e=e||{};this.name=(e.name||"GOST R 34.10")+"-"+(e.version||2012)%100+((e.version||2012)>1?"-"+(e.length||256):"")+((e.mode||"HASH")!=="HASH"?"-"+e.mode:"")+(e.procreator?"/"+e.procreator:"")+(typeof e.sBox==="string"?"/"+e.sBox:"");this.procreator=e.procreator;this.bitLength=e.length||256;switch(e.version||2012){case 1:this.digest=c;this.bitLength=160;break;case 1994:this.digest=s;this.sBox=(e.sBox||(e.procreator==="SC"?"D-SC":"D-A")).toUpperCase();this.cipher=new i.GostCipher({name:"GOST 28147",block:"ECB",sBox:this.sBox,procreator:this.procreator});break;case 2012:this.digest=o;break;default:throw new a.NotSupportedError("Algorithm version "+e.version+" not supported")}this.keySize=e.keySize||(e.version<=2?this.bitLength/8:32);switch(e.mode||"HASH"){case"HASH":break;case"HMAC":this.sign=signHMAC;this.verify=verifyHMAC;this.generateKey=generateKey;break;case"KDF":this.deriveKey=deriveKey;this.deriveBits=deriveBitsKDF;this.label=e.label;this.context=e.context;break;case"PBKDF2":this.deriveKey=deriveKey;this.deriveBits=deriveBitsPBKDF2;this.generateKey=generateKey;this.salt=e.salt;this.iterations=e.iterations||2e3;this.diversifier=e.diversifier||1;break;case"PFXKDF":this.deriveKey=deriveKey;this.deriveBits=deriveBitsPFXKDF;this.generateKey=generateKey;this.salt=e.salt;this.iterations=e.iterations||2e3;this.diversifier=e.diversifier||1;break;case"CPKDF":this.deriveKey=deriveKey;this.deriveBits=deriveBitsCP;this.generateKey=generateKey;this.salt=e.salt;this.iterations=e.iterations||2e3;break;default:throw new a.NotSupportedError("Algorithm mode "+e.mode+" not supported")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GostCipher=GostCipher;var n=r(0);var i=r(1);var a=ArrayBuffer;var o=function(){var e=new a(2);new DataView(e).setInt16(0,256,true);return new Int16Array(e)[0]===256}();var s=new Uint8Array([0,0,0,0,0,0,0,0]);var c={"E-TEST":[4,2,15,5,9,1,0,8,14,3,11,12,13,7,10,6,12,9,15,14,8,1,3,10,2,7,4,13,6,0,11,5,13,8,14,12,7,3,9,10,1,5,2,4,6,15,0,11,14,9,11,2,5,15,7,1,0,13,12,6,10,4,3,8,3,14,5,9,6,8,0,13,10,11,7,12,2,1,15,4,8,15,6,11,1,9,12,5,13,3,7,10,0,14,2,4,9,11,12,0,3,6,7,5,4,8,14,15,1,10,2,13,12,6,5,2,11,0,9,13,3,14,7,10,15,4,1,8],"E-A":[9,6,3,2,8,11,1,7,10,4,14,15,12,0,13,5,3,7,14,9,8,10,15,0,5,2,6,12,11,4,13,1,14,4,6,2,11,3,13,8,12,15,5,10,0,7,1,9,14,7,10,12,13,1,3,9,0,2,11,4,15,8,5,6,11,5,1,9,8,13,15,0,14,4,2,3,12,7,10,6,3,10,13,12,1,2,0,11,7,5,9,4,8,15,14,6,1,13,2,9,7,10,6,0,8,12,4,5,15,3,11,14,11,10,15,5,0,12,14,8,6,2,3,9,1,7,13,4],"E-B":[8,4,11,1,3,5,0,9,2,14,10,12,13,6,7,15,0,1,2,10,4,13,5,12,9,7,3,15,11,8,6,14,14,12,0,10,9,2,13,11,7,5,8,15,3,6,1,4,7,5,0,13,11,6,1,2,3,10,12,15,4,14,9,8,2,7,12,15,9,5,10,11,1,4,0,13,6,8,14,3,8,3,2,6,4,13,14,11,12,1,7,15,10,0,9,5,5,2,10,11,9,1,12,3,7,4,13,0,6,15,8,14,0,4,11,14,8,3,7,1,10,2,9,6,15,13,5,12],"E-C":[1,11,12,2,9,13,0,15,4,5,8,14,10,7,6,3,0,1,7,13,11,4,5,2,8,14,15,12,9,10,6,3,8,2,5,0,4,9,15,10,3,7,12,13,6,14,1,11,3,6,0,1,5,13,10,8,11,2,9,7,14,15,12,4,8,13,11,0,4,5,1,2,9,3,12,14,6,15,10,7,12,9,11,1,8,14,2,4,7,3,6,5,10,0,15,13,10,9,6,8,13,14,2,0,15,3,5,11,4,1,12,7,7,4,0,5,10,2,15,14,12,6,1,11,13,9,3,8],"E-D":[15,12,2,10,6,4,5,0,7,9,14,13,1,11,8,3,11,6,3,4,12,15,14,2,7,13,8,0,5,10,9,1,1,12,11,0,15,14,6,5,10,13,4,8,9,3,7,2,1,5,14,12,10,7,0,13,6,2,11,4,9,3,15,8,0,12,8,9,13,2,10,11,7,3,6,5,4,14,15,1,8,0,15,3,2,5,14,11,1,10,4,7,12,9,13,6,3,0,6,15,1,14,9,2,13,8,12,4,11,10,5,7,1,10,6,8,15,11,0,4,12,3,5,9,7,13,2,14],"E-SC":[3,6,1,0,5,7,13,9,4,11,8,12,14,15,2,10,7,1,5,2,8,11,9,12,13,0,3,10,15,14,4,6,15,1,4,6,12,8,9,2,14,3,7,10,11,13,5,0,3,4,15,12,5,9,14,0,6,8,7,10,1,11,13,2,6,9,0,7,11,8,4,12,2,14,10,15,1,13,5,3,6,1,2,15,0,11,9,12,7,13,10,5,8,4,14,3,0,2,14,12,9,1,4,7,3,15,6,8,10,13,11,5,5,2,11,8,4,12,7,1,10,6,14,0,9,3,13,15],"E-Z":[12,4,6,2,10,5,11,9,14,8,13,7,0,3,15,1,6,8,2,3,9,10,5,12,1,14,4,7,11,13,0,15,11,3,5,8,2,15,10,13,14,1,7,4,12,9,6,0,12,8,2,1,13,4,15,6,7,0,10,5,3,14,9,11,7,15,5,10,8,1,6,13,0,9,3,14,11,4,2,12,5,13,15,6,9,2,12,10,11,7,8,1,4,3,14,0,8,14,2,5,6,9,1,12,15,4,11,0,13,10,3,7,1,7,14,13,0,5,8,3,4,15,10,6,9,12,11,2],"D-TEST":[4,10,9,2,13,8,0,14,6,11,1,12,7,15,5,3,14,11,4,12,6,13,15,10,2,3,8,1,0,7,5,9,5,8,1,13,10,3,4,2,14,15,12,7,6,0,9,11,7,13,10,1,0,8,9,15,14,4,6,12,11,2,5,3,6,12,7,1,5,15,13,8,4,10,9,14,0,3,11,2,4,11,10,0,7,2,1,13,3,6,8,5,9,12,15,14,13,11,4,1,3,15,5,9,0,10,14,7,6,8,2,12,1,15,13,0,5,7,10,4,9,2,3,14,6,11,8,12],"D-A":[10,4,5,6,8,1,3,7,13,12,14,0,9,2,11,15,5,15,4,0,2,13,11,9,1,7,6,3,12,14,10,8,7,15,12,14,9,4,1,0,3,11,5,2,6,10,8,13,4,10,7,12,0,15,2,8,14,1,6,5,13,11,9,3,7,6,4,11,9,12,2,10,1,8,0,14,15,13,3,5,7,6,2,4,13,9,15,0,10,1,5,11,8,14,12,3,13,14,4,1,7,0,5,10,3,12,8,15,6,2,9,11,1,3,10,9,5,11,4,15,8,6,7,14,13,0,2,12],"D-SC":[11,13,7,0,5,4,1,15,9,14,6,10,3,12,8,2,1,2,7,9,13,11,15,8,14,12,4,0,5,6,10,3,5,1,13,3,15,6,12,7,9,8,11,2,4,14,0,10,13,1,11,4,9,12,14,0,7,5,8,15,6,2,10,3,2,13,10,15,9,11,3,7,8,12,5,14,6,0,1,4,0,4,6,12,5,3,8,13,10,11,15,2,1,9,7,14,1,3,12,8,10,6,11,0,2,14,7,9,15,4,5,13,10,11,6,0,1,3,4,7,14,13,5,15,8,2,9,12]};var u=new Uint8Array([105,0,114,34,100,201,4,35,141,58,219,150,70,233,42,196,24,254,172,148,0,237,7,18,192,134,220,194,239,76,169,43]);function signed(e){return e>=2147483648?e-4294967296:e}function unsigned(e){return e<0?e+4294967296:e}function buffer(e){if(e instanceof a)return e;else if(e&&e.buffer&&e.buffer instanceof a)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;else throw new n.DataError("CryptoOperationData required")}function byteArray(e){return new Uint8Array(buffer(e))}function cloneArray(e){return new Uint8Array(byteArray(e))}function intArray(e){return new Int32Array(buffer(e))}function swap32(e){return(e&255)<<24|(e&65280)<<8|e>>8&65280|e>>24&255}var f=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);var d=function(){function gmul(e,t){var r=0,n,i;for(n=0;n<8;n++){if(t&1)r^=e;i=e&128;e=e<<1&255;if(i)e^=195;t>>=1}return r&255}var e=[1,16,32,133,148,192,194,251];var t=[];for(var r=0;r<8;r++){t[r]=[];for(var n=0;n<256;n++){t[r][n]=gmul(e[r],n)}}return t}();var h=[4,2,3,1,6,5,0,7,0,5,6,1,3,2,4,0];function funcR(e){var t=0;for(var r=0;r<16;r++){t^=d[h[r]][e[r]]}for(var r=16;r>0;--r){e[r]=e[r-1]}e[0]=t}function funcReverseR(e){var t=e[0];for(var r=0;r<15;r++){e[r]=e[r+1]}e[15]=t;var n=0;for(r=0;r<16;r++){n^=d[h[r]][e[r]]}e[15]=n}var y=[252,238,221,17,207,110,49,22,251,196,250,218,35,197,4,77,233,119,240,219,147,46,153,186,23,54,241,187,20,205,95,193,249,24,101,90,226,92,239,33,129,28,60,66,139,1,142,79,5,132,2,174,227,106,143,160,6,11,237,152,127,212,211,31,235,52,44,81,234,200,72,171,242,42,104,162,253,58,206,204,181,112,14,86,8,12,118,18,191,114,19,71,156,183,93,135,21,161,150,41,16,123,154,199,243,145,120,111,157,158,178,177,50,117,25,61,255,53,138,126,109,84,198,128,195,189,13,87,223,245,36,169,62,168,67,201,215,121,214,246,124,34,185,3,224,15,236,222,122,148,176,188,220,232,40,80,78,51,10,74,167,151,96,115,30,0,98,68,26,184,56,130,100,159,38,65,173,69,70,146,39,94,85,47,140,163,165,125,105,213,149,59,7,88,179,64,134,172,29,247,48,55,107,228,136,217,231,137,225,27,131,73,76,63,248,254,141,83,170,144,202,216,133,97,32,113,103,164,45,43,9,91,203,155,37,208,190,229,108,82,89,166,116,210,230,244,180,192,209,102,175,194,57,75,99,182];var l=function(){var e=[];for(var t=0,r=y.length;t<r;t++){e[y[t]]=t}return e}();function funcS(e){for(var t=0;t<16;++t){e[t]=y[e[t]]}}function funcReverseS(e){for(var t=0;t<16;++t){e[t]=l[e[t]]}}function funcX(e,t){for(var r=0;r<16;++r){e[r]^=t[r]}}function funcL(e){for(var t=0;t<16;++t){funcR(e)}}function funcReverseL(e){for(var t=0;t<16;++t){funcReverseR(e)}}function funcLSX(e,t){funcX(e,t);funcS(e);funcL(e)}function funcReverseLSX(e,t){funcX(e,t);funcReverseL(e);funcReverseS(e)}function funcF(e,t,r){var n=new Uint8Array(e);funcLSX(e,r);funcX(e,t);t.set(n)}function funcC(e,t){for(var r=0;r<15;r++){t[r]=0}t[15]=e;funcL(t)}function keySchedule128(e){var t=new Uint8Array(160),r=new Uint8Array(16);t.set(byteArray(e));for(var n=0;n<4;n++){var i=32*n,a=32*(n+1);t.set(new Uint8Array(t.buffer,i,32),a);for(var o=1;o<9;o++){funcC(n*8+o,r);funcF(new Uint8Array(t.buffer,a,16),new Uint8Array(t.buffer,a+16,16),r)}}return t}function process128(e,t,r,n){r=r||t.byteOffset;var i=new Uint8Array(t.buffer,r,16);if(n){for(var a=0;a<9;a++){funcReverseLSX(i,new Uint8Array(e.buffer,(9-a)*16,16))}funcX(i,new Uint8Array(e.buffer,0,16))}else{for(var a=0;a<9;a++){funcLSX(i,new Uint8Array(e.buffer,16*a,16))}funcX(i,new Uint8Array(e.buffer,16*9,16))}}function round(e,t,r){var n=t[0]+r&4294967295;var i=e[0+(n>>0*4&15)]<<0*4;i|=e[16+(n>>1*4&15)]<<1*4;i|=e[32+(n>>2*4&15)]<<2*4;i|=e[48+(n>>3*4&15)]<<3*4;i|=e[64+(n>>4*4&15)]<<4*4;i|=e[80+(n>>5*4&15)]<<5*4;i|=e[96+(n>>6*4&15)]<<6*4;i|=e[112+(n>>7*4&15)]<<7*4;n=i<<11|i>>>32-11;n^=t[1];t[1]=t[0];t[0]=n}function process89(e,t,r){r=r||t.byteOffset;var n=this.sBox,i=new Int32Array(t.buffer,r,2);for(var a=0;a<32;a++){round(n,i,e[a])}var o=i[0];i[0]=i[1];i[1]=o}function process15(e,t,r){r=r||t.byteOffset;var n=this.sBox,i=new Int32Array(t.buffer,r,2),a=swap32(i[0]);i[0]=swap32(i[1]);i[1]=a;for(var o=0;o<32;o++){round(n,i,e[o])}i[0]=swap32(i[0]);i[1]=swap32(i[1])}function keySchedule89(e,t){var r=new Int32Array(32),n=new Int32Array(buffer(e));for(var i=0;i<8;i++){r[i]=n[i]}if(t){for(var i=0;i<8;i++){r[i+8]=r[7-i]}for(var i=0;i<8;i++){r[i+16]=r[7-i]}}else{for(var i=0;i<8;i++){r[i+8]=r[i]}for(var i=0;i<8;i++){r[i+16]=r[i]}}for(var i=0;i<8;i++){r[i+24]=r[7-i]}return r}function keySchedule15(e,t){var r=new Int32Array(32),n=new Int32Array(buffer(e));for(var i=0;i<8;i++){r[i]=swap32(n[i])}if(t){for(var i=0;i<8;i++){r[i+8]=r[7-i]}for(var i=0;i<8;i++){r[i+16]=r[7-i]}}else{for(var i=0;i<8;i++){r[i+8]=r[i]}for(var i=0;i<8;i++){r[i+16]=r[i]}}for(var i=0;i<8;i++){r[i+24]=r[7-i]}return r}var p=function(){var e=new Uint8Array([217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173]);return function(t){var r=new Uint8Array(buffer(t)),n=Math.min(r.length,128),i=this.effectiveLength,a=Math.floor((i+7)/8),o=255%Math.pow(2,8+i-8*a);var s=new Uint8Array(128),c=new Uint16Array(s.buffer);for(var u=0;u<n;u++){s[u]=r[u]}for(var u=n;u<128;u++){s[u]=e[(s[u-1]+s[u-n])%256]}s[128-a]=e[s[128-a]&o];for(var u=127-a;u>=0;--u){s[u]=e[s[u+1]^s[u+a]]}return c}}();var v=function(){var e,t,r=new Uint16Array(4),n=new Uint16Array([1,2,3,5]),i;function rol(e,t){return(e<<t|e>>>16-t)&65535}function ror(e,t){return(e>>>t|e<<16-t)&65535}function mix(a){if(i){r[a]=ror(r[a],n[a]);r[a]=r[a]-e[t]-(r[(a+3)%4]&r[(a+2)%4])-(~r[(a+3)%4]&r[(a+1)%4]);t=t-1}else{r[a]=r[a]+e[t]+(r[(a+3)%4]&r[(a+2)%4])+(~r[(a+3)%4]&r[(a+1)%4]);t=t+1;r[a]=rol(r[a],n[a])}}function mash(t){if(i){r[t]=r[t]-e[r[(t+3)%4]&63]}else{r[t]=r[t]+e[r[(t+3)%4]&63]}}function perform(e,t){t=t||1;for(var r=0;r<t;r++){if(i){for(var n=3;n>=0;--n){e(n)}}else{for(var n=0;n<4;n++){e(n)}}}}return function(n,a,o,s){i=s;r=new Uint16Array(a.buffer,o||a.byteOffset,4);e=n;t=s?63:0;perform(mix,5);perform(mash);perform(mix,6);perform(mash);perform(mix,5)}}();function encryptECB(e,t){var r=this.pad(byteArray(t)),n=this.blockSize,i=r.byteLength/n,a=this.keySchedule(e);for(var o=0;o<i;o++){this.process(a,r,n*o)}return r.buffer}function decryptECB(e,t){var r=cloneArray(t),n=this.blockSize,i=r.byteLength/n,a=this.keySchedule(e,1);for(var o=0;o<i;o++){this.process(a,r,n*o,1)}return this.unpad(r).buffer}function encryptCFB(e,t,r){var n=new Uint8Array(r||this.iv),i=cloneArray(t),a=n.length,o=new Uint8Array(a),s=this.shiftBits>>3,c=i.length,u=c%s,f=(c-u)/s,d=this.keySchedule(e);for(var h=0;h<f;h++){for(var y=0;y<a;y++){o[y]=n[y]}this.process(d,n);for(var y=0;y<s;y++){i[h*s+y]^=n[y]}for(var y=0;y<a-s;y++){n[y]=o[s+y]}for(var y=0;y<s;y++){n[a-s+y]=i[h*s+y]}e=this.keyMeshing(e,n,h,d)}if(u>0){this.process(d,n);for(var h=0;h<u;h++){i[f*s+h]^=n[h]}}return i.buffer}function decryptCFB(e,t,r){var n=new Uint8Array(r||this.iv),i=cloneArray(t),a=n.length,o=new Uint8Array(a),s=this.shiftBits>>3,c=i.length,u=c%s,f=(c-u)/s,d=this.keySchedule(e);for(var h=0;h<f;h++){for(var y=0;y<a;y++){o[y]=n[y]}this.process(d,n);for(var y=0;y<s;y++){o[y]=i[h*s+y];i[h*s+y]^=n[y]}for(var y=0;y<a-s;y++){n[y]=o[s+y]}for(var y=0;y<s;y++){n[a-s+y]=o[y]}e=this.keyMeshing(e,n,h,d)}if(u>0){this.process(d,n);for(var h=0;h<u;h++){i[f*s+h]^=n[h]}}return i.buffer}function processOFB(e,t,r){var n=new Uint8Array(r||this.iv),i=cloneArray(t),a=n.length,o=new Uint8Array(a),s=this.shiftBits>>3,c=new Uint8Array(s),u=i.length,f=u%s,d=(u-f)/s,h=this.keySchedule(e);for(var y=0;y<d;y++){for(var l=0;l<a;l++){o[l]=n[l]}this.process(h,n);for(var l=0;l<s;l++){c[l]=n[l]}for(var l=0;l<s;l++){i[y*s+l]^=n[l]}for(var l=0;l<a-s;l++){n[l]=o[s+l]}for(var l=0;l<s;l++){n[a-s+l]=c[l]}e=this.keyMeshing(e,n,y,h)}if(f>0){this.process(h,n);for(var y=0;y<f;y++){i[d*s+y]^=n[y]}}return i.buffer}function processCTR89(e,t,r){var n=new Uint8Array(r||this.iv),i=cloneArray(t),a=this.blockSize,o=new Int8Array(a),s=i.length,c=s%a,u=(s-c)/a,f=this.keySchedule(e),d=new Int32Array(n.buffer);this.process(f,n);for(var h=0;h<u;h++){d[0]=d[0]+16843009&4294967295;var y=unsigned(d[1])+16843012;d[1]=signed(y<4294967296?y:y-4294967295);for(var l=0;l<a;l++){o[l]=n[l]}this.process(f,d);for(var l=0;l<a;l++){i[h*a+l]^=n[l]}for(var l=0;l<a;l++){n[l]=o[l]}e=this.keyMeshing(e,n,h,f)}if(c>0){d[0]=d[0]+16843009&4294967295;var y=unsigned(d[1])+16843012;d[1]=signed(y<4294967296?y:y-4294967295);this.process(f,d);for(var h=0;h<c;h++){i[u*a+h]^=n[h]}}return i.buffer}function processCTR15(e,t,r){var n=cloneArray(t),i=this.blockSize,a=this.shiftBits>>3,o=n.length,s=o%a,c=(o-s)/a,u=new Uint8Array(i),f=new Int32Array(i),d=this.keySchedule(e);u.set(r||this.iv);for(var h=0;h<c;h++){for(var y=0;y<i;y++){f[y]=u[y]}this.process(d,u);for(var y=0;y<a;y++){n[a*h+y]^=u[y]}for(var y=0;y<i;y++){u[y]=f[y]}for(var y=i-1;h>=0;--h){if(u[y]>254){u[y]-=254}else{u[y]++;break}}}if(s>0){this.process(d,u);for(var y=0;y<s;y++){n[a*c+y]^=u[y]}}return n.buffer}function encryptCBC(e,t,r){var n=new Uint8Array(r||this.iv),i=this.blockSize,a=n.length,o=this.pad(byteArray(t)),s=this.keySchedule(e);for(var c=0,u=o.length/i;c<u;c++){for(var f=0;f<i;f++){n[f]^=o[c*i+f]}this.process(s,n);for(var f=0;f<i;f++){o[c*i+f]=n[f]}if(a!==i){for(var f=0;f<a-i;f++){n[f]=n[i+f]}for(var f=0;f<i;f++){n[f+a-i]=o[c*i+f]}}e=this.keyMeshing(e,n,c,s)}return o.buffer}function decryptCBC(e,t,r){var n=new Uint8Array(r||this.iv),i=this.blockSize,a=n.length,o=cloneArray(t),s=new Uint8Array(i),c=this.keySchedule(e,1);for(var u=0,f=o.length/i;u<f;u++){for(var d=0;d<i;d++){s[d]=o[u*i+d]}this.process(c,o,u*i,1);for(var d=0;d<i;d++){o[u*i+d]^=n[d]}if(a!==i){for(var d=0;d<a-i;d++){n[d]=n[i+d]}}for(var d=0;d<i;d++){n[d+a-i]=s[d]}e=this.keyMeshing(e,n,u,c,1)}return this.unpad(o).buffer}function generateKey(){var e=new Uint8Array(this.keySize);(0,i.randomSeed)(e);return e.buffer}function processMAC89(e,t,r){var n=zeroPad.call(this,byteArray(r)),i=this.blockSize,a=n.length/i,o=this.sBox,s=new Int32Array(t.buffer);for(var c=0;c<a;c++){for(var u=0;u<i;u++){t[u]^=n[c*i+u]}for(var u=0;u<16;u++){round(o,s,e[u])}}}function processKeyMAC15(e){var t=0,r=e.length;for(var n=r-1;n>=0;--n){var i=e[n]>>>7;e[n]=e[n]<<1&255|t;t=i}if(t!==0){if(r===16)e[15]^=135;else e[7]^=27}}function processMAC15(e,t,r){var n=this.blockSize,i=this.sBox,a=byteArray(r),o=new Uint8Array(n);this.process(e,o);processKeyMAC15(o);if(r.byteLength%n!==0){a=bitPad.call(this,byteArray(r));processKeyMAC15(o)}for(var s=0,c=a.length/n;s<c;s++){for(var u=0;u<n;u++){t[u]^=a[s*n+u]}if(s===c-1){for(var u=0;u<n;u++){t[u]^=o[u]}}this.process(e,t)}}function signMAC(e,t,r){var n=this.keySchedule(e),i=new Uint8Array(r||this.iv),a=Math.ceil(this.macLength>>3)||this.blockSize>>1;this.processMAC(n,i,t);var o=new Uint8Array(a);o.set(new Uint8Array(i.buffer,0,a));return o.buffer}function verifyMAC(e,t,r,n){var i=new Uint8Array(signMAC.call(this,e,r,n)),a=byteArray(t);if(i.length!==a.length)return false;for(var o=0,s=i.length;o<s;o++){if(i[o]!==a[o])return false}return true}function wrapKeyGOST(e,t){var r=this.blockSize,i=this.keySize,a=i+(r>>1);if(!this.ukm)throw new n.DataError("UKM must be defined");var o=new Uint8Array(this.ukm);var s=signMAC.call(this,e,t,o);var c=encryptECB.call(this,e,t);var u=new Uint8Array(a);u.set(new Uint8Array(c),0);u.set(new Uint8Array(s),i);return u.buffer}function unwrapKeyGOST(e,t){var r=this.blockSize,i=this.keySize,a=i+(r>>1);var o=buffer(t);if(o.byteLength!==a)throw new n.DataError("Wrapping key size must be "+a+" bytes");if(!this.ukm)throw new n.DataError("UKM must be defined");var s=new Uint8Array(this.ukm),c=new Uint8Array(o,0,i),u=new Uint8Array(o,i,r>>1);var f=decryptECB.call(this,e,c);var d=verifyMAC.call(this,e,u,f,s);if(!d)throw new n.DataError("Error verify MAC of wrapping key");return f}function diversifyKEK(e,t){var r=this.blockSize;var n=intArray(e);var i=[];for(var a=0;a<r;a++){i[a]=[];for(var o=0;o<8;o++){i[a][o]=t[a]>>>o&1}}for(var a=0;a<r;a++){var s=new Int32Array(2);for(var o=0;o<8;o++){if(i[a][o])s[0]=s[0]+n[o]&4294967295;else s[1]=s[1]+n[o]&4294967295}var c=new Uint8Array(s.buffer);n=new Int32Array(encryptCFB.call(this,n,n,c))}return n}function wrapKeyCP(e,t){var r=this.blockSize,i=this.keySize,a=i+(r>>1);if(!this.ukm)throw new n.DataError("UKM must be defined");var o=new Uint8Array(this.ukm);var s=diversifyKEK.call(this,e,o);var c=signMAC.call(this,s,t,o);var u=encryptECB.call(this,s,t);var f=new Uint8Array(a);f.set(new Uint8Array(u),0);f.set(new Uint8Array(c),i);return f.buffer}function unwrapKeyCP(e,t){var r=this.blockSize,i=this.keySize,a=i+(r>>1);var o=buffer(t);if(o.byteLength!==a)throw new n.DataError("Wrapping key size must be "+a+" bytes");if(!this.ukm)throw new n.DataError("UKM must be defined");var s=new Uint8Array(this.ukm),c=new Uint8Array(o,0,i),u=new Uint8Array(o,i,r>>1);var f=diversifyKEK.call(this,e,s);var d=decryptECB.call(this,f,c);var h=verifyMAC.call(this,f,u,d,s);if(!h)throw new n.DataError("Error verify MAC of wrapping key");return d}function packKeySC(e,t){var r=this.blockSize>>1,a=this.keySize;var o=8;var s=new Uint8Array(buffer(e));if(s.byteLength!==a)throw new n.DataError("Wrong cleartext size "+s.byteLength+" bytes");t=t||this.ukm;if(t){t=new Uint8Array(buffer(t));if(t.byteLength>0&&t.byteLength%a===0)o=t.byteLength/a+1;else throw new n.DataError("Wrong rand size "+t.byteLength+" bytes")}else(0,i.randomSeed)(t=new Uint8Array((o-1)*a));var c=new Uint8Array(o*a+r+2),u=c.buffer;var f=new Uint8Array(a);var d=signMAC.call(this,s,f);c[0]=34;c[1]=o;c.set(new Uint8Array(d),2);c.set(t,a+r+2);for(var h=1;h<o;h++){var y=new Uint8Array(u,2+r+a*h);for(var l=0;l<a;l++){s[l]^=y[l]}}c.set(s,r+2);return c.buffer}function unpackKeySC(e){var t=this.blockSize>>1,r=this.keySize;var i=buffer(e);var a=new Uint8Array(i,0,1)[0];if(a!==34)throw new n.DataError("Invalid magic number");var o=new Uint8Array(i,1,1)[0];var s=new Uint8Array(i,2,t);var u=new Uint8Array(r);for(var f=0;f<o;f++){var d=new Uint8Array(i,2+t+r*f,r);for(var h=0;h<r;h++){u[h]^=d[h]}}var y=new Uint8Array(r);var l=verifyMAC.call(this,u,s,y);if(!l){var p=["E-A","E-B","E-C","E-D","E-SC"];for(var f=0,v=p.length;f<v;f++){this.sBox=c[p[f]];l=verifyMAC.call(this,u,s,y);if(l)break}}if(!l)throw new n.DataError("Invalid main key MAC");return u.buffer}function wrapKeySC(e,t){var r=this.blockSize>>1,n=this.keySize;var i=buffer(e);var a=buffer(t);if(i.byteLength!==n)i=unpackKeySC.call(this,i);var o=encryptECB.call(this,i,a);var s=signMAC.call(this,i,a);var c=new Uint8Array(r+n);c.set(new Uint8Array(o),0);c.set(new Uint8Array(s),n);return c.buffer}function unwrapKeySC(e,t){var r=this.blockSize>>1,i=this.keySize;var a=buffer(e);var o=buffer(t);if(a.byteLength!==i)a=unpackKeySC.call(this,a);var s=new Uint8Array(o,0,i);var c=new Uint8Array(o,i,r);var u=decryptECB.call(this,a,s);if(!verifyMAC.call(this,a,c,u))throw new n.DataError("Invalid key MAC");return u}function generateWrappingKeySC(){return packKeySC.call(this,generateKey.call(this))}function maskKey(e,t,r,n){var i=n/4,a=new Int32Array(buffer(e)),o=new Int32Array(buffer(t)),s=new Int32Array(i);if(r)for(var c=0;c<i;c++){s[c]=o[c]+a[c]&4294967295}else for(var c=0;c<i;c++){s[c]=o[c]-a[c]&4294967295}return s.buffer}function wrapKeyMask(e,t){return maskKey(e,t,this.procreator==="VN",this.keySize)}function unwrapKeyMask(e,t){return maskKey(e,t,this.procreator!=="VN",this.keySize)}function keyMeshingCP(e,t,r,n,i){if((r+1)*this.blockSize%1024===0){e=decryptECB.call(this,e,u);t.set(new Uint8Array(encryptECB.call(this,e,t)));n.set(this.keySchedule(e,i))}return e}function noKeyMeshing(e){return e}function noPad(e){return new Uint8Array(e)}function pkcs5Pad(e){var t=e.byteLength,r=this.blockSize,n=r-t%r,i=Math.ceil((t+1)/r)*r,a=new Uint8Array(i);a.set(e);for(var o=t;o<i;o++){a[o]=n}return a}function pkcs5Unpad(e){var t=e.byteLength,r=this.blockSize,i=e[t-1],a=t-i;if(i>r)throw(0,n.DataError)("Invalid padding");var o=new Uint8Array(a);if(a>0)o.set(new Uint8Array(e.buffer,0,a));return o}function zeroPad(e){var t=e.byteLength,r=this.blockSize,n=Math.ceil(t/r)*r,i=new Uint8Array(n);i.set(e);for(var a=t;a<n;a++){i[a]=0}return i}function bitPad(e){var t=e.byteLength,r=this.blockSize,n=Math.ceil((t+1)/r)*r,i=new Uint8Array(n);i.set(e);i[t]=1;for(var a=t+1;a<n;a++){i[a]=0}return i}function bitUnpad(e){var t=e.byteLength,r=t;while(r>1&&e[r-1]===0){r--}if(e[r-1]!==1)throw(0,n.DataError)("Invalid padding");r--;var i=new Uint8Array(r);if(r>0)i.set(new Uint8Array(e.buffer,0,r));return i}function randomPad(e){var t=e.byteLength,r=this.blockSize,n=r-t%r,a=Math.ceil(t/r)*r,o=new Uint8Array(a),s=new Uint8Array(o.buffer,t,n);o.set(e);(0,i.randomSeed)(s);return o}function GostCipher(e){if(!o)throw new n.NotSupportedError("Big endian platform not supported");e=e||{};this.keySize=32;this.blockLength=e.length||64;this.blockSize=this.blockLength>>3;this.name=(e.name||(e.version===1?"RC2":e.version===1989?"GOST 28147":"GOST R 34.12"))+(e.version>4?"-"+(e.version||1989)%100:"")+"-"+(this.blockLength===64?"":this.blockLength+"-")+(e.mode==="MAC"?"MAC-"+(e.macLength||this.blockLength>>1):e.mode==="KW"||e.keyWrapping?((e.keyWrapping||"NO")!=="NO"?e.keyWrapping:"")+"KW":(e.block||"ECB")+((e.block==="CFB"||e.block==="OFB"||e.block==="CTR"&&e.version===2015)&&e.shiftBits&&e.shiftBits!==this.blockLength?"-"+e.shiftBits:"")+(e.padding?"-"+(e.padding||(e.block==="CTR"||e.block==="CFB"||e.block==="OFB"?"NO":"ZERO"))+"PADDING":"")+((e.keyMeshing||"NO")!=="NO"?"-CPKEYMESHING":""))+(e.procreator?"/"+e.procreator:"")+(typeof e.sBox==="string"?"/"+e.sBox:"");this.procreator=e.procreator;switch(e.version||1989){case 1:this.process=v;this.keySchedule=p;this.blockLength=64;this.effectiveLength=e.length||32;this.keySize=8*Math.ceil(this.effectiveLength/8);this.blockSize=this.blockLength>>3;break;case 2015:this.version=2015;if(this.blockLength===64){this.process=process15;this.keySchedule=keySchedule15}else if(this.blockLength===128){this.process=process128;this.keySchedule=keySchedule128}else throw new n.DataError("Invalid block length");this.processMAC=processMAC15;break;case 1989:this.version=1989;this.process=process89;this.processMAC=processMAC89;this.keySchedule=keySchedule89;if(this.blockLength!==64)throw new n.DataError("Invalid block length");break;default:throw new n.NotSupportedError("Algorithm version "+e.version+" not supported")}switch(e.mode||e.keyWrapping&&"KW"||"ES"){case"ES":switch(e.block||"ECB"){case"ECB":this.encrypt=encryptECB;this.decrypt=decryptECB;break;case"CTR":if(this.version===1989){this.encrypt=processCTR89;this.decrypt=processCTR89}else{this.encrypt=processCTR15;this.decrypt=processCTR15;this.shiftBits=e.shiftBits||this.blockLength}break;case"CBC":this.encrypt=encryptCBC;this.decrypt=decryptCBC;break;case"CFB":this.encrypt=encryptCFB;this.decrypt=decryptCFB;this.shiftBits=e.shiftBits||this.blockLength;break;case"OFB":this.encrypt=processOFB;this.decrypt=processOFB;this.shiftBits=e.shiftBits||this.blockLength;break;default:throw new n.NotSupportedError("Block mode "+e.block+" not supported")}switch(e.keyMeshing){case"CP":this.keyMeshing=keyMeshingCP;break;default:this.keyMeshing=noKeyMeshing}if(this.encrypt===encryptECB||this.encrypt===encryptCBC){switch(e.padding){case"PKCS5P":this.pad=pkcs5Pad;this.unpad=pkcs5Unpad;break;case"RANDOM":this.pad=randomPad;this.unpad=noPad;break;case"BIT":this.pad=bitPad;this.unpad=bitUnpad;break;default:this.pad=zeroPad;this.unpad=noPad}}else{this.pad=noPad;this.unpad=noPad}this.generateKey=generateKey;break;case"MAC":this.sign=signMAC;this.verify=verifyMAC;this.generateKey=generateKey;this.macLength=e.macLength||this.blockLength>>1;this.pad=noPad;this.unpad=noPad;this.keyMeshing=noKeyMeshing;break;case"KW":this.pad=noPad;this.unpad=noPad;this.keyMeshing=noKeyMeshing;switch(e.keyWrapping){case"CP":this.wrapKey=wrapKeyCP;this.unwrapKey=unwrapKeyCP;this.generateKey=generateKey;this.shiftBits=e.shiftBits||this.blockLength;break;case"SC":this.wrapKey=wrapKeySC;this.unwrapKey=unwrapKeySC;this.generateKey=generateWrappingKeySC;break;default:this.wrapKey=wrapKeyGOST;this.unwrapKey=unwrapKeyGOST;this.generateKey=generateKey}break;case"MASK":this.wrapKey=wrapKeyMask;this.unwrapKey=unwrapKeyMask;this.generateKey=generateKey;break;default:throw new n.NotSupportedError("Mode "+e.mode+" not supported")}var t=e.sBox,r;if(!t)t=this.version===2015?c["E-Z"]:this.procreator==="SC"?c["E-SC"]:c["E-A"];else if(typeof t==="string"){r=t.toUpperCase();t=c[r];if(!t)throw new SyntaxError("Unknown sBox name: "+e.sBox)}else if(!t.length||t.length!==c["E-Z"].length)throw new SyntaxError("Length of sBox must be "+c["E-Z"].length);this.sBox=t;if(e.iv){this.iv=new Uint8Array(e.iv);if(this.iv.byteLength!==this.blockSize&&this.version===1989)throw new SyntaxError("Length of iv must be "+this.blockLength+" bits");else if(this.iv.byteLength!==this.blockSize>>1&&this.encrypt===processCTR15)throw new SyntaxError("Length of iv must be "+this.blockLength>>1+" bits");else if(this.iv.byteLength%this.blockSize!==0&&this.encrypt!==processCTR15)throw new SyntaxError("Length of iv must be a multiple of "+this.blockLength+" bits")}else this.iv=this.blockLength===128?f:s;if(e.ukm){this.ukm=new Uint8Array(e.ukm);if(this.ukm.byteLength*8!==this.blockLength)throw new SyntaxError("Length of ukm must be "+this.blockLength+" bits")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostASN1Instance=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.GostASN1=GostASN1;var i=r(18);var a=r(6);var o=r(2);var s=ArrayBuffer;var c=a.gostSecurityInstance.algorithms,u=a.gostSecurityInstance.names,f=a.gostSecurityInstance.identifiers,d=a.gostSecurityInstance.attributes,h=a.gostSecurityInstance.parameters;var y=o.gostCodingInstance.BER,l=o.gostCodingInstance.PEM,p=o.gostCodingInstance.Chars,v=o.gostCodingInstance.Hex,g=o.gostCodingInstance.Int16;function swapBytes(e){if(e instanceof s)e=new Uint8Array(e);var t=new Uint8Array(e.length);for(var r=0,n=e.length;r<n;r++){t[n-r-1]=e[r]}return t.buffer}function isBinary(e){return e instanceof s||e.buffer instanceof s}function lpad(e,t){return e.length>=t?e:new Array(t-e.length+1).join("0")+e}function npw2(e){return e<=2?e:e<=4?4:e<=8?8:e<=16?16:e<=32?32:e<=64?64:e<=128?128:e<=256?256:e<512?512:e<1024?1024:undefined}var m={encode:function encode(e,t){return"0x"+v.encode(e,t)},decode:function decode(e,t,r){if(typeof e==="number")e=e.toString(16);var n=e.replace("0x","");r=r||npw2(n.length);return v.decode(lpad(n,r),t)}};function assert(e){if(e)throw Error("Invalid format")}function defineProperty(e,t,r,i){if((typeof r==="undefined"?"undefined":n(r))!=="object")r={value:r};if(i!==undefined)r.enumerable=i;Object.defineProperty(e,t,r)}function defineProperties(e,t,r){for(var n in t){defineProperty(e,n,t[n],r)}}function getOwnPropertyDescriptor(e,t){return Object.getOwnPropertyDescriptor(e,t)}function _encode(e,t,r,n,i,a){assert(t===undefined);var o={tagNumber:r,tagClass:n||0,tagConstructed:i||false,object:t};e=e||"DER";if(e==="DER"||e==="CER")o=y.encode(o,e);if(e==="PEM")o=l.encode(o,a);return o}function _decode(e,t,r,n,i){assert(e===undefined);if(typeof e==="string")e=l.decode(e,i,false);if(e instanceof s){try{e=l.decode(p.encode(e),i,true)}catch(t){e=y.decode(e)}}r=r||0;n=n||false;if(e.tagNumber===undefined){e=_encode(true,e.object,t,r,e.object instanceof Array);e=y.decode(e)}assert(e.tagClass!==r||e.tagNumber!==t||e.tagConstructed!==n);if(r===0&&t===5)return null;else return e.object}function extend(e,t,r,n){if(typeof t!=="function"){n=r;r=t;t=function Class(){e.apply(this,arguments)}}t.prototype=Object.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}});if(r)defineProperties(t.prototype,r);if(e!==Object)for(var i in e){t[i]=e[i]}t.super=e;if(n)defineProperties(t,n,true);return t}var C=extend(Object,function(e){this.object=e},{_set:function _set(e,t,r){e.property(t).set.call(this,r)},_get:function _get(e,t){return e.property(t).get.call(this)},_call:function _call(e,t,r){return e.method(t).apply(this,r)},hasProperty:function hasProperty(e){return this.hasOwnProperty(e)||!!this.constructor.property(e)},encode:function encode(){return this.object}},{decode:function decode(e){return new this(e)},property:function property(e){var t=this.prototype;while(t){var r=getOwnPropertyDescriptor(t,e);if(r)return r;else t=t.superclass}},method:function method(e){var t=this.prototype;while(t){if(t[e])return t[e];else t=t.superclass}}});var b=function PRIMITIVE(e){return extend(C,{encode:function encode(t){return _encode(t,this.object,e)}},{decode:function decode(t){return new this(_decode(t,e))}})};var A=C;var w=b(1);var F=b(22);var S=b(18);var E=b(19);var K=b(20);var P=b(12);var B=b(23);var D=b(24);var k=b(28);var I=b(30);var x=extend(b(5),{object:{get:function get(){return null},set:function set(e){assert(e!==null)}}});var T=function PRIMITIVE_CODE(e){var t=extend(b(e),function(e){if(this instanceof t)t.super.apply(this,arguments);else return CODE(e)});function CODE(r){return extend(b(e),function(e){t.super.call(this,e)},{encode:function encode(t){return _encode(t,r[this.object],e)}},{decode:function decode(t){var n=_decode(t,e);for(var i in r){if(n===r[i])return new this(i)}assert(true)}})}return t};var R=T(2);var G=T(10);var U=function(){var e=extend(b(4),function(t){if(this instanceof e)e.super.apply(this,arguments);else return WRAPPING(t)});function WRAPPING(t){if(t){return extend(t,{encode:function encode(e){return _encode(e,t.method("encode").call(this,true),4)}},{decode:function decode(e){return t.decode.call(this,_decode(e,4))}})}else return e}return e}();var O=function(){var e=extend(b(3),function(t){if(this instanceof e)e.super.apply(this,arguments);else if((typeof t==="undefined"?"undefined":n(t))==="object")return MASK(t);else return WRAPPING(t)});function WRAPPING(t){if(t){return extend(t,{encode:function encode(e){return _encode(e,t.method("encode").call(this,true),3)}},{decode:function decode(e){return t.decode.call(this,_decode(e,3))}})}else return e}function MASK(e){return extend(C,function(e,t){C.call(this,e);this.numbits=t||0},{encode:function encode(t){var r=this.object,n=[];if(r instanceof Array){for(var i=0,a=r.length;i<a;i++){var o=e[r[i]];if(o!==undefined)n[o]="1"}for(var i=0,a=Math.max(n.length,this.numbits);i<a;i++){if(!n[i])n[i]="0"}n=n.join("")}else n="0";return _encode(t,n,3)}},{decode:function decode(t){var r=_decode(t,3),n=[];for(var i in e){var a=e[i];if(r.charAt(a)==="1")n.push(i)}return new this(n,r.length)}})}return e}();var M=function COMBINE(e){e.combine=function(t,r){for(var n in e.prototype){if(e.prototype.hasOwnProperty(n)&&!t.hasProperty(n)){defineProperty(t,n,function(e){return{get:function get(){return this[r]&&this[r][e]},set:function set(t){if(!this[r])this[r]={};this[r][e]=t},configurable:false,enumerable:true}}(n))}}};return e};var N=function SEQUENCE(e,t){var r=extend(C,function(e,t){defineProperty(this,"items",{writable:true,value:{}});if(typeof e==="string"||e instanceof s)this.decode(e);else if(e!==undefined){this.object=e;if(t)this.check()}},{object:{get:function get(){return this},set:function set(t){if(t instanceof r){this.items=t.items;for(var n in e){var i=this.getItemClass(n,this.items);if(i.combine)i.combine(this,n)}}else{var a={};for(var n in e){var o=t[n];var i=this.getItemClass(n,a);if(o!==undefined){a[n]=new i(o)}else if(i.combine){a[n]=new i(t)}if(i.combine)i.combine(this,n)}this.items=a}}},getItemClass:function getItemClass(t,r){return e[t]},encode:function encode(r){var n=[],i=this.items;for(var a in e){if(i[a]){var o=i[a].encode(true);if(o!==undefined)n.push(o)}}return _encode(r,n,16,0,true,t)},decode:function decode(e){this.object=this.constructor.decode(e)},check:function check(){this.constructor.decode(this.encode(true))}},{encode:function encode(e,t){return new this(e).encode(t)},decode:function decode(r){r=_decode(r,16,0,true,t);var n=0,i=new this,a=i.items={};for(var o in e){var s=i.getItemClass(o,a);var c=s.decode(r[n]);if(c!==undefined){a[o]=c;if(s.combine)s.combine(i,o);n++}}return i}});for(var n in e){defineProperty(r.prototype,n,function(t){return{get:function get(){return this.items[t]&&this.items[t].object},set:function set(e){if(e!==undefined){var r=this.getItemClass(t,this.items);this.items[t]=new r(e)}else delete this.items[t]},configurable:false,enumerable:!e[t].combine}}(n));if(e[n].combine)e[n].combine(r.prototype,n)}return r};var L=function ATTRIBUTE(e,t,r,n,i){var a=N(e,i);var o=function DEFINE(i,o){t=t||"type";r=r||"value";o=o||n||A;var s=extend(a,function(e){if(this instanceof s){a.apply(this,arguments)}else return DEFINE.apply(this,arguments)},{getItemClass:function getItemClass(n,a){var s=e[n];if(r===n){var c,u=a&&a[t];if(u){var f=u.object;if(i){if(typeof i==="function")c=i(f);else c=i[f]}}c=c||o||A;s=s===A?c:s(c)}return s}});defineProperty(s.prototype,t,{get:function get(){return this.items[t]&&this.items[t].object},set:function set(){assert(true)},configurable:false,enumerable:true});return s};return o()};var H=extend(C,{encode:function encode(e){var t=this.object;t=/^(\d+\.)+\d+$/.test(t)?t:f[t];assert(!t);return _encode(e,t,6)}},{decode:function decode(e){var t=_decode(e,6);return new this(u[t]||t)}});var j=function IMPLICIT(e){e=e||A;return extend(e,{encode:function encode(t){var r=e.method("encode").call(this,t);if(typeof r==="string"||r instanceof s)return r;if(r.tagNumber!==4&&r.tagClass===0&&!(r.object instanceof Array))return{object:y.encode(r,"DER",true)};else return{object:r.object}}},{decode:function decode(t){if(typeof t==="string"||t instanceof s){return e.decode.call(this,t)}else{t={object:t.object,header:t.header,content:t.content};return e.decode.call(this,t)}}})};var W=function EXPLICIT(e){e=e||A;return extend(e,{encode:function encode(t){var r=e.method("encode").call(this,t);if(typeof r==="string"||r instanceof s)return r;return{object:[r]}}},{decode:function decode(t){if(typeof t==="string"||t instanceof s){return e.decode.call(this,t)}else return e.decode.call(this,t.object[0])}})};var q=function CTX(e,t){function CTX(){t.apply(this,arguments)}return extend(t,CTX,{encode:function encode(r){var n=t.method("encode").call(this,r);if(typeof n==="string"||n instanceof s)return n;n.tagNumber=e;n.tagClass=2;n.tagConstructed=n.object instanceof Array;return n}},{decode:function decode(r){assert(r.tagNumber!==undefined&&(r.tagClass!==2||r.tagNumber!==e));return t.decode.call(this,r)}})};var V=function ARRAY_OF(e){return function(t,r){t=t||A;var n=function DEFINE(n,i){var a=typeof t==="function"&&n!==undefined?t(n,i):t;if(r){var o=extend(C,function(e){if(this instanceof o){defineProperty(this,"items",{writable:true,value:{}});C.call(this,e||{})}else return DEFINE.apply(this,arguments)},{object:{get:function get(){this.read();return this},set:function set(e){if(e instanceof o){e.read();this.items=e.items}else{var t={};for(var r in e){var n=e[r];t[r]=this.createItem(n,r)}this.items=t}this.reset()}},createItem:function createItem(e,t){if(r){var n={};n[r.typeName]=t;n[r.valueName]=e}else n=e;return new a(n)},getItemValue:function getItemValue(e){var t=this.items[e];return r?t.object[r.valueName]:t.object},setItemValue:function setItemValue(e,t){var n=this.items[e];if(r)n.object[r.valueName]=t;else n.object=t},isItemType:function isItemType(e){return r?f[e]:!isNaN(parseInt(e))},reset:function reset(){var e=this.items;for(var t in this){if(this.hasOwnProperty(t)&&!this.items[t]&&this.isItemType(t))delete this[t]}for(var t in e){this[t]=this.getItemValue(t)}},read:function read(){var e=this.items;for(var t in this){if(this.isItemType(t)){if(!this.items[t]){e[t]=this.createItem(this[t],t);this[t]=this.getItemValue(t)}else if(this.getItemValue(t)!==this[t]){this.setItemValue(t,this[t])}}}},encode:function encode(t){this.read();var r=this.items,n=[];for(var i in r){var a=r[i].encode(true);if(a!==undefined)n.push(a)}return _encode(t,n,e,0,true)},decode:function decode(e){this.object=this.constructor.decode(e)},check:function check(){this.constructor.decode(this.encode(true))}},{encode:function encode(e,t){return new this(e).encode(t)},decode:function decode(t){t=_decode(t,e,0,true);var n=new this,i=n.items={};for(var o=0,s=t.length;o<s;o++){var c=a.decode(t[o]);var u=r?c.object[r.typeName]:o;i[u]=c}n.reset();return n}});return o}else{var s=extend(C,function(e){if(this instanceof s){defineProperties(this,{items:{writable:true,value:[]},values:{writable:true,value:[]}});C.call(this,e||[])}else return DEFINE.apply(this,arguments)},{object:{get:function get(){this.read();return this.values},set:function set(e){if(e instanceof s){e.read();this.items=e.items}else{var t=[];for(var r=0,n=e.length;r<n;r++){t[r]=new a(e[r])}this.items=t}this.reset()}},encode:function encode(t){this.read();var r=this.items,n=[];for(var i=0,a=r.length;i<a;i++){var o=r[i].encode(true);if(o!==undefined)n.push(o)}return _encode(t,n,e,0,true)},decode:function decode(e){this.object=this.constructor.decode(e)},check:function check(){this.constructor.decode(this.encode(true))},reset:function reset(){for(var e=0,t=this.items.length;e<t;e++){this.values.push(this.items[e].object)}},read:function read(){var e=this.items,t=this.values;for(var r=0,n=t.length;r<n;r++){if(!this.items[r]){e[r]=new a(t[r]);t[r]=e[r].object}else if(e[r].object!==t[r])e[r].object=t[r]}}},{encode:function encode(e,t){return new this(e).encode(t)},decode:function decode(t){t=_decode(t,e,0,true);var r=new this;r.items=[];for(var n=0,i=t.length;n<i;n++){r.items.push(a.decode(t[n]))}r.reset();return r}});return s}};return n()}};var X=V(16);var z=V(17);var Y=function ENCLOSURE(e,t){if(t){var r=extend(C,{object:{get:function get(){if(this.item)return t.decode(this.item.object);else return undefined},set:function set(r){if(r!==undefined)this.item=new e(t.encode(r));else delete this.item}},encode:function encode(e){return this.item.encode(e)}},{decode:function decode(t){var r=new this;r.item=e.decode(t);return r}});for(var n in e){if(!r[n])r[n]=e[n]}return r}else return e};var Z=function SET_OF_SINGLE(e){var t=Y(z(e),{encode:function encode(e){return[e]},decode:function decode(e){return e[0]}});return t};var J=function CHOICE(e,t){return extend(C,{object:{get:function get(){return this.item&&this.item.object},set:function set(r){if(r instanceof C){for(var n in e){if(r instanceof e[n]){this.item=r;return}}}var n=typeof t==="function"?t(r):t;assert(!n||!e[n]);r=new e[n](r);this.item=r}},encode:function encode(e){return this.item.encode(e)}},{decode:function decode(t){for(var r in e){try{var n=e[r].decode(t);if(n!==undefined)return new this(n)}catch(e){}}assert(true)}})};var Q=function ENCAPSULATES(e){e=e||A;return extend(e,{encode:function encode(){return y.encode(e.method("encode").call(this,true))}},{encode:function encode(e,t){return new this(e).encode(t)},decode:function decode(t){return e.decode.call(this,y.decode(t))}})};var _=function DEFAULT(e,t){e=e||A;return extend(e,{encode:function encode(r){if(this.object===t)return undefined;return e.method("encode").call(this,r)}},{decode:function decode(r){if(r===undefined)return new this(t);else try{return e.decode.call(this,r)}catch(e){return undefined}}})};var $=function OPTIONAL(e){e=e||A;return extend(e,{},{decode:function decode(t){if(t===undefined)return undefined;else try{return e.decode.call(this,t)}catch(e){return undefined}}})};var ee=function DEFAULT_NULL(e,t){e=e||A;return extend(e,{encode:function encode(r){if(this.object===t)return new x(null).encode(r);return e.method("encode").call(this,r)}},{decode:function decode(r){if(r===undefined)return undefined;else if(r===null||r.tagNumber===5&&r.tagClass===0)return new this(t);else try{return e.decode.call(this,r)}catch(e){return undefined}}})};var te=J({teletexString:K,printableString:E,universalString:k,utf8String:P,bmpString:I,numericString:S},function(e){return/^[A-Za-z0-9\.@\+\-\:\=\\\/\?\!\#\$\%\^\&\*\(\)\[\]\{\}\>\<\|\~]*$/.test(e)?"printableString":"utf8String"});var re=J({utcTime:B,generalTime:D},function(e){return e.getYear()>=2050?"generalTime":"utcTime"});var ne=H;var ie=A;var ae=L({type:ne,value:ie});var oe={typeName:"type",valueName:"value"};var se=Z(ae({serialName:E,countryName:E,dnQualifier:E,emailAddress:F,domainComponent:F,SNILS:S,OGRN:S,INN:S},te));var ce=X(se,oe)();var ue=J({rdnSequence:ce},"rdnSequence");var fe=M(N({notBefore:re,notAfter:re}));var de=R;var he=L({type:H,value:A});var ye=z(he,oe);var le=X(he,oe);var pe=R;var ve=N({a:pe,b:pe,seed:$(O)});var ge=U(extend(C,{encode:function encode(){var e=this.object;var t=Math.max(npw2(e.x.length-2),npw2(e.y.length-2))/2,r=new Uint8Array(2*t+1);r[0]=4;r.set(new Uint8Array(m.decode(e.x,false,t)),1);r.set(new Uint8Array(m.decode(e.y,false,t)),t+1);return r.buffer}},{decode:function decode(e){var t=(e.byteLength-1)/2;return new this({x:m.encode(new Uint8Array(e,1,t)),y:m.encode(new Uint8Array(e,t+1,t))})}}));var me=N({fieldType:H,parameters:R});var Ce=N({version:de,fieldID:me,curve:ve,base:ge,order:R,cofactor:$(R)});var be=N({publicKeyParamSet:H,digestParamSet:H,encryptionParamSet:$(H)});var Ae=ee(H,"id-GostR3411-94-CryptoProParamSet");var we=J({namedParameters:H,ecParameters:Ce,implicitly:$(x)},function(e){return typeof e==="string"||e instanceof String?"namedParameters":"ecParameters"});var Fe=function Algorithm(e,t){return Y(N({algorithm:H,parameters:$(e)}),t)};var Se=function(){var e=Fe(A),t=extend(C,function(e){if(this instanceof t)t.super.apply(this,arguments);else return r(e)},{encode:function encode(t){return new e(this.object).encode(t)}},{decode:function decode(t){return new this(e.decode(t).object)}});var r=function DEFINE(e){return extend(C,{object:{get:function get(){if(this.item)return this.item.object;else return undefined},set:function set(t){if(t){var r=e[t.id];if(!r)throw new Error("Algorithm not supported");this.item=new r(t)}else delete this.item}},encode:function encode(e){return this.item.encode(e)}},{decode:function decode(t){if(typeof t==="string")t=l.decode(t,undefined,false);if(t instanceof s)t=y.decode(t);var r=e[u[t.object[0].object]];if(r){var n=new this;n.item=r.decode(t);return n}else throw new Error("Algorithm not supported")}})};return t}();var Ee=Fe(we,{encode:function encode(e){var t;if(typeof e.namedCurve==="string")t=d["namedCurve"][e.namedCurve];else t={version:1,fieldID:{fieldType:"id-prime-Field",parameters:e.curve.p},curve:{a:e.curve.a,b:e.curve.b},base:{x:e.curve.x,y:e.curve.y},order:e.curve.q,cofactor:1};return{algorithm:e.id,parameters:t}},decode:function decode(e){var t=e.parameters,r=c[e.algorithm];if(typeof t==="string"||t instanceof String){r=(0,i.expand)(r,h[t])}else if((typeof t==="undefined"?"undefined":n(t))==="object"){r=(0,i.expand)(r,{curve:{p:t.fieldID.parameters,a:t.curve.a,b:t.curve.b,x:t.base.x,y:t.base.y,q:t.order}})}else throw new DataError("Invalid key paramters");return r}});var Ke=Fe(be,{encode:function encode(e){var t=e.namedCurve?"namedCurve":"namedParam",r=e.name.indexOf("-94")>=0||e.name.indexOf("-2001")>=0||e.version===1994||e.version===2001?e.sBox||"D-A":e.name.indexOf("-512")>=0||e.length===512?"D-512":"D-256";return{algorithm:e.id,parameters:{publicKeyParamSet:d[t][e[t]],digestParamSet:d["sBox"][r],encryptionParamSet:e.encParams&&e.encParams.sBox?d["sBox"][e.encParams.sBox]:undefined}}},decode:function decode(e){var t=e.parameters,r=(0,i.expand)(c[e.algorithm],h[t.publicKeyParamSet],h[t.digestParamSet]);if(t.encryptionParamSet)r.encParams=h[t.encryptionParamSet];return r}});var Pe=Fe(A,{encode:function encode(e){return{algorithm:e.id}},decode:function decode(e){return c[e.algorithm]}});var Be=Fe(x,{encode:function encode(e){return{algorithm:e.id,parameters:null}},decode:function decode(e){return c[e.algorithm]}});var De=Fe(Ae,{encode:function encode(e){return{algorithm:e.id,parameters:d["sBox"][e.sBox||e.hash&&e.hash.sBox||"D-A"]}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]),r=h[e.parameters];if(t.hash)t.hash=(0,i.expand)(t.hash,r);else t=(0,i.expand)(t,r);return t}});var ke=Se({ecdsa:Ee,noSignature:Be,rsaEncryption:Be,"id-sc-gostR3410-2001":Ee,"id-GostR3410-2001":Ke,"id-GostR3410-94":Ke,"id-GostR3410-2001DH":Ke,"id-GostR3410-94DH":Ke,"id-tc26-gost3410-12-256":Ke,"id-tc26-gost3410-12-512":Ke,"id-tc26-agreement-gost-3410-12-256":Ke,"id-tc26-agreement-gost-3410-12-512":Ke,"id-sc-gost28147-gfb":Pe,"id-Gost28147-89":Pe});var Ie=Se({noSignature:Be,rsaEncryption:Be,sha1withRSAEncryption:Be,sha256withRSAEncryption:Be,sha384withRSAEncryption:Be,sha512withRSAEncryption:Be,ecdsa:Pe,"ecdsa-with-SHA1":Pe,"ecdsa-with-SHA256":Pe,"ecdsa-with-SHA384":Pe,"ecdsa-with-SHA512":Pe,"id-GostR3410-94":Be,"id-GostR3410-2001":Be,"id-GostR3411-94-with-GostR3410-2001":Pe,"id-GostR3411-94-with-GostR3410-94":Pe,"id-tc26-gost3410-12-256":Be,"id-tc26-gost3410-12-512":Be,"id-tc26-signwithdigest-gost3410-12-94":Pe,"id-tc26-signwithdigest-gost3410-12-256":Pe,"id-tc26-signwithdigest-gost3410-12-512":Pe,"id-sc-gostR3410-94":Be,"id-sc-gostR3410-2001":Be,"id-sc-gostR3411-94-with-gostR3410-94":Be,"id-sc-gostR3411-94-with-gostR3410-2001":Be});var xe=Se({sha1:Pe,sha256:Be,sha384:Be,sha512:Be,"id-GostR3411-94":De,"id-tc26-gost3411-94":De,"id-tc26-gost3411-12-256":Be,"id-tc26-gost3411-12-512":Be,"id-sc-gostR3411-94":Pe});var Te=U;var Re=U;var Ge=H;var Ue=U;var Oe=N({iv:Ue,encryptionParamSet:Ge});var Me=N({encryptionParamSet:Ge,ukm:$(U)});var Ne=Fe(Oe,{encode:function encode(e){return{algorithm:e.id,parameters:{iv:e.iv,encryptionParamSet:d["sBox"][e.sBox||"E-A"]}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm],h[e.parameters.encryptionParamSet]);t.iv=e.parameters.iv;return t}});var Le=Fe(Ue,{encode:function encode(e){return{algorithm:e.id,parameters:e.iv}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.iv=e.parameters||new Uint8Array([0,0,0,0,0,0,0,0]);return t}});var He=Fe(Me,{encode:function encode(e){return{algorithm:e.id,parameters:{encryptionParamSet:d["sBox"][e.sBox||"E-A"],ukm:e.ukm}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm],h[e.parameters.encryptionParamSet]);if(e.parameters.ukm)t.ukm=e.parameters.ukm;return t}});var je=Se({"id-Gost28147-89-None-KeyWrap":He,"id-Gost28147-89-CryptoPro-KeyWrap":He});var We=Fe(je,{encode:function encode(e){return{algorithm:e.id,parameters:e.wrapping}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.wrapping=e.parameters;return t}});var qe=Se({"id-sc-gost28147-gfb":Le,"id-Gost28147-89":Ne});var Ve=Se({"id-Gost28147-89-MAC":Oe,"id-HMACGostR3411-94":De,"id-tc26-hmac-gost-3411-12-256":De,"id-tc26-hmac-gost-3411-12-512":De,hmacWithSHA1:Pe,hmacWithSHA224:Pe,hmacWithSHA256:Pe,hmacWithSHA384:Pe,hmacWithSHA512:Pe,"id-sc-gost28147-mac":Pe,"id-sc-hmacWithGostR3411":Pe});var Xe=N({salt:J({specified:U,otherSource:Se},function(e){return isBinary(e)?"specified":"otherSource"}),iterationCount:R,keyLength:$(R),prf:Ve});var ze=Fe(Xe,{encode:function encode(e){return{algorithm:e.id,parameters:{salt:e.salt,iterationCount:e.iterations,prf:e.hmac}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.salt=e.parameters.salt;t.iterations=e.parameters.iterationCount;t.hmac=e.parameters.prf;t.hash=t.hmac.hash;return t}});var Ye=Se({PBKDF2:ze});var Ze=N({salt:U,iterationCount:R});var Je=Fe(Ze,{paramType:Ze,encode:function encode(e){return{algorithm:e.id,parameters:{salt:e.derivation.salt,iterationCount:e.derivation.iterations}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.derivation=(0,i.expand)(t.derivation,{salt:e.parameters.salt,iterations:e.parameters.iterationCount});return t}});var Qe=N({keyDerivationFunc:Ye,encryptionScheme:qe});var _e=Fe(Qe,{encode:function encode(e){return{algorithm:e.id,parameters:{keyDerivationFunc:e.derivation,encryptionScheme:e.encryption}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.derivation=e.parameters.keyDerivationFunc;t.encryption=e.parameters.encryptionScheme;return t}});var $e=Se({"pbeWithSHAAndAES128-CBC":Je,"pbeWithSHAAndAES192-CBC":Je,"pbeWithSHAAndAES256-CBC":Je,"pbeWithSHA256AndAES128-CBC":Je,"pbeWithSHA256AndAES192-CBC":Je,"pbeWithSHA256AndAES256-CBC":Je,"id-sc-pbeWithGost3411AndGost28147":Je,"id-sc-pbeWithGost3411AndGost28147CFB":Je,"pbeWithSHAAnd3-KeyTripleDES-CBC":Je,"pbeWithSHAAnd2-KeyTripleDES-CBC":Je,"pbeWithSHAAnd128BitRC2-CBC":Je,"pbeWithSHAAnd40BitRC2-CBC":Je,pbeUnknownGost:Je,PBES2:_e});var et=Se({ecdsa:Ee,rsaEncryption:Be,"id-sc-gost28147-gfb":Le,"id-Gost28147-89":Ne,"id-sc-gostR3410-2001":Ee,"id-GostR3410-2001":Ke,"id-GostR3410-94":Ke,"id-tc26-gost3410-12-256":Ke,"id-tc26-gost3410-12-512":Ke,"id-GostR3410-94-CryptoPro-ESDH":We,"id-GostR3410-2001-CryptoPro-ESDH":We,"id-tc26-agreement-gost-3410-12-256":We,"id-tc26-agreement-gost-3410-12-512":We,"id-sc-r3410-ESDH-r3411kdf":Be,"id-Gost28147-89-None-KeyWrap":He,"id-Gost28147-89-CryptoPro-KeyWrap":He,"id-sc-cmsGostWrap":Pe,"id-sc-cmsGost28147Wrap":Pe,"pbeWithSHAAndAES128-CBC":Je,"pbeWithSHAAndAES192-CBC":Je,"pbeWithSHAAndAES256-CBC":Je,"pbeWithSHA256AndAES128-CBC":Je,"pbeWithSHA256AndAES192-CBC":Je,"pbeWithSHA256AndAES256-CBC":Je,"id-sc-pbeWithGost3411AndGost28147":Je,"id-sc-pbeWithGost3411AndGost28147CFB":Je,"pbeWithSHAAnd3-KeyTripleDES-CBC":Je,"pbeWithSHAAnd2-KeyTripleDES-CBC":Je,"pbeWithSHAAnd128BitRC2-CBC":Je,"pbeWithSHAAnd40BitRC2-CBC":Je,pbeUnknownGost:Je,PBES2:_e});var tt=N({keyDerivationFunc:Ye,messageAuthScheme:Ve});var rt=Fe(tt,{encode:function encode(e){return{algorithm:e.id,parameters:{keyDerivationFunc:e.derivation,messageAuthScheme:e.hmac}}},decode:function decode(e){var t=(0,i.expand)(c[e.algorithm]);t.derivation=e.parameters.keyDerivationFunc;t.hmac=e.parameters.messageAuthScheme;return t}});var nt=Se({PBMAC1:rt});var it=Se({"id-sc-gost28147-gfb":Le,"id-Gost28147-89":Ne,"pbeWithSHAAndAES128-CBC":Je,"pbeWithSHAAndAES192-CBC":Je,"pbeWithSHAAndAES256-CBC":Je,"pbeWithSHA256AndAES128-CBC":Je,"pbeWithSHA256AndAES192-CBC":Je,"pbeWithSHA256AndAES256-CBC":Je,"id-sc-pbeWithGost3411AndGost28147":Je,"id-sc-pbeWithGost3411AndGost28147CFB":Je,"pbeWithSHAAnd3-KeyTripleDES-CBC":Je,"pbeWithSHAAnd2-KeyTripleDES-CBC":Je,"pbeWithSHAAnd128BitRC2-CBC":Je,"pbeWithSHAAnd40BitRC2-CBC":Je,pbeUnknownGost:Je,PBES2:_e});var at=Y;var ot=at(O(Q(R)),{encode:function encode(e){return g.encode(swapBytes(e))},decode:function decode(e){return swapBytes(g.decode(e))}});var st=at(O(Q(U)),{encode:function encode(e){var t=new Uint8Array(e.byteLength+1),r=swapBytes(e),n=e.byteLength/2;t[0]=4;t.set(new Uint8Array(r,n,n),1);t.set(new Uint8Array(r,0,n),n+1);return t.buffer},decode:function decode(e){assert((e.byteLength&1)===0);var t=new Uint8Array(e.byteLength-1),r=t.byteLength/2;t.set(new Uint8Array(e,r+1,r),0);t.set(new Uint8Array(e,1,r),r);return swapBytes(t)}});var ct=O(Q(U));var ut=N({algorithm:ke,subjectPublicKey:O},"PUBLIC KEY");var ft=function(e){return Y(L({algorithm:ke,subjectPublicKey:A},"algorithm","subjectPublicKey")(function(t){return e[t.id]}),{encode:function encode(e){return{algorithm:e.algorithm,subjectPublicKey:e.buffer}},decode:function decode(e){return{algorithm:e.algorithm,type:"public",extractable:true,usages:["verify","deriveKey","deriveBits"],buffer:e.subjectPublicKey}}})}({"id-sc-gostR3410-2001":st,"id-sc-gostR3410-94":ot,"id-GostR3410-2001":ct,"id-GostR3410-94":ct,"id-tc26-gost3410-12-256":ct,"id-tc26-gost3410-12-512":ct});var dt=U;var ht=at(dt(Q(R)),{encode:function encode(e){return m.encode(e,true)},decode:function decode(e){return m.decode(e,true)}});var yt=U;var lt=N({keyValueMask:yt,keyValyePublicKey:U});var pt=J({privateKey:dt(Q(J({keyValueMask:yt,keyValueInfo:lt},function(e){if(isBinary(e))return"keyValueMask";else return"keyValueInfo"}))),keyValueMask:yt},function(e){return e.enclosed?"keyValueMask":"privateKey"});var vt=function(e){return L({version:de,privateKeyAlgorithm:ke,privateKeyWrapped:at(dt(Q(N({keyData:R,keyMac:R}))),{encode:function encode(e){var t=e.byteLength-4;return{keyData:m.encode(new Uint8Array(e,0,t)),keyMac:m.encode(new Uint8Array(e,t,4))}},decode:function decode(e){var t=m.decode(e.keyData),r=m.decode(e.keyMac),n=new Uint8Array(t.byteLength+r.byteLength);n.set(new Uint8Array(t));n.set(new Uint8Array(r),t.byteLength);return n}}),attributes:A},"privateKeyAlgorithm","attributes")(function(t){return $(q(0,j(ye({"id-sc-gostR3410-2001-publicKey":Z(e[t.id])}))))})}({"id-sc-gostR3410-2001":st,"id-sc-gostR3410-94":ot,"id-GostR3410-2001":ct,"id-GostR3410-94":ct,"id-GostR3410-2001DH":ct,"id-GostR3410-94DH":ct,"id-tc26-gost3410-12-256":ct,"id-tc26-gost3410-12-512":ct,"id-tc26-agreement-gost-3410-12-256":ct,"id-tc26-agreement-gost-3410-12-512":ct});var gt=N({version:de,privateKeyAlgorithm:ke,privateKey:dt,attributes:$(q(0,j(ye)))},"PRIVATE KEY");var mt=ke;var Ct=O;var bt=N({version:de,privateKeyAlgorithm:mt,privateKey:dt,attributes:$(q(0,j(ye))),publicKey:$(q(1,j(Ct)))});var At=X(bt);var wt=function(e){return Y(L({version:de,privateKeyAlgorithm:ke,privateKey:A,attributes:$(q(0,j(ye)))},"privateKeyAlgorithm","privateKey")(function(t){return e[t.id]}),{encode:function encode(e){return{version:0,privateKeyAlgorithm:e.algorithm,privateKey:e.buffer}},decode:function decode(e){return{algorithm:e.privateKeyAlgorithm,type:"private",extractable:true,usages:["sign","deriveKey","deriveBits"],buffer:isBinary(e.privateKey)?e.privateKey:e.privateKey.keyValueMask}}})}({"id-sc-gostR3410-2001":ht,"id-sc-gostR3410-94":ht,"id-GostR3410-2001":pt,"id-GostR3410-94":pt,"id-GostR3410-2001DH":pt,"id-GostR3410-94DH":pt,"id-tc26-gost3410-12-256":pt,"id-tc26-gost3410-12-512":pt,"id-tc26-agreement-gost-3410-12-256":pt,"id-tc26-agreement-gost-3410-12-512":pt});var Ft=U;var St=N({encryptionAlgorithm:et,encryptedData:Ft},"ENCRYPTED PRIVATE KEY");var Et=O;var Kt=R;var Pt=N({cA:_(w,false),pathLenConstraint:$(R)});var Bt=O({digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8});var Dt=H,kt=X(Dt);var It=U;var xt=N({type:H,value:q(0,W(A))});var Tt=N({nameAssigner:$(q(0,j(te))),partyName:$(q(1,j(te)))});var Rt=N({});var Gt=J({otherName:q(0,j(xt)),rfc822Name:q(1,j(te)),dNSName:q(2,j(te)),x400Address:q(3,j(Rt)),directoryName:q(4,W(ue)),ediPartyName:q(5,j(Tt)),uniformResourceIdentifier:q(6,j(te)),iPAddress:q(7,j(U)),registeredID:q(8,j(H))},function(e){return typeof e==="string"||e instanceof String?e.indexOf("@")>=0?"rfc822Name":"dNSName":isBinary(e)?"iPAddress":"directoryName"});var Ut=X(Gt);var Ot=N({keyIdentifier:$(q(0,j(It))),authorityCertIssuer:$(q(1,j(Ut))),authorityCertSerialNumber:$(q(2,j(Kt)))});var Mt=N({notBefore:$(q(0,j(D))),notAfter:$(q(1,j(D)))});var Nt=H,Lt=H;var Ht=N({policyQualifierId:Lt,qualifier:A});var jt=N({policyIdentifier:Nt,policyQualifiers:$(X(Ht))});var Wt=N({issuerDomainPolicy:Nt,subjectDomainPolicy:Nt});var qt=R;var Vt=N({base:Gt,minimum:_(q(0,j(qt)),0),maximum:$(q(1,j(qt)))});var Xt=X(Vt);var zt=N({permittedSubtrees:$(q(0,j(Xt))),excludedSubtrees:$(q(1,j(Xt)))});var Yt=R;var Zt=N({requireExplicitPolicy:$(q(0,j(Yt))),inhibitPolicyMapping:$(q(1,j(Yt)))});var Jt=O({unused:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,privilegeWithdrawn:7,aACompromise:8});var Qt=J({fullName:q(0,j(Ut)),nameRelativeToCRLIssuer:q(1,j(se))},function(e){return e instanceof Array?"fullName":"nameRelativeToCRLIssuer"});var _t=N({distributionPoint:$(q(0,W(Qt))),reasons:$(q(1,j(Jt))),cRLIssuer:$(q(2,j(Ut)))});var $t=X(_t);var er=$t;var tr=N({accessMethod:H,accessLocation:Gt});var rr=function Extension(e,t){var r=L({extnID:H,critical:_(w,false),extnValue:function extnValue(e){return U(Q(e))}},"extnID","extnValue");var i=extend(r(e),{object:{get:function get(){var e=this._get(i.super,"object");if(e&&n(e.extnValue)==="object")this.defineValue(e.extnValue);return e},set:function set(e){this._set(i.super,"object",e);if(e&&e.extnValue)if(e.extnValue.critical!==undefined)this.critical=e.extnValue.critical;else if(this.critical===undefined&&t)this.critical=t(this.extnID,e.extnValue)}},extnValue:{get:function get(){var e=this._get(i.super,"extnValue");if((typeof e==="undefined"?"undefined":n(e))==="object")this.defineValue(e);return e},set:function set(e){this._set(i.super,"extnValue",e);if(e){if(e.critical!==undefined)this.critical=e.critical;else if(this.critical===undefined&&t)this.critical=t(this.extnID,e)}}},defineValue:function defineValue(e){if((typeof e==="undefined"?"undefined":n(e))==="object")if(!getOwnPropertyDescriptor(e,"critical")){var t=this;defineProperty(e,"critical",{get:function get(){return t.critical},set:function set(e){t.critical=e},enumerable:true,configurable:false})}}});return i};var nr=N({signTool:P,cATool:P,signToolCert:P,cAToolCert:P});var ir=X(rr,{typeName:"extnID",valueName:"extnValue"});var ar=ir({authorityKeyIdentifier:Ot,subjectKeyIdentifier:It,keyUsage:Bt,privateKeyUsagePeriod:Mt,certificatePolicies:X(jt),policyMappings:X(Wt),subjectAltName:Ut,issuerAltName:Ut,subjectDirectoryAttributes:le,basicConstraints:Pt,nameConstraints:zt,policyConstraints:Zt,extKeyUsage:kt,cRLDistributionPoints:$t,inhibitAnyPolicy:Yt,freshestCRL:er,authorityInfoAccess:X(tr),subjectInfoAccess:X(tr),subjectSignTool:P,issuerSignTool:nr},function(e,t){return e==="keyUsage"||e==="basicConstraints"&&t.pathLenConstraint===undefined});var or=N({r:R,s:R});var sr=A;var cr=or;var ur=M(N({version:q(0,W(de)),serialNumber:Kt,signature:Ie,issuer:ue,validity:fe,subject:ue,subjectPublicKeyInfo:ut,issuerUniqueID:$(q(1,j(Et))),subjectUniqueID:$(q(2,j(Et))),extensions:$(q(3,W(ar)))}));var fr=N({tbsCertificate:ur,signatureAlgorithm:Ie,signatureValue:O},"CERTIFICATE");var dr=ar;var hr=ye({challengePassword:Z(te),extensionRequest:Z(dr),msCertExtensions:Z(ar),extendedCertificateAttributes:Z(ye)});var yr=M(N({version:R,subject:ue,subjectPublicKeyInfo:ut,attributes:q(0,j(hr))}));var lr=N({requestInfo:yr,signatureAlgorithm:Ie,signatureValue:O},"CERTIFICATE REQUEST");var pr=R;var vr=G({unspecified:0,keyCompromise:1,cACompromise:2,affiliationChanged:3,superseded:4,cessationOfOperation:5,certificateHold:6,removeFromCRL:8,privilegeWithdrawn:9,aACompromise:10});var gr=N({distributionPoint:$(q(0,W(Qt))),onlyContainsUserCerts:_(q(1,j(w)),false),onlyContainsCACerts:_(q(2,j(w)),false),onlySomeReasons:$(q(3,j(Jt))),indirectCRL:_(q(4,j(w)),false),onlyContainsAttributeCerts:_(q(5,j(w)),false)});var mr=ir({authorityKeyIdentifier:Ot,issuerAltName:Ut,cRLNumber:pr,deltaCRLIndicator:pr,issuingDistributionPoint:gr,freshestCRL:er},function(e){return e==="cRLNumber"});var Cr=ir({cRLReason:vr,instructionCode:H,invalidityDate:D,certificateIssuer:Ut});var br=M(N({version:$(de),signature:Ie,issuer:ue,thisUpdate:re,nextUpdate:$(re),revokedCertificates:$(X(N({userCertificate:Kt,revocationDate:re,crlEntryExtensions:$(Cr)}))),crlExtensions:$(q(0,W(mr)))}));var Ar=N({tbsCertList:br,signatureAlgorithm:Ie,signatureValue:O},"CRL");var wr=R;var Fr=N({digestedObjectType:G({publicKey:0,publicKeyCert:1,otherObjectTypes:2}),otherObjectTypeID:$(H),digestAlgorithm:xe,objectDigest:O});var Sr=N({issuer:Ut,serial:Kt,issuerUID:$(Et)});var Er=N({issuerName:$(Ut),baseCertificateID:$(q(0,j(Sr))),objectDigestInfo:$(q(1,j(Fr)))});var Kr=N({targetCertificate:Sr,targetName:$(Gt),certDigestInfo:$(Fr)});var Pr=J({targetName:q(0,W(Gt)),targetGroup:q(1,W(Gt)),targetCert:q(2,j(Kr))});var Br=X(Pr);var Dr=ir({auditIdentity:U,targetInformation:Br,authorityKeyIdentifier:Ot,authorityInfoAccess:X(tr),cRLDistributionPoints:$t,noRevAvail:x},function(e){return e==="auditIdentity"||e==="targetInformation"});var kr=N({baseCertificateID:$(q(0,j(Sr))),entityName:$(q(1,j(Ut))),objectDigestInfo:$(q(2,j(Fr)))});var Ir=J({v1Form:Ut,v2Form:q(0,j(Er))},"v2Form");var xr=N({notBeforeTime:D,notAfterTime:D});var Tr=N({service:Gt,ident:Gt,authInfo:$(U)});var Rr=N({roleAuthority:$(q(0,j(Ut))),roleName:q(1,W(Gt))});var Gr=O({unmarked:0,unclassified:1,restricted:2,confidential:3,secret:4,topSecret:5});var Ur=N({type:q(0,j(H)),value:q(1,j(A))});var Or=N({policyId:q(0,j(H)),classList:_(q(1,j(Gr)),["unclassified"]),securityCategories:$(q(2,j(z(Ur))))});var Mr=N({policyAuthority:$(q(0,j(Ut))),values:X(J({octets:U,oid:H,string:P},function(e){return isBinary?"octets":getIdentifier(e)?"oid":"string"}))});var Nr=M(N({version:wr,holder:kr,issuer:Ir,signature:Ie,serialNumber:Kt,attrCertValidityPeriod:xr,attributes:le({authenticationInfo:z(Tr),accessIdentity:z(Tr),chargingIdentity:Z(Mr),group:Z(Mr),role:z(Rr),clearance:z(Or)}),issuerUniqueID:$(Et),extensions:$(Dr)}));var Lr=N({acinfo:Nr,signatureAlgorithm:Ie,signatureValue:O},"ATTRIBUTE CERTIFICATE");var Hr=U;var jr=U;var Wr=U;var qr=U;var Vr=N({keyInfo:je,entityUInfo:$(q(0,W(U))),suppPubInfo:q(2,W(U))});var Xr=Y(N({encryptedKey:Te,maskKey:$(q(0,j(Te))),macKey:Re}),{encode:function encode(e){var t=new Uint8Array(new Uint8Array(e,0,32)).buffer,r=new Uint8Array(new Uint8Array(e,32,4)).buffer;return{encryptedKey:t,macKey:r}},decode:function decode(e){var t=e.encryptedKey,r=e.maskKey,n=e.macKey;if(r){var i=new Int32Array(r),a=new Int32Array(t);for(var o=0,s=i.length/a.length;o<s;o++){for(var c=0,u=a.length;c<u;c++){a[c]=a[c]+i[u*o+c]&4294967295}}}var f=new Uint8Array(t.byteLength+n.byteLength);f.set(new Uint8Array(t),0);f.set(new Uint8Array(n),32);return f.buffer}});var zr=N({encryptionParamSet:Ge,ephemeralPublicKey:$(q(0,j(ft))),ukm:U});var Yr=Y(N({sessionEncryptedKey:Xr,transportParameters:$(q(0,j(zr)))}),{encode:function encode(e){var t=e.algorithm;return{sessionEncryptedKey:e.sessionEncryptedKey,transportParameters:{encryptionParamSet:d["sBox"][t.wrapping.sBox||"E-A"],ephemeralPublicKey:t["public"],ukm:t.ukm}}},decode:function decode(e){return{algorithm:{wrapping:h[e.transportParameters.encryptionParamSet],ukm:e.transportParameters.ukm,public:e.transportParameters.ephemeralPublicKey},sessionEncryptedKey:e.sessionEncryptedKey}}});var Zr=Y(N({sessionEncryptedKey:Xr,ukm:N({ephemeralPublicKey:ft,addedukm:$(q(0,W(qr)))})}),{encode:function encode(e){var t=e.algorithm;return{sessionEncryptedKey:e.sessionEncryptedKey,ukm:{ephemeralPublicKey:t["public"],addedukm:t.ukm}}},decode:function decode(e){return{algorithm:{ukm:e.ukm.addedukm,public:e.ukm.ephemeralPublicKey},sessionEncryptedKey:e.sessionEncryptedKey}}});var Jr=function(e){return function(t){var r=e[t.id];return r?Q(r):A}}({"id-sc-gostR3410-2001":Zr,"id-sc-gostR3410-94":Zr,"id-GostR3410-2001":Yr,"id-GostR3410-94":Yr,"id-tc26-gost3410-12-256":Yr,"id-tc26-gost3410-12-512":Yr,"id-GostR3410-94-CryptoPro-ESDH":Xr,"id-GostR3410-2001-CryptoPro-ESDH":Xr,"id-tc26-agreement-gost-3410-12-256":Xr,"id-tc26-agreement-gost-3410-12-512":Xr,"id-sc-r3410-ESDH-r3411kdf":Xr,"id-Gost28147-89-None-KeyWrap":Xr,"id-Gost28147-89-CryptoPro-KeyWrap":Xr,"id-sc-cmsGostWrap":Xr,"id-sc-cmsGost28147Wrap":Xr});var Qr=O({kccaSoftPassword:0,kccaReservePrimary:1,kccaPrimaryKeyAbsent:2,kccaFKCShared:3});var _r=O({pkaExportable:0,pkaUserProtect:1,pkaExchange:2,pkaEphemeral:3,pkaNonCachable:4,pkaDhAllowed:5});var $r=N({attributes:$(_r),privateKeyAlgorithm:$(q(0,j(ke)))});var en=N({path:F,hmac:Re});var tn=Se;var rn=N({containerAlgoritmIdentifier:$(q(0,j(Se))),containerName:$(F),attributes:Qr,primaryPrivateKeyParameters:$r,hmacPassword:$(q(2,j(Re))),secondaryEncryptedPrivateKey:$(q(3,j(Xr))),secondaryPrivateKeyParameters:$(q(4,j($r))),primaryCertificate:$(q(5,j(U(Q(fr))))),secondaryCertificate:$(q(6,j(U(Q(fr))))),encryptionContainerName:$(q(7,j(F))),primaryCertificateLink:$(q(8,j(en))),secondaryCertificateLink:$(q(9,j(en))),primaryFP:$(q(10,j(U))),secondaryFP:$(q(11,j(U))),passwordPolicy:$(tn),containerSecurityLevel:$(R),extensions:$(q(12,j(ir({keyValidity:N({notBefore:$(q(0,j(D))),notAfter:$(q(1,j(D)))})})))),secondaryEncryptionContainerName:$(q(13,j(F)))});var nn=N({keyContainerContent:rn,hmacKeyContainerContent:Re});var an=N({containerName:F,extElem1:$(A)});var on=N({primaryKey:Te,secondaryKey:$(Te),hmacKey:$(Re)});var sn=N({mask:Te,randomStatus:U,hmacRandom:Re});var cn=N({keyClass:R,keyType:R,algorithm:$(q(0,W(ke))),serialNumber:$(q(1,W(U))),addSerialNumber:$(q(2,W(U))),certSerialNumber:$(q(3,W(U))),subjectUID:$(q(4,W(U))),recipientUID:$(q(5,W(U))),validity:$(q(6,W(J({validity:fe,keyValidity:N({notBefore:$(q(0,j(D))),notAfter:$(q(1,j(D)))})},function(){return"keyValidity"})))),keyUID:$(q(7,W(O))),flags:$(q(10,W(R)))});var un=N({version:R,keyInfo:cn,defenceKeyInfo:cn,certificate:$(q(0,W(fr))),publicKey:$(q(1,W(U)))});var fn=R;var dn=H;var hn=re;var Wr=U;var yn=U;var ln=U;var pn=R;var vn=X(pn);var gn=N({bodyPartPath:vn,identifier:H,content:A});var mn=ye({contentType:Z(dn),signingTime:Z(hn),messageDigest:Z(U)});var Cn=ye(function(e){return{countersignature:z(Kn),unsignedData:z(gn)}[e]});var bn=mn,An=ye,wn=ye;var Fn=N({issuer:ue,serialNumber:Kt});var Sn=J({issuerAndSerialNumber:Fn,subjectKeyIdentifier:q(0,j(Wr))},function(e){return isBinary(e)?"subjectKeyIdentifier":"issuerAndSerialNumber"});var En=N({version:fn,sid:Sn,digestAlgorithm:xe,signedAttrs:$(q(0,j(mn))),signatureAlgorithm:Ie,signatureValue:U,unsignedAttrs:$(q(1,j(Cn)))});var Kn=En,Pn=z(En),Bn=z(xe),Dn=Lr;var kn=M(N({version:fn,certificate:fr,attributes:An}));var In=N({extendedCertificateInfo:kn,signatureAlgorithm:Ie,signatureValue:O});var xn=N({otherCertFormat:H,otherCert:A});var Tn=M(N({version:R,subject:J({baseCertificateID:q(0,j(Sr)),subjectName:q(1,j(Ut))},function(e){return e.issuer?"baseCertificateID":"subjectName"}),issuer:Ut,signature:Ie,serialNumber:Kt,attCertValidityPeriod:xr,attributes:le,issuerUniqueID:$(Et),extensions:$(ar)}));var Rn=N({acInfo:Tn,signatureAlgorithm:Ie,signatureValue:O});var Gn=N({eContentType:dn,eContent:$(q(0,W(U)))});var Un=J({certificate:fr,extendedCertificate:q(0,j(In)),v1AttrCert:q(1,j(Rn)),v2AttrCert:q(2,j(Dn)),other:q(3,j(xn))},function(e){return e.holder?"AttributeCertificateV2":e.certificate?"ExtendedCertificate":e.otherCertFormat?"other":"certificate"});var On=N({otherRevInfoFormat:H,otherRevInfo:A});var Mn=J({crl:Ar,other:q(1,j(On))},function(e){return e.otherRevInfoFormat?"other":"crl"});var Nn=z(Un),Ln=z(Mn);var Hn=N({version:fn,digestAlgorithms:Bn,encapContentInfo:Gn,certificates:$(q(0,j(Nn))),crls:$(q(1,j(Ln))),signerInfos:Pn});var jn=J({issuerAndSerialNumber:Fn,subjectKeyIdentifier:q(0,j(Wr))},function(e){return isBinary(e)?"subjectKeyIdentifier":"issuerAndSerialNumber"});var Wn=N({version:fn,rid:jn,keyEncryptionAlgorithm:et,encryptedKey:Hr});var qn=N({keyAttrId:H,keyAttr:$(A)});var Vn=N({subjectKeyIdentifier:Wr,date:$(D),other:$(qn)});var Xn=J({issuerAndSerialNumber:Fn,rKeyId:q(0,j(Vn))},function(e){return isBinary(e)?"rKeyId":"issuerAndSerialNumber"});var zn=N({rid:Xn,encryptedKey:Hr});var Yn=X(zn);var Zn=N({algorithm:ke,publicKey:O});var Jn=N({ephemeralPublicKey:Zn,addedukm:$(q(0,W(qr)))});var Qn=J({issuerAndSerialNumber:Fn,subjectKeyIdentifier:q(0,j(Wr)),originatorKey:q(1,j(Zn))},function(e){return isBinary(e)?"subjectKeyIdentifier":e.algorithm?"originatorKey":"issuerAndSerialNumber"});var _n=N({version:fn,originator:q(0,W(Qn)),ukm:$(q(1,W(qr))),keyEncryptionAlgorithm:et,recipientEncryptedKeys:Yn});var $n=N({keyIdentifier:U,date:$(D),other:$(qn)});var ei=N({version:fn,kekid:$n,keyEncryptionAlgorithm:et,encryptedKey:Hr});var ti=N({version:fn,friendlyName:$(q(0,j(Ye))),keyEncryptionAlgorithm:et,encryptedKey:Hr});var ri=N({oriType:H,oriValue:A});var ni=J({ktri:Wn,kari:q(1,j(_n)),kekri:q(2,j(ei)),pwri:q(3,j(ti)),ori:q(4,j(ri))},function(e){return e.rid?"ktri":e.originator?"kari":e.kekid?"kekri":e.oriType?"ori":"pwri"});var ii=N({certs:$(q(0,j(Nn))),crls:$(q(1,j(Ln)))});var ai=z(ni);var oi=N({contentType:dn,contentEncryptionAlgorithm:it,encryptedContent:$(q(0,j(jr)))});var si=N({version:fn,originatorInfo:$(q(0,j(ii))),recipientInfos:ai,encryptedContentInfo:oi,unprotectedAttrs:$(q(1,j(wn)))});var ci=N({version:fn,digestAlgorithm:xe,encapContentInfo:Gn,digest:yn});var ui=N({version:fn,encryptedContentInfo:oi,unprotectedAttrs:$(q(1,j(wn)))});var fi=N({version:fn,originatorInfo:$(q(0,j(ii))),recipientInfos:ai,macAlgorithm:Ve,digestAlgorithm:$(q(1,xe)),encapContentInfo:Gn,authAttrs:$(q(2,j(bn))),mac:ln,unauthAttrs:$(q(3,j(An)))});var di=N({version:fn,originatorInfo:$(q(0,j(ii))),recipientInfos:ai,authEncryptedContentInfo:oi,authAttrs:$(q(1,j(bn))),mac:ln,unauthAttrs:$(q(2,j(An)))});var hi=J({encrypted:ui,enveloped:q(0,j(si)),authEnveloped:q(1,j(di))},function(e){return e.encryptedContentInfo?e.recipientInfos?"enveloped":"encrypted":"authEnveloped"});var dn=H;var yi=L({contentType:dn,content:function content(e){return q(0,W(e))}},"contentType","content",undefined,"CMS")({data:U,signedData:M(Hn),envelopedData:M(si),digestedData:M(ci),encryptedData:M(ui),authData:M(fi),encryptedKeyPkg:M(hi),aKeyPackage:M(At)});var li=N({digestAlgorithm:xe,digest:yn});var pi=ye({friendlyName:Z(I),keyProviderNameAttr:Z(I),localKeyId:Z(U),certKeyIdentifierPropId:Z(U)});var vi=H;var gi=H;var mi=H;var Ci=H;var bi=gt;var Ai=St;var wi=L({certId:gi,certValue:function certValue(e){return q(0,W(e))}},"certId","certValue")({x509Certificate:U(Q(fr)),sdsiCertificate:F},U);var Fi=L({crlId:mi,crlValue:function crlValue(e){return q(0,W(e))}},"crlId","crlValue")({x509CRL:U(Q(Ar))},U);var Si=L({secretTypeId:Ci,secretValue:function secretValue(e){return q(0,W(e))}},"secretTypeId","secretValue")({secret:U},U);var Ei=L({bagId:vi,bagValue:function bagValue(e){return q(0,W(e))},bagAttributes:$(pi)},"bagId","bagValue")(function(e){return{keyBag:bi,pkcs8ShroudedKeyBag:Ai,certBag:wi,crlBag:Fi,secretBag:Si,safeContentsBag:Ki}[e]});var Ki=X(Ei);var Pi=X(yi);var Bi=N({mac:li,macSalt:U,iterations:_(R,1)});var Di=N({version:R,authSafe:yi,macData:$(Bi)},"PFX");var ki=P;var Ii=P;var xi=N({issuer:Gt,serialNumber:R});var Ti=xi;var Ri=ut;var Gi=N({intendedAlg:$(q(0,j(Se))),symmAlg:$(q(1,j(Se))),encSymmKey:$(q(2,j(O))),keyAlg:$(q(3,j(Se))),valueHint:$(q(4,j(U))),encValue:O});var Ui=U;var Hr=J({encryptedValue:Gi,envelopedData:q(0,j(si))},function(e){return e.encryptedContentInfo?"envelopedData":"encryptedValue"});var Oi=J({encryptedPrivKey:q(0,Hr),keyGenParameters:q(1,j(Ui)),archiveRemGenPrivKey:q(2,j(w))});var Mi=N({pubMethod:R({dontCare:0,x500:1,web:2,ldap:3}),pubLocation:$(Gt)});var Ni=N({action:R({dontPublish:0,pleasePublish:1}),pubInfos:$(X(Mi))});var Li=R({encrCert:0,challengeResp:1});var Hi=J({thisMessage:q(0,j(O)),subsequentMessage:q(1,j(Li)),dhMAC:q(2,j(O)),agreeMAC:q(3,j(Wi)),encryptedKey:q(4,j(si))});var ji=N({salt:U,owf:Se,iterationCount:R,mac:Se});var Wi=N({algId:Se,value:O});var qi=N({authInfo:J({sender:q(0,W(Gt)),publicKeyMAC:Wi}),publicKey:ut});var Vi=N({poposkInput:$(q(0,qi)),algorithmIdentifier:Se,signature:O});var Xi=J({raVerified:q(0,j(x)),signature:q(1,j(Vi)),keyEncipherment:q(2,j(Hi)),keyAgreement:q(3,j(Hi))});var zi=X(ae({regToken:ki,authenticator:Ii,pkiPublicationInfo:Ni,pkiArchiveOptions:Oi,oldCertID:Ti,protocolEncrKey:Ri}));var Yi=N({notBefore:$(q(0,j(re))),notAfter:$(q(1,j(re)))});var Zi=N({version:$(q(0,j(de))),serialNumber:$(q(1,j(R))),signingAlg:$(q(2,j(Se))),issuer:$(q(3,j(ue))),validity:$(q(4,j(Yi))),subject:$(q(5,j(ue))),publicKey:$(q(6,j(ut))),issuerUID:$(q(7,j(Et))),subjectUID:$(q(8,j(Et))),extensions:$(q(9,j(ir)))});var Ji=N({certReqId:R,certTemplate:Zi,controls:$(zi)});var Qi=P;var _i=Ji;var $i=N({privateKey:gt,identifier:$(J({string:P,generalName:Gt},function(e){return typeof e==="string"||e instanceof String?"string":"generalName"}))});var ea=N({certReq:Ji,popo:$(Xi),regInfo:$(X(ae({utf8Pairs:Qi,certReq:_i,encKeyWithID:$i})))});var ta=X(ea);var ra=N({pendToken:U,pendTime:D});var na=R({success:0,failed:2,pending:3,noSupport:4,confirmRequired:5,popRequired:6,partial:7});var ia=R({badAlg:0,badMessageCheck:1,badRequest:2,badTime:3,badCertId:4,unsupportedExt:5,mustArchiveKeys:6,badIdentity:7,popRequired:8,popFailed:9,noKeyReuse:10,internalCAError:11,tryLater:12,authDataFail:13});var aa=N({cMCStatus:na,bodyList:X(pn),statusString:$(P),otherInfo:$(J({failInfo:ia,pendInfo:ra}))});var oa=N({pkiDataReference:pn,certReferences:X(pn),extensions:X(rr)});var sa=N({pkiDataBodyid:pn,bodyIds:X(pn)});var ca=N({issuerName:Gt,serialNumber:R});var ua=N({issuerName:ue,cRLName:$(Gt),time:$(D),reasons:$(Jt)});var fa=N({issuerName:ue,serialNumber:R,reason:vr,invalidityDate:$(D),passphrase:$(U),comment:$(P)});var da=N({bodyPartID:pn,thePOPAlgID:Se,thePOP:U});var ha=Fn;var ya=J({bodyPartID:pn,bodyPartPath:vn});var la=N({cMCStatus:na,bodyList:X(ya),statusString:$(P),otherInfo:$(J({failInfo:ia,pendInfo:ra,extendedFailInfo:N({failInfoOID:H,failInfoValue:ie})}))});var pa=N({seqNumber:R,hashAlgorithm:Se,anchorHashes:X(U)});var va=pn;var ga=X(pn);var ma=N({hashAlg:Se,certHashes:X(U),pubInfo:Ni});var Ca=N({pkiDataReference:vn,certReferences:ga,replace:_(w,true),certTemplate:Zi});var ba=N({bodyList:X(ya)});var Aa=N({proofAlgID:Se,macAlgId:Se,witness:U});var wa=N({keyGenAlgorithm:Se,macAlgorithm:Se,witness:U});var Fa=N({bodyPartID:pn,certificationRequest:lr});var Sa=N({bodyPartID:pn,contentInfo:yi});var Ea=N({bodyPartID:pn,otherMsgType:H,otherMsgValue:A});var Ka=J({tcr:q(0,j(Fa)),crm:q(1,j(ea)),orm:q(2,j(N({bodyPartID:pn,requestMessageType:H,requestMessageValue:A})))});var Pa=N({request:Ka,cms:yi,thePOPAlgID:Se,witnessAlgID:Se,witness:U});var Ba=L({bodyPartID:pn,attrType:H,attrValues:function attrValues(e){return z(e)}},"attrType","attrValues",ie)({statusInfo:aa,identification:P,identityProof:U,dataReturn:U,transactionId:R,senderNonce:U,recipientNonce:U,addExtensions:oa,encryptedPOP:Pa,decryptedPOP:da,lraPOPWitness:sa,getCert:ca,getCRL:ua,revokeRequest:fa,regInfo:U,responseInfo:U,queryPending:U,popLinkRandom:U,popLinkWitness:U,confirmCertAcceptance:ha,statusInfoV2:la,trustedAnchors:pa,authPublish:va,batchRequests:ga,batchResponses:ga,publishCert:ma,modCertTemplate:Ca,controlProcessed:ba,popLinkWitnessV2:wa,identityProofV2:Aa});var Da=N({controlSequence:X(Ba),reqSequence:X(Ka),cmsSequence:X(Sa),otherMsgSequence:X(Ea)},"PKI REQUEST");var ka=N({controlSequence:X(Ba),cmsSequence:X(Sa),otherMsgSequence:X(Ea)},"PKI RESPONSE");function GostASN1(){}GostASN1.prototype={GostPrivateKeyInfo:wt,GostSubjectPublicKeyInfo:ft,GostKeyContainer:nn,GostKeyContainerName:an,GostPrivateKeys:on,GostPrivateMasks:sn,ViPNetInfo:un,GostSignature:cr,GostEncryptedKey:Jr,GostWrappedPrivateKey:vt,PrivateKeyInfo:gt,EncryptedPrivateKeyInfo:St,SubjectPublicKeyInfo:ut,TBSCertificate:ur,Certificate:fr,CertificationRequestInfo:yr,CertificationRequest:lr,TBSCertList:br,CertificateList:Ar,AttributeCertificateInfo:Nr,AttributeCertificate:Lr,SignedAttributes:mn,UnsignedAttributes:Cn,ContentInfo:yi,SafeContents:Ki,AuthenticatedSafe:Pi,PFX:Di,PKIData:Da,PKIResponse:ka};var Ia=t.gostASN1Instance=new GostASN1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.GostSecurity=GostSecurity;function expand(){var e={};for(var t=0,r=arguments.length;t<r;t++){var i=arguments[t];if((typeof i==="undefined"?"undefined":n(i))==="object")for(var a in i){e[a]=i[a]}}return e}var i={"1.2.643.2.2":"CryptoPro","1.2.643.2.2.3":"id-GostR3411-94-with-GostR3410-2001","1.2.643.2.2.4":"id-GostR3411-94-with-GostR3410-94","1.2.643.2.2.9":"id-GostR3411-94","1.2.643.2.2.10":"id-HMACGostR3411-94","1.2.643.2.2.13.0":"id-Gost28147-89-None-KeyWrap","1.2.643.2.2.13.1":"id-Gost28147-89-CryptoPro-KeyWrap","1.2.643.2.2.14.0":"id-Gost28147-89-None-KeyMeshing","1.2.643.2.2.14.1":"id-Gost28147-89-CryptoPro-KeyMeshing","1.2.643.2.2.19":"id-GostR3410-2001","1.2.643.2.2.20":"id-GostR3410-94","1.2.643.2.2.20.1":"id-GostR3410-94-a","1.2.643.2.2.20.2":"id-GostR3410-94-aBis","1.2.643.2.2.20.3":"id-GostR3410-94-b","1.2.643.2.2.20.4":"id-GostR3410-94-bBis","1.2.643.2.2.21":"id-Gost28147-89","1.2.643.2.2.22":"id-Gost28147-89-MAC","1.2.643.2.2.30.0":"id-GostR3411-94-TestParamSet","1.2.643.2.2.30.1":"id-GostR3411-94-CryptoProParamSet","1.2.643.2.2.30.2":"id-GostR3411-94-CryptoPro-B-ParamSet","1.2.643.2.2.30.3":"id-GostR3411-94-CryptoPro-C-ParamSet","1.2.643.2.2.30.4":"id-GostR3411-94-CryptoPro-D-ParamSet","1.2.643.2.2.31.0":"id-Gost28147-89-TestParamSet","1.2.643.2.2.31.1":"id-Gost28147-89-CryptoPro-A-ParamSet","1.2.643.2.2.31.2":"id-Gost28147-89-CryptoPro-B-ParamSet","1.2.643.2.2.31.3":"id-Gost28147-89-CryptoPro-C-ParamSet","1.2.643.2.2.31.4":"id-Gost28147-89-CryptoPro-D-ParamSet","1.2.643.2.2.31.5":"id-Gost28147-89-CryptoPro-Oscar-1-1-ParamSet","1.2.643.2.2.31.6":"id-Gost28147-89-CryptoPro-Oscar-1-0-ParamSet","1.2.643.2.2.31.7":"id-Gost28147-89-CryptoPro-RIC-1-ParamSet ","1.2.643.2.2.31.12":"id-Gost28147-89-CryptoPro-tc26-1","1.2.643.2.2.31.13":"id-Gost28147-89-CryptoPro-tc26-2","1.2.643.2.2.31.14":"id-Gost28147-89-CryptoPro-tc26-3","1.2.643.2.2.31.15":"id-Gost28147-89-CryptoPro-tc26-4","1.2.643.2.2.31.16":"id-Gost28147-89-CryptoPro-tc26-5","1.2.643.2.2.31.17":"id-Gost28147-89-CryptoPro-tc26-6","1.2.643.2.2.32.0":"id-GostR3410-94-TestParamSet","1.2.643.2.2.32.2":"id-GostR3410-94-CryptoPro-A-ParamSet","1.2.643.2.2.32.3":"id-GostR3410-94-CryptoPro-B-ParamSet","1.2.643.2.2.32.4":"id-GostR3410-94-CryptoPro-C-ParamSet","1.2.643.2.2.32.5":"id-GostR3410-94-CryptoPro-D-ParamSet","1.2.643.2.2.33.1":"id-GostR3410-94-CryptoPro-XchA-ParamSet","1.2.643.2.2.33.2":"id-GostR3410-94-CryptoPro-XchB-ParamSet","1.2.643.2.2.33.3":"id-GostR3410-94-CryptoPro-XchC-ParamSet","1.2.643.2.2.34.2":"temporaryAccessToRC","1.2.643.2.2.34.3":"internetContentSignature","1.2.643.2.2.34.4":"adminRC","1.2.643.2.2.34.5":"operatorRC","1.2.643.2.2.34.6":"userRC","1.2.643.2.2.34.7":"clientRC","1.2.643.2.2.34.8":"serverRC","1.2.643.2.2.34.9":"sysAdminRC","1.2.643.2.2.34.10":"arcAdminRC","1.2.643.2.2.34.11":"authorityPersonRC","1.2.643.2.2.34.12":"clientCC","1.2.643.2.2.34.13":"sysAdminCC","1.2.643.2.2.34.14":"arcAdminCC","1.2.643.2.2.34.15":"accessIPSecCA","1.2.643.2.2.34.16":"auditAdminHSM","1.2.643.2.2.34.21":"adminHSM","1.2.643.2.2.34.22":"serverAdminHSH","1.2.643.2.2.34.24":"winlogonCA","1.2.643.2.2.34.25":"timestampServiceUser","1.2.643.2.2.34.26":"statusServiceUser","1.2.643.2.2.34.27":"arcAdminHSM","1.2.643.2.2.34.28":"auditorHSM","1.2.643.2.2.35.0":"id-GostR3410-2001-CryptoPro-TestParamSet","1.2.643.2.2.35.1":"id-GostR3410-2001-CryptoPro-A-ParamSet","1.2.643.2.2.35.2":"id-GostR3410-2001-CryptoPro-B-ParamSet","1.2.643.2.2.35.3":"id-GostR3410-2001-CryptoPro-C-ParamSet","1.2.643.2.2.36.0":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","1.2.643.2.2.36.1":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","1.2.643.2.2.37.1":"id-CryptoPro-GostPrivateKeys-V1","1.2.643.2.2.37.2":"id-CryptoPro-GostPrivateKeys-V2","1.2.643.2.2.37.2.1":"id-CryptoPro-GostPrivateKeys-V2-Full","1.2.643.2.2.37.2.2":"id-CryptoPro-GostPrivateKeys-V2-PartOf","1.2.643.2.2.37.3.1":"intermediateCertificates","1.2.643.2.2.37.3.2":"trustedCertificatesSignature","1.2.643.2.2.37.3.3":"trustedCertificatesExchange","1.2.643.2.2.37.3.10":"keyValidity","1.2.643.2.2.38.1":"personalBaseProlicy","1.2.643.2.2.38.2":"networkBasePolicy","1.2.643.2.2.47.1":"id-CryptoPro-ocsp-treats-exp-key-or-exp-cert-rev","1.2.643.2.2.47.2":"id-CryptoPro-ocsp-crl-locator","1.2.643.2.2.47.3":"id-CryptoPro-ocsp-instant-revocation-indicator","1.2.643.2.2.47.4":"id-CryptoPro-ocsp-revocation-announcement-reference","1.2.643.2.2.47.5":"id-CryptoPro-ocsp-historical-request","1.2.643.2.2.49.2":"limitedLicense","1.2.643.2.2.96":"id-GostR3410-2001-CryptoPro-ESDH","1.2.643.2.2.97":"id-GostR3410-94-CryptoPro-ESDH","1.2.643.2.2.98":"id-GostR3410-2001DH","1.2.643.2.2.99":"id-GostR3410-94DH","1.2.643.2.45.1.1.1":"signatureComment","1.2.643.2.45.1.1.2":"resourceName","1.2.643.2.45.1.1.3":"signatureUsage","1.2.643.3.131.1.1":"INN","1.2.643.3.141.1.1":"RNS FSS","1.2.643.3.141.1.2":"KP FSS","1.2.643.7.1":"tc26","1.2.643.7.1.1.1.1":"id-tc26-gost3410-12-256","1.2.643.7.1.1.1.2":"id-tc26-gost3410-12-512","1.2.643.7.1.1.2.1":"id-tc26-gost3411-94","1.2.643.7.1.1.2.2":"id-tc26-gost3411-12-256","1.2.643.7.1.1.2.3":"id-tc26-gost3411-12-512","1.2.643.7.1.1.3.1":"id-tc26-signwithdigest-gost3410-12-94","1.2.643.7.1.1.3.2":"id-tc26-signwithdigest-gost3410-12-256","1.2.643.7.1.1.3.3":"id-tc26-signwithdigest-gost3410-12-512","1.2.643.7.1.1.4.1":"id-tc26-hmac-gost-3411-12-256","1.2.643.7.1.1.4.2":"id-tc26-hmac-gost-3411-12-512","1.2.643.7.1.1.6.1":"id-tc26-agreement-gost-3410-12-256","1.2.643.7.1.1.6.2":"id-tc26-agreement-gost-3410-12-512","1.2.643.7.1.2.1.1.0":"id-tc26-gost-3410-12-256-paramSetTest","1.2.643.7.1.2.1.1.1":"id-tc26-gost-3410-12-256-paramSetA","1.2.643.7.1.2.1.1.2":"id-tc26-gost-3410-12-256-paramSetB","1.2.643.7.1.2.1.2.0":"id-tc26-gost-3410-12-512-paramSetTest","1.2.643.7.1.2.1.2.1":"id-tc26-gost-3410-12-512-paramSetA","1.2.643.7.1.2.1.2.2":"id-tc26-gost-3410-12-512-paramSetB","1.2.643.7.1.2.1.2.3":"id-tc26-gost-3410-12-512-paramSetC","1.2.643.7.1.2.1.2.4":"id-tc26-gost-3410-12-512-paramSetD","1.2.643.7.1.2.5.1.1":"id-tc26-gost-28147-param-Z","1.2.643.100.1":"OGRN","1.2.643.100.2.1":"SMEV-person","1.2.643.100.2.2":"SMEV-government","1.2.643.100.3":"SNILS","1.2.643.100.4":"KPP","1.2.643.100.5":"OGRNIP","1.2.643.100.6":"internal-government","1.2.643.100.111":"subjectSignTool","1.2.643.100.112":"issuerSignTool","1.2.643.100.113.1":"signToolClassKC1","1.2.643.100.113.2":"signToolClassKC2","1.2.643.100.113.3":"signToolClassKC3","1.2.643.100.113.4":"signToolClassKB1","1.2.643.100.113.5":"signToolClassKB2","1.2.643.100.113.6":"signToolClassKA1","1.2.643.100.114.1":"issuerToolClassKC1","1.2.643.100.114.2":"issuerToolClassKC2","1.2.643.100.114.3":"issuerToolClassKC3","1.2.643.100.114.4":"issuerToolClassKB2","1.2.643.100.114.5":"issuerToolClassKB1","1.2.643.100.114.6":"issuerToolClassKA1","1.2.840.10040.4":"x9cm","1.2.840.10040.4.1":"dsa","1.2.840.10040.4.3":"dsa-with-SHA1","1.2.840.10045":"ansi-x962","1.2.840.10045.1":"id-fieldType","1.2.840.10045.1.1":"id-prime-Field","1.2.840.10045.1.2":"id-characteristic-two-field","1.2.840.10045.2.1":"ecPublicKey","1.2.840.10045.3.0":"characteristicTwo","1.2.840.10045.3.1.1":"secp192r1","1.2.840.10045.3.1.2":"prime192v2","1.2.840.10045.3.1.3":"prime192v3","1.2.840.10045.3.1.4":"prime239v1","1.2.840.10045.3.1.5":"prime239v2","1.2.840.10045.3.1.6":"prime239v3","1.2.840.10045.3.1.7":"secp256r1","1.2.840.10045.4":"ecdsa","1.2.840.10045.4.1":"ecdsa-with-SHA1","1.2.840.10045.4.2":"ecdsa-with-Recommended","1.2.840.10045.4.4":"ecdsa-with-SHA2","1.2.840.10045.4.4.1":"ecdsa-with-SHA224","1.2.840.10045.4.4.2":"ecdsa-with-SHA256","1.2.840.10045.4.4.3":"ecdsa-with-SHA384","1.2.840.10045.4.4.4":"ecdsa-with-SHA512","1.2.840.113533.7.66.13":"PasswordBasedMac","1.3.6.1.4.1.22554.1.1.2.1.2":"pbeWithSHAAndAES128-CBC","1.3.6.1.4.1.22554.1.1.2.1.22":"pbeWithSHAAndAES192-CBC","1.3.6.1.4.1.22554.1.1.2.1.42":"pbeWithSHAAndAES256-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.2":"pbeWithSHA256AndAES128-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.22":"pbeWithSHA256AndAES192-CBC","1.3.6.1.4.1.22554.1.2.1.2.1.42":"pbeWithSHA256AndAES256-CBC","1.2.840.113549":"rsa","1.2.840.113549.1.1.1":"rsaEncryption","1.2.840.113549.1.1.2":"md2withRSAEncryption","1.2.840.113549.1.1.3":"md4withRSAEncryption","1.2.840.113549.1.1.4":"md5withRSAEncryption","1.2.840.113549.1.1.5":"sha1withRSAEncryption","1.2.840.113549.1.1.7":"rsaes-oaep","1.2.840.113549.1.1.8":"mgf1","1.2.840.113549.1.1.9":"pSpecified","1.2.840.113549.1.1.10":"rsassa-pss","1.2.840.113549.1.1.11":"sha256withRSAEncryption","1.2.840.113549.1.1.12":"sha384withRSAEncryption","1.2.840.113549.1.1.13":"sha512withRSAEncryption","1.2.840.113549.1.2.7":"hmacWithSHA1","1.2.840.113549.1.2.8":"hmacWithSHA224","1.2.840.113549.1.2.9":"hmacWithSHA256","1.2.840.113549.1.2.10":"hmacWithSHA384","1.2.840.113549.1.2.11":"hmacWithSHA512","1.2.840.113549.1.3.1":"dhKeyAgreement","1.2.840.113549.1.5.12":"PBKDF2","1.2.840.113549.1.5.13":"PBES2","1.2.840.113549.1.5.14":"PBMAC1","1.2.840.113549.1.7.1":"data","1.2.840.113549.1.7.2":"signedData","1.2.840.113549.1.7.3":"envelopedData","1.2.840.113549.1.7.4":"signedAndEnvelopedData","1.2.840.113549.1.7.5":"digestedData","1.2.840.113549.1.7.6":"encryptedData","1.2.840.113549.1.9.1":"emailAddress","1.2.840.113549.1.9.2":"unstructuredName","1.2.840.113549.1.9.3":"contentType","1.2.840.113549.1.9.4":"messageDigest","1.2.840.113549.1.9.5":"signingTime","1.2.840.113549.1.9.6":"countersignature","1.2.840.113549.1.9.7":"challengePassword","1.2.840.113549.1.9.8":"unstructuredAddress","1.2.840.113549.1.9.9":"extendedCertificateAttributes","1.2.840.113549.1.9.10":"issuerAndSerialNumber","1.2.840.113549.1.9.11":"passwordCheck","1.2.840.113549.1.9.12":"publicKey","1.2.840.113549.1.9.13":"signingDescription","1.2.840.113549.1.9.14":"extensionRequest","1.2.840.113549.1.9.15":"sMimeCapabilities","1.2.840.113549.1.9.16":"sMimeObjectIdentifierRegistry","1.2.840.113549.1.9.16.1.2":"authData","1.2.840.113549.1.9.16.1.4 ":"timestampToken","1.2.840.113549.1.9.16.1.17 ":"firmwareLoadReceipt","1.2.840.113549.1.9.16.1.21":"encKeyWithID","1.2.840.113549.1.9.16.1.23":"authEnvelopedData","1.2.840.113549.1.9.16.2":"sMimeAttributes","1.2.840.113549.1.9.16.2.1":"receiptRequest","1.2.840.113549.1.9.16.2.12":"signingCertificate","1.2.840.113549.1.9.16.2.14":"timeStampToken","1.2.840.113549.1.9.16.2.2":"securityLabel","1.2.840.113549.1.9.16.2.3":"mlExpansionHistory","1.2.840.113549.1.9.16.2.34":"unsignedData","1.2.840.113549.1.9.16.2.47":"signingCertificateV2","1.2.840.113549.1.9.16.3.5":"ESDH","1.2.840.113549.1.9.20":"friendlyName","1.2.840.113549.1.9.21":"localKeyId","1.2.840.113549.1.9.22":"certTypes","1.2.840.113549.1.9.22.1":"x509Certificate","1.2.840.113549.1.9.22.2":"sdsiCertificate","1.2.840.113549.1.9.23":"crlTypes","1.2.840.113549.1.9.23.1":"x509CRL","1.2.840.113549.1.9.24":"secretTypes","1.2.840.113549.1.9.24.1":"secret","1.2.840.113549.1.9.25.1":"pkcs15Token","1.2.840.113549.1.9.25.2":"encryptedPrivateKeyInfo","1.2.840.113549.1.9.25.3":"randomNonce","1.2.840.113549.1.9.25.4":"sequenceNumber","1.2.840.113549.1.9.25.5":"pkcs7PDU","1.2.840.113549.1.9.26.1":"pkcs9String","1.2.840.113549.1.9.26.2":"signingTimeString","1.2.840.113549.1.9.27.1":"caseIgnoreMatch","1.2.840.113549.1.9.27.2":"signingTimeMatch","1.2.840.113549.1.12.0.1":"pkcs-12","1.2.840.113549.1.12.1":"pbe","1.2.840.113549.1.12.1.1":"pbeWithSHAAnd128BitRC4","1.2.840.113549.1.12.1.2":"pbeWithSHAAnd40BitRC4","1.2.840.113549.1.12.1.3":"pbeWithSHAAnd3-KeyTripleDES-CBC","1.2.840.113549.1.12.1.4":"pbeWithSHAAnd2-KeyTripleDES-CBC","1.2.840.113549.1.12.1.5":"pbeWithSHAAnd128BitRC2-CBC","1.2.840.113549.1.12.1.6":"pbeWithSHAAnd40BitRC2-CBC","1.2.840.113549.1.12.1.80":"pbeUnknownGost","1.2.840.113549.1.12.2.1":"pkcs8-key-shrouding","1.2.840.113549.1.12.3.1":"keyBagId","1.2.840.113549.1.12.3.2":"certAndCRLBagId","1.2.840.113549.1.12.3.3":"secretBagId","1.2.840.113549.1.12.3.4":"safeContentsId","1.2.840.113549.1.12.3.5":"pkcs-8ShroudedKeyBagId","1.2.840.113549.1.12.4.1":"x509CertCRLBagId","1.2.840.113549.1.12.4.2":"pkcs-12-SDSICertBag","1.2.840.113549.1.12.10.1.1":"keyBag","1.2.840.113549.1.12.10.1.2":"pkcs8ShroudedKeyBag","1.2.840.113549.1.12.10.1.3":"certBag","1.2.840.113549.1.12.10.1.4":"crlBag","1.2.840.113549.1.12.10.1.5":"secretBag","1.2.840.113549.1.12.10.1.6":"safeContentsBag","1.2.840.113549.2.5":"md-5","1.2.840.113549.3.7":"des-EDE3-CBC","1.3.132.0.34":"secp384r1","1.3.132.0.35":"secp521r1","1.3.132.112":"ecDH","1.3.14.3.2.26":"sha1","1.3.6.1.4.1.311.2.1.14":"msCertExtensions","1.3.6.1.4.1.311.17.1":"keyProviderNameAttr","1.3.6.1.4.1.311.17.2":"localMachineKeyset","1.3.6.1.4.1.311.17.3.20":"certKeyIdentifierPropId","1.3.6.1.4.1.5849":"SignalCom","1.3.6.1.4.1.5849.1.1.1":"id-sc-gost28147-ecb","1.3.6.1.4.1.5849.1.1.2":"id-sc-gost28147-gamma","1.3.6.1.4.1.5849.1.1.3":"id-sc-gost28147-gfb","1.3.6.1.4.1.5849.1.1.4":"id-sc-gost28147-mac","1.3.6.1.4.1.5849.1.1.5":"id-sc-gostR3410-94","1.3.6.1.4.1.5849.1.1.6.1.1.1":"id-sc-gostR3410-94-default","1.3.6.1.4.1.5849.1.1.6.1.1.2":"id-sc-gostR3410-94-test","1.3.6.1.4.1.5849.1.2.1":"id-sc-gostR3411-94","1.3.6.1.4.1.5849.1.3.1":"id-sc-gostR3411-94-with-gostR3410-94","1.3.6.1.4.1.5849.1.3.2":"id-sc-gostR3411-94-with-gostR3410-2001","1.3.6.1.4.1.5849.1.4.1":"id-sc-cmsGostWrap","1.3.6.1.4.1.5849.1.4.2":"id-sc-cmsGost28147Wrap","1.3.6.1.4.1.5849.1.5.1":"id-sc-pbeWithGost3411AndGost28147","1.3.6.1.4.1.5849.1.5.2":"id-sc-pbeWithGost3411AndGost28147CFB","1.3.6.1.4.1.5849.1.6.2":"id-sc-gostR3410-2001","1.3.6.1.4.1.5849.1.7.2":"id-sc-hmacWithGostR3411","1.3.6.1.4.1.5849.1.8.1":"id-sc-r3410-ESDH-r3411kdf","1.3.6.1.4.1.5849.1.8.3":"id-sc-ecdh-singlePass-cofactor-r3411kdf","1.3.6.1.4.1.5849.2.2.1":"id-sc-gostR3410-2001-publicKey","1.3.6.1.5.5.7.0.12":"attribute-cert","1.3.6.1.5.5.7.1.1":"authorityInfoAccess","1.3.6.1.5.5.7.1.4":"auditIdentity","1.3.6.1.5.5.7.1.6":"aaControls","1.3.6.1.5.5.7.1.10":"ac-proxying","1.3.6.1.5.5.7.1.11":"subjectInfoAccess","1.3.6.1.5.5.7.3.1":"serverAuth","1.3.6.1.5.5.7.3.2":"clientAuth","1.3.6.1.5.5.7.3.3":"codeSigning","1.3.6.1.5.5.7.3.4":"emailProtection","1.3.6.1.5.5.7.3.5":"ipsecEndSystem","1.3.6.1.5.5.7.3.6":"ipsecTunnel","1.3.6.1.5.5.7.3.7":"ipsecUser","1.3.6.1.5.5.7.3.8":"timeStamping","1.3.6.1.5.5.7.3.9":"OCSPSigning","1.3.6.1.5.5.7.5.1":"regCtrl","1.3.6.1.5.5.7.5.1.1":"regToken","1.3.6.1.5.5.7.5.1.2":"authenticator","1.3.6.1.5.5.7.5.1.3":"pkiPublicationInfo","1.3.6.1.5.5.7.5.1.4":"pkiArchiveOptions","1.3.6.1.5.5.7.5.1.5":"oldCertID","1.3.6.1.5.5.7.5.1.6":"protocolEncrKey","1.3.6.1.5.5.7.5.2":"regInfoAttr","1.3.6.1.5.5.7.5.2.1":"UTF8Pairs","1.3.6.1.5.5.7.5.2.2":"certReq","1.3.6.1.5.5.7.6.2":"noSignature","1.3.6.1.5.5.7.7.1":"statusInfo","1.3.6.1.5.5.7.7.2":"identification","1.3.6.1.5.5.7.7.3":"identityProof","1.3.6.1.5.5.7.7.4":"dataReturn","1.3.6.1.5.5.7.7.5":"transactionId","1.3.6.1.5.5.7.7.6":"senderNonce","1.3.6.1.5.5.7.7.7":"recipientNonce","1.3.6.1.5.5.7.7.8":"addExtensions","1.3.6.1.5.5.7.7.9":"encryptedPOP","1.3.6.1.5.5.7.7.10":"decryptedPOP","1.3.6.1.5.5.7.7.11":"lraPOPWitness","1.3.6.1.5.5.7.7.15":"getCert","1.3.6.1.5.5.7.7.16":"getCRL","1.3.6.1.5.5.7.7.17":"revokeRequest","1.3.6.1.5.5.7.7.18":"regInfo","1.3.6.1.5.5.7.7.19":"responseInfo","1.3.6.1.5.5.7.7.21":"queryPending","1.3.6.1.5.5.7.7.22":"popLinkRandom","1.3.6.1.5.5.7.7.23":"popLinkWitness","1.3.6.1.5.5.7.7.24":"confirmCertAcceptance","1.3.6.1.5.5.7.7.25":"statusInfoV2","1.3.6.1.5.5.7.7.26":"trustedAnchors","1.3.6.1.5.5.7.7.27":"authPublish","1.3.6.1.5.5.7.7.28":"batchRequests","1.3.6.1.5.5.7.7.29":"batchResponses","1.3.6.1.5.5.7.7.30":"publishCert","1.3.6.1.5.5.7.7.31":"modCertTemplate","1.3.6.1.5.5.7.7.32":"controlProcessed","1.3.6.1.5.5.7.7.33":"popLinkWitnessV2","1.3.6.1.5.5.7.7.34":"identityProofV2","1.3.6.1.5.5.7.9.1":"dateOfBirth","1.3.6.1.5.5.7.9.2":"placeOfBirth","1.3.6.1.5.5.7.9.3":"gender","1.3.6.1.5.5.7.9.4":"countryOfCitizenship","1.3.6.1.5.5.7.9.5":"countryOfResidence","1.3.6.1.5.5.7.10.1":"authenticationInfo","1.3.6.1.5.5.7.10.2":"accessIdentity","1.3.6.1.5.5.7.10.3":"chargingIdentity","1.3.6.1.5.5.7.10.4":"group","1.3.6.1.5.5.7.10.6":"encAttrs","1.3.6.1.5.5.7.12.2":"PKIData","1.3.6.1.5.5.7.12.3":"PKIResponse","1.3.6.1.5.5.7.48.1.1":"ocsp-basic","1.3.6.1.5.5.7.48.1.2":"ocsp-nonce","1.3.6.1.5.5.7.48.1.3":"ocsp-crl","1.3.6.1.5.5.7.48.1.4":"ocsp-response","1.3.6.1.5.5.7.48.1.5":"ocsp-nocheck","1.3.6.1.5.5.7.48.1.6":"ocsp-archive-cutoff","1.3.6.1.5.5.7.48.1.7":"ocsp-service-locator","2.16.840.1.101.2.1.2.78.2":"encryptedKeyPkg","2.16.840.1.101.2.1.2.78.3":"keyPackageReceipt","2.16.840.1.101.2.1.2.78.5":"aKeyPackage","2.16.840.1.101.2.1.2.78.6":"keyPackageError","2.16.840.1.101.3.4":"nistAlgorithms","2.16.840.1.101.3.4.1":"aes","2.16.840.1.101.3.4.1.1":"aes128-ECB","2.16.840.1.101.3.4.1.2":"aes128-CBC","2.16.840.1.101.3.4.1.3":"aes128-OFB","2.16.840.1.101.3.4.1.4":"aes128-CFB","2.16.840.1.101.3.4.1.5":"aes128-wrap","2.16.840.1.101.3.4.1.6":"aes128-GCM","2.16.840.1.101.3.4.1.7":"aes128-CCM","2.16.840.1.101.3.4.1.8":"aes128-wrap-pad","2.16.840.1.101.3.4.1.21":"aes192-ECB","2.16.840.1.101.3.4.1.22":"aes192-CBC","2.16.840.1.101.3.4.1.23":"aes192-OFB","2.16.840.1.101.3.4.1.24":"aes192-CFB","2.16.840.1.101.3.4.1.25":"aes192-wrap","2.16.840.1.101.3.4.1.26":"aes192-GCM","2.16.840.1.101.3.4.1.27":"aes192-CCM","2.16.840.1.101.3.4.1.28":"aes192-wrap-pad","2.16.840.1.101.3.4.1.41":"aes256-ECB","2.16.840.1.101.3.4.1.42":"aes256-CBC","2.16.840.1.101.3.4.1.43":"aes256-OFB","2.16.840.1.101.3.4.1.44":"aes256-CFB","2.16.840.1.101.3.4.1.45":"aes256-wrap","2.16.840.1.101.3.4.1.46":"aes256-GCM","2.16.840.1.101.3.4.1.47":"aes256-CCM","2.16.840.1.101.3.4.1.48":"aes256-wrap-pad","2.16.840.1.101.3.4.2.1":"sha256","2.16.840.1.101.3.4.2.2":"sha384","2.16.840.1.101.3.4.2.3":"sha512","2.16.840.1.113730.3.1.216":"userPKCS12","2.5.1.5.55":"clearance","2.5.4.0":"objectClass","2.5.4.1":"aliasedEntryName","2.5.4.2":"knowldgeinformation","2.5.4.3":"commonName","2.5.4.5":"serialName","2.5.4.6":"countryName","2.5.4.7":"localityName","2.5.4.8":"stateOrProvinceName","2.5.4.9":"streetAddress","2.5.4.10":"organizationName","2.5.4.11":"organizationalUnitName","2.5.4.12":"title","2.5.4.13":"description","2.5.4.14":"searchGuide","2.5.4.15":"businessCategory","2.5.4.16":"postalAddress","2.5.4.17":"postalCode","2.5.4.18":"postOfficeBox","2.5.4.19":"physicalDeliveryOfficeName","2.5.4.20":"telephoneNumber","2.5.4.21":"telexNumber","2.5.4.22":"teletexTerminalIdentifier","2.5.4.23":"facsimileTelephoneNumber","2.5.4.24":"x121Address","2.5.4.25":"internationalISDNNumber","2.5.4.26":"registeredAddress","2.5.4.27":"destinationIndicator","2.5.4.28":"preferredDeliveryMethod","2.5.4.29":"presentationAddress","2.5.4.30":"supportedApplicationContext","2.5.4.31":"member","2.5.4.32":"owner","2.5.4.33":"roleOccupant","2.5.4.34":"seeAlso","2.5.4.35":"userPassword","2.5.4.36":"userCertificate","2.5.4.37":"cACertificate","2.5.4.38":"authorityRevocationList","2.5.4.39":"certificateRevocationList","2.5.4.40":"crossCertificatePair","2.5.4.41":"name","2.5.4.42":"givenName","2.5.4.43":"initials","2.5.4.44":"generationQualifier","2.5.4.45":"uniqueIdentifier","2.5.4.46":"dnQualifier","2.5.4.47":"enhancedSearchGuide","2.5.4.48":"protocolInformation","2.5.4.49":"distinguishedName","2.5.4.50":"uniqueMember","2.5.4.51":"houseIdentifier","2.5.4.52":"supportedAlgorithms","2.5.4.53":"deltaRevocationList","2.5.4.58":"attributeCertificate","2.5.4.65":"pseudonym","2.5.4.72":"role","2.5.29.1":"authorityKeyIdentifierX","2.5.29.2":"keyAttributesX","2.5.29.3":"certificatePoliciesX","2.5.29.4":"keyUsageRestriction","2.5.29.5":"policyMapping","2.5.29.6":"subtreesConstraint","2.5.29.7":"subjectAltNameX","2.5.29.8":"issuerAltNameX","2.5.29.9":"subjectDirectoryAttributes","2.5.29.10":"basicConstraintsX","2.5.29.11":"nameConstraintsX","2.5.29.12":"policyConstraintsX","2.5.29.13":"basicConstraintsY","2.5.29.14":"subjectKeyIdentifier","2.5.29.15":"keyUsage","2.5.29.16":"privateKeyUsagePeriod","2.5.29.17":"subjectAltName","2.5.29.18":"issuerAltName","2.5.29.19":"basicConstraints","2.5.29.20":"cRLNumber","2.5.29.21":"cRLReason","2.5.29.22":"expirationDate","2.5.29.23":"instructionCode","2.5.29.24":"invalidityDate","2.5.29.25":"cRLDistributionPointsX","2.5.29.26":"issuingDistributionPointX","2.5.29.27":"deltaCRLIndicator","2.5.29.28":"issuingDistributionPoint","2.5.29.29":"certificateIssuer","2.5.29.30":"nameConstraints","2.5.29.31":"cRLDistributionPoints","2.5.29.32":"certificatePolicies","2.5.29.33":"policyMappings","2.5.29.34":"policyConstraintsY","2.5.29.35":"authorityKeyIdentifier","2.5.29.36":"policyConstraints","2.5.29.37":"extKeyUsage","2.5.29.46":"freshestCRL","2.5.29.54":"inhibitAnyPolicy","2.5.29.55":"targetInformation","2.5.29.56":"noRevAvail"};var a={};for(var o in i){a[i[o]]=o}var s={"id-GostR3411-94-with-GostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94","id-GostR3411-94-with-GostR3410-94":"GOST R 34.10-94/GOST R 34.11-94","id-GostR3411-94":"GOST R 34.11-94","id-HMACGostR3411-94":{name:"HMAC",hash:{name:"GOST R 34.11-94"}},"id-Gost28147-89-None-KeyWrap":"GOST 28147-89-KW","id-Gost28147-89-CryptoPro-KeyWrap":"GOST 28147-89-CPKW","id-GostR3410-2001":"GOST R 34.10-2001","id-GostR3410-94":"GOST R 34.10-94","id-GostR3410-94-a":"GOST R 34.10-94","id-GostR3410-94-aBis":"GOST R 34.10-94","id-GostR3410-94-b":"GOST R 34.10-94","id-GostR3410-94-bBis":"GOST R 34.10-94","id-Gost28147-89":"GOST 28147-89","id-Gost28147-89-MAC":"GOST 28147-89-MAC","id-GostR3410-2001-CryptoPro-ESDH":"GOST R 34.10-2001-DH/GOST R 34.11-94","id-GostR3410-94-CryptoPro-ESDH":"GOST R 34.10-94-DH/GOST R 34.11-94","id-GostR3410-2001DH":"GOST R 34.10-2001-DH","id-GostR3410-94DH":"GOST R 34.10-94-DH","id-tc26-gost3410-12-256":"GOST R 34.10-256","id-tc26-gost3410-12-512":"GOST R 34.10-512","id-tc26-gost3411-94":"GOST R 34.11-94","id-tc26-gost3411-12-256":"GOST R 34.11-256","id-tc26-gost3411-12-512":"GOST R 34.11-512","id-tc26-signwithdigest-gost3410-12-94":"GOST R 34.10-256/GOST R 34.11-94","id-tc26-signwithdigest-gost3410-12-256":"GOST R 34.10-256/GOST R 34.11-256","id-tc26-signwithdigest-gost3410-12-512":"GOST R 34.10-512/GOST R 34.11-512","id-tc26-hmac-gost-3411-12-256":{name:"HMAC",hash:{name:"GOST R 34.11-256"}},"id-tc26-hmac-gost-3411-12-512":{name:"HMAC",hash:{name:"GOST R 34.11-512"}},"id-tc26-agreement-gost-3410-12-256":"GOST R 34.10-256-DH/GOST R 34.11-256","id-tc26-agreement-gost-3410-12-512":"GOST R 34.10-512-DH/GOST R 34.11-256","id-sc-gost28147-ecb":"GOST 28147-89-ECB/SC","id-sc-gost28147-gamma":"GOST 28147-89-CTR/SC","id-sc-gost28147-gfb":"GOST 28147-89-CFB/SC","id-sc-gost28147-mac":"GOST 28147-89-MAC/SC","id-sc-gostR3410-94":"GOST R 34.10-94/SC","id-sc-gostR3410-94-default":"GOST R 34.10-94/SC","id-sc-gostR3410-94-test":"GOST R 34.10-94/SC/S-TEST","id-sc-gostR3411-94":"GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-94":"GOST R 34.10-94/GOST R 34.11-94/SC","id-sc-gostR3411-94-with-gostR3410-2001":"GOST R 34.10-2001/GOST R 34.11-94/SC","id-sc-cmsGostWrap":"GOST 28147-89-SCKW/SC","id-sc-cmsGost28147Wrap":"GOST 28147-89-KW/SC","id-sc-pbeWithGost3411AndGost28147":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-ECB/SC"}},"id-sc-pbeWithGost3411AndGost28147CFB":{derivation:{name:"GOST R 34.11-94-PBKDF2/SC"},encryption:{name:"GOST 28147-CFB/SC"}},"id-sc-gostR3410-2001":"GOST R 34.10-2001/SC","id-sc-hmacWithGostR3411":{name:"HMAC",hash:{name:"GOST R 34.11-94/SC"}},"id-sc-r3410-ESDH-r3411kdf":"GOST R 34.10-2001-DH/GOST R 34.11-94/SC",noSignature:"NONE",rsaEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha1withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},sha256withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},sha384withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}},sha512withRSAEncryption:{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}},"rsaes-oaep":"RSA-OAEP","rsassa-pss":"RSA-PSS",ecdsa:"ECDSA","ecdsa-with-SHA1":{name:"ECDSA",hash:{name:"SHA-1"}},"ecdsa-with-SHA256":{name:"ECDSA",hash:{name:"SHA-256"}},"ecdsa-with-SHA384":{name:"ECDSA",hash:{name:"SHA-384"}},"ecdsa-with-SHA512":{name:"ECDSA",hash:{name:"SHA-512"}},"pbeWithSHAAndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHAAndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHAAndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-1"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHA256AndAES128-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:128}},"pbeWithSHA256AndAES192-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:192}},"pbeWithSHA256AndAES256-CBC":{derivation:{name:"PBKDF2",hash:{name:"SHA-256"}},encryption:{name:"AES-CBC",length:256}},"pbeWithSHAAnd3-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"3DES",block:"CBC"}},"pbeWithSHAAnd2-KeyTripleDES-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"2DES",block:"CBC"}},"pbeWithSHAAnd128BitRC2-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:128}},"pbeWithSHAAnd40BitRC2-CBC":{derivation:{name:"PFXKDF",iterations:2e3,hash:"SHA-1"},encryption:{name:"RC2",block:"CBC",length:40}},pbeUnknownGost:{derivation:{name:"PFXKDF",iterations:2e3,hash:"GOST R 34.11-94"},encryption:{name:"GOST 28147-89-CFB"}},ecDH:"ECDH",dhKeyAgreement:"DH","aes128-CBC":{name:"AES-CBC",length:128},"aes128-CFB":{name:"AES-CFB-8",length:128},"aes128-GCM":{name:"AES-GCM",length:128},"aes128-wrap":{name:"AES-KW",length:128},"aes192-CBC":{name:"AES-CBC",length:192},"aes192-CFB":{name:"AES-CFB-8",length:192},"aes192-GCM":{name:"AES-GCM",length:192},"aes192-wrap":{name:"AES-KW",length:192},"aes256-CBC":{name:"AES-CBC",length:256},"aes256-CFB":{name:"AES-CFB-8",length:256},"aes256-GCM":{name:"AES-GCM",length:256},"aes256-wrap":{name:"AES-KW",length:256},sha1:"SHA-1",sha256:"SHA-256",sha384:"SHA-384",sha512:"SHA-512",PBKDF2:"PBKDF2",PBES2:{derivation:{name:"PBKDF2"},encryption:{}},PBMAC1:{derivation:{name:"PBKDF2"},hmac:{}},hmacWithSHA1:"SHA-1-HMAC",hmacWithSHA256:{name:"HMAC",hash:{name:"SHA-256"}},hmacWithSHA384:{name:"HMAC",hash:{name:"SHA-384"}},hmacWithSHA512:{name:"HMAC",hash:{name:"SHA-512"}}};for(var c in s){var u=s[c];if(typeof u==="string"){u={name:u}}u.id=c;s[c]=u}var f={"id-GostR3410-94-TestParamSet":{namedParam:"S-TEST"},"id-GostR3410-94-CryptoPro-A-ParamSet":{namedParam:"S-A"},"id-GostR3410-94-CryptoPro-B-ParamSet":{namedParam:"S-B"},"id-GostR3410-94-CryptoPro-C-ParamSet":{namedParam:"S-C"},"id-GostR3410-94-CryptoPro-D-ParamSet":{namedParam:"S-D"},"id-GostR3410-94-CryptoPro-XchA-ParamSet":{namedParam:"X-A"},"id-GostR3410-94-CryptoPro-XchB-ParamSet":{namedParam:"X-B"},"id-GostR3410-94-CryptoPro-XchC-ParamSet":{namedParam:"X-C"},"id-GostR3410-2001-CryptoPro-TestParamSet":{namedCurve:"S-256-TEST"},"id-GostR3410-2001-CryptoPro-A-ParamSet":{namedCurve:"S-256-A"},"id-GostR3410-2001-CryptoPro-B-ParamSet":{namedCurve:"S-256-B"},"id-GostR3410-2001-CryptoPro-C-ParamSet":{namedCurve:"S-256-C"},"id-GostR3410-2001-CryptoPro-XchA-ParamSet":{namedCurve:"X-256-A"},"id-GostR3410-2001-CryptoPro-XchB-ParamSet":{namedCurve:"X-256-B"},"id-tc26-gost-3410-12-256-paramSetTest":{namedCurve:"T-256-TEST"},"id-tc26-gost-3410-12-256-paramSetA":{namedCurve:"T-256-A"},"id-tc26-gost-3410-12-256-paramSetB":{namedCurve:"T-256-B"},"id-tc26-gost-3410-12-512-paramSetTest":{namedCurve:"T-512-TEST"},"id-tc26-gost-3410-12-512-paramSetA":{namedCurve:"T-512-A"},"id-tc26-gost-3410-12-512-paramSetB":{namedCurve:"T-512-B"},"id-tc26-gost-3410-12-512-paramSetC":{namedCurve:"T-512-C"},"id-tc26-gost-3410-12-512-paramSetD":{namedCurve:"T-512-D"},secp256r1:{namedCurve:"P-256"},secp384r:{namedCurve:"P-384"},secp521r:{namedCurve:"P-521"},"id-GostR3411-94-TestParamSet":{sBox:"D-TEST"},"id-GostR3411-94-CryptoProParamSet":{sBox:"D-A"},"id-GostR3411-94-CryptoPro-A-ParamSet":{sBox:"D-B"},"id-GostR3411-94-CryptoPro-B-ParamSet":{sBox:"D-C"},"id-GostR3411-94-CryptoPro-C-ParamSet":{sBox:"D-D"},"id-Gost28147-89-TestParamSet":{block:"CTR",sBox:"E-TEST"},"id-Gost28147-89-CryptoPro-A-ParamSet":{block:"CFB",sBox:"E-A",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-B-ParamSet":{block:"CFB",sBox:"E-B",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-C-ParamSet":{block:"CFB",sBox:"E-C",keyMeshing:"CP"},"id-Gost28147-89-CryptoPro-D-ParamSet":{block:"CFB",sBox:"E-D",keyMeshing:"CP"},"id-Gost28147-89-None-KeyMeshing":{keyMeshing:"NO"},"id-Gost28147-89-CryptoPro-KeyMeshing":{keyMeshing:"CP"},"id-tc26-gost-28147-param-Z":{block:"CFB",sBox:"E-Z"}};var d={sBox:{"D-TEST":"id-GostR3411-94-TestParamSet","D-A":"id-GostR3411-94-CryptoProParamSet","D-B":"id-GostR3411-94-CryptoPro-A-ParamSet","D-C":"id-GostR3411-94-CryptoPro-B-ParamSet","D-D":"id-GostR3411-94-CryptoPro-C-ParamSet","E-TEST":"id-Gost28147-89-TestParamSet","E-A":"id-Gost28147-89-CryptoPro-A-ParamSet","E-B":"id-Gost28147-89-CryptoPro-B-ParamSet","E-C":"id-Gost28147-89-CryptoPro-C-ParamSet","E-D":"id-Gost28147-89-CryptoPro-D-ParamSet","E-Z":"id-tc26-gost-28147-param-Z","D-256":"id-tc26-gost3411-12-256","D-512":"id-tc26-gost3411-12-512"},namedParam:{"S-TEST":"id-GostR3410-94-TestParamSet","S-A":"id-GostR3410-94-CryptoPro-A-ParamSet","S-B":"id-GostR3410-94-CryptoPro-B-ParamSet","S-C":"id-GostR3410-94-CryptoPro-C-ParamSet","S-D":"id-GostR3410-94-CryptoPro-D-ParamSet","X-A":"id-GostR3410-94-CryptoPro-XchA-ParamSet","X-B":"id-GostR3410-94-CryptoPro-XchB-ParamSet","X-C":"id-GostR3410-94-CryptoPro-XchC-ParamSet"},namedCurve:{"S-256-TEST":"id-GostR3410-2001-CryptoPro-TestParamSet","S-256-A":"id-GostR3410-2001-CryptoPro-A-ParamSet","S-256-B":"id-GostR3410-2001-CryptoPro-B-ParamSet","S-256-C":"id-GostR3410-2001-CryptoPro-C-ParamSet","X-256-A":"id-GostR3410-2001-CryptoPro-XchA-ParamSet","X-256-B":"id-GostR3410-2001-CryptoPro-XchB-ParamSet","P-256":"secp256r1","T-256-TEST":"id-tc26-gost-3410-12-256-paramSetTest","T-256-A":"id-tc26-gost-3410-12-256-paramSetA","T-256-B":"id-tc26-gost-3410-12-256-paramSetB","T-512-TEST":"id-tc26-gost-3410-12-512-paramSetTest","T-512-A":"id-tc26-gost-3410-12-512-paramSetA","T-512-B":"id-tc26-gost-3410-12-512-paramSetB"}};var h={"CP-94":{title:"Crypto-Pro GOST R 34.10-94 Cryptographic Service Provider",signature:s["id-GostR3411-94-with-GostR3410-94"],publicKey:{id:"id-GostR3410-94",name:"GOST R 34.10-94",namedParam:"X-A"},privateKey:{id:"id-GostR3410-94DH",name:"GOST R 34.10-94-DH",namedParam:"X-A"},digest:s["id-GostR3411-94"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:s["id-HMACGostR3411-94"],agreement:s["id-GostR3410-94-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89",block:"CFB",sBox:"E-A",keyMeshing:"CP"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2e3}},"CP-01":{title:"Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider",signature:s["id-GostR3411-94-with-GostR3410-2001"],publicKey:{id:"id-GostR3410-2001",name:"GOST R 34.10-2001",namedCurve:"X-256-A"},privateKey:{id:"id-GostR3410-2001DH",name:"GOST R 34.10-2001-DH",namedCurve:"X-256-A"},digest:{id:"id-GostR3411-94",name:"GOST R 34.11-94",sBox:"D-A"},wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:s["id-HMACGostR3411-94"],agreement:s["id-GostR3410-2001-CryptoPro-ESDH"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2",iterations:2e3}},"TC-256":{title:"Crypto-Pro GOST R 34.10-2012 Cryptographic Service Provider",signature:s["id-tc26-signwithdigest-gost3410-12-256"],publicKey:{id:"id-tc26-gost3410-12-256",name:"GOST R 34.10-256",namedCurve:"X-256-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-256",name:"GOST R 34.10-256-DH/GOST R 34.11-256",namedCurve:"X-256-A"},digest:s["id-tc26-gost3411-12-256"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:s["id-tc26-hmac-gost-3411-12-256"],agreement:s["id-tc26-agreement-gost-3410-12-256"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-12-PBKDF2",iterations:2e3}},"TC-512":{title:"Crypto-Pro GOST R 34.10-2012 Strong Cryptographic Service Provider",signature:s["id-tc26-signwithdigest-gost3410-12-512"],publicKey:{id:"id-tc26-gost3410-12-512",name:"GOST R 34.10-512",namedCurve:"T-512-A"},privateKey:{id:"id-tc26-agreement-gost-3410-12-512",name:"GOST R 34.10-512-DH/GOST R 34.11-256",namedCurve:"T-512-A"},digest:s["id-tc26-gost3411-12-512"],wrapping:{id:"id-Gost28147-89-CryptoPro-KeyWrap",name:"GOST 28147-89-CPKW",sBox:"E-A"},hmac:s["id-tc26-hmac-gost-3411-12-512"],agreement:s["id-tc26-agreement-gost-3410-12-512"],encryption:{id:"id-Gost28147-89",name:"GOST 28147-89-CFB-CPKM",sBox:"E-A"},derivation:{id:"PBKDF2",name:"GOST R 34.11-256-PBKDF2",iterations:2e3}},"SC-94":{title:"Signal-COM GOST Cryptographic Provider",signature:s["id-sc-gostR3411-94-with-gostR3410-94"],publicKey:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94/SC",namedParam:"S-A"},privateKey:{id:"id-sc-gostR3410-94",name:"GOST R 34.10-94/SC",modulusLength:1024,param:{p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"}},digest:s["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:s["id-sc-hmacWithGostR3411"],wrapping:["id-sc-cmsGostWrap"],agreement:s["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"SC-01":{title:"Signal-COM ECGOST Cryptographic Provider",signature:s["id-sc-gostR3411-94-with-gostR3410-2001"],publicKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",namedCurve:"P-256"},privateKey:{id:"id-sc-gostR3410-2001",name:"GOST R 34.10-2001/SC",curve:{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"}},digest:s["id-sc-gostR3411-94"],encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-89-CFB/SC"},hmac:s["id-sc-hmacWithGostR3411"],wrapping:s["id-sc-cmsGostWrap"],agreement:s["id-sc-r3410-ESDH-r3411kdf"],derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},pbes:{id:"id-sc-pbeWithGost3411AndGost28147CFB",derivation:{id:"PBKDF2",name:"GOST R 34.11-94-PBKDF2/SC",iterations:2048},encryption:{id:"id-sc-gost28147-gfb",name:"GOST 28147-CFB/SC",iv:new Uint8Array([0,0,0,0,0,0,0,0])}}},"RSA-2048":{title:"Microsoft Strong Cryptographic Provider",signature:s["sha256withRSAEncryption"],publicKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:s["sha256"]},privateKey:{id:"rsaEncryption",name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1]),hash:s["sha256"]},digest:s["sha256"],encryption:s["aes256-CFB"],hmac:s["hmacWithSHA256"]},"ECDSA-256":{title:"Microsoft Base DSS and Diffie-Hellman Cryptographic Provider",signature:s["ecdsa-with-SHA256"],publicKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},privateKey:{id:"ecdsa",name:"ECDSA",namedCurve:"P-256"},digest:s["sha256"],encryption:s["aes256-CFB"],hmac:s["hmacWithSHA256"],agreement:s["ecDH"]}};["CP-94","CP-01","TC-256","TC-512","SC-94","SC-01"].forEach(function(e){var t=h[e];t.hmac=expand(t.hmac,{hash:t.digest});t.derivation=expand(t.derivation,{hash:t.digest,hmac:t.hmac});t.pbes=t.pbes||{id:"PBES2",derivation:t.derivation,encryption:t.encryption};t.pbmac=t.pbmac||{id:"PBMAC1",derivation:t.derivation,hmac:t.hmac};t.agreement=expand(t.agreement,{wrapping:t.wrapping})});["RSA-2048","ECDSA-256"].forEach(function(e){var t=h[e];t.derivation=t.derivation||{id:"PBKDF2",name:"PBKDF2",iterations:2048,hash:t.digest};t.pbes=t.pbes||{id:"PBES2",derivation:t.derivation,encryption:t.encryption};t.pbmac=t.pbmac||{id:"PBMAC1",derivation:t.derivation,hmac:t.hmac}});function GostSecurity(){}GostSecurity.prototype={names:i,identifiers:a,algorithms:s,parameters:f,attributes:d,providers:h};var y=t.gostSecurityInstance=new GostSecurity},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getRoot=getRoot;t.getCryptoModule=getCryptoModule;t.isInNode=isInNode;t.isBrowser=isBrowser;t.isInWebWorker=isInWebWorker;function getRoot(){return isInNode()?global:self}function getCryptoModule(){var e=getRoot();if(getRoot().hasOwnProperty("crypto")){return e.crypto}else if(e.hasOwnProperty("msCrypto")){return e.msCrypto}else if(isInNode()){return r(12)}throw new Error("Your environment does not have rypto module")}function isInNode(){return(false?undefined:n(t))==="object"&&typeof e!=="undefined"}function isBrowser(){return typeof window!=="undefined"}function isInWebWorker(){return typeof importScripts!=="undefined"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GostRandom=GostRandom;var n=r(7);function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var i={seed:new Uint8Array(1024),getIndex:0,setIndex:0,set:function set(e){if(this.setIndex>=1024)this.setIndex=0;this.seed[this.setIndex++]=e},get:function get(){if(this.getIndex>=1024)this.getIndex=0;return this.seed[this.getIndex++]}};if((0,n.isBrowser)()){try{document.addEventListener("mousemove",function(e){i.set((new Date).getTime()&255^(e.clientX||e.pageX)&255^(e.clientY||e.pageY)&255)},false)}catch(e){}try{document.addEventListener("keydown",function(e){i.set((new Date).getTime()&255^e.keyCode&255)},false)}catch(e){}}var a=function(e){_inherits(TypeMismatchError,e);function TypeMismatchError(){_classCallCheck(this,TypeMismatchError);return _possibleConstructorReturn(this,(TypeMismatchError.__proto__||Object.getPrototypeOf(TypeMismatchError)).apply(this,arguments))}return TypeMismatchError}(Error);var o=function(e){_inherits(QuotaExceededError,e);function QuotaExceededError(){_classCallCheck(this,QuotaExceededError);return _possibleConstructorReturn(this,(QuotaExceededError.__proto__||Object.getPrototypeOf(QuotaExceededError)).apply(this,arguments))}return QuotaExceededError}(Error);function GostRandom(){}var s=(0,n.getCryptoModule)();GostRandom.prototype.getRandomValues=function(e){if(!e.byteLength)throw new a("Array is not of an integer type (Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array, or Uint32Array)");if(e.byteLength>65536)throw new o("Byte length of array can't be greate then 65536");var t=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);if(s&&s.getRandomValues){s.getRandomValues(t)}else{for(var r=0,n=t.length;r<n;r++){t[r]=Math.floor(256*Math.random())&255}}for(var r=0,n=t.length;r<n;r++){t[r]=t[r]^i.get()}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GostSign=GostSign;var n=r(3);var i=r(0);var a=r(1);var o=ArrayBuffer;var s={"S-256-TEST":{a:7,b:"0x5FBFF498AA938CE739B8E022FBAFEF40563F6E6A3472FC2A514C0CE9DAE23B7E",p:"0x8000000000000000000000000000000000000000000000000000000000000431",q:"0x8000000000000000000000000000000150FE8A1892976154C59CFC193ACCF5B3",x:2,y:"0x8E2A8A0E65147D4BD6316030E16D19C85C97F0A9CA267122B96ABBCEA7E8FC8"},"S-256-A":{a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD94",b:166,p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFD97",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF6C611070995AD10045841B09B761B893",x:1,y:"0x8D91E471E0989CDA27DF505A453F2B7635294F2DDF23E3B122ACC99C9E9F1E14"},"S-256-B":{a:"0x8000000000000000000000000000000000000000000000000000000000000C96",b:"0x3E1AF419A269A5F866A7D3C25C3DF80AE979259373FF2B182F49D4CE7E1BBC8B",p:"0x8000000000000000000000000000000000000000000000000000000000000C99",q:"0x800000000000000000000000000000015F700CFFF1A624E5E497161BCC8A198F",x:1,y:"0x3FA8124359F96680B83D1C3EB2C070E5C545C9858D03ECFB744BF8D717717EFC"},"S-256-C":{a:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D7598",b:32858,p:"0x9B9F605F5A858107AB1EC85E6B41C8AACF846E86789051D37998F7B9022D759B",q:"0x9B9F605F5A858107AB1EC85E6B41C8AA582CA3511EDDFB74F02F3A6598980BB9",x:0,y:"0x41ECE55743711A8C3CBF3783CD08C0EE4D4DC440D4641A8F366E550DFDB3BB67"},"P-256":{p:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF",a:"0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC",b:"0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B",x:"0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296",y:"0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",q:"0xFFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551"},"T-512-TEST":{a:7,b:"0x1CFF0806A31116DA29D8CFA54E57EB748BC5F377E49400FDD788B649ECA1AC4361834013B2AD7322480A89CA58E0CF74BC9E540C2ADD6897FAD0A3084F302ADC",p:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DF1D852741AF4704A0458047E80E4546D35B8336FAC224DD81664BBF528BE6373",q:"0x4531ACD1FE0023C7550D267B6B2FEE80922B14B2FFB90F04D4EB7C09B5D2D15DA82F2D7ECB1DBAC719905C5EECC423F1D86E25EDBE23C595D644AAF187E6E6DF",x:"0x24D19CC64572EE30F396BF6EBBFD7A6C5213B3B3D7057CC825F91093A68CD762FD60611262CD838DC6B60AA7EEE804E28BC849977FAC33B4B530F1B120248A9A",y:"0x2BB312A43BD2CE6E0D020613C857ACDDCFBF061E91E5F2C3F32447C259F39B2C83AB156D77F1496BF7EB3351E1EE4E43DC1A18B91B24640B6DBB92CB1ADD371E"},"T-512-A":{p:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7",a:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4",b:"0xE8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879BD081CFD0B6265EE3CB090F30D27614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760",q:"0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF27E69532F48D89116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275",x:3,y:"0x7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC1778064FDCBEFA921DF1626BE4FD036E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4"},"T-512-B":{p:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006F",a:"0x8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006C",b:"0x687D1B459DC841457E3E06CF6F5E2517B97C7D614AF138BCBF85DC806C4B289F3E965D2DB1416D217F8B276FAD1AB69C50F78BEE1FA3106EFB8CCBC7C5140116",q:"0x800000000000000000000000000000000000000000000000000000000000000149A1EC142565A545ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD",x:2,y:"0x1A8F7EDA389B094C2C071E3647A8940F3C123B697578C213BE6DD9E6C8EC7335DCB228FD1EDF4A39152CBCAAF8C0398828041055F94CEEEC7E21340780FE41BD"}};s["X-256-A"]=s["S-256-A"];s["X-256-B"]=s["S-256-C"];s["T-256-TEST"]=s["S-256-TEST"];s["T-256-A"]=s["S-256-A"];s["T-256-B"]=s["S-256-B"];s["T-256-C"]=s["S-256-C"];var c={"S-TEST":{modulusLength:512,p:"0xEE8172AE8996608FB69359B89EB82A69854510E2977A4D63BC97322CE5DC3386EA0A12B343E9190F23177539845839786BB0C345D165976EF2195EC9B1C379E3",q:"0x98915E7EC8265EDFCDA31E88F24809DDB064BDC7285DD50D7289F0AC6F49DD2D",a:"0x9e96031500c8774a869582d4afde2127afad2538b4b6270a6f7c8837b50d50f206755984a49e509304d648be2ab5aab18ebe2cd46ac3d8495b142aa6ce23e21c"},"S-A":{modulusLength:1024,p:"0xB4E25EFB018E3C8B87505E2A67553C5EDC56C2914B7E4F89D23F03F03377E70A2903489DD60E78418D3D851EDB5317C4871E40B04228C3B7902963C4B7D85D52B9AA88F2AFDBEB28DA8869D6DF846A1D98924E925561BD69300B9DDD05D247B5922D967CBB02671881C57D10E5EF72D3E6DAD4223DC82AA1F7D0294651A480DF",q:"0x972432A437178B30BD96195B773789AB2FFF15594B176DD175B63256EE5AF2CF",a:"0x8FD36731237654BBE41F5F1F8453E71CA414FFC22C25D915309E5D2E62A2A26C7111F3FC79568DAFA028042FE1A52A0489805C0DE9A1A469C844C7CABBEE625C3078888C1D85EEA883F1AD5BC4E6776E8E1A0750912DF64F79956499F1E182475B0B60E2632ADCD8CF94E9C54FD1F3B109D81F00BF2AB8CB862ADF7D40B9369A"},"S-B":{modulusLength:1024,p:"0xC6971FC57524B30C9018C5E621DE15499736854F56A6F8AEE65A7A404632B1BCF0349FFCAFCB0A103177971FC1612ADCDB8C8CC938C70225C8FD12AFF01B1D064E0AD6FDE6AB9159166CB9F2FC171D92F0CC7B6A6B2CD7FA342ACBE2C9315A42D576B1ECCE77A963157F3D0BD96A8EB0B0F3502AD238101B05116334F1E5B7AB",q:"0xB09D634C10899CD7D4C3A7657403E05810B07C61A688BAB2C37F475E308B0607",a:"0x3D26B467D94A3FFC9D71BF8DB8934084137264F3C2E9EB16DCA214B8BC7C872485336744934FD2EF5943F9ED0B745B90AA3EC8D70CDC91682478B664A2E1F8FB56CEF2972FEE7EDB084AF746419B854FAD02CC3E3646FF2E1A18DD4BEB3C44F7F2745588029649674546CC9187C207FB8F2CECE8E2293F68395C4704AF04BAB5"},"S-C":{modulusLength:1024,p:"0x9D88E6D7FE3313BD2E745C7CDD2AB9EE4AF3C8899E847DE74A33783EA68BC30588BA1F738C6AAF8AB350531F1854C3837CC3C860FFD7E2E106C3F63B3D8A4C034CE73942A6C3D585B599CF695ED7A3C4A93B2B947B7157BB1A1C043AB41EC8566C6145E938A611906DE0D32E562494569D7E999A0DDA5C879BDD91FE124DF1E9",q:"0xFADD197ABD19A1B4653EECF7ECA4D6A22B1F7F893B641F901641FBB555354FAF",a:"0x7447ED7156310599070B12609947A5C8C8A8625CF1CF252B407B331F93D639DDD1BA392656DECA992DD035354329A1E95A6E32D6F47882D960B8F10ACAFF796D13CD9611F853DAB6D2623483E46788708493937A1A29442598AEC2E0742022563440FE9C18740ECE6765AC05FAF024A64B026E7E408840819E962E7E5F401AE3"},"S-D":{modulusLength:1024,p:"0x80F102D32B0FD167D069C27A307ADAD2C466091904DBAA55D5B8CC7026F2F7A1919B890CB652C40E054E1E9306735B43D7B279EDDF9102001CD9E1A831FE8A163EED89AB07CF2ABE8242AC9DEDDDBF98D62CDDD1EA4F5F15D3A42A6677BDD293B24260C0F27C0F1D15948614D567B66FA902BAA11A69AE3BCEADBB83E399C9B5",q:"0xF0F544C418AAC234F683F033511B65C21651A6078BDA2D69BB9F732867502149",a:"0x6BCC0B4FADB3889C1E06ADD23CC09B8AB6ECDEDF73F04632595EE4250005D6AF5F5ADE44CB1E26E6263C672347CFA26F9E9393681E6B759733784CDE5DBD9A14A39369DFD99FA85CC0D10241C4010343F34A91393A706CF12677CBFA1F578D6B6CFBE8A1242CFCC94B3B653A476E145E3862C18CC3FED8257CFEF74CDB205BF1"},"X-A":{modulusLength:1024,p:"0xCA3B3F2EEE9FD46317D49595A9E7518E6C63D8F4EB4D22D10D28AF0B8839F079F8289E603B03530784B9BB5A1E76859E4850C670C7B71C0DF84CA3E0D6C177FE9F78A9D8433230A883CD82A2B2B5C7A3306980278570CDB79BF01074A69C9623348824B0C53791D53C6A78CAB69E1CFB28368611A397F50F541E16DB348DBE5F",q:"0xCAE4D85F80C147704B0CA48E85FB00A9057AA4ACC44668E17F1996D7152690D9",a:"0xBE27D652F2F1E339DA734211B85B06AE4DE236AA8FBEEB3F1ADCC52CD43853777E834A6A518138678A8ADBD3A55C70A7EAB1BA7A0719548677AAF4E609FFB47F6B9D7E45B0D06D83D7ADC53310ABD85783E7317F7EC73268B6A9C08D260B85D8485696CA39C17B17F044D1E050489036ABD381C5E6BF82BA352A1AFF136601AF"},"X-B":{modulusLength:1024,p:"0x9286DBDA91ECCFC3060AA5598318E2A639F5BA90A4CA656157B2673FB191CD0589EE05F4CEF1BD13508408271458C30851CE7A4EF534742BFB11F4743C8F787B11193BA304C0E6BCA25701BF88AF1CB9B8FD4711D89F88E32B37D95316541BF1E5DBB4989B3DF13659B88C0F97A3C1087B9F2D5317D557DCD4AFC6D0A754E279",q:"0xC966E9B3B8B7CDD82FF0F83AF87036C38F42238EC50A876CD390E43D67B6013F",a:"0x7E9C3096676F51E3B2F9884CF0AC2156779496F410E049CED7E53D8B7B5B366B1A6008E5196605A55E89C3190DABF80B9F1163C979FCD18328DAE5E9048811B370107BB7715F82091BB9DE0E33EE2FED6255474F8769FCE5EAFAEEF1CB5A32E0D5C6C2F0FC0B3447072947F5B4C387666993A333FC06568E534AD56D2338D729"},"X-C":{modulusLength:1024,p:"0xB194036ACE14139D36D64295AE6C50FC4B7D65D8B340711366CA93F383653908EE637BE428051D86612670AD7B402C09B820FA77D9DA29C8111A8496DA6C261A53ED252E4D8A69A20376E6ADDB3BDCD331749A491A184B8FDA6D84C31CF05F9119B5ED35246EA4562D85928BA1136A8D0E5A7E5C764BA8902029A1336C631A1D",q:"0x96120477DF0F3896628E6F4A88D83C93204C210FF262BCCB7DAE450355125259",a:"0x3F1817052BAA7598FE3E4F4FC5C5F616E122CFF9EBD89EF81DC7CE8BF56CC64B43586C80F1C4F56DD5718FDD76300BE336784259CA25AADE5A483F64C02A20CF4A10F9C189C433DEFE31D263E6C9764660A731ECCAECB74C8279303731E8CF69205BC73E5A70BDF93E5BB681DAB4EEB9C733CAAB2F673C475E0ECA921D29782E"}};var u=28,f=(1<<u)-1,d=1<<u,h=Math.pow(2,52),y=52-u,l=2*u-52;function am(e,t,r,n,i,a,o){var s=r&16383,c=r>>14;while(--o>=0){var u=e[t]&16383;var f=e[t++]>>14;var d=c*u+f*s;u=s*u+((d&16383)<<14)+n[i]+a;a=(u>>28)+(d>>14)+c*f;n[i++]=u&268435455}return a}function nbi(e){var t=new Array(Math.ceil(e));t.s=0;t.t=0;return t}function copyTo(e,t){for(var r=e.t-1;r>=0;--r){t[r]=e[r]}t.t=e.t;t.s=e.s;return t}function copy(e){return copyTo(e,nbi(e.t))}function setInt(e,t){e.t=1;e.s=t<0?-1:0;if(t>0)e[0]=t;else if(t<-1)e[0]=t+d;else e.t=0;return e}function nbv(e){var t=nbi(1);setInt(t,e);return t}var p=nbv(0),v=nbv(1),g=nbv(3);function clamp(e){var t=e.s&f;while(e.t>0&&e[e.t-1]===t){--e.t}return e}function subTo(e,t,r){var n=0,i=0,a=Math.min(t.t,e.t);while(n<a){i+=e[n]-t[n];r[n++]=i&f;i>>=u}if(t.t<e.t){i-=t.s;while(n<e.t){i+=e[n];r[n++]=i&f;i>>=u}i+=e.s}else{i+=e.s;while(n<t.t){i-=t[n];r[n++]=i&f;i>>=u}i-=t.s}r.s=i<0?-1:0;if(i<-1)r[n++]=d+i;else if(i>0)r[n++]=i;r.t=n;return clamp(r)}function sub(e,t){return subTo(e,t,nbi(e.t))}function addTo(e,t,r){var n=0,i=0,a=Math.min(t.t,e.t);while(n<a){i+=e[n]+t[n];r[n++]=i&f;i>>=u}if(t.t<e.t){i+=t.s;while(n<e.t){i+=e[n];r[n++]=i&f;i>>=u}i+=e.s}else{i+=e.s;while(n<t.t){i+=t[n];r[n++]=i&f;i=i>>u}i+=t.s}r.s=i<0?-1:0;if(i>0)r[n++]=i;else if(i<-1)r[n++]=d+i;r.t=n;return clamp(r)}function add(e,t){return addTo(e,t,nbi(e.t))}function negTo(e,t){return subTo(p,e,t)}function neg(e){return negTo(e,nbi(e.t))}function absTo(e,t){return e.s<0?negTo(t):copyTo(t)}function abs(e){return e.s<0?neg(e):e}function compare(e,t){var r=e.s-t.s;if(r!==0)return r;var n=e.t;r=n-t.t;if(r!==0)return e.s<0?-r:r;while(--n>=0){if((r=e[n]-t[n])!==0)return r}return 0}function equals(e,t){return compare(e,t)===0}function min(e,t){return compare(e,t)<0?e:t}function max(e,t){return compare(e,t)>0?e:t}function nbits(e){var t=1,r;if((r=e>>>16)!==0){e=r;t+=16}if((r=e>>8)!==0){e=r;t+=8}if((r=e>>4)!==0){e=r;t+=4}if((r=e>>2)!==0){e=r;t+=2}if((r=e>>1)!==0){e=r;t+=1}return t}function dshlTo(e,t,r){var n;for(n=e.t-1;n>=0;--n){r[n+t]=e[n]}for(n=t-1;n>=0;--n){r[n]=0}r.t=e.t+t;r.s=e.s;return r}function dshrTo(e,t,r){for(var n=t;n<e.t;++n){r[n-t]=e[n]}r.t=Math.max(e.t-t,0);r.s=e.s;return r}function shlTo(e,t,r){var n=t%u;var i=u-n;var a=(1<<i)-1;var o=Math.floor(t/u),s=e.s<<n&f,c;for(c=e.t-1;c>=0;--c){r[c+o+1]=e[c]>>i|s;s=(e[c]&a)<<n}for(c=o-1;c>=0;--c){r[c]=0}r[o]=s;r.t=e.t+o+1;r.s=e.s;return clamp(r)}function shrTo(e,t,r){r.s=e.s;var n=Math.floor(t/u);if(n>=e.t){r.t=0;return}var i=t%u;var a=u-i;var o=(1<<i)-1;r[0]=e[n]>>i;for(var s=n+1;s<e.t;++s){r[s-n-1]|=(e[s]&o)<<a;r[s-n]=e[s]>>i}if(i>0)r[e.t-n-1]|=(e.s&o)<<a;r.t=e.t-n;return clamp(r)}function shl(e,t){var r=nbi(e.t);if(t<0)shrTo(e,-t,r);else shlTo(e,t,r);return r}function shr(e,t){var r=nbi(e.t);if(t<0)shlTo(e,-t,r);else shrTo(e,t,r);return r}function bitLength(e){if(e.t<=0)return 0;return u*(e.t-1)+nbits(e[e.t-1]^e.s&f)}function _mulTo(e,t,r){var n=abs(e),i=abs(t);var a=n.t;r.t=a+i.t;while(--a>=0){r[a]=0}for(a=0;a<i.t;++a){r[a+n.t]=am(n,0,i[a],r,a,0,n.t)}r.s=0;if(e.s!==t.s)subTo(p,r,r);return clamp(r)}function mul(e,t){return _mulTo(e,t,nbi(e.t+t.t))}function _sqrTo(e,t){var r=abs(e);var n=t.t=2*r.t;while(--n>=0){t[n]=0}for(n=0;n<r.t-1;++n){var i=am(r,n,r[n],t,2*n,0,1);if((t[n+r.t]+=am(r,n+1,2*r[n],t,2*n+1,i,r.t-n-1))>=r.DV){t[n+r.t]-=r.DV;t[n+r.t+1]=1}}if(t.t>0)t[t.t-1]+=am(r,n,r[n],t,2*n,0,1);t.s=0;return clamp(t)}function sqr(e){return _sqrTo(e,nbi(e.t*2))}function divRemTo(e,t,r,n){var i=abs(t);if(i.t<=0)throw new OperationError("Division by zero");var a=abs(e);if(a.t<i.t){if(r)setInt(r,0);if(n)copyTo(e,n);return r}if(!n)n=nbi(t.t);var o=nbi(t.t),s=e.s,c=t.s;var d=u-nbits(i[i.t-1]);if(d>0){shlTo(i,d,o);shlTo(a,d,n)}else{copyTo(i,o);copyTo(a,n)}var g=o.t;var m=o[g-1];if(m===0)return r;var C=m*(1<<y)+(g>1?o[g-2]>>l:0);var b=h/C,A=(1<<y)/C,w=1<<l;var F=n.t,S=F-g,E=!r?nbi(Math.max(e.t-t.t,1)):r;dshlTo(o,S,E);if(compare(n,E)>=0){n[n.t++]=1;subTo(n,E,n)}dshlTo(v,g,E);subTo(E,o,o);while(o.t<g){o[o.t++]=0}while(--S>=0){var K=n[--F]===m?f:Math.floor(n[F]*b+(n[F-1]+w)*A);if((n[F]+=am(o,0,K,n,S,0,g))<K){dshlTo(o,S,E);subTo(n,E,n);while(n[F]<--K){subTo(n,E,n)}}}if(r){dshrTo(n,g,r);if(s!==c)subTo(p,r,r)}n.t=g;clamp(n);if(d>0)shrTo(n,d,n);if(s<0)subTo(p,n,n);return r}function modTo(e,t,r){divRemTo(abs(e),t,null,r);if(e.s<0&&compare(r,p)>0)subTo(t,r,r);return r}function mod(e,t){return modTo(e,t,nbi(t.t))}function div(e,t){return divRemTo(e,t,nbi(Math.max(e.t-t.t,1)),null)}function isEven(e){return(e.t>0?e[0]&1:e.s)===0}function isZero(e){return equals(e,p)}function sig(e){if(e.s<0)return-1;else if(e.t<=0||e.t===1&&e[0]<=0)return 0;else return 1}function invMod(e,t){var r=isEven(t);if(isEven(e)&&r||sig(t)===0)return p;var n=copy(t),i=copy(e);var a=nbv(1),o=nbv(0),s=nbv(0),c=nbv(1);while(sig(n)!==0){while(isEven(n)){shrTo(n,1,n);if(r){if(!isEven(a)||!isEven(o)){addTo(a,e,a);subTo(o,t,o)}shrTo(a,1,a)}else if(!isEven(o))subTo(o,t,o);shrTo(o,1,o)}while(isEven(i)){shrTo(i,1,i);if(r){if(!isEven(s)||!isEven(c)){addTo(s,e,s);subTo(c,t,c)}shrTo(s,1,s)}else if(!isEven(c))subTo(c,t,c);shrTo(c,1,c)}if(compare(n,i)>=0){subTo(n,i,n);if(r)subTo(a,s,a);subTo(o,c,o)}else{subTo(i,n,i);if(r)subTo(s,a,s);subTo(c,o,c)}}if(compare(i,v)!==0)return p;if(compare(c,t)>=0)return subtract(c,t);if(sig(c)<0)addTo(c,t,c);else return c;if(sig(c)<0)return add(c,t);else return c}function testBit(e,t){var r=Math.floor(t/u);if(r>=e.t)return e.s!==0;return(e[r]&1<<t%u)!==0}function nothing(e){return e}function extend(e,t){for(var r in t){e.prototype[r]=t[r]}}var m=function Classic(e){this.m=e};extend(m,{convert:function convert(e){if(e.s<0||compare(e,this.m)>=0)return mod(e,this.m);else return e},revert:nothing,reduce:function reduce(e){modTo(e,this.m,e)},sqrTo:function sqrTo(e,t){_sqrTo(e,t);this.reduce(t)},mulTo:function mulTo(e,t,r){_mulTo(e,t,r);this.reduce(r)}});function invDig(e){if(e.t<1)return 0;var t=e[0];if((t&1)===0)return 0;var r=t&3;r=r*(2-(t&15)*r)&15;r=r*(2-(t&255)*r)&255;r=r*(2-((t&65535)*r&65535))&65535;r=r*(2-t*r%d)%d;return r>0?d-r:-r}var C=function Montgomery(e){this.m=e;this.mp=invDig(e);this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<u-15)-1;this.mt2=2*e.t};extend(C,{convert:function convert(e){var t=nbi(e.t);dshlTo(abs(e),this.m.t,t);divRemTo(t,this.m,null,t);if(e.s<0&&compare(t,p)>0)subTo(this.m,t,t);return t},revert:function revert(e){var t=nbi(e.t);copyTo(e,t);this.reduce(t);return t},reduce:function reduce(e){while(e.t<=this.mt2){e[e.t++]=0}for(var t=0;t<this.m.t;++t){var r=e[t]&32767;var n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&f;r=t+this.m.t;e[r]+=am(this.m,0,n,e,t,0,this.m.t);while(e[r]>=d){e[r]-=d;e[++r]++}}clamp(e);dshrTo(e,this.m.t,e);if(compare(e,this.m)>=0)subTo(e,this.m,e)},sqrTo:function sqrTo(e,t){_sqrTo(e,t);this.reduce(t)},mulTo:function mulTo(e,t,r){_mulTo(e,t,r);this.reduce(r)}});function dAddOffset(e,t,r){if(t===0)return;while(e.t<=r){e[e.t++]=0}e[r]+=t;while(e[r]>=d){e[r]-=d;if(++r>=e.t)e[e.t++]=0;++e[r]}}function mulLowerTo(e,t,r,n){var i=Math.min(e.t+t.t,r);n.s=0;n.t=i;while(i>0){n[--i]=0}var a;for(a=n.t-e.t;i<a;++i){n[i+e.t]=am(e,0,t[i],n,i,0,e.t)}for(a=Math.min(t.t,r);i<a;++i){am(e,0,t[i],n,i,0,r-i)}return clamp(n)}function mulUpperTo(e,t,r,n){--r;var i=n.t=e.t+t.t-r;n.s=0;while(--i>=0){n[i]=0}for(i=Math.max(r-e.t,0);i<t.t;++i){n[e.t+i-r]=am(e,r-i,t[i],n,0,0,e.t+i-r)}clamp(n);return dshrTo(n,1,n)}function Barrett(e){this.r2=nbi(2*e.t);this.q3=nbi(2*e.t);dshlTo(v,2*e.t,this.r2);this.mu=div(this.r2,e);this.m=e}extend(Barrett,{convert:function convert(e){if(e.s<0||e.t>2*this.m.t)return mod(e,this.m);else if(compare(e,this.m)<0)return e;else{var t=nbi(e.t);copyTo(e,t);this.reduce(t);return t}},revert:function revert(e){return e},reduce:function reduce(e){dshrTo(e,this.m.t-1,this.r2);if(e.t>this.m.t+1){e.t=this.m.t+1;clamp(e)}mulUpperTo(this.mu,this.r2,this.m.t+1,this.q3);mulLowerTo(this.m,this.q3,this.m.t+1,this.r2);while(compare(e,this.r2)<0){dAddOffset(e,1,this.m.t+1)}subTo(e,this.r2,e);while(compare(e,this.m)>=0){subTo(e,this.m,e)}},sqrTo:function sqrTo(e,t){_sqrTo(e,t);this.reduce(t)},mulTo:function mulTo(e,t,r){_mulTo(e,t,r);this.reduce(r)}});function expMod(e,t,r){var n=bitLength(t),i,a=nbv(1),o;if(n<=0)return a;else if(n<18)i=1;else if(n<48)i=3;else if(n<144)i=4;else if(n<768)i=5;else i=6;if(n<8)o=new m(r);else if(isEven(r))o=new Barrett(r);else o=new C(r);var s=new Array,c=3,f=i-1,d=(1<<i)-1;s[1]=o.convert(e);if(i>1){var h=nbi(r.t*2);o.sqrTo(s[1],h);while(c<=d){s[c]=nbi(r.t*2);o.mulTo(h,s[c-2],s[c]);c+=2}}var y=t.t-1,l,p=true,v=nbi(r.t*2),g;n=nbits(t[y])-1;while(y>=0){if(n>=f)l=t[y]>>n-f&d;else{l=(t[y]&(1<<n+1)-1)<<f-n;if(y>0)l|=t[y-1]>>u+n-f}c=i;while((l&1)==0){l>>=1;--c}if((n-=c)<0){n+=u;--y}if(p){copyTo(s[l],a);p=false}else{while(c>1){o.sqrTo(a,v);o.sqrTo(v,a);c-=2}if(c>0)o.sqrTo(a,v);else{g=a;a=v;v=g}o.mulTo(v,s[l],a)}while(y>=0&&(t[y]&1<<n)==0){o.sqrTo(a,v);g=a;a=v;v=g;if(--n<0){n=u-1;--y}}}return o.revert(a)}function newFE(e,t){e.r.reduce(t);t.q=e.q;t.r=e.r;return t}function copyFE(e,t){t.q=e.q;t.r=e.r;return t}function negFE(e){return copyFE(e,sub(e.q,e))}function addFE(e,t){var r=add(e,t);if(compare(r,e.q)>0)subTo(r,e.q,r);return copyFE(e,r)}function subFE(e,t){var r=sub(e,t);if(r.s<0)addTo(e.q,r,r);return copyFE(e,r)}function mulFE(e,t){return newFE(e,mul(e,t))}function sqrFE(e){return newFE(e,sqr(e))}function shlFE(e,t){return newFE(e,shl(e,t))}function invFE(e){return copyFE(e,invMod(e,e.q))}function newEC(e,t,r,n){return{curve:e,x:t,y:r,z:n||newFE(e,v)}}function getX(e){if(!e.zinv)e.zinv=invFE(e.z);return mulFE(e.x,e.zinv)}function getY(e){if(!e.zinv)e.zinv=invFE(e.z);return mulFE(e.y,e.zinv)}function isInfinity(e){if(!e.x&&!e.y)return true;return isZero(e.z)&&!isZero(e.y)}function getInfinity(e){return e.curve.infinity}function equalsEC(e,t){if(e===t)return true;if(isInfinity(e))return isInfinity(t);if(isInfinity(t))return isInfinity(e);var r,n;r=subFE(mulFE(t.y,e.z),mulFE(e.y,t.z));if(!isZero(r))return false;n=subFE(mulFE(t.x,e.z),mulFE(e.x,t.z));return isZero(n)}function negEC(e){return newEC(e.curve,e.x,negFE(e.y),e.z)}function addEC(e,t){if(isInfinity(e))return t;if(isInfinity(t))return e;var r=subFE(mulFE(t.y,e.z),mulFE(e.y,t.z));var n=subFE(mulFE(t.x,e.z),mulFE(e.x,t.z));if(isZero(n)){if(isZero(r)){return twiceEC(e)}return getInfinity(e)}var i=e.x;var a=e.y;var o=sqrFE(n);var s=mulFE(o,n);var c=mulFE(i,o);var u=mulFE(sqrFE(r),e.z);var f=mulFE(subFE(mulFE(subFE(u,shlFE(c,1)),t.z),s),n);var d=addFE(mulFE(subFE(subFE(mulFE(mulFE(c,g),r),mulFE(a,s)),mulFE(u,r)),t.z),mulFE(r,s));var h=mulFE(mulFE(s,e.z),t.z);return newEC(e.curve,f,d,h)}function twiceEC(e){if(isInfinity(e))return e;if(sig(e.y)===0)return getInfinity(e);var t=e.x;var r=e.y;var n=mulFE(r,e.z);var i=mulFE(n,r);var a=e.curve.a;var o=mulFE(sqrFE(t),g);if(!isZero(a)){o=addFE(o,mulFE(sqrFE(e.z),a))}var s=mulFE(shlFE(subFE(sqrFE(o),mulFE(shlFE(t,3),i)),1),n);var c=subFE(mulFE(shlFE(subFE(mulFE(mulFE(o,g),t),shlFE(i,1)),2),i),mulFE(sqrFE(o),o));var u=shlFE(mulFE(sqrFE(n),n),3);return newEC(e.curve,s,c,u)}function mulEC(e,t){if(isInfinity(e))return e;if(sig(t)===0)return getInfinity(e);var r=t;var n=mul(r,g);var i=negEC(e);var a=e;var o;for(o=bitLength(n)-2;o>0;--o){a=twiceEC(a);var s=testBit(n,o);var c=testBit(r,o);if(s!==c){a=addEC(a,s?e:i)}}return a}function mul2AndAddEC(e,t){var r=bitLength(t);var n=e,i=getInfinity(e);for(var a=0;a<r-1;a++){if(testBit(t,a)===1)i=addEC(i,n);n=twiceEC(n)}if(testBit(t,r-1)===1)i=addEC(i,n);return i}function mulTwoEC(e,t,r,n){var i;if(bitLength(t)>bitLength(n))i=bitLength(t)-1;else i=bitLength(n)-1;var a=getInfinity(e);var o=addEC(e,r);while(i>=0){a=twiceEC(a);if(testBit(t,i)){if(testBit(n,i)){a=addEC(a,o)}else{a=addEC(a,e)}}else{if(testBit(n,i)){a=addEC(a,r)}}--i}return a}function newCurve(e,t,r){var n={};n.q=e;n.r=new Barrett(e);n.a=newFE(n,t);n.b=newFE(n,r);n.infinity=newEC(n);return n}function atobi(e){var t=8;var r=new Uint8Array(e);var n=nbi(r.length*8/u);n.t=0;n.s=0;var i=0;for(var a=0,o=r.length;a<o;a++){var s=r[a];if(i===0)n[n.t++]=s;else if(i+t>u){n[n.t-1]|=(s&(1<<u-i)-1)<<i;n[n.t++]=s>>u-i}else n[n.t-1]|=s<<i;i+=t;if(i>=u)i-=u}return clamp(n)}function bitoa(e,t){var r=8;var n=(1<<r)-1,i,a=false,o=[],s=e.t;var c=u-s*u%r;if(s-- >0){if(c<u&&(i=e[s]>>c)>0){a=true;o.push(i)}while(s>=0){if(c<r){i=(e[s]&(1<<c)-1)<<r-c;i|=e[--s]>>(c+=u-r)}else{i=e[s]>>(c-=r)&n;if(c<=0){c+=u;--s}}if(i>0)a=true;if(a)o.push(i)}}var f=new Uint8Array(t?t/8:o.length);if(a)f.set(o.reverse());return f.buffer}function htobi(e){if(typeof e==="number"||e instanceof Number)return nbv(e);e=e.replace(/[^\-A-Fa-f0-9]/g,"");if(!e)e="0";var t=4;var r=nbi(e.length/7);var n=e.length,i=false,a=0;while(--n>=0){var o=e.charAt(n);if(o==="-"){i=true;continue}var s=parseInt(e.charAt(n),16);i=false;if(a===0)r[r.t++]=s;else if(a+t>u){r[r.t-1]|=(s&(1<<u-a)-1)<<a;r[r.t++]=s>>u-a}else r[r.t-1]|=s<<a;a+=t;if(a>=u)a-=u}if(i)subTo(p,r,r);return clamp(r)}function bitoh(e){if(e.s<0)return"-"+bitoh(negTo(e,nbi(e.t)));var t=4;var r=(1<<t)-1,n,i=false,a="",o=e.t;var s=u-o*u%t;if(o-- >0){if(s<u&&(n=e[o]>>s)>0){i=true;a=n.toString(16)}while(o>=0){if(s<t){n=(e[o]&(1<<s)-1)<<t-s;n|=e[--o]>>(s+=u-t)}else{n=e[o]>>(s-=t)&r;if(s<=0){s+=u;--o}}if(n>0)i=true;if(i)a+=n.toString(16)}}return"0x"+(i?a:"0")}function bitoi(e){var t=e.t,r=[];r[0]=e.s;var n=u-t*u%8,i,a=0;if(t-- >0){if(n<u&&(i=e[t]>>n)!==(e.s&f)>>n)r[a++]=i|e.s<<u-n;while(t>=0){if(n<8){i=(e[t]&(1<<n)-1)<<8-n;i|=e[--t]>>(n+=u-8)}else{i=e[t]>>(n-=8)&255;if(n<=0){n+=u;--t}}if((i&128)!==0)i|=-256;if(a===0&&(e.s&128)!==(i&128))++a;if(a>0||i!==e.s)r[a++]=i}}return new Uint8Array(r).buffer}function itobi(e){var t=8,r=new Uint8Array(e),n=nbi(r.length/7);n.t=0;n.s=0;var i=r.length,a=0;while(--i>=0){var o=r[i]&255;if(a===0)n[n.t++]=o;else if(a+t>u){n[n.t-1]|=(o&(1<<u-a)-1)<<a;n[n.t++]=o>>u-a}else n[n.t-1]|=o<<a;a+=t;if(a>=u)a-=u}if((r[0]&128)!==0){n.s=-1;if(a>0)n[n.t-1]|=(1<<u-a)-1<<a}return clamp(n)}function swap(e){var t=new Uint8Array(e),r=new Uint8Array(t.length);for(var n=0,i=t.length;n<i;n++){r[i-n-1]=t[n]}return r.buffer}function hash(e){if(this.hash)e=this.hash.digest(e);if(this.procreator==="SC"||this.procreator==="VN"&&this.hash.version===2012)e=swap(e);return e}function buffer(e){if(e instanceof o)return e;else if(e&&e.buffer&&e.buffer instanceof o)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;else throw new i.DataError("CryptoOperationData or CryptoOperationDataView required")}function to2(e){var t=buffer(e);if(t.byteLength%2>0)throw new i.DataError("Buffer length must be even");var r=t.byteLength/2;return[atobi(new Uint8Array(t,0,r)),atobi(new Uint8Array(t,r,r))]}function from2(e,t,r){var n=bitoa(e,r),i=bitoa(t,r),a=new Uint8Array(n.byteLength+i.byteLength);a.set(new Uint8Array(n));a.set(new Uint8Array(i),n.byteLength);return a.buffer}function sign(e,t){var r=buffer(t);var n=atobi(hash.call(this,r));var i=this.q;var o=mod(atobi(buffer(e)),i);var s=mod(n,i);if(isZero(s))s=v;var c=p;while(isZero(c)){var u=p;while(isZero(u)){var f=mod(atobi(this.ukm||(0,a.getSeed)(this.bitLength)),i);if(this.curve){var d=this.P;var h=mulEC(d,f);u=mod(getX(h),i)}else{var y=this.p,l=this.a;u=mod(expMod(l,f,y),i)}}c=mod(add(mul(u,o),mul(f,s)),i)}var g;if(this.procreator==="SC"){g={r:bitoh(u),s:bitoh(c)}}else{g=from2(u,c,this.bitLength);if(this.procreator==="CP"||this.procreator==="VN")g=swap(g)}return g}function verify(e,t,r){var n=this.q;var i,a;if(this.procreator==="SC"){i=htobi(t.r);a=htobi(t.s)}else{if(this.procreator==="CP"||this.procreator==="VN")t=swap(t);var o=to2(t);a=o[1];i=o[0]}if(compare(i,n)>=0||compare(a,n)>=0)return false;var s=buffer(r);var c=atobi(hash.call(this,s));var u=mod(c,n);if(isZero(u)===0)u=v;var f=invMod(u,n);var d=mod(mul(a,f),n);var h=sub(n,mod(mul(i,f),n));if(this.curve){var y=to2(e),l=this.curve,p=this.P,g=newFE(l,y[0]),m=newFE(l,y[1]),C=new newEC(l,g,m);var b=mulTwoEC(p,d,C,h);var A=mod(getX(b),n)}else{var w=this.p,F=this.a;var m=atobi(e);var A=mod(mod(mul(expMod(F,d,w),expMod(m,h,w)),w),n)}return compare(A,i)===0}function generateKey(){var e=this.curve;if(e){var t=e.infinity;while(isInfinity(t)){var r=p;if(this.ukm){r=atobi(this.ukm)}else{while(isZero(r)){r=mod(atobi((0,a.getSeed)(this.bitLength)),this.q)}}t=mulEC(this.P,r);var n=getX(t),o=getY(t)}return{privateKey:bitoa(r,this.bitLength),publicKey:from2(n,o,this.bitLength)}}else throw new i.NotSupportedError("Key generation for GOST R 34.10-94 not supported")}function generateMaskKey(){var e=this.curve;if(e){var t=p;while(isZero(t)){t=mod(atobi((0,a.getSeed)(this.bitLength)),this.q)}return bitoa(t,this.bitLength)}else throw new i.NotSupportedError("Key generation for GOST R 34.10-94 not supported")}function unwrapKey(e,t){var r=this.curve;if(r){var n=this.q;var a=mod(atobi(buffer(t)),n);var o=mod(atobi(buffer(e)),n);var s=this.procreator==="VN"?mod(mul(a,o),n):mod(mul(a,invMod(o,n)),n);return bitoa(s)}else throw new i.NotSupportedError("Key wrapping GOST R 34.10-94 not supported")}function wrapKey(e,t){var r=this.curve;if(r){var n=this.q;var a=mod(atobi(buffer(t)),n);var o=mod(atobi(buffer(e)),n);var s=this.procreator==="VN"?mod(mul(a,invMod(o,n)),n):mod(mul(a,o),n);return bitoa(s)}else throw new i.NotSupportedError("Key wrapping GOST R 34.10-94 not supported")}function derive(e){var t,r=atobi(this.ukm);var n=this.q;var i=mod(atobi(buffer(e)),n);if(this.curve){var a=mulEC(this.peer_Q,mod(mul(r,i),n));t=from2(getX(a),getY(a),this.bitLength)}else{var o=this.p,s=this.a;t=bitoa(expMod(this.peer_y,i,o))}return hash.call(this,t)}function deriveBits(e,t){if(t<8||t>this.bitLength||t%8>0)throw new i.DataError("Length must be no more than "+this.bitLength+" bits and multiple of 8");var r=t/8,n=derive.call(this,e),a=new Uint8Array(r);a.set(new Uint8Array(n,0,r));return a.buffer}function deriveKey(e){var t=derive.call(this,e),r=new Uint8Array(32);r.set(new Uint8Array(t,0,32));return r.buffer}function GostSign(e){e=e||{};this.name=(e.name||"GOST R 34.10")+"-"+(e.version||2012)%100+"-"+(e.length||256)+((e.mode||"SIGN")!=="SIGN"?"-"+e.mode:"")+(typeof e.namedParam==="string"?"/"+e.namedParam:"")+(typeof e.namedCurve==="string"?"/"+e.namedCurve:"")+(typeof e.sBox==="string"?"/"+e.sBox:"");var t=e.version||2012;switch(e.mode||"SIGN"){case"SIGN":this.sign=sign;this.verify=verify;this.generateKey=generateKey;break;case"DH":this.deriveBits=deriveBits;this.deriveKey=deriveKey;this.generateKey=generateKey;break;case"MASK":this.wrapKey=wrapKey;this.unwrapKey=unwrapKey;this.generateKey=generateMaskKey;break}if(t===1994){var r=e.param;if(!r)r=c[this.namedParam=(e.namedParam||"S-A").toUpperCase()];this.modulusLength=e.modulusLength||r.modulusLength||1024;this.p=htobi(r.p);this.q=htobi(r.q);this.a=htobi(r.a);if(e["public"])this.peer_y=atobi(e["public"])}else{var r=e.curve;if(!r)r=s[this.namedCurve=(e.namedCurve||"S-256-A").toUpperCase()];var a=this.curve=newCurve(htobi(r.p),htobi(r.a),htobi(r.b));this.P=newEC(a,newFE(a,htobi(r.x)),newFE(a,htobi(r.y)));this.q=htobi(r.q);if(e["public"]){var o=to2(e["public"]);this.peer_Q=new newEC(this.curve,newFE(this.curve,o[0]),newFE(this.curve,o[1]))}}var u,f;if(this.curve){f=e.length||bitLength(this.q);if(f>508&&f<=512)f=512;else if(f>254&&f<=256)f=256;else throw new i.NotSupportedError("Support keys only 256 or 512 bits length");u=f}else{f=e.modulusLength||bitLength(this.p);if(f>1016&&f<=1024)f=1024;else if(f>508&&f<=512)f=512;else throw new i.NotSupportedError("Support keys only 512 or 1024 bits length");u=256}this.bitLength=u;this.keyLength=f;this.procreator=e.procreator;var d=e.hash;if(d){if(typeof d==="string"||d instanceof String)d={name:d};if(e.version===1994||e.version===2001){d.version=1994;d.length=256;d.sBox=e.sBox||d.sBox}else{d.version=2012;d.length=u}d.procreator=d.procreator||e.procreator;this.hash=new n.GostDigest(d)}if(e.ukm)this.ukm=e.ukm}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostEngine=undefined;var n=r(4);var i=r(3);var a=r(9);var o=r(0);function defineEngine(e,t){if(!t)throw new(SyntaxError||Error)("Algorithm not defined");if(!t.name)throw new(SyntaxError||Error)("Algorithm name not defined");var r=t.name,n=t.mode;if((r==="GOST 28147"||r==="GOST R 34.12"||r==="RC2")&&(e==="generateKey"||n==="MAC"&&(e==="sign"||e==="verify")||(n==="KW"||n==="MASK")&&(e==="wrapKey"||e==="unwrapKey")||(!n||n==="ES")&&(e==="encrypt"||e==="decrypt"))){return"GostCipher"}else if((r==="GOST R 34.11"||r==="SHA")&&(e==="digest"||n==="HMAC"&&(e==="sign"||e==="verify"||e==="generateKey")||(n==="KDF"||n==="PBKDF2"||n==="PFXKDF"||n==="CPKDF")&&(e==="deriveKey"||e==="deriveBits"||e==="generateKey"))){return"GostDigest"}else if(r==="GOST R 34.10"&&(e==="generateKey"||(!n||n==="SIGN")&&(e==="sign"||e==="verify")||n==="MASK"&&(e==="wrapKey"||e==="unwrapKey")||n==="DH"&&(e==="deriveKey"||e==="deriveBits"))){return"GostSign"}else throw new o.NotSupportedError("Algorithm "+r+"-"+n+" is not valid for "+e)}var s={execute:function execute(e,t,r){var n=defineEngine(t,e);var i=this["get"+n](e);return i[t].apply(i,r)},getGostCipher:function getGostCipher(e){return new n.GostCipher(e)},getGostDigest:function getGostDigest(e){return new i.GostDigest(e)},getGostSign:function getGostSign(e){return new a.GostSign(e)}};t.gostEngine=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostSubtleInstance=undefined;t.SubtleCrypto=SubtleCrypto;var n=r(10);var i=r(7);var a=r(0);var o=r(5);function _classCallCheck(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _possibleConstructorReturn(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _inherits(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var s=function(e){_inherits(InvalidStateError,e);function InvalidStateError(){_classCallCheck(this,InvalidStateError);return _possibleConstructorReturn(this,(InvalidStateError.__proto__||Object.getPrototypeOf(InvalidStateError)).apply(this,arguments))}return InvalidStateError}(Error);var c=function(e){_inherits(InvalidAccessError,e);function InvalidAccessError(){_classCallCheck(this,InvalidAccessError);return _possibleConstructorReturn(this,(InvalidAccessError.__proto__||Object.getPrototypeOf(InvalidAccessError)).apply(this,arguments))}return InvalidAccessError}(Error);var u=(0,i.getCryptoModule)();function normalize(e,t){if(typeof e==="string"||e instanceof String)e={name:e};var r=e.name;if(!r)throw new SyntaxError("Algorithm name not defined");var n=r.split("/"),n=n[0].split("-").concat(n.slice(1));var i={};r=n[0].replace(/[\.\s]/g,"");n=n.slice(1);if(r.indexOf("28147")>=0){i={name:"GOST 28147",version:1989,mode:(e.mode||(t==="sign"||t==="verify"?"MAC":t==="wrapKey"||t==="unwrapKey"?"KW":"ES")).toUpperCase(),length:e.length||64}}else if(r.indexOf("3412")>=0){i={name:"GOST R 34.12",version:2015,mode:(e.mode||(t==="sign"||t==="verify"?"MAC":t==="wrapKey"||t==="unwrapKey"?"KW":"ES")).toUpperCase(),length:e.length||64}}else if(r.indexOf("3411")>=0){i={name:"GOST R 34.11",version:2012,mode:(e.mode||(t==="deriveKey"||t==="deriveBits"?"KDF":t==="sign"||t==="verify"?"HMAC":"HASH")).toUpperCase(),length:e.length||256}}else if(r.indexOf("3410")>=0){i={name:"GOST R 34.10",version:2012,mode:(e.mode||(t==="deriveKey"||t==="deriveBits"?"DH":"SIGN")).toUpperCase(),length:e.length||256}}else if(r.indexOf("SHA")>=0){i={name:"SHA",version:(e.length||160)===160?1:2,mode:(e.mode||(t==="deriveKey"||t==="deriveBits"?"KDF":t==="sign"||t==="verify"?"HMAC":"HASH")).toUpperCase(),length:e.length||160}}else if(r.indexOf("RC2")>=0){i={name:"RC2",version:1,mode:(e.mode||(t==="sign"||t==="verify"?"MAC":t==="wrapKey"||t==="unwrapKey"?"KW":"ES")).toUpperCase(),length:e.length||32}}else if(r.indexOf("PBKDF2")>=0){i=normalize(e.hash,"digest");i.mode="PBKDF2"}else if(r.indexOf("PFXKDF")>=0){i=normalize(e.hash,"digest");i.mode="PFXKDF"}else if(r.indexOf("CPKDF")>=0){i=normalize(e.hash,"digest");i.mode="CPKDF"}else if(r.indexOf("HMAC")>=0){i=normalize(e.hash,"digest");i.mode="HMAC"}else throw new a.NotSupportedError("Algorithm not supported");n.forEach(function(e){e=e.toUpperCase();if(/^[0-9]+$/.test(e)){if(["8","16","32"].indexOf(e)>=0||i.length==="128"&&e==="64"){if(i.mode==="ES")i.shiftBits=parseInt(e);else if(i.mode==="MAC")i.macLength=parseInt(e);else throw new a.NotSupportedError("Algorithm "+i.name+" mode "+e+" not supported")}else if(["89","94","01","12","15","1989","1994","2001","2012","2015"].indexOf(e)>=0){var t=parseInt(e);t=t<1900?t<80?2e3+t:1900+t:t;i.version=t}else if(["1"].indexOf(e)>=0&&i.name==="SHA"){i.version=1;i.length=160}else if(["256","384","512"].indexOf(e)>=0&&i.name==="SHA"){i.version=2;i.length=parseInt(e)}else if(["40","128"].indexOf(e)>=0&&i.name==="RC2"){i.version=1;i.length=parseInt(e)}else if(["64","128","256","512"].indexOf(e)>=0)i.length=parseInt(e);else if(["1000","2000"].indexOf(e)>=0)i.iterations=parseInt(e)}else if(["E-TEST","E-A","E-B","E-C","E-D","E-SC","E-Z","D-TEST","D-A","D-SC"].indexOf(e)>=0){i.sBox=e}else if(["S-TEST","S-A","S-B","S-C","S-D","X-A","X-B","X-C"].indexOf(e)>=0){i.namedParam=e}else if(["S-256-TEST","S-256-A","S-256-B","S-256-C","P-256","T-512-TEST","T-512-A","T-512-B","X-256-A","X-256-B","T-256-TEST","T-256-A","T-256-B","S-256-B","T-256-C","S-256-C"].indexOf(e)>=0){i.namedCurve=e}else if(["SC","CP","VN"].indexOf(e)>=0){i.procreator=e}else if(i.name==="GOST 28147"||i.name==="GOST R 34.12"||i.name==="RC2"){if(["ES","MAC","KW","MASK"].indexOf(e)>=0){i.mode=e}else if(["ECB","CFB","OFB","CTR","CBC"].indexOf(e)>=0){i.mode="ES";i.block=e}else if(["CPKW","NOKW","SCKW"].indexOf(e)>=0){i.mode="KW";i.keyWrapping=e.replace("KW","")}else if(["ZEROPADDING","PKCS5PADDING","NOPADDING","RANDOMPADDING","BITPADDING"].indexOf(e)>=0){i.padding=e.replace("PADDING","")}else if(["NOKM","CPKM"].indexOf(e)>=0){i.keyMeshing=e.replace("KM","")}else throw new a.NotSupportedError("Algorithm "+i.name+" mode "+e+" not supported")}else if(i.name==="GOST R 34.11"||i.name==="SHA"){if(["HASH","KDF","HMAC","PBKDF2","PFXKDF","CPKDF"].indexOf(e)>=0)i.mode=e;else throw new a.NotSupportedError("Algorithm "+i.name+" mode "+e+" not supported")}else if(i.name==="GOST R 34.10"){var r=e.replace(/[\.\s]/g,"");if(r.indexOf("GOST")>=0&&r.indexOf("3411")>=0)i.hash=e;else if(["SIGN","DH","MASK"].indexOf(e))i.mode=e;else throw new a.NotSupportedError("Algorithm "+i.name+" mode "+e+" not supported")}});i.procreator=e.procreator||i.procreator||"CP";switch(i.name){case"GOST R 34.10":i.keySize=i.length/(i.version===1994?4:8);break;case"GOST R 34.11":i.keySize=32;break;case"GOST 28147":case"GOST R 34.12":i.keySize=32;break;case"RC2":i.keySize=Math.ceil(i.length/8);break;case"SHA":i.keySize=i.length/8;break}if(i.mode==="ES"){if(e.block)i.block=e.block;if(i.block)i.block=i.block.toUpperCase();if(e.padding)i.padding=e.padding;if(i.padding)i.padding=i.padding.toUpperCase();if(e.shiftBits)i.shiftBits=e.shiftBits;if(e.keyMeshing)i.keyMeshing=e.keyMeshing;if(i.keyMeshing)i.keyMeshing=i.keyMeshing.toUpperCase();if(t!=="importKey"&&t!=="generateKey"){i.block=i.block||"ECB";i.padding=i.padding||(i.block==="CBC"||i.block==="ECB"?"ZERO":"NO");if(i.block==="CFB"||i.block==="OFB")i.shiftBits=i.shiftBits||i.length;i.keyMeshing=i.keyMeshing||"NO"}}if(i.mode==="KW"){if(e.keyWrapping)i.keyWrapping=e.keyWrapping;if(i.keyWrapping)i.keyWrapping=i.keyWrapping.toUpperCase();if(t!=="importKey"&&t!=="generateKey")i.keyWrapping=i.keyWrapping||"NO"}["sBox","namedParam","namedCurve","curve","param","modulusLength"].forEach(function(t){e[t]&&(i[t]=e[t])});if(t!=="importKey"&&t!=="generateKey"){if(i.name==="GOST 28147"){i.sBox=i.sBox||(i.procreator==="SC"?"E-SC":"E-A")}else if(i.name==="GOST R 34.12"&&i.length===64){i.sBox="E-Z"}else if(i.name==="GOST R 34.11"&&i.version===1994){i.sBox=i.sBox||(i.procreator==="SC"?"D-SC":"D-A")}else if(i.name==="GOST R 34.10"&&i.version===1994){i.namedParam=i.namedParam||(i.mode==="DH"?"X-A":"S-A")}else if(i.name==="GOST R 34.10"&&i.version===2001){i.namedCurve=i.namedCurve||(i.length===256?i.procreator==="SC"?"P-256":i.mode==="DH"?"X-256-A":"S-256-A":i.mode==="T-512-A")}else if(i.name==="GOST R 34.10"&&i.version===2012){i.namedCurve=i.namedCurve||(i.length===256?i.procreator==="SC"?"P-256":i.mode==="DH"?"X-256-A":"S-256-A":i.mode==="T-512-A")}}switch(i.mode){case"DH":e.ukm&&(i.ukm=e.ukm);e["public"]&&(i["public"]=e["public"]);break;case"SIGN":case"KW":e.ukm&&(i.ukm=e.ukm);break;case"ES":case"MAC":e.iv&&(i.iv=e.iv);break;case"KDF":e.label&&(i.label=e.label);e.contex&&(i.context=e.contex);break;case"PBKDF2":e.salt&&(i.salt=e.salt);e.iterations&&(i.iterations=e.iterations);e.diversifier&&(i.diversifier=e.diversifier);break;case"PFXKDF":e.salt&&(i.salt=e.salt);e.iterations&&(i.iterations=e.iterations);e.diversifier&&(i.diversifier=e.diversifier);break;case"CPKDF":e.salt&&(i.salt=e.salt);e.iterations&&(i.iterations=e.iterations);break}if(t&&(i.mode!=="ES"&&i.mode!=="SIGN"&&i.mode!=="MAC"&&i.mode!=="HMAC"&&i.mode!=="KW"&&i.mode!=="DH"&&i.mode!=="MASK"&&t==="generateKey"||i.mode!=="ES"&&(t==="encrypt"||t==="decrypt")||i.mode!=="SIGN"&&i.mode!=="MAC"&&i.mode!=="HMAC"&&(t==="sign"||t==="verify")||i.mode!=="HASH"&&t==="digest"||i.mode!=="KW"&&i.mode!=="MASK"&&(t==="wrapKey"||t==="unwrapKey")||i.mode!=="DH"&&i.mode!=="PBKDF2"&&i.mode!=="PFXKDF"&&i.mode!=="CPKDF"&&i.mode!=="KDF"&&(t==="deriveKey"||t==="deriveBits")))throw new a.NotSupportedError("Algorithm mode "+i.mode+" not valid for method "+t);e.hash&&(i.hash=e.hash);if(i.hash){if((typeof i.hash==="string"||i.hash instanceof String)&&i.procreator)i.hash=i.hash+"/"+i.procreator;i.hash=normalize(i.hash,"digest")}e.id&&(i.id=e.id);return i}function checkNative(e){if(!u||!u.subtle||!e)return false;var t=typeof e==="string"||e instanceof String?t=e:e.name;if(!t)return false;t=t.toUpperCase();if((t.indexOf("KDF")>=0||t.indexOf("HMAC")>=0)&&e.hash)return checkNative(e.hash);return t.indexOf("GOST")===-1&&t.indexOf("SHA-1")===-1&&t.indexOf("RC2")===-1&&t.indexOf("?DES")===-1}function checkKey(e,t){if(!e.algorithm)throw new SyntaxError("Key algorithm not defined");if(!e.algorithm.name)throw new SyntaxError("Key algorithm name not defined");var r=e.algorithm.name,n=r==="GOST 28147"||r==="GOST R 34.12"||r==="RC2",i=r==="GOST R 34.11"||r==="SHA",o=r==="GOST R 34.10";if(!n&&!o&&!i)throw new a.NotSupportedError("Key algorithm "+r+" is unsupproted");if(!e.type)throw new SyntaxError("Key type not defined");if((n||i)&&e.type!=="secret"||o&&!(e.type==="public"||e.type==="private"))throw new a.DataError("Key type "+e.type+" is not valid for algorithm "+r);if(!e.usages||!e.usages.indexOf)throw new SyntaxError("Key usages not defined");for(var u=0,f=e.usages.length;u<f;u++){var d=e.usages[u];if((d==="encrypt"||d==="decrypt")&&e.type!=="secret"||d==="sign"&&e.type==="public"||d==="verify"&&e.type==="private")throw new s("Key type "+e.type+" is not valid for "+d)}if(t)if(e.usages.indexOf(t)===-1)throw new c("Key usages is not contain method "+t);if(!e.buffer)throw new SyntaxError("Key buffer is not defined");var h=e.buffer.byteLength*8,y=8*e.algorithm.keySize;if(e.type==="secret"&&h!==(y||256)&&(e.usages.indexOf("encrypt")>=0||e.usages.indexOf("decrypt")>=0)||e.type==="private"&&!(h===256||h===512)||e.type==="public"&&!(h===512||h===1024))throw new SyntaxError("Key buffer has wrong size "+h+" bit")}function extractKey(e,t,r){checkKey(r,e);if(t){var n;switch(t.mode){case"ES":n=["sBox","keyMeshing","padding","block"];break;case"SIGN":n=["namedCurve","namedParam","sBox","curve","param","modulusLength"];break;case"MAC":n=["sBox"];break;case"KW":n=["keyWrapping","ukm"];break;case"DH":n=["namedCurve","namedParam","sBox","ukm","curve","param","modulusLength"];break;case"KDF":n=["context","label"];break;case"PBKDF2":n=["sBox","iterations","salt"];break;case"PFXKDF":n=["sBox","iterations","salt","diversifier"];break;case"CPKDF":n=["sBox","salt"];break}if(n)n.forEach(function(e){r.algorithm[e]&&(t[e]=r.algorithm[e])})}return r.buffer}function convertKey(e,t,r,n,i){var a={type:i||(e.name==="GOST R 34.10"?"private":"secret"),extractable:t||"false",algorithm:e,usages:r||[],buffer:n};checkKey(a);return a}function convertKeyPair(e,t,r,n,i,a){if(!n||!n.indexOf)throw new SyntaxError("Key usages not defined");var o=n.filter(function(e){return e!=="sign"});var s=n.filter(function(e){return e!=="verify"});return{publicKey:convertKey(e,r,o,i,"public"),privateKey:convertKey(t,r,s,a,"private")}}function swapBytes(e){if(e instanceof f)e=new Uint8Array(e);var t=new Uint8Array(e.length);for(var r=0,n=e.length;r<n;r++){t[n-r-1]=e[r]}return t.buffer}function execute(e,t,r){return new Promise(function(i,a){try{i(n.gostEngine.execute(e,t,r))}catch(e){a(e)}})}function call(e){try{e()}catch(e){}}var f=ArrayBuffer;function SubtleCrypto(){}SubtleCrypto.prototype.encrypt=function(e,t,r){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.encrypt(e,t,r);e=normalize(e,"encrypt");return execute(e,"encrypt",[extractKey("encrypt",e,t),r])})};SubtleCrypto.prototype.decrypt=function(e,t,r){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.decrypt(e,t,r);e=normalize(e,"decrypt");return execute(e,"decrypt",[extractKey("decrypt",e,t),r])})};SubtleCrypto.prototype.sign=function(e,t,r){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.sign(e,t,r);e=normalize(e,"sign");var n=execute(e,"sign",[extractKey("sign",e,t),r]).then(function(t){if(e.procreator==="SC"&&e.mode==="SIGN"){t=o.gostASN1Instance.GostSignature.encode(t)}return t});return n})};SubtleCrypto.prototype.verify=function(e,t,r,n){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.verify(e,t,r,n);e=normalize(e,"verify");if(e.procreator==="SC"&&e.mode==="SIGN"){var i=o.gostASN1Instance.GostSignature.decode(r);r={r:i.r,s:i.s}}return execute(e,"verify",[extractKey("verify",e,t),r,n])})};SubtleCrypto.prototype.digest=function(e,t){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.digest(e,t);e=normalize(e,"digest");return execute(e,"digest",[t])})};SubtleCrypto.prototype.generateKey=function(e,t,r){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.generateKey(e,t,r);var n=e.privateKey,i=e.publicKey;e=normalize(e,"generateKey");if(n)n=normalize(n,"generateKey");else n=e;if(i)i=normalize(i,"generateKey");else i=e;return execute(e,"generateKey",[]).then(function(a){if(a.publicKey&&a.privateKey)return convertKeyPair(i,n,t,r,a.publicKey,a.privateKey);else return convertKey(e,t,r,a)})})};SubtleCrypto.prototype.deriveKey=function(e,t,r,n,i){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.deriveKey(e,t,r,n,i);e=normalize(e,"deriveKey");r=normalize(r,"generateKey");e.keySize=r.keySize;if(e["public"]){e["public"].algorithm=normalize(e["public"].algorithm);e["public"]=extractKey("deriveKey",e,e["public"])}return execute(e,"deriveKey",[extractKey("deriveKey",e,t)]).then(function(e){return convertKey(r,n,i,e)})})};SubtleCrypto.prototype.deriveBits=function(e,t,r){return new Promise(call).then(function(){if(checkNative(e))return u.subtle.deriveBits(e,t,r);e=normalize(e,"deriveBits");if(e["public"])e["public"]=extractKey("deriveBits",e,e["public"]);return execute(e,"deriveBits",[extractKey("deriveBits",e,t),r])})};SubtleCrypto.prototype.importKey=function(e,t,r,n,i){var s;return new Promise(call).then(function(){if(checkNative(r))return u.subtle.importKey(e,t,r,n,i);if(e==="raw"){r=normalize(r,"importKey");if(i&&i.indexOf){var c=r.name.toUpperCase().replace(/[\.\s]/g,"");if(c.indexOf("3410")>=0&&i.indexOf("sign")>=0)s="private";else if(c.indexOf("3410")>=0&&i.indexOf("verify")>=0)s="public"}return t}else{var f;if(e==="pkcs8")f=o.gostASN1Instance.GostPrivateKeyInfo.decode(t).object;else if(e==="spki")f=o.gostASN1Instance.GostSubjectPublicKeyInfo.decode(t).object;else throw new a.NotSupportedError("Key format not supported");r=normalize(f.algorithm,"importKey");s=f.type;if(n!==false)n=n||f.extractable;if(i){for(var d=0;d<i.length;d++){if(f.usages.indexOf(i[d])<0)throw(0,a.DataError)("Key usage not valid for this key")}}else i=f.usages;var h=f.buffer,y=r.keySize,l=h.byteLength;if(s==="public"||y===l)return h;else{if(l%y>0)throw new a.DataError("Invalid key size");r.mode="MASK";r.procreator="VN";var p=[];for(var d=y;d<l;d+=y){p.push(function(e){return function(t){return execute(r,"unwrapKey",[e,t]).then(function(e){var t=p.pop();if(t)return t(e);else{delete r.mode;return e}})}}(new Uint8Array(h,d,y)))}return p.pop()(new Uint8Array(h,0,y))}}}).then(function(e){return convertKey(r,n,i,e,s)})};SubtleCrypto.prototype.exportKey=function(e,t){return new Promise(call).then(function(){if(t&&checkNative(t.algorithm))return u.subtle.exportKey(e,t);if(!t.extractable)throw new c("Key not extractable");var r=extractKey(null,null,t);if(e==="raw")return r;else if(e==="pkcs8"&&t.algorithm&&t.algorithm.id){if(t.algorithm.procreator==="VN"){var n=t.algorithm,i;n.mode="MASK";return execute(n,"generateKey").then(function(e){i=e;return execute(n,"wrapKey",[i,t.buffer])}).then(function(e){delete n.mode;var t=new Uint8Array(e.byteLength+i.byteLength);t.set(new Uint8Array(e,0,e.byteLength));t.set(new Uint8Array(i,0,i.byteLength),e.byteLength);var r=t.buffer;r.enclosed=true;return o.gostASN1Instance.GostPrivateKeyInfo.encode({algorithm:n,buffer:r})})}else return o.gostASN1Instance.GostPrivateKeyInfo.encode(t)}else if(e==="spki"&&t.algorithm&&t.algorithm.id)return o.gostASN1Instance.GostSubjectPublicKeyInfo.encode(t);else throw new a.NotSupportedError("Key format not supported")})};SubtleCrypto.prototype.wrapKey=function(e,t,r,n){return new Promise(call).then(function(){if(checkNative(n))return u.subtle.wrapKey(e,t,r,n);n=normalize(n,"wrapKey");var i=extractKey(null,null,t);if(n.procreator==="SC"&&t.type==="private")i=swapBytes(i);return execute(n,"wrapKey",[extractKey("wrapKey",n,r),i]).then(function(t){if(e==="raw")return t;else throw new a.NotSupportedError("Key format not supported")})})};SubtleCrypto.prototype.unwrapKey=function(e,t,r,n,i,o,s){return new Promise(call).then(function(){if(checkNative(n))return u.subtle.unwrapKey(e,t,r,n,i,o,s);n=normalize(n,"unwrapKey");i=normalize(i,"importKey");if(e!=="raw")throw new a.NotSupportedError("Key format not supported");return execute(n,"unwrapKey",[extractKey("unwrapKey",n,r),t]).then(function(e){var t;if(i&&i.name){var r=i.name.toUpperCase().replace(/[\.\s]/g,"");if(r.indexOf("3410")>=0&&s.indexOf("sign")>=0)t="private";else if(r.indexOf("3410")>=0&&s.indexOf("verify")>=0)t="public"}if(n.procreator==="SC"&&t==="private")e=swapBytes(e);return convertKey(i,o,s,e,t)})})};var d=t.gostSubtleInstance=new SubtleCrypto},function(e,t){e.exports=require("crypto")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostCertInstance=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.GostCert=GostCert;var i=r(15);var a=r(6);var o=r(2);var s=r(5);var c=r(11);var u=ArrayBuffer;var f=o.gostCodingInstance;var d=a.gostSecurityInstance.providers;var h=s.gostASN1Instance;var y=c.gostSubtleInstance;function expand(e){for(var t=1,r=arguments.length;t<r;t++){var i=arguments[t];if((typeof i==="undefined"?"undefined":n(i))==="object")for(var a in i){if(i.hasOwnProperty(a))e[a]=i[a]}}return e}function extend(e){var t=function F(){};t.prototype=e.prototype;var r=new t,n=[r];for(var i=1;i<arguments.length;i++){n.push(arguments[i])}return expand.apply(this,n)}function today(e){var t=new Date;t.setHours(0,0,0,0);if(e)t.setDate(t.getDate()+e);return t}function call(e){try{e()}catch(e){}}function genSerialNumber(){var e=new Uint8Array(4);i.gostCrypto.getRandomValues(e);e[0]=e[0]&127;return f.Int16.encode(e)}var l=function(){var e=function hex(e){var t=typeof e==="undefined"?"undefined":n(e);return t==="undefined"||e===""?"0":t==="number"||e instanceof Number?e.toString(16).toLowerCase():e.replace("0x","").toLowerCase()};var t=function lpad(e,t){return(new Array(t+1).join("0")+e).slice(-t)};return function(r,n){r=e(r);n=e(n);var i=Math.max(r.length,n.length);return t(r,i)===t(n,i)}}();function equalNames(e,t){for(var r in e){if(e[r]!==t[r])return false}for(var r in t){if(e[r]!==t[r])return false}return true}function equalBuffers(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return false;for(var i=0,a=r.length;i<a;i++){if(r[i]!==n[i])return false}return true}function matchCertificate(e,t){var r=e.extensions&&e.extensions.subjectKeyIdentifier;return e&&t&&(!t.issuer||equalNames(e.issuer,t.issuer))&&(!t.serialNumber||l(e.serialNumber,t.serialNumber))&&(!t.subjectKeyIdentifier||equalBuffers(r,t.subjectKeyIdentifier))&&(!t.subject||equalNames(e.subject,t.subject))&&(!t.date||e.notBefore.getTime()<=t.date.getTime()&&e.notAfter.getTime()>t.date.getTime())}function authoritySelector(e,t,r){var n={subject:e.issuer,date:r},i=t&&t.authorityKeyIdentifier;if(i){n.subjectKeyIdentifier=i.keyIdentifier;if(i.authorityCertIssuer&&i.authorityCertIssuer[0]&&i.authorityCertSerialNumber){n.issuer=i.authorityCertIssuer[0];n.serialNumber=i.authorityCertSerialNumber}}return n}function selectCertificates(e,t){var r=[];for(var n=0,i=e.length;n<i;n++){if(matchCertificate(e[n],t))r.push(e[n])}return r}function matchCRL(e,t){return(!t.issuer||equalNames(e.issuer,t.issuer))&&(!t.date||e.thisUpdate.getTime()<t.date.getTime())}function selectCRLs(e,t){var r=[];for(var n=0,i=e.length;n<i;n++){if(matchCRL(e[n],t))r.push(e[n])}return r}function keyProvider(e){var t=e.id;for(var r in d){var n=d[r];if(n.publicKey.id===t)return n}}function defineProperty(e,t,r,i){if((typeof r==="undefined"?"undefined":n(r))!=="object")r={value:r};if(i!==undefined)r.enumerable=i;Object.defineProperty(e,t,r)}function defineProperties(e,t,r){for(var n in t){defineProperty(e,n,t[n],r)}}function extend(e,t,r,n){if(typeof t!=="function"){n=r;r=t;t=function Class(){e.apply(this,arguments)}}t.prototype=Object.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}});if(r)defineProperties(t.prototype,r,true);if(e!==Object)for(var i in e){t[i]=e[i]}t.super=e;if(n)defineProperties(t,n,true);return t}function GostCert(){}var p={providerName:"CP-01",subject:{countryName:"RU",commonName:"Anonymous"},caKeyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign"],caExtKeyUsage:["serverAuth","clientAuth","codeSigning","emailProtection","ipsecEndSystem","ipsecTunnel","ipsecUser","timeStamping","OCSPSigning"],userKeyUsage:["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement"],userExtKeyUsage:["clientAuth","emailProtection"],days:7305};GostCert.prototype.options=p;var v=function X509(e){try{h.Certificate.call(this,e,true)}catch(t){try{e=new h.CertificationRequest(e,true)}catch(e){}e=e||{};h.Certificate.call(this,{version:2,serialNumber:e.serialNumber||genSerialNumber(),signature:e.signature||{id:"noSignature"},issuer:e.subject||p.subject,notBefore:e.notBefore||today(),notAfter:e.notAfter||today(e.days||p.days),subject:e.subject||p.subject,subjectPublicKeyInfo:e.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new u(0)},extensions:e.attributes&&(e.attributes.extensionRequest||e.attributes.msCertExtensions)||e.extensions,signatureAlgorithm:{id:"noSignature"},signatureValue:new u(0)})}};extend(h.Certificate,v,{sign:function sign(e,t){var r=this,n=r.subjectPublicKeyInfo;return new Promise(call).then(function(){if(!n||!n.algorithm||n.algorithm==="noSignature")throw new Error("Key pair was not generated for the certificate");if(!e)throw new Error("The private key of the issuer is not defined");t=t||r;return y.digest("SHA-1",n.subjectPublicKey)}).then(function(n){var i=t.getProvider()||d[p.providerName];if(!r.signature||r.signature.id==="noSignature")r.signature=i.signature;r.signatureAlgorithm=r.signature;r.issuer=t.subject;if(!r.extensions)r.extensions={};var a=r.extensions,o=t.extensions;if(r===t){a.keyUsage=a.keyUsage||p.caKeyUsage;a.extKeyUsage=a.extKeyUsage||p.caExtKeyUsage;a.basicConstraints=a.basicConstraints||{cA:true}}else{if(!t.checkUsage("keyCertSign",r.notBefore))throw new Error("The issuer's certificate is not valid for signing a certificate");a.keyUsage=a.keyUsage||p.userKeyUsage;a.extKeyUsage=a.extKeyUsage||p.userExtKeyUsage;a.basicConstraints=a.basicConstraints||{cA:a.keyUsage.indexOf("keyCertSign")>=0};if(a.basicConstraints.cA){var s=o&&o.basicConstraints&&o.pathLenConstraint;if(s!==undefined){if(s>0)a.basicConstraints.pathLenConstraint=s-1;else throw new Error("Path length constraint exceeded")}}}a.subjectKeyIdentifier=n;if(o&&o.subjectKeyIdentifier)a.authorityKeyIdentifier={keyIdentifier:o.subjectKeyIdentifier,authorityCertIssuer:[t.issuer],authorityCertSerialNumber:t.serialNumber};return y.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,false,["sign"])}).then(function(e){return y.sign(r.signatureAlgorithm,e,r.tbsCertificate.encode())}).then(function(e){r.signatureValue=e;return r})},generate:function generate(e){var t=this,r,n;if(e)n=d[e];else n=this.getProvider()||d[p.providerName];if(n)e=expand(n.publicKey,{privateKey:n.privateKey});return new Promise(call).then(function(){return y.generateKey(e,"true",["sign","verify"])}).then(function(e){r=e.privateKey;return y.exportKey("spki",e.publicKey)}).then(function(e){t.subjectPublicKeyInfo=new h.SubjectPublicKeyInfo(e);return y.exportKey("pkcs8",r)}).then(function(e){return new h.PrivateKeyInfo(e)})},getPublicKey:function getPublicKey(){var e=this.subjectPublicKeyInfo,t=e.algorithm.id==="rsaEncryption"?["verify"]:["verify","deriveKey","deriveBits"];return y.importKey("spki",e.encode(),e.algorithm,"false",t)},getProvider:function getProvider(){return keyProvider(this.subjectPublicKeyInfo.algorithm)},verify:function verify(e,t,r){var n=this,i=n.extensions;return new Promise(call).then(function(){r=r||today();if(n.notBefore.getTime()>r.getTime()||n.notAfter.getTime()<=r.getTime())throw new Error("The certificate has not yet started or expired");for(var t in i){var a=i[t];if(a.critical&&["authorityKeyIdentifier","subjectKeyIdentifier","keyUsage","certificatePolicies","policyMappings","basicConstraints","nameConstraints","policyConstraints","extKeyUsage"].indexOf(t)<0)throw new Error("The critical extension '"+t+"' is unrecognized")}var o=authoritySelector(n,i,n.notBefore);if(!e&&matchCertificate(n,o))e=n;if(e){if(!matchCertificate(e,o)||!e.checkUsage("keyCertSign",n.notBefore))throw new Error("The issuer's certificate is not valid");return e.verifySignature(n.tbsCertificate.encode(),n.signatureValue,n.signatureAlgorithm)}return true}).then(function(e){if(!e)throw new Error("The certificate has invalid signature");if(t){if(!matchCRL(t,{issuer:n.issuer,date:r}))throw new Error("The issuer's CRL is not valid");if(t.isRevoked(n.serialNumber))throw new Error("The certificate is revoked")}return n})},verifySignature:function verifySignature(e,t,r){return this.getPublicKey().then(function(n){return y.verify(r,n,t,e)})},checkUsage:function checkUsage(e,t){var r=this,n=r.extensions;t=t||today();return r.notBefore.getTime()<=t.getTime()&&r.notAfter.getTime()>t.getTime()&&(!n||!(["keyCertSign","cRLSign"].indexOf(e)>0&&n.basicConstraints&&!n.basicConstraints.cA||n.keyUsage&&n.keyUsage.indexOf(e)<0&&n.extKeyUsage&&n.extKeyUsage.indexOf(e)<0))}});GostCert.prototype.X509=v;var g=function CRL(e){CRL.super.call(this,e);if(!this.version)this.version=1;if(!this.revokedCertificates)this.revokedCertificates=[];if(!this.thisUpdate)this.thisUpdate=today()};extend(h.CertificateList,g,{sign:function sign(e,t){var r=this;return new Promise(call).then(function(){if(!e)throw new Error("The issuer's private key is not defined");if(!t)throw new Error("The issuer's certificate is not defined");if(!r.issuer)r.issuer=t.issuer;else if(!equalNames(r.issuer,t.issuer))throw new Error("The CRL prototype and authority certificate have different issuers");if(!t.checkUsage("cRLSign",r.thisUpdate))throw new Error("The issuer's certificate is not valid for signing a CRL");var n=t.getProvider()||d[p.providerName];if(!r.signature)r.signature=n.signature;r.signatureAlgorithm=r.signature;r.issuer=t.subject;if(!r.crlExtensions)r.crlExtensions={};var i=r.crlExtensions,a=t.extensions;if(a&&a.subjectKeyIdentifier)i.authorityKeyIdentifier={keyIdentifier:a.subjectKeyIdentifier,authorityCertIssuer:[t.issuer],authorityCertSerialNumber:t.serialNumber};i.cRLNumber=i.cRLNumber||0;return y.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,false,["sign"])}).then(function(e){return y.sign(r.signatureAlgorithm,e,r.tbsCertList.encode())}).then(function(e){r.signatureValue=e;return r})},verify:function verify(e,t){var r=this,n=r.crlExtensions;return new Promise(call).then(function(){t=t||today();if(!r.thisUpdate.getTime()>t.getTime())throw new Error("The CRL has not yet started");if(e){if(!matchCertificate(e,authoritySelector(r,n,r.thisUpdate))||!e.checkUsage("cRLSign",r.thisUpdate))throw new Error("The issuer's certificate is not valid");if(!r.signatureValue||!r.signatureAlgorithm)throw new Error("The has no signature");return e.verifySignature(r.tbsCertList.encode(),r.signatureValue,r.signatureAlgorithm)}}).then(function(e){if(!e)throw new Error("The CRL has invalid signature");return r})},isRevoked:function isRevoked(e,t){var r=this.revokedCertificates;t=t||today();for(var n=0;n<r.length;n++){if(t.getTime()>=r[n].revocationDate.getTime()&&l(r[n].userCertificate,e))return true}return false}});GostCert.prototype.CRL=g;function Request(e){try{h.CertificationRequest.call(this,e,true)}catch(t){e=e||{};h.CertificationRequest.call(this,{version:0,subject:e.subject||p.subject,subjectPublicKeyInfo:e.subjectPublicKeyInfo||{algorithm:{id:"noSignature"},subjectPublicKey:new u(0)},attributes:e.attributes||{extensionRequest:{keyUsage:p.userKeyUsage,extKeyUsage:p.userExtKeyUsage}},signatureAlgorithm:{id:"noSignature"},signatureValue:new u(0)})}}extend(h.CertificationRequest,Request,{generate:function generate(e){var t=this,r,n;if(e)n=d[e];else n=this.getProvider()||d[p.providerName];if(n)e=expand(n.publicKey,{privateKey:n.privateKey});return new Promise(call).then(function(){return y.generateKey(e,"true",["sign","verify"])}).then(function(e){r=e.privateKey;return y.exportKey("spki",e.publicKey)}).then(function(e){t.subjectPublicKeyInfo=new h.SubjectPublicKeyInfo(e);return y.exportKey("pkcs8",r)}).then(function(e){r=new h.PrivateKeyInfo(e);return t.sign(r)}).then(function(){return r})},getProvider:function getProvider(){return keyProvider(this.subjectPublicKeyInfo.algorithm)},sign:function sign(e){var t=this,r=t.subjectPublicKeyInfo;return new Promise(call).then(function(){if(!r||!r.algorithm||r.algorithm==="noSignature")throw new Error("Key pair was not generated for the certificate");if(!e)throw new Error("The private key is not defined");var n=keyProvider(r.algorithm)||d[p.providerName];t.signatureAlgorithm=n.signature;return y.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,false,["sign"])}).then(function(e){return y.sign(t.signatureAlgorithm,e,t.requestInfo.encode())}).then(function(e){t.signatureValue=e;return t})},verify:function verify(){var e=this,t=e.subjectPublicKeyInfo;return new Promise(call).then(function(){return y.importKey("spki",t.encode(),t.algorithm,"false",["verify"])}).then(function(t){return y.verify(e.signatureAlgorithm,t,e.signatureValue,e.requestInfo.encode())}).then(function(t){if(!t)throw new Error("The certification request has invalid signature");return e})}});GostCert.prototype.Request=Request;function CertStore(e,t){this.certificates=e||[];this.crls=t||[]}extend(Object,CertStore,{getCertificates:function getCertificates(e){return selectCertificates(this.certificates,e)},getCRLs:function getCRLs(e){return selectCRLs(this.certificates,e)},load:function load(e){var t=new h.ContentInfo(e),r=t.certificates,n=t.crls;for(var i=0;i<r.length;i++){this.certificates.push(new v(r[i]))}for(var i=0;i<n.length;i++){this.crls.push(new g(n[i]))}return this},store:function store(){return new h.ContentInfo({contentType:"signedData",version:0,digestAlgorithms:[],encapContentInfo:{contentType:"data"},certificates:this.certs,crls:this.crls,signerInfos:[]})}});GostCert.prototype.CertStore=CertStore;function CertPath(e){this.certStore=e}extend(Object,CertPath,{build:function build(e,t){var r=this;return new Promise(call).then(function(){var n=new v(e),i=[],a=false,o=[];while(n){var s=[],c=[];i.push(n);if(!a){s=r.certStore.getCRLs({issuer:n.issuer,date:t});var u=authoritySelector(n,n.extensions,n.notBefore);if(!matchCertificate(n,u))c=r.certStore.getCertificates(u);else a=true}var f=c.length>0&&new v(c[0]),d=s.length>0&&new g(s[0]);if(d)o.push(d.verify(f,t));o.push(n.verify(f,d,t));n=f}if(!a)throw new Error("Root certificate is not found");return Promise.all(o).then(function(e){for(var t=0;t<e;t++){if(!e[t])throw new Error("Certification path is not validated")}return i})})}});GostCert.prototype.CertPath=CertPath;function CertificateTrustPolicy(){}extend(Object,CertificateTrustPolicy,{getValidCertificate:function getValidCertificate(e,t,r){}});GostCert.prototype.CertificateTrustPolicy=CertificateTrustPolicy;function TrustedCAPolicy(e,t,r){this.trustedCACerts=e||[];this.requireCRL=t||false;this.requireCA=r||true}extend(CertificateTrustPolicy,TrustedCAPolicy,{getValidCertificate:function getValidCertificate(e,t,r,n){var i=this,a;return new Promise(call).then(function(){t=t||[];r=r||[];var o=selectCertificates(i.trustedCACerts,e);if(o.length>0)return new v(o[0]);o=selectCertificates(t,e);if(o.length===0)return;var s=new v(o[0]),c=false,u=[];a=[];while(s){var f=[],d=[];a.push(s);if(!c){f=selectCRLs(r,{issuer:s.issuer,date:n});if(f.length===0&&i.requireCRL)return;e=authoritySelector(s,s.extensions,s.notBefore);d=selectCertificates(i.trustedCACerts,e);if(d.length===0){if(!matchCertificate(s,e)){d=selectCertificates(t,e);if(d.length>0){var h=d[0].extensions;if(i.requireCA){if(!h||!h.basicConstraints||!h.basicConstraints.cA)return;if(h.basicConstraints.pathLenConstraint!==undefined&&h.basicConstraints.pathLenConstraint<a.length-1)return}}else return}}else c=true}var y=d.length>0&&new v(d[0]),l=f.length>0&&new g(f[0]);if(l)u.push(l.verify(y,n));u.push(s.verify(y,l,n));s=y}if(!c)throw new Error("Trusted root certificate is not found");return Promise.all(u).then(function(e){for(var t=0;t<e;t++){if(!e[t])throw new Error("Certification path is not validated")}return a[0]})})}});GostCert.prototype.TrustedCAPolicy=TrustedCAPolicy;var m=t.gostCertInstance=new GostCert},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostCMSInstance=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.GostCMS=GostCMS;var i=r(11);var a=r(5);var o=r(2);var s=r(13);var c=r(6);var u=ArrayBuffer;var f=c.gostSecurityInstance.providers;var d=o.gostCodingInstance;var h=a.gostASN1Instance;var y=i.gostSubtleInstance;var l=s.gostCertInstance;function expand(){var e={};for(var t=0,r=arguments.length;t<r;t++){var i=arguments[t];if((typeof i==="undefined"?"undefined":n(i))==="object")for(var a in i){if(i.hasOwnProperty(a))e[a]=i[a]}}return e}function defineProperty(e,t,r,i){if((typeof r==="undefined"?"undefined":n(r))!=="object")r={value:r};if(i!==undefined)r.enumerable=i;Object.defineProperty(e,t,r)}function defineProperties(e,t,r){for(var n in t){defineProperty(e,n,t[n],r)}}function extend(e,t,r,n){if(typeof t!=="function"){n=r;r=t;t=function Class(){e.apply(this,arguments)}}t.prototype=Object.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}});if(r)defineProperties(t.prototype,r,true);if(e!==Object)for(var i in e){t[i]=e[i]}t.super=e;if(n)defineProperties(t,n,true);return t}function call(e){try{e()}catch(e){}}function equalBuffers(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return false;for(var i=0,a=r.length;i<a;i++){if(r[i]!==n[i])return false}return true}var p=function(){var e=function hex(e){var t=typeof e==="undefined"?"undefined":n(e);return t==="undefined"||e===""?"0":t==="number"||e instanceof Number?e.toString(16).toLowerCase():e.replace("0x","").toLowerCase()};var t=function lpad(e,t){return(new Array(t+1).join("0")+e).slice(-t)};return function(r,n){r=e(r);n=e(n);var i=Math.max(r.length,n.length);return t(r,i)===t(n,i)}}();function equalNames(e,t){for(var r in e){if(e[r]!==t[r])return false}for(var r in t){if(e[r]!==t[r])return false}return true}function addUnique(e,t,r){var n=false;for(var i=0,a=e.length;i<a;i++){if(r(e[i],t)){n=true;break}}if(!n)e.push(t)}function setContentData(e,t){var r=e.content;switch(e.contentType){case"data":e.content=t.content;break;case"digestedData":case"signedData":case"authData":r.encapContentInfo={eContentType:t.contentType,eContent:t.content};break;case"envelopedData":case"encryptedData":r.encryptedContentInfo={contentType:t.contentType,encryptedContent:t.content};break}}function getContentData(e){var t=e.content;switch(e.contentType){case"data":return{contentType:e.contentType,content:e.content};case"digestedData":case"signedData":case"authData":var r=t.encapContentInfo;return{contentType:r.eContentType,content:r.eContent};case"envelopedData":case"encryptedData":var n=t.encryptedContentInfo;return{contentType:n.contentType,content:n.encryptedContent}}}function checkContentInfo(e){var t,r;if(e){if(typeof e==="string")try{e=d.PEM.decode(e)}catch(t){e=d.Chars.decode(e)}if(e instanceof u)try{e=h.ContentInfo.decode(e)}catch(t){e={contentType:"data",content:e}}r=e.contentType;if(!r)throw new Error("Invalid content object");t=e.content;if(!(t instanceof u))t=t.encode();return{contentType:r,content:t}}else e={contentType:"data"};return e}function createContentInfo(e){try{e=new h.ContentInfo(e.content,true)}catch(e){}switch(e.contentType){case"data":return new DataContentInfo(e);case"digestedData":return new DigestedDataContentInfo(e);case"signedData":return new SignedDataContentInfo(e);case"encryptedData":return new EncryptedDataContentInfo(e);case"envelopedData":return new EnvelopedDataContentInfo(e);default:return new h.ContentInfo(e)}}function matchCert(e,t){return e instanceof u?t.extensions&&equalBuffers(e,t.extensions.subjectKeyIdentifier):equalNames(t.issuer,e.issuer)&&p(t.serialNumber,e.serialNumber)}function getSeed(e){var t=new Uint8Array(e);gostCrypto.getRandomValues(t);return t.buffer}function saltSize(e){switch(e.id){case"pbeWithSHAAnd40BitRC2-CBC":case"pbeWithSHAAnd128BitRC2-CBC":return 8;case"pbeUnknownGost":return 16;case"sha1":return 20;default:return 32}}function passwordData(e,t){if(!t)return new u(0);if(t instanceof u)return t;if(typeof t!=="string")throw new Error("The password must be string or raw data type");if(e.name.indexOf("CPKDF")>=0){var r=[];for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);r.push(i&255);r.push(i>>>8&255);r.push(0);r.push(0)}return new Uint8Array(r).buffer}else if(e.name.indexOf("PFXKDF")>=0)return d.Chars.decode(t+"\0","unicode");else return d.Chars.decode(t,"utf8")}function encryptionProvider(e){var t=e.id;for(var r in f){var n=f[r];if(n.encryption.id===t)return n}}function GostCMS(){}var v={providerName:"CP-01",autoAddCert:false,useKeyIdentifier:false};GostCMS.prototype.options=v;function DataContentInfo(e,t){h.ContentInfo.call(this,e||t||{contentType:"data"});if(t&&this.contentType!==(t.contentType||"data"))throw new Error("Invalid content type")}extend(h.ContentInfo,DataContentInfo,{isDetached:{value:false,enumerable:true,writable:true},writeDetached:function writeDetached(e){this.isDetached=e},encode:function encode(e){if(this.isDetached){var t=getContentData(this);setContentData(this,{contentType:t.contentType});var r=h.ContentInfo.method("encode").call(this,e);setContentData(this,t);return r}else return h.ContentInfo.method("encode").call(this,e)},encloseContent:function encloseContent(e){var t=this;return new Promise(call).then(function(){t.setEnclosed(e);return t})},setEnclosed:function setEnclosed(e){setContentData(this,checkContentInfo(e))},getEnclosed:function getEnclosed(){return createContentInfo(getContentData(this))}});GostCMS.prototype.DataContentInfo=DataContentInfo;function DigestedDataContentInfo(e){DataContentInfo.call(this,e,{contentType:"digestedData",version:0,digestAlgorithm:f[v.providerName].digest,encapContentInfo:{eContentType:"data"},digest:new u(0)})}extend(DataContentInfo,DigestedDataContentInfo,{encloseContent:function encloseContent(e,t){var r=this;return new Promise(call).then(function(){r.setEnclosed(e);if(t){var n=f[t];r.digestAlgorithm=n&&n.digest||t}return y.digest(r.digestAlgorithm,r.encapContentInfo.eContent)}).then(function(e){r.digest=e})},verify:function verify(e){var t=this;return new Promise(call).then(function(){if(e)t.setEnclosed(e);var r=t.encapContentInfo&&t.encapContentInfo.eContent;if(!r)throw new Error("Detached content is not found");return y.digest(t.digestAlgorithm,t.encapContentInfo.eContent)}).then(function(e){if(!equalBuffers(e,t.digest))throw Error("Message digest is not verified");return createContentInfo({contentType:t.encapContentInfo.eContentType,content:t.encapContentInfo.eContent})})}});GostCMS.prototype.DigestedDataContentInfo=DigestedDataContentInfo;function SignedDataContentInfo(e){DataContentInfo.call(this,e,{contentType:"signedData",version:1,digestAlgorithms:[],encapContentInfo:{eContentType:"data"},signerInfos:[]})}extend(DataContentInfo,SignedDataContentInfo,{addSignature:function addSignature(e,t,r,i){var a=this,o,s,c;return new Promise(call).then(function(){if(!e||!t)throw new Error("Signer key or certificate is not defined");if(t instanceof Array){c=t;t=c[0]}else c=[t];var u=t.getProvider()||f[v.providerName];var d=v.useKeyIdentifier&&t.extensions&&t.extensions.subjectKeyIdentifier;s=a.encapContentInfo.eContent;o={version:d?2:0,sid:d?t.extensions.subjectKeyIdentifier:{issuer:t.issuer,serialNumber:t.serialNumber},digestAlgorithm:u.digest,signatureAlgorithm:t.subjectPublicKeyInfo.algorithm};if(i)o.unsignedAttrs=i;if(r){if((typeof r==="undefined"?"undefined":n(r))!=="object")r={};return y.digest(o.digestAlgorithm,s)}}).then(function(t){if(t){r.contentType=a.encapContentInfo.eContentType,r.messageDigest=t,r.signingTime=new Date;o.signedAttrs=r,s=h.SignedAttributes.encode(o.signedAttrs)}return y.importKey("pkcs8",h.PrivateKeyInfo.encode(e),e.privateKeyAlgorithm,false,["sign"])}).then(function(e){var t=expand(o.signatureAlgorithm,{hash:o.digestAlgorithm});return y.sign(t,e,s)}).then(function(e){o.signatureValue=e;addUnique(a.digestAlgorithms,o.digestAlgorithm,function(e,t){return e.id===t.id});if(v.autoAddCert){if(!a.certificates)a.certificates=[];for(var t=0,r=c.length;t<r;t++){addUnique(a.certificates,c[t],function(e,t){return equalNames(e.issuer,t.issuer)&&p(e.serialNumber,t.serialNumber)})}}a.signerInfos.push(o)})},isDegenerate:{get:function get(){return!(this.signerInfos&&this.signerInfos.length>0)}},verify:function verify(e,t){var r=this,n;return new Promise(call).then(function(){if(t)r.setEnclosed(t);if(!r.signerInfos||r.signerInfos.length===0)throw new Error("No signatures found");return Promise.all(r.signerInfos.map(function(t,n){var i=t.sid,a=i instanceof u?{subjectKeyIdentifier:i}:{issuer:i.issuer,serialNumber:i.serialNumber};var o;if(t.signedAttrs&&t.signedAttrs.signingTime)o=t.signedAttrs.signingTime;return e.getValidCertificate(a,r.certificates,r.crls,o).catch(function(){return})}))}).then(function(e){var t=[];e.forEach(function(e){if(e)t.push(r.verifySignature(e).then(function(e){n=e},function(){return}))});if(t.length===0)throw new Error("Valid verification path not found");return Promise.all(t)}).then(function(){if(!n)throw Error("Verification path found but no valid signature");return n})},verifySignature:function verifySignature(e,t){var r=this,n,i,a;return new Promise(call).then(function(){if(t)r.setEnclosed(t);i=r.encapContentInfo&&r.encapContentInfo.eContent;if(!i)throw new Error("Detached content is not found");for(var o=0;o<r.signerInfos.length;o++){var s=r.signerInfos[o].sid;if(matchCert(s,e)){n=r.signerInfos[o];break}}if(!n)throw new Error("Signature not found for the certificate");if(n.signedAttrs){a=n.signedAttrs.messageDigest;if(!a)throw new Error("Message digest must present in signed attributes");i=n.signedAttrs.encode()}if(!i)throw new Error("Data for verification not found");var c=expand(n.signatureAlgorithm,{hash:n.digestAlgorithm});return e.verifySignature(i,n.signatureValue,c)}).then(function(e){if(!e)throw new Error("Signature not verified");if(n.signedAttrs)return y.digest(n.digestAlgorithm,r.encapContentInfo.eContent)}).then(function(e){if(e&&!equalBuffers(e,a))throw new Error("Message digest not verified");return createContentInfo({contentType:r.encapContentInfo.eContentType,content:r.encapContentInfo.eContent})})}});GostCMS.prototype.SignedDataContentInfo=SignedDataContentInfo;function EncryptedDataContentInfo(e){DataContentInfo.call(this,e,{contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:f[v.providerName].encryption}})}extend(DataContentInfo,EncryptedDataContentInfo,{encloseContent:function encloseContent(e,t,r){var n=this,i,a;return new Promise(call).then(function(){e=checkContentInfo(e);if(!e.content)throw new Error("Content for encryption must be specified");var n=typeof t==="string"?"pbes":"encryption";if(r){var o=f[r];r=o&&o[n]||r}else r=f[v.providerName][n];if(r.derivation){a=expand(r.derivation);i=expand(r.encryption);a.salt=getSeed(saltSize(r));var s;return y.importKey("raw",passwordData(a,t),a,false,["deriveKey","deriveBits"]).then(function(e){s=e;if(a.name.indexOf("PFXKDF")>=0){a.diversifier=2;return y.deriveBits(a,s,64)}}).then(function(e){if(e)i.iv=e;a.diversifier=1;return y.deriveKey(a,s,i,false,["encrypt"])}).then(function(e){return e})}else{i=expand(r);if(t instanceof u){return y.importKey("raw",t,i,false,["encrypt"])}else if(t.type==="secret"){return t}else throw new Error("Content encryption key must be raw data or secret key type")}}).then(function(t){if(!i.iv)i.iv=getSeed(8);return y.encrypt(i,t,e.content)}).then(function(t){if(r.derivation){delete a.diversifier;r=expand(r,{derivation:a,encryption:i})}else r=i;n.encryptedContentInfo={contentType:e.contentType,contentEncryptionAlgorithm:r,encryptedContent:t};return n})},getEnclosed:function getEnclosed(e,t){var r=this,n,i,a;return new Promise(call).then(function(){if(t)r.setEnclosed(t);a=r.encryptedContentInfo.encryptedContent;if(!a)throw new Error("Encrypted content must be specified");n=expand(r.encryptedContentInfo.contentEncryptionAlgorithm);if(n.derivation){i=expand(n.derivation);n=expand(n.encryption);var o;return y.importKey("raw",passwordData(i,e),i,false,["deriveKey","deriveBits"]).then(function(e){o=e;if(i.name.indexOf("PFXKDF")>=0){i.diversifier=2;return y.deriveBits(i,o,64)}}).then(function(e){if(e)n.iv=e;i.diversifier=1;return y.deriveKey(i,o,n,false,["decrypt"])})}else{if(e instanceof u){return y.importKey("raw",e,n,false,["decrypt"])}else if(e.type==="secret"){return e}else throw new Error("Decryption key must be raw data or secret key type")}}).then(function(e){return y.decrypt(n,e,a)}).then(function(e){return createContentInfo({contentType:r.encryptedContentInfo.contentType,content:e})})}});GostCMS.prototype.EncryptedDataContentInfo=EncryptedDataContentInfo;function EnvelopedDataContentInfo(e){DataContentInfo.call(this,e,{contentType:"envelopedData",version:0,recipientInfos:[],encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:f[v.providerName].encryption}})}extend(DataContentInfo,EnvelopedDataContentInfo,{encloseContent:function encloseContent(e,t){var r=this;return new Promise(call).then(function(){e=checkContentInfo(e);if(!e.content)throw new Error("Content for encryption must be specified");if(t){var r=f[t];t=r&&r.encryption||t}else t=f[v.providerName].encryption;return y.generateKey(t,true,["encrypt"])}).then(function(n){r.contentEncryptionKey=n;if(!t.iv)t.iv=getSeed(8);return y.encrypt(t,n,e.content)}).then(function(n){r.encryptedContentInfo={contentType:e.contentType,contentEncryptionAlgorithm:t,encryptedContent:n};return r})},addRecipient:function addRecipient(e,t,r,n){var i=this,a,o,s,c;return new Promise(call).then(function(){e=new l.X509(e);if(t&&typeof t!=="string"&&!t.algorithm){n=r;r=t;t=undefined}if(t){o=f[t]}else o=e.getProvider();if(!i.contentEncryptionKey)throw new Error("The content encryption key is not assigned");if(n){var a;if(n instanceof Array){a=n;n=a[0]}else a=[n];if(v.autoAddCert){if(!i.originatorInfo)i.originatorInfo={certs:[]};else if(!i.originatorInfo.certs)i.originatorInfo.certs=[];for(var s=0,c=a.length;s<c;s++){addUnique(i.originatorInfo.certs,a[s],function(e,t){return equalNames(e.issuer,t.issuer)&&p(e.serialNumber,t.serialNumber)})}}if(o)t=expand(o.agreement);else o=e.getProvider();if(e.subjectPublicKeyInfo.algorithm.namedCurve!==n.subjectPublicKeyInfo.algorithm.namedCurve)throw new Error("The sender and the recipient have different public key algorithms");return y.importKey("pkcs8",r.encode(),r.privateKeyAlgorithm,false,["deriveKey"])}else{if(o)t=expand(e.subjectPublicKeyInfo.algorithm);else o=e.getProvider();return y.generateKey(t,true,["deriveKey"]).then(function(e){t["public"]=e.publicKey;return e.privateKey})}}).then(function(t){a=t;return y.importKey("spki",e.subjectPublicKeyInfo.encode(),e.subjectPublicKeyInfo.algorithm,false,["deriveKey","deriveBits"])}).then(function(e){t.ukm=getSeed(8);s=expand(o.agreement,{sBox:t.sBox,ukm:t.ukm,public:e});c=expand(t.wrapping||o.wrapping,{ukm:t.ukm});return y.deriveKey(s,a,c,true,["wrapKey"])}).then(function(e){t.wrapping=c;return y.wrapKey("raw",i.contentEncryptionKey,e,c)}).then(function(r){var a;var o=v.useKeyIdentifier&&e.extensions&&e.extensions.subjectKeyIdentifier,s=o?e.extensions.subjectKeyIdentifier:{issuer:e.issuer,serialNumber:e.serialNumber};if(n){var c=n.subjectPublicKeyInfo;a={version:3,originator:{algorithm:c.algorithm,publicKey:c.subjectPublicKey},ukm:t.ukm,keyEncryptionAlgorithm:t,recipientEncryptedKeys:[{rid:s,encryptedKey:h.GostEncryptedKey(t).encode(r)}]}}else{a={version:0,rid:s,keyEncryptionAlgorithm:t,encryptedKey:h.GostEncryptedKey(t).encode({algorithm:t,sessionEncryptedKey:r})}}i.recipientInfos.push(a);return i})},getEnclosed:function getEnclosed(e,t,r,n){var i=this,a,o,s,c,u;return new Promise(call).then(function(){var e=t.getProvider();if(r)i.setEnclosed(r);o=i.encryptedContentInfo.encryptedContent;if(!o)throw new Error("Encrypted content must be specified");u=i.encryptedContentInfo.contentEncryptionAlgorithm;for(var f=0;f<i.recipientInfos.length;f++){var d=i.recipientInfos[f],l=expand(d.keyEncryptionAlgorithm);if(d.rid){if(matchCert(d.rid,t)){var p=h.GostEncryptedKey(l).decode(d.encryptedKey).object;a=p.sessionEncryptedKey;l=expand(l,p.algorithm);s=expand(e.agreement,{ukm:l.ukm,sBox:l.sBox});c=expand(e.wrapping,l.wrapping,{ukm:l.ukm});return l["public"]}}else{var v=d.recipientEncryptedKeys;if(v){for(var g=0;g<v.length;g++){if(matchCert(v[g].rid,t)){l=expand(e.agreement,l,{ukm:d.ukm});a=h.GostEncryptedKey(l).decode(v[g].encryptedKey).object;s=l;c=expand(l.wrapping||e.wrapping,{ukm:d.ukm});var m=d.originator;if(m.algorithm){var C=new h.SubjectPublicKeyInfo({algorithm:m.algorithm,subjectPublicKey:m.publicKey});return y.importKey("spki",C.encode(),C.algorithm,false,["deriveKey","deriveBits"])}else if(n&&matchCert(m,n))return importKey("pkcs",n.subjectPublicKeyInfo.encode(),n.subjectPublicKeyInfo.algorithm,false,["deriveKey","deriveBits"]);else throw Error("Originator certificate not specified or not valid")}}}}}throw new Error("Recipient not found or format not supported")}).then(function(t){s["public"]=t;return y.importKey("pkcs8",e.encode(),e.privateKeyAlgorithm,false,["deriveKey","deriveBits"])}).then(function(e){return y.deriveKey(s,e,c,true,["unwrapKey"])}).then(function(e){return y.unwrapKey("raw",a,e,c,u,false,["decrypt"])}).then(function(e){return y.decrypt(u,e,o)}).then(function(e){return createContentInfo({contentType:i.encryptedContentInfo.contentType,content:e})})}});GostCMS.prototype.EnvelopedDataContentInfo=EnvelopedDataContentInfo;var g=t.gostCMSInstance=new GostCMS},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostCrypto=undefined;var n=r(8);var i=r(2);var a=r(6);var o=r(5);var s=r(11);var c=r(13);var u=r(14);var f=r(17);var d=t.gostCrypto={coding:i.gostCodingInstance,security:a.gostSecurityInstance,asn1:o.gostASN1Instance,subtle:s.gostSubtleInstance,cert:c.gostCertInstance,cms:u.gostCMSInstance,keys:f.gostKeysInstance};d.getRandomValues=function(e){try{var t=new n.GostRandom;return t.getRandomValues(e)}catch(e){throw new Error("Error occurred during random values generation")}}},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.gostKeysInstance=undefined;var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.GostKeys=GostKeys;var i=r(6);var a=r(2);var o=r(5);var s=r(11);var c=r(13);var u=r(14);var f=ArrayBuffer;var d=a.gostCodingInstance;var h=i.gostSecurityInstance.providers;var y=o.gostASN1Instance;var l=s.gostSubtleInstance;var p=c.gostCertInstance;var v=u.gostCMSInstance;function expand(){var e={};for(var t=0,r=arguments.length;t<r;t++){var i=arguments[t];if((typeof i==="undefined"?"undefined":n(i))==="object")for(var a in i){if(i.hasOwnProperty(a))e[a]=i[a]}}return e}function defineProperty(e,t,r,i){if((typeof r==="undefined"?"undefined":n(r))!=="object")r={value:r};if(i!==undefined)r.enumerable=i;Object.defineProperty(e,t,r)}function defineProperties(e,t,r){for(var n in t){defineProperty(e,n,t[n],r)}}function extend(e,t,r,n){if(typeof t!=="function"){n=r;r=t;t=function Class(){e.apply(this,arguments)}}t.prototype=Object.create(e.prototype,{constructor:{value:t},superclass:{value:e.prototype}});if(r)defineProperties(t.prototype,r,true);if(e!==Object)for(var i in e){t[i]=e[i]}t.super=e;if(n)defineProperties(t,n,true);return t}function getSeed(e){var t=new Uint8Array(e);gostCrypto.getRandomValues(t);return t.buffer}function call(e){try{e()}catch(e){}}function buffer(e){if(e instanceof f)return e;else if(e&&e.buffer&&e.buffer instanceof f)return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(new Uint8Array(e,e.byteOffset,e.byteLength)).buffer;else throw new DataError("CryptoOperationData required")}function now(e){var t=new Date;if(e)t.setDate(t.getDate()+e);return t}function today(e){var t=now(e);t.setHours(0,0,0,0);return t}function equalBuffers(e,t){var r=new Uint8Array(e),n=new Uint8Array(t);if(r.length!==n.length)return false;for(var i=0,a=r.length;i<a;i++){if(r[i]!==n[i])return false}return true}function generateUUID(){var e=new Uint8Array(getSeed(16)),t="";for(var r=0;r<16;r++){t+=("00"+e[r].toString(16)).slice(-2)}return t.substr(0,8)+"-"+t.substr(8,4)+"-4"+t.substr(13,3)+"-9"+t.substr(17,3)+"-"+t.substr(20,12)}function get32(e,t){var r=new Uint8Array(e,t,4);return r[3]<<24|r[2]<<16|r[1]<<8|r[0]}function set32(e,t,r){var n=new Uint8Array(e,t,4);n[3]=r>>>24;n[2]=r>>>16&255;n[1]=r>>>8&255;n[0]=r&255;return n}function saltSize(e){switch(e.id){case"pbeWithSHAAnd40BitRC2-CBC":case"pbeWithSHAAnd128BitRC2-CBC":return 8;case"pbeUnknownGost":return 16;case"sha1":return 20;default:return 32}}function passwordData(e,t){if(!t)return new f(0);if(e.name.indexOf("CPKDF")>=0){var r=[];for(var n=0;n<t.length;n++){var i=t.charCodeAt(n);r.push(i&255);r.push(i>>>8&255);r.push(0);r.push(0)}return new Uint8Array(r).buffer}else if(e.name.indexOf("PFXKDF")>=0)return d.Chars.decode(t+"\0","unicode");else return d.Chars.decode(t,"utf8")}function GostKeys(){}var g={providerName:"CP-01",days:7305};GostKeys.prototype.options=g;function PKCS8(e){y.PrivateKeyInfo.call(this,e)}extend(y.PrivateKeyInfo,PKCS8,{getPrivateKey:function getPrivateKey(){var e=this.privateKeyAlgorithm.id==="rsaEncryption"?["sign"]:["sign","deriveKey","deriveBits"];return l.importKey("pkcs8",this.encode(),this.privateKeyAlgorithm,"true",e)},setPrivateKey:function setPrivateKey(e){var t=this;return l.exportKey("pkcs8",e).then(function(e){y.PrivateKeyInfo.call(t,e);return t})},generate:function generate(e,t){var r=this;return new Promise(call).then(function(){if(!(e instanceof p.Request))e=new p.Request(e);return e.generate(t)}).then(function(t){y.PrivateKeyInfo.call(r,t);return e})}});GostKeys.prototype.PKCS8=PKCS8;function PKCS8Encrypted(e){y.EncryptedPrivateKeyInfo.call(this,e)}extend(y.EncryptedPrivateKeyInfo,PKCS8Encrypted,{getKey:function getKey(e){var t=this,r;return new Promise(call).then(function(){r=new v.EncryptedDataContentInfo({contentType:"encryptedData",version:0,encryptedContentInfo:{contentType:"data",contentEncryptionAlgorithm:t.encryptionAlgorithm,encryptedContent:t.encryptedData}});return r.getEnclosed(e)}).then(function(e){return PKCS8.decode(e.content)})},getPrivateKey:function getPrivateKey(e){return this.getKey(e).then(function(e){return e.getPrivateKey()})},setKey:function setKey(e,t,r){var n=this,i;return new Promise(call).then(function(){e=new PKCS8(e);i=new v.EncryptedDataContentInfo;return i.encloseContent(e.encode(),t,r||g.providerName)}).then(function(){n.encryptionAlgorithm=i.encryptedContentInfo.contentEncryptionAlgorithm;n.encryptedData=i.encryptedContentInfo.encryptedContent;return n})},setPrivateKey:function setPrivateKey(e,t,r){var n=this;return(new PKCS8).setPrivateKey(e).then(function(e){return n.setKey(e,t,r)})},generate:function generate(e,t,r,n){var i=this;return new Promise(call).then(function(){if(!(e instanceof p.Request))e=new p.Request(e);return e.generate(r)}).then(function(e){return i.setKey(e,t,n)}).then(function(){return e})}});GostKeys.prototype.PKCS8Encrypted=PKCS8Encrypted;function SignalComKeyContainer(e){if(e){var t=this;["mk.db3","masks.db3","kek.opq","rand.opq"].forEach(function(r){t[r]=e[r]})}}extend(Object,SignalComKeyContainer,{getEncryptionKey:function getEncryptionKey(e){var t=this,r=h["SC-01"].wrapping,n=h["SC-01"].encryption,i=h["SC-01"].derivation,a=t["masks.db3"],o=t["mk.db3"],s=t["kek.opq"];return new Promise(call).then(function(){if(!a||!o||!s)throw new Error("Not enougth key container files");if(a.byteLength>32){if(e){return l.importKey("raw",d.Chars.decode(e,"utf8"),i,false,["deriveKey","deriveBits"]).then(function(e){return l.deriveKey(expand(i,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),e,n,false,["decrypt"])}).then(function(e){var t=new v.EncryptedDataContentInfo(a);return t.getEnclosed(e)}).then(function(e){return e.verify()}).then(function(e){return e.content})}else throw new Error("Key password is required")}else if(e)throw new Error("Key password is not required");return a}).then(function(e){a=e;var t=new Uint8Array(o.byteLength+a.byteLength);t.set(new Uint8Array(o),0);t.set(new Uint8Array(a),o.byteLength);return l.importKey("raw",t.buffer,r,false,["unwrapKey"])}).then(function(e){return l.unwrapKey("raw",s,e,r,n,false,["wrapKey","unwrapKey"])})},generateContainer:function generateContainer(e){var t=this,r=h["SC-01"].wrapping,n=h["SC-01"].encryption,i=h["SC-01"].derivation,a=h["SC-01"].digest,o,s;return new Promise(call).then(function(){return l.generateKey(r,true,["wrapKey"])}).then(function(r){s=r;var o=s.buffer.byteLength;t["mk.db3"]=new Uint8Array(new Uint8Array(s.buffer,0,o-32)).buffer;var c=new Uint8Array(new Uint8Array(s.buffer,o-32,32)).buffer;if(e){var u=new v.EncryptedDataContentInfo,f=new v.DigestedDataContentInfo;return f.encloseContent(c,a).then(function(){f={contentType:"digestedData",content:f.encode()};return l.importKey("raw",d.Chars.decode(e,"utf8"),i,false,["deriveKey","deriveBits"])}).then(function(e){return l.deriveKey(expand(i,{salt:new Uint8Array([0,0,0,0,0,0,0,0])}),e,n,false,["encrypt"])}).then(function(e){return u.encloseContent(f,e,n)}).then(function(){return u.encode()})}return c}).then(function(e){t["masks.db3"]=e;return l.generateKey(n,false,["wrapKey","unwrapKey"])}).then(function(e){o=e;return l.wrapKey("raw",e,s,r)}).then(function(e){t["kek.opq"]=e;return l.generateKey(n,false,["wrapKey","unwrapKey"])}).then(function(e){return l.wrapKey("raw",e,s,r)}).then(function(e){t["rand.opq"]=e;return o})}});GostKeys.prototype.SignalComKeyContainer=SignalComKeyContainer;function SignalComPrivateKeyInfo(e,t){y.GostWrappedPrivateKey.call(this,e);SignalComKeyContainer.call(this,t)}extend(y.GostWrappedPrivateKey,SignalComPrivateKeyInfo,{getKey:function getKey(e){return this.getPrivateKey(e).then(function(e){return(new PKCS8).setPrivateKey(e)})},getPrivateKey:function getPrivateKey(e){var t=this,r=h["SC-01"].wrapping,n;return new Promise(call).then(function(){return t.getEncryptionKey(e,true)}).then(function(e){return l.unwrapKey("raw",t.privateKeyWrapped,e,r,t.privateKeyAlgorithm,true,["sign","deriveKey","deriveBits"])}).then(function(e){n=t.attributes&&t.attributes["id-sc-gostR3410-2001-publicKey"];if(n)return l.generateKey(expand(e.algorithm,{ukm:e.buffer}),e.extractable,e.usages);else return{privateKey:e}}).then(function(e){if(n&&!equalBuffers(e.publicKey.buffer,n))throw new Error("Check public key failed");return e.privateKey})},setKey:function setKey(e,t){var r=this;return new PKCS8(e).getPrivateKey().then(function(e){return r.setPrivateKey(e,t)})},setPrivateKey:function setPrivateKey(e,t){var r=this,n=h["SC-01"].wrapping,i;return new Promise(call).then(function(){return r.getEncryptionKey(t)["catch"](function(){return r.generateContainer(t)})}).then(function(t){return l.wrapKey("raw",e,t,n)}).then(function(t){i=t;return l.generateKey(expand(e.algorithm,{ukm:e.buffer}),true,["sign","verify"])}).then(function(t){r.object={version:0,privateKeyAlgorithm:e.algorithm,privateKeyWrapped:i,attributes:{"id-sc-gostR3410-2001-publicKey":t.publicKey.buffer}};return r})},changePassword:function changePassword(e,t){var r=this;return r.getPrivateKey(e).then(function(e){return r.setPrivateKey(e,t)})},generate:function generate(e,t,r){var n=this,i;return new Promise(call).then(function(){if(!(e instanceof p.Request))e=new p.Request(e);return e.generate(r)}).then(function(e){i=e;return n.setKey(i,t)}).then(function(){return e})}});defineProperties(SignalComPrivateKeyInfo.prototype,SignalComKeyContainer.prototype);GostKeys.prototype.SignalComPrivateKeyInfo=SignalComPrivateKeyInfo;function CryptoProKeyContainer(e){if(e){this.header=y.GostKeyContainer.decode(e.header);this.name=y.GostKeyContainerName.decode(e.name);this.primary=y.GostPrivateKeys.decode(e.primary);this.masks=y.GostPrivateMasks.decode(e.masks);if(e.primary2&&e.masks2){this.primary2=y.GostPrivateKeys.decode(e.primary2);this.masks2=y.GostPrivateMasks.decode(e.masks2)}}}extend(Object,CryptoProKeyContainer,function(){function isKeySize512(e){return e.name.indexOf("-512")>=0||e.length===512}function isVersion2012(e){return!(e.name.indexOf("-94")>=0||e.name.indexOf("-2001")>=0||e.version===1994||e.version===2001)}function derivePasswordKey(e,t,r){var n=isVersion2012(e)?"GOST R 34.11-256":"GOST R 34.11-94/"+(e.sBox||"D-A"),i={name:"CPKDF",hash:n,salt:r,iterations:t?2e3:2};return l.importKey("raw",passwordData(i,t),i,false,["deriveKey","deriveBits"]).then(function(e){return l.deriveKey(i,e,"GOST 28147",false,["sign","verify","encrypt","decrypt"])})}function computePasswordMAC(e,t,r){var n=expand({name:"GOST 28147-MAC"},e.encParams);return derivePasswordKey(e,t,r).then(function(e){return l.sign(n,e,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]))})}function computeContainerMAC(e,t){var r=expand({name:"GOST 28147-MAC"},e.encParams),n=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return l.importKey("raw",n,r,false,["sign"]).then(function(e){return l.sign(r,e,t.encode())})}function computeMaskMAC(e,t,r){var n=expand({name:"GOST 28147-MAC"},e.encParams),i=t.byteLength===64?new Uint8Array(new Uint8Array(t,32,32)).buffer:t;return l.importKey("raw",i,n,false,["sign"]).then(function(e){return l.sign(n,e,r)})}function generateMasks(e){var t=expand(e,{mode:"MASK"}),r,n=getSeed(12);t.name=t.name.replace("-DH","");return l.generateKey(t,true,["wrapKey","unwrapKey"]).then(function(e){return l.exportKey("raw",e)}).then(function(t){r=t;return computeMaskMAC(e,r,n)}).then(function(e){return new y.GostPrivateMasks({mask:r,randomStatus:n,hmacRandom:e})})}function computeFP(e){return l.generateKey(expand(e.algorithm,{ukm:e.buffer}),true,["sign","verify"]).then(function(e){return new Uint8Array(new Uint8Array(e.publicKey.buffer,0,8)).buffer})}function unwrapKey(e,t,r,n,i){var a={name:"GOST 28147-ECB",sBox:e.encParams&&e.encParams.sBox},o=expand(e,{mode:"MASK"}),s;o.name=o.name.replace("-DH","");var c;return l.decrypt(a,t,r).then(function(e){c=e;return l.importKey("raw",n,o,"false",["sign","unwrapKey"])}).then(function(t){return l.unwrapKey("raw",c,t,o,e,"true",["sign"])}).then(function(e){s=e;return computeFP(s)}).then(function(e){if(!equalBuffers(e,i))throw new Error("Incorrect fp");return s})}function wrapKey(e,t,r,n){var i={name:"GOST 28147-ECB",sBox:e.encParams&&e.encParams.sBox},a=expand(e,{mode:"MASK"});a.name=a.name.replace("-DH","");return l.importKey("raw",n,a,false,["sign","wrapKey"]).then(function(e){return l.wrapKey("raw",r,e,a)}).then(function(e){return l.encrypt(i,t,e)})}function decryptKey(e,t,r,n,i){var a=e.primaryPrivateKeyParameters.privateKeyAlgorithm;return new Promise(call).then(function(){if(t.hmacKey)throw new Error("Old key format");if(r.randomStatus.byteLength<12)throw new Error("Invalid random status length");return computeMaskMAC(a,r.mask,r.randomStatus)}).then(function(e){if(!equalBuffers(e,r.hmacRandom))throw new Error("Imita for mask is invalid");return derivePasswordKey(a,n,new Uint8Array(r.randomStatus,0,12))}).then(function(n){return i&&t.secondaryKey?unwrapKey(e.secondaryPrivateKeyParameters.privateKeyAlgorithm,n,t.secondaryKey,r.mask,e.secondaryFP):unwrapKey(a,n,t.primaryKey,r.mask,e.primaryFP)})}function encryptKey(e,t,r,n,i,a){return derivePasswordKey(e,n,new Uint8Array(r.randomStatus,0,12)).then(function(t){return wrapKey(e,t,a,r.mask)}).then(function(e){if(!t)t=new y.GostPrivateKeys;if(i){t.secondaryKey=e}else{t.primaryKey=e}return t})}return{getKey:function getKey(e,t){return this.getPrivateKey(e,t).then(function(e){return(new PKCS8).setPrivateKey(e)})},getPrivateKey:function getPrivateKey(e,t){var r=this,n=r.header.keyContainerContent;return decryptKey(n,r.primary,r.masks,e,t)["catch"](function(i){if(r.primary2&&r.masks2)return decryptKey(n,r.primary2,r.masks2,e,t);else throw i})},getCertificate:function getCertificate(e){var t=this,r=t.header.keyContainerContent;return new Promise(call).then(function(){if(e)return new p.X509(r.secondaryCertificate);else return new p.X509(r.primaryCertificate)})},getContainerName:function getContainerName(){return this.name.containerName},setKey:function setKey(e,t,r,n){var i=this;return new PKCS8(e).getPrivateKey().then(function(e){return i.setPrivateKey(e,t,r,n)})},setPrivateKey:function setPrivateKey(e,t,r,n){var i=this,a,o;return new Promise(call).then(function(){i.header=i.header||new y.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary","kccaPrimaryKeyAbsent"],extensions:{keyValidity:{notAfter:now(n||g.days)}}}});a=i.header.keyContainerContent;var t=r?a.secondaryPrivateKeyParameters:a.primaryPrivateKeyParameters;if(!t){o=expand(e.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}});t={attributes:["pkaExportable","pkaExchange","pkaDhAllowed"],privateKeyAlgorithm:o};if(r){if(!a.primaryPrivateKeyParameters)throw new Error("Primary key must be defined first");a.secondaryPrivateKeyParameters=t}else{a.primaryPrivateKeyParameters=t;var s=a.attributes.indexOf("kccaPrimaryKeyAbsent");if(s>=0)a.attributes.splice(s,1)}}else o=t.privateKeyAlgorithm;var c=[];[0,1].forEach(function(e){var t="masks"+(e>0?"2":"");if(!i[t])c.push(generateMasks(o).then(function(e){i[t]=e}))});return Promise.all(c)}).then(function(){var n=[];[0,1].forEach(function(a){var s="primary"+(a>0?"2":""),c="masks"+(a>0?"2":"");n.push(encryptKey(o,i[s],i[c],t,r,e).then(function(e){i[s]=e}))});return Promise.all(n)}).then(function(){return computeFP(e).then(function(e){if(r)a.secondaryFP=e;else a.primaryFP=e})}).then(function(){var e=a.attributes.indexOf("kccaSoftPassword");if(t){if(e<0)a.attributes.push("kccaSoftPassword");return computePasswordMAC(o,t,a.primaryFP)}else{if(e>=0)a.attributes.splice(e,1)}}).then(function(e){if(e)a.hmacPassword=e;return computeContainerMAC(o,a)}).then(function(e){i.header.hmacKeyContainerContent=e;return i})},setCertificate:function setCertificate(e,t,r){var n=this,i,a;return new Promise(call).then(function(){n.header=n.header||new y.GostKeyContainer({keyContainerContent:{containerAlgoritmIdentifier:{algorithm:"id-CryptoPro-GostPrivateKeys-V2-Full"},attributes:["kccaReservePrimary","kccaPrimaryKeyAbsent"],extensions:{keyValidity:{notAfter:now(r||g.days)}}}});i=n.header.keyContainerContent;e=new p.X509(e);a=i.primaryPrivateKeyParameters&&i.primaryPrivateKeyParameters.privateKeyAlgorithm||expand(e.subjectPublicKeyInfo.algorithm,{sBox:"D-A",encParams:{block:"CFB",sBox:"E-A",keyMeshing:"CP"}});return e.getPublicKey()}).then(function(r){if(t){if(i.secondaryFP&&!equalBuffers(i.secondaryFP,new Uint8Array(r.buffer,0,i.secondaryFP.byteLength)))throw new Error("The public key of the certificate does not match the private key");i.secondaryCertificate=e}else{if(i.primaryFP&&!equalBuffers(i.primaryFP,new Uint8Array(r.buffer,0,i.primaryFP.byteLength)))throw new Error("The public key of the certificate does not match the private key");i.primaryCertificate=e}return computeContainerMAC(a,i)}).then(function(e){n.header.hmacKeyContainerContent=e;return n})},setContainerName:function setContainerName(e){this.name=new y.GostKeyContainerName({containerName:e})},verify:function verify(e){var t=this,r,n;return new Promise(call).then(function(){r=t.header.keyContainerContent;n=r.primaryPrivateKeyParameters.privateKeyAlgorithm;return computeContainerMAC(n,r)}).then(function(i){if(!equalBuffers(i,t.header.hmacKeyContainerContent))throw new Error("Container is not valid.");var a=r.attributes.indexOf("kccaSoftPassword")>=0;if(!e&&a)throw new Error("Password is required");if(e&&!a)throw new Error("Password is not reqiured.");if(e)return computePasswordMAC(n,e,r.primaryFP).then(function(e){if(!equalBuffers(e,r.hmacPassword))throw new Error("Password is not valid.");return t});return t})},changePassword:function changePassword(e,t){var r=this,n;return new Promise(call).then(function(){n=r.header.keyContainerContent;if(!n.primaryPrivateKeyParameters)throw new Error("Private key not yet defined");return r.getPrivateKey(e).then(function(e){return r.setPrivateKey(e,t)})}).then(function(){if(n.secondaryPrivateKeyParameters)return r.getPrivateKey(e,true).then(function(e){return r.setPrivateKey(e,t,true)});return r})},generate:function generate(e,t,r){var n=this,i,a;return new Promise(call).then(function(){if(!(e instanceof p.Request))e=new p.Request(e);return e.generate(r)}).then(function(e){a=e;return n.setKey(a,t)}).then(function(){i=new p.X509(e);return i.sign(a)}).then(function(){return n.setCertificate(i)}).then(function(){return e})},encode:function encode(e){return{header:this.header.encode(e),name:this.name.encode(e),masks:this.masks.encode(e),primary:this.primary.encode(e),masks2:this.masks2.encode(e),primary2:this.primary2.encode(e)}}}}());GostKeys.prototype.CryptoProKeyContainer=CryptoProKeyContainer;function ViPNetContainerEntry(e){y.ViPNetInfo.call(this,e||{version:3,keyInfo:{keyClass:1,keyType:43556,flags:1},defenceKeyInfo:{keyClass:1024,keyType:24622,keyUID:getSeed(32),flags:-2147483648}})}extend(y.ViPNetInfo,ViPNetContainerEntry,function(){function getKeyPassword(e){if(e===undefined)e="";var t=d.Chars.decode(e,"win1251"),r;return l.digest("GOST R 34.11-94",t).then(function(e){r=e;var n=new Uint8Array(t.byteLength+r.byteLength);n.set(new Uint8Array(t),0);n.set(new Uint8Array(r),t.byteLength);return l.digest("GOST R 34.11-94",n)}).then(function(e){return l.importKey("raw",e,"GOST 28147",false,["unwrapKey"])}).then(function(e){return l.unwrapKey("raw",r,e,"GOST 28147-MASK/VN","GOST 28147-89","false",["encrypt","decrypt","sign","verify"])})}return{getPrivateKey:function getPrivateKey(e){var t=this,r,n;return new Promise(call).then(function(){return!e||typeof e==="string"?getKeyPassword(e):e}).then(function(i){e=i;r=t.keyPart;n=new Uint8Array(r,0,r.byteLength-4-8);var a=new Uint8Array(r,n.byteLength,4),o=t.keyInfo.encode(),s=new Uint8Array(n.byteLength+o.byteLength);s.set(new Uint8Array(n),0);s.set(new Uint8Array(o),n.byteLength);return l.verify({name:"GOST 28147-89-MAC"},e,a,s)}).then(function(t){if(!t)throw new Error("Invalid key password");var i=new Uint8Array(r,r.byteLength-8,8);return l.decrypt({name:"GOST 28147-89-CFB",iv:i},e,n)}).then(function(e){var r=e.byteLength/2;if(t.keyInfo.keyClass&3===0){return l.importKey("raw",new Int32Array(e,r,r),"GOST 28147",false,["unwrapKey"]).then(function(t){return l.unwrapKey("raw",new Int32Array(e,0,r),t,"GOST 28147-MASK/VN","GOST 28147-89","false",["encrypt","decrypt","sign","verify"])})}else{var n=t.keyInfo.algorithm||t.certificate&&t.certificate.subjectPublicKeyInfo.algorithm;if(!n)throw new Error("Algorithm is not specified");var i=expand(n,{mode:"MASK",procreator:"VN"});i.name=i.name.replace("-DH","");var a=new Uint8Array(e,0,r),o=new Uint8Array(e,r,r);return l.importKey("raw",o,i,"false",["sign","unwrapKey"]).then(function(e){return l.unwrapKey("raw",a,e,i,n,"true",["sign","deriveBits","deriveKey"])}).then(function(e){if(t.publicKey)return l.generateKey(expand(e.algorithm,{ukm:e.buffer}),e.extractable,e.usages);else return{privateKey:e}}).then(function(e){if(t.publicKey&&!equalBuffers(e.publicKey.buffer,t.publicKey))throw new Error("Check public key failed");return e.privateKey})}})},setPrivateKey:function setPrivateKey(e,t,r){var n=this,i,a,o,s;return new Promise(call).then(function(){return!t||typeof t==="string"?getKeyPassword(t):t}).then(function(a){t=a;var o=e.algorithm;n.keyInfo.algorithm=o;n.keyInfo.serialNumber=getSeed(16);n.keyInfo.keyUID=getSeed(8);n.keyInfo.validity={notBefore:today(),notAfter:today(r||g.days)};if(e.type==="private"){i=expand(o,{mode:"MASK",procreator:"VN"});i.name=i.name.replace("-DH","");n.keyInfo.keyClass=1;n.keyInfo.keyType=43556;return l.generateKey(expand(o,{ukm:e.buffer}),true,["sign","verify"]).then(function(e){n.publicKey=e.publicKey.buffer;if(n.certificate){var t=n.certificate.subjectPublicKeyInfo;return l.importKey("spki",t.encode(),t.algorithm,true,["verify"])}}).then(function(e){if(e&&!equalBuffers(e.buffer,n.publicKey))delete n.certificate})}else if(e.type==="secret"){i="GOST 28147/MASK/VN";delete n.certificate;delete n.publicKey;n.keyInfo.keyClass=64;n.keyInfo.keyType=24622}else throw new Error("Invalid key type")}).then(function(){return l.generateKey(i,true,["wrapKey","unwrapKey"])}).then(function(t){a=t;return l.wrapKey("raw",e,a,i)}).then(function(e){o=new Uint8Array(e.byteLength*2);o.set(new Uint8Array(e));return l.exportKey("raw",a)}).then(function(e){o.set(new Uint8Array(e),e.byteLength);s=new Uint8Array(o.byteLength+12);var r={name:"GOST 28147-CFB",iv:getSeed(8)};s.set(new Uint8Array(r.iv),s.byteLength-8);return l.encrypt(r,t,o)}).then(function(e){s.set(new Uint8Array(e));var r=n.keyInfo.encode(),i=new Uint8Array(e.byteLength+r.byteLength);i.set(new Uint8Array(e),0);i.set(new Uint8Array(r),e.byteLength);return l.sign({name:"GOST 28147-89-MAC"},t,i)}).then(function(e){s.set(new Uint8Array(e),s.byteLength-12);n.keyPart=s.buffer;return n})},encode:function encode(e){var t=y.ViPNetInfo.method("encode").call(this),r=new Uint8Array(8+t.byteLength+this.keyPart.byteLength);set32(r.buffer,0,4+t.byteLength+this.keyPart.byteLength);r.set(new Uint8Array(t),4);set32(r.buffer,4+t.byteLength,this.keyPart.byteLength);r.set(new Uint8Array(this.keyPart),8+t.byteLength);if(e==="PEM")return d.Base64.encode(r.buffer);return r.buffer}}}(),{decode:function decode(e){if(typeof e==="string")e=d.Base64.decode(e);e=buffer(e);var t=get32(e,0);if(e.byteLength!==t+4)throw new Error("Invalid container entry size");var r=d.BER.decode(new Uint8Array(e,4,t));var n=y.ViPNetInfo.decode.call(this,r);var i=r.header.byteLength+r.content.byteLength,a=get32(e,4+i);if(e.byteLength!==i+a+8)throw new Error("Invalid container key part size");n.keyPart=new Uint8Array(new Uint8Array(e,i+8,a)).buffer;return n}});GostKeys.prototype.ViPNetContainerEntry=ViPNetContainerEntry;function ViPNetContainer(e){if(e&&(e instanceof f||e.buffer instanceof f||typeof e==="string"))this.decode(e);else{e=e||{};this.fileType=e.fileType||"ITCS";this.fileVersion=e.fileVersion||16;if(e.applicationHeader)this.applicationHeader=e.applicationHeader;this.entries=e.entries||[]}}extend(Object,ViPNetContainer,{getCertificate:function getCertificate(e){var t=this;return new Promise(call).then(function(){var r=t.entries[e||0];if(!r)throw new Error("Entry not defined");if(r.certificate)return new p.X509(r.certificate)})},getKey:function getKey(e,t){return this.getPrivateKey(e,t).then(function(e){return(new PKCS8).setPrivateKey(e)})},getPrivateKey:function getPrivateKey(e,t){var r=this;return new Promise(call).then(function(){var n=r.entries[t||0];if(!n)throw new Error("Entry not defined");return n.getPrivateKey(e)})},setCertificate:function setCertificate(e,t){var r=this,n,e;return new Promise(call).then(function(){n=r.entries[t||0]||(r.entries[t||0]=new ViPNetContainerEntry);e=new p.X509(e);if(n.publicKey)return e.getPublicKey()}).then(function(t){if(t&&!equalBuffers(n.publicKey,t.buffer))throw new Error("Invalid certificate for private key");n.certificate=e;return r})},setKey:function setKey(e,t,r,n){var i=this;return new PKCS8(e).getPrivateKey().then(function(e){return i.setPrivateKey(e,t,r,n)})},setPrivateKey:function setPrivateKey(e,t,r,n){var i=this;return new Promise(call).then(function(){var a=i.entries[r||0]||(i.entries[r||0]=new ViPNetContainerEntry);return a.setPrivateKey(e,t,n)}).then(function(){return i})},changePassword:function changePassword(e,t){var r=this;return new Promise(call).then(function(){return r.getPrivateKey(e).then(function(e){return r.setPrivateKey(e,t)})})},generate:function generate(e,t,r){var n=this,i,a;return new Promise(call).then(function(){if(!(e instanceof p.Request))e=new p.Request(e);return e.generate(r)}).then(function(e){a=e;return n.setKey(a,t)}).then(function(){i=new p.X509(e);return i.sign(a)}).then(function(){return n.setCertificate(i)}).then(function(){return e})},encode:function encode(e){var t=[],r=0;this.entries.forEach(function(e){var n=e.encode();r+=n.byteLength;t.push(n)});var n=this.applicationHeader?this.applicationHeader.byteLength:0,i=new Uint8Array(12+n+r);i.set(new Uint8Array(d.Chars.decode(this.fileType,"ascii")));set32(i.buffer,4,this.fileVersion);set32(i.buffer,8,n);if(n>0)i.set(new Uint8Array(this.applicationHeader),12);var a=12+n;t.forEach(function(e){i.set(new Uint8Array(e),a);a+=e.byteLength});if(e==="PEM")return d.Base64.encode(i.buffer);return i.buffer},decode:function decode(e){e=this.constructor.decode(e);this.fileType=e.fileType;this.fileVersion=e.fileVersion;if(e.applicationHeader)this.applicationHeader=e.applicationHeader;this.entries=e.entries}},{encode:function encode(e,t){return new this(e).encode(t)},decode:function decode(e){if(typeof e==="string")e=d.Base64.decode(e);e=buffer(e);var t=d.Chars.encode(new Uint8Array(e,0,4),"ascii");if(t!=="ITCS"&&t!=="PKEY"&&t!=="_CCK"&&t!=="_LCK")throw new Error("Unsupported ViPNet container type");var r=get32(e,4),n=r>>>16,i=r&65535;if(n!==0&&n!==1||i>255)throw new Error("Unsupported ViPNet container version");var a=get32(e,8),o;if(a>0)o=buffer(new Uint8Array(e,12,a));var s=12+a,c=[];while(s<e.byteLength){var u=get32(e,s);c.push(ViPNetContainerEntry.decode(new Uint8Array(e,s,u+4)));s=s+u+4}return new ViPNetContainer({fileType:t,fileVersion:r,applicationHeader:o,entries:c})}});GostKeys.prototype.ViPNetContainer=ViPNetContainer;function PKCS12(e){y.PFX.call(this,e||{version:3,authSafe:{contentType:"data"}})}extend(y.PFX,PKCS12,function(){function calcHMAC(e,t,r){var n={name:"HMAC",hash:e.hash};return l.importKey("raw",passwordData(e,t),e,false,["deriveKey"]).then(function(t){return l.deriveKey(e,t,n,false,["sign"])}).then(function(e){return l.sign(n,e,r)})}function verifyHMAC(e,t,r,n){return calcHMAC(e,t,n).then(function(e){if(!equalBuffers(r,e))throw new Error("Invalid password, MAC is not verified")})}return{sign:function sign(e,t){var r=this;return new Promise(call).then(function(){if(e){var n,i,a;if(t)a=h[t];else t=h[g.providerName].digest;if(a){n=a.digest;i=a.derivation}else{n=t;i={name:"PFXKDF",hash:n,iterations:2e3}}i=expand(i,{salt:getSeed(saltSize(n)),diversifier:3});var o=r.authSafe.content;return calcHMAC(i,e,o).then(function(e){r.macData={mac:{digestAlgorithm:n,digest:e},macSalt:i.salt,iterations:i.iterations};return r})}else return r})},verify:function verify(e){var t=this,r=t.authSafe,n;return new Promise(call).then(function(){if(r.contentType==="data"){if(t.macData){if(!e)throw new Error("Password must be defined for the MAC verification");n={name:"PFXKDF",hash:t.macData.mac.digestAlgorithm,salt:t.macData.macSalt,iterations:t.macData.iterations,diversifier:3};var i=t.authSafe.content,a=t.macData.mac.digest;return verifyHMAC(n,e,a,i)["catch"](function(){n.name="PBKDF2";return verifyHMAC(n,e,a,i)})}}else throw new Error("Unsupported format")}).then(function(){return t})}}}());GostKeys.prototype.PKCS12=PKCS12;function KeyStore(e){this.entries={};if(e)for(var t in e){this.setEntry(t,e[t])}}extend(Object,KeyStore,{aliases:function aliases(){var e=[];for(var t in this.entries){e.push(t)}return e},containsAlias:function containsAlias(e){return!!this.entries[e]},deleteEntry:function deleteEntry(e){delete this.entries[e]},setEntry:function setEntry(e,t){var r={};if(t.key){try{r.key=new PKCS8(t.key,true)}catch(e){try{r.key=new PKCS8Encrypted(t.key,true)}catch(e){if(t.key instanceof f)r.key=t.key;else throw new Error("Unknown Key format")}}}if(t.certs){var n=t.certs instanceof Array?t.certs:[t.certs];for(var i=0;i<n.length;i++){try{n[i]=new p.X509(n[i])}catch(e){}}r.certs=n}if(t.crls){var a=t.crls instanceof Array?t.crls:[t.crls];for(var i=0;i<a.length;i++){try{a[i]=new p.CRL(a[i])}catch(e){}}r.crls=a}this.entries[e]=r},getEntry:function getEntry(e){return this.entries[e]},load:function load(e,t){var r=this;return new Promise(call).then(function(){e=new PKCS12(e);return e.verify(t)}).then(function(){if(e.authSafe.contentType!=="data")throw new Error("Unsupported PFX format");var r=y.AuthenticatedSafe.decode(e.authSafe.content).object,n=[];r.forEach(function(e){if(e.contentType==="data")n.push(new v.DataContentInfo(e));else if(e.contentType==="encryptedData")n.push(new v.EncryptedDataContentInfo(e).getEnclosed(t));else throw new Error("Unsupported PFX format")});return Promise.all(n)}).then(function(e){var r={};e.forEach(function(e){var t=y.SafeContents.decode(e.content).object;t.forEach(function(e){var t=d.Hex.encode(e.bagAttributes&&e.bagAttributes.localKeyId||getSeed(4),true),n=r[t]||(r[t]={});switch(e.bagId){case"keyBag":n.key=new PKCS8(e.bagValue);break;case"pkcs8ShroudedKeyBag":n.key=new PKCS8Encrypted(e.bagValue);break;case"secretBag":if(e.bagValue.secretTypeId==="secret")n.key=e.bagValue.secretValue;break;case"certBag":var i=n.certs||(n.certs=[]);if(e.bagValue.certId==="x509Certificate")i.push(new p.X509(e.bagValue.certValue));break;case"crlBag":var a=n.crls||(n.crls=[]);if(e.bagValue.crlId==="x509CRL")a.push(new p.CRL(e.bagValue.crlValue));break}if(e.bagAttributes&&e.bagAttributes.friendlyName)n.friendlyName=e.bagAttributes.friendlyName})});var n=[];for(var i in r){n.push(function(e){if(e.key instanceof PKCS8Encrypted)return e.key.getKey(t).then(function(t){e.key=t;return e})["catch"](function(){return e});else return e}(r[i]))}return Promise.all(n)}).then(function(e){e.forEach(function(e){var t=e.friendlyName;if(t){delete e.friendlyName;r.entries[t]=e}else r.entries[generateUUID()]=e});return r})},store:function store(e,t,r){var n=this,i=[],a=[],o=[];return new Promise(call).then(function(){if(r)r=h[r]?h[r].pbes:r;else if(t)r=h[t]?h[t].pbes:h[g.providerName].pbes;else r=h[g.providerName].pbes;var o=1;for(var s in n.entries){var c=new Uint32Array([o]),u=n.entries[s];if(u.key){(function(t,n){if(t instanceof f)a.push({bagId:"secretBag",bagValue:{secretTypeId:"secret",secretValue:t,bagAttributes:n}});else if(t instanceof PKCS8){if(r&&e)i.push((new PKCS8Encrypted).setKey(t,e,r).then(function(e){return{bagId:"pkcs8ShroudedKeyBag",bagValue:e,bagAttributes:n}}));else i.push({bagId:"keyBag",bagValue:t,bagAttributes:n})}else if(t instanceof PKCS8Encrypted)i.push({bagId:"pkcs8ShroudedKeyBag",bagValue:t,bagAttributes:n})})(u.key,{localKeyId:c,friendlyName:s})}if(u.certs){u.certs.forEach(function(e){var t={localKeyId:c};if(e instanceof p.X509)a.push({bagId:"certBag",bagValue:{certId:"x509Certificate",certValue:e},bagAttributes:t})})}if(u.crls){u.crls.forEach(function(e){var t={localKeyId:c};if(e instanceof p.CRL)a.push({bagId:"crlBag",bagValue:{crlId:"x509CRL",crlValue:e},bagAttributes:t})})}}if(i.length>0)return Promise.all(i)}).then(function(t){if(t){var n=y.SafeContents.encode(t);o.push(new v.DataContentInfo({contentType:"data",content:n}))}if(a.length>0){a=y.SafeContents.encode(a);if(r&&e)return(new v.EncryptedDataContentInfo).encloseContent(a,e,r);else return(new v.DataContentInfo).encloseContent(a)}}).then(function(r){o.push(r);o=new y.AuthenticatedSafe(o);var n=new PKCS12;n.authSafe={contentType:"data",content:o.encode()};return n.sign(e,t)})}});GostKeys.prototype.KeyStore=KeyStore;var m=t.gostKeysInstance=new GostKeys},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.expand=expand;function expand(){var e={};for(var t=0,r=arguments.length;t<r;t++){var i=arguments[t];if((typeof i==="undefined"?"undefined":n(i))==="object")for(var a in i){e[a]=i[a]}}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.GostEngine=t.CryptoGost=undefined;var n=r(15);var i=r(10);t.CryptoGost=n.gostCrypto;t.GostEngine=i.gostEngine}])});
//# sourceMappingURL=CryptoGost.min.js.map